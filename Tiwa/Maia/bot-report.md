**Note:** There is a section for disputed findings below the usual findings sections

## Summary

### Medium Risk Issues

| |Issue|Instances|
|-|:-|:-:|
| [[M&#x2011;01](#m01-unchecked-return-value-of-low-level-calldelegatecall)] | Unchecked return value of low-level `call()`/`delegatecall()` | 3 | 
| [[M&#x2011;02](#m02-use-of-transferfrom-rather-than-safetransferfrom-for-nfts-in-will-lead-to-the-loss-of-nfts)] | Use of `transferFrom()` rather than `safeTransferFrom()` for NFTs in will lead to the loss of NFTs | 1 | 
| [[M&#x2011;03](#m03-the-owner-is-a-single-point-of-failure-and-a-centralization-risk)] | The `owner` is a single point of failure and a centralization risk | 38 | 
| [[M&#x2011;04](#m04-return-values-of-approve-not-checked)] | Return values of `approve()` not checked | 1 | 

Total: 43 instances over 4 issues

### Low Risk Issues

| |Issue|Instances|
|-|:-|:-:|
| [[L&#x2011;01](#l01-addstrategytoken-does-note-remove-old-entries-before-adding-new-ones)] | `addStrategyToken()` does note remove old entries before adding new ones | 2 | 
| [[L&#x2011;02](#l02-unsafe-downcast)] | Unsafe downcast | 8 | 
| [[L&#x2011;03](#l03-array-lengths-not-checked)] | Array lengths not checked | 1 | 
| [[L&#x2011;04](#l04-receivepayable-fallback-function-does-not-authorize-requests)] | `receive()`/`payable fallback()` function does not authorize requests | 3 | 
| [[L&#x2011;05](#l05-safeapprove-is-deprecated)] | `safeApprove()` is deprecated | 2 | 
| [[L&#x2011;06](#l06-use-ownable2step-rather-than-ownable)] | Use `Ownable2Step` rather than `Ownable` | 12 | 
| [[L&#x2011;07](#l07-empty-receivefallback-function)] | Empty `receive()`/`fallback()` function | 3 | 
| [[L&#x2011;08](#l08-external-calls-in-an-un-bounded-for-loop-may-result-in-a-dos)] | External calls in an un-bounded `for-`loop may result in a DOS | 4 | 
| [[L&#x2011;09](#l09-consider-implementing-two-step-procedure-for-updating-protocol-addresses)] | Consider implementing two-step procedure for updating protocol addresses | 10 | 
| [[L&#x2011;10](#l10-name-is-not-a-part-of-the-erc-20-standard)] | `name()` is not a part of the ERC-20 standard | 5 | 
| [[L&#x2011;11](#l11-symbol-is-not-a-part-of-the-erc-20-standard)] | `symbol()` is not a part of the ERC-20 standard | 5 | 
| [[L&#x2011;12](#l12-decimals-is-not-a-part-of-the-erc-20-standard)] | `decimals()` is not a part of the ERC-20 standard | 4 | 
| [[L&#x2011;13](#l13-safetransferlib-does-not-ensure-that-the-token-contract-exists)] | `SafeTransferLib` does not ensure that the token contract exists | 2 | 
| [[L&#x2011;14](#l14-functions-calling-contractsaddresses-with-transfer-hooks-are-missing-reentrancy-guards)] | Functions calling contracts/addresses with transfer hooks are missing reentrancy guards | 1 | 
| [[L&#x2011;15](#l15-approvesafeapprove-may-revert-if-the-current-approval-is-not-zero)] | `approve()`/`safeApprove()` may revert if the current approval is not zero | 3 | 
| [[L&#x2011;16](#l16-external-call-recipient-may-consume-all-transaction-gas)] | External call recipient may consume all transaction gas | 8 | 
| [[L&#x2011;17](#l17-missing-contract-existence-checks-before-low-level-calls)] | Missing contract-existence checks before low-level calls | 4 | 
| [[L&#x2011;18](#l18-code-does-not-follow-the-best-practice-of-check-effects-interaction)] | Code does not follow the best practice of check-effects-interaction | 43 | 
| [[L&#x2011;19](#l19-missing-checks-for-address0x0-in-the-constructorinitializer)] | Missing checks for `address(0x0)` in the constructor/initializer | 7 | 
| [[L&#x2011;20](#l20-missing-checks-for-address0x0-when-updating-address-state-variables)] | Missing checks for `address(0x0)` when updating `address` state variables | 1 | 
| [[L&#x2011;21](#l21-state-variables-not-capped-at-reasonable-values)] | State variables not capped at reasonable values | 2 | 
| [[L&#x2011;22](#l22-tokens-may-be-minted-to-address0x0)] | Tokens may be minted to `address(0x0)` | 2 | 
| [[L&#x2011;23](#l23-initialization-can-be-front-run)] | Initialization can be front-run | 8 | 

Total: 140 instances over 23 issues

### Non-critical Issues

| |Issue|Instances|
|-|:-|:-:|
| [[N&#x2011;01](#n01-public-functions-not-called-by-the-contract-should-be-declared-external-instead)] | `public` functions not called by the contract should be declared `external` instead | 6 | 
| [[N&#x2011;02](#n02-event-is-not-properly-indexed)] | Event is not properly `indexed` | 1 | 
| [[N&#x2011;03](#n03-duplicated-requirerevert-checks-should-be-refactored-to-a-modifier-or-function)] | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function | 12 | 
| [[N&#x2011;04](#n04-common-functions-should-be-refactored-to-a-common-base-contract)] | Common functions should be refactored to a common base contract | 1 | 
| [[N&#x2011;05](#n05-import-declarations-should-import-specific-identifiers-rather-than-the-whole-file)] | Import declarations should import specific identifiers, rather than the whole file | 1 | 
| [[N&#x2011;06](#n06-events-that-mark-critical-parameter-changes-should-contain-both-the-old-and-the-new-value)] | Events that mark critical parameter changes should contain both the old and the new value | 6 | 
| [[N&#x2011;07](#n07-constant-redefined-elsewhere)] | Constant redefined elsewhere | 25 | 
| [[N&#x2011;08](#n08-inconsistent-spacing-in-comments)] | Inconsistent spacing in comments | 145 | 
| [[N&#x2011;09](#n09-lines-are-too-long)] | Lines are too long | 32 | 
| [[N&#x2011;10](#n10-long-functions-should-be-refactored-into-multiple-smaller-functions)] | Long functions should be refactored into multiple, smaller, functions | 13 | 
| [[N&#x2011;11](#n11-inconsistent-method-of-specifying-a-floating-pragma)] | Inconsistent method of specifying a floating pragma | 3 | 
| [[N&#x2011;12](#n12-using--without-specifying-an-upper-bound-is-unsafe)] | Using `>`/`>=` without specifying an upper bound is unsafe | 3 | 
| [[N&#x2011;13](#n13-typos)] | Typos | 37 | 
| [[N&#x2011;14](#n14-file-is-missing-natspec)] | File is missing NatSpec | 3 | 
| [[N&#x2011;15](#n15-function-definition-modifier-order-does-not-follow-solidity-style-guide)] | Function definition modifier order does not follow Solidity style guide | 2 | 
| [[N&#x2011;16](#n16-assembly-blocks-should-have-extensive-comments)] | Assembly blocks should have extensive comments | 1 | 
| [[N&#x2011;17](#n17-visibility-should-be-set-explicitly-rather-than-defaulting-to-internal)] | Visibility should be set explicitly rather than defaulting to `internal` | 3 | 
| [[N&#x2011;18](#n18-function-ordering-does-not-follow-the-solidity-style-guide)] | Function ordering does not follow the Solidity style guide | 11 | 
| [[N&#x2011;19](#n19-contract-does-not-follow-the-solidity-style-guides-suggested-layout-ordering)] | Contract does not follow the Solidity style guide's suggested layout ordering | 15 | 
| [[N&#x2011;20](#n20-add-inline-comments-for-unnamed-variables)] | Add inline comments for unnamed variables | 18 | 
| [[N&#x2011;21](#n21-invalid-natspec-comment-style)] | Invalid NatSpec comment style | 67 | 
| [[N&#x2011;22](#n22-contracts-should-have-full-test-coverage)] | Contracts should have full test coverage | 1 | 
| [[N&#x2011;23](#n23-large-or-complicated-code-bases-should-implement-invariant-tests)] | Large or complicated code bases should implement invariant tests | 1 | 
| [[N&#x2011;24](#n24-consider-adding-formal-verification-proofs)] | Consider adding formal verification proofs | 1 | 
| [[N&#x2011;25](#n25-multiple-addressid-mappings-can-be-combined-into-a-single-mapping-of-an-addressid-to-a-struct-for-readability)] | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 3 | 
| [[N&#x2011;26](#n26-custom-errors-should-be-used-rather-than-revertrequire)] | Custom errors should be used rather than `revert()`/`require()` | 54 | 
| [[N&#x2011;27](#n27-use-abiencodecall-instead-of-abiencodewithsignatureabiencodewithselector)] | Use `abi.encodeCall()` instead of `abi.encodeWithSignature()`/`abi.encodeWithSelector()` | 12 | 
| [[N&#x2011;28](#n28-style-guide-non-externalpublic-variable-names-should-begin-with-an-underscore)] | Style guide: Non-`external`/`public` variable names should begin with an underscore | 23 | 
| [[N&#x2011;29](#n29-variable-names-for-immutables-should-use-constant_case)] | Variable names for `immutable`s should use CONSTANT_CASE | 39 | 
| [[N&#x2011;30](#n30-array-indicies-should-be-referenced-via-enums-rather-than-via-numeric-literals)] | Array indicies should be referenced via `enum`s rather than via numeric literals | 66 | 
| [[N&#x2011;31](#n31-consider-using-named-mappings)] | Consider using named mappings | 40 | 
| [[N&#x2011;32](#n32-use-of-override-is-unnecessary)] | Use of `override` is unnecessary | 117 | 
| [[N&#x2011;33](#n33-consider-using-descriptive-constants-when-passing-zero-as-a-function-argument)] | Consider using descriptive `constant`s when passing zero as a function argument | 4 | 
| [[N&#x2011;34](#n34-variables-need-not-be-initialized-to-zero)] | Variables need not be initialized to zero | 17 | 
| [[N&#x2011;35](#n35-requirerevert-statements-should-have-descriptive-reason-strings)] | `require()`/`revert()` statements should have descriptive reason strings | 13 | 
| [[N&#x2011;36](#n36-contractslibraries-should-each-be-defined-in-separate-files)] | Contracts/libraries should each be defined in separate files | 4 | 
| [[N&#x2011;37](#n37-contract-uses-both-requirerevert-as-well-as-custom-errors)] | Contract uses both `require()`/`revert()` as well as custom errors | 10 | 
| [[N&#x2011;38](#n38-contract-doesnt-handle-all-nft-types)] | Contract doesn't handle all NFT types | 2 | 
| [[N&#x2011;39](#n39-style-guide-non-externalpublic-function-names-should-begin-with-an-underscore)] | Style guide: Non-`external`/`public` function names should begin with an underscore | 2 | 
| [[N&#x2011;40](#n40-constants-should-be-defined-rather-than-using-magic-numbers)] | `constant`s should be defined rather than using magic numbers | 125 | 
| [[N&#x2011;41](#n41-events-are-missing-sender-information)] | Events are missing sender information | 27 | 
| [[N&#x2011;42](#n42-consider-adding-a-blockdeny-list)] | Consider adding a block/deny-list | 12 | 
| [[N&#x2011;43](#n43-consider-using-safetransferlibsafetransfereth-or-addresssendvalue-for-clearer-semantic-meaning)] | Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning | 3 | 
| [[N&#x2011;44](#n44-unused-import)] | Unused import | 15 | 
| [[N&#x2011;45](#n45-array-is-pushed-but-not-poped)] | Array is `push()`ed but not `pop()`ed | 12 | 
| [[N&#x2011;46](#n46-unused-struct-definition)] | Unused `struct` definition | 1 | 
| [[N&#x2011;47](#n47-unused-error-definition)] | Unused `error` definition | 7 | 
| [[N&#x2011;48](#n48-natspec-contract-declarations-should-have-natspec-descriptions)] | NatSpec: Contract declarations should have NatSpec descriptions | 4 | 
| [[N&#x2011;49](#n49-natspec-contract-declarations-should-have-notice-tags)] | NatSpec: Contract declarations should have `@notice` tags | 4 | 
| [[N&#x2011;50](#n50-natspec-error-declarations-should-have-natspec-descriptions)] | NatSpec: Error declarations should have NatSpec descriptions | 90 | 
| [[N&#x2011;51](#n51-natspec-event-declarations-should-have-natspec-descriptions)] | NatSpec: Event declarations should have NatSpec descriptions | 28 | 
| [[N&#x2011;52](#n52-natspec-state-variable-declarations-should-have-natspec-descriptions)] | NatSpec: State variable declarations should have NatSpec descriptions | 22 | 
| [[N&#x2011;53](#n53-natspec-function-declarations-should-have-natspec-descriptions)] | NatSpec: Function declarations should have NatSpec descriptions | 37 | 
| [[N&#x2011;54](#n54-natspec-function-declarations-should-have-notice-tags)] | NatSpec: Function declarations should have `@notice` tags | 37 | 
| [[N&#x2011;55](#n55-constants-in-comparisons-should-appear-on-the-left-side)] | Constants in comparisons should appear on the left side | 62 | 
| [[N&#x2011;56](#n56-custom-error-has-no-error-details)] | Custom error has no error details | 90 | 
| [[N&#x2011;57](#n57-natspec-contract-declarations-should-have-author-tags)] | NatSpec: Contract declarations should have `@author` tags | 9 | 
| [[N&#x2011;58](#n58-natspec-contract-declarations-should-have-dev-tags)] | NatSpec: Contract declarations should have `@dev` tags | 34 | 
| [[N&#x2011;59](#n59-natspec-contract-declarations-should-have-title-tags)] | NatSpec: Contract declarations should have `@title` tags | 4 | 
| [[N&#x2011;60](#n60-empty-function-body)] | Empty function body | 1 | 
| [[N&#x2011;61](#n61-use-bytesconcat-on-bytes-instead-of-abiencodepacked-for-clearer-semantic-meaning)] | Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning | 14 | 
| [[N&#x2011;62](#n62-if-statement-can-be-converted-to-a-ternary)] | `if`-statement can be converted to a ternary | 2 | 
| [[N&#x2011;63](#n63-overflows-in-unchecked-blocks)] | Overflows in unchecked blocks | 15 | 
| [[N&#x2011;64](#n64-consider-splitting-long-calculations)] | Consider splitting long calculations | 8 | 
| [[N&#x2011;65](#n65-contract-should-expose-an-interface)] | Contract should expose an `interface` | 47 | 
| [[N&#x2011;66](#n66-else-block-not-required)] | `else`-block not required | 2 | 
| [[N&#x2011;67](#n67-missing-event-and-or-timelock-for-critical-parameter-change)] | Missing event and or timelock for critical parameter change | 1 | 
| [[N&#x2011;68](#n68-setters-should-prevent-re-setting-of-the-same-value)] | Setters should prevent re-setting of the same value | 11 | 
| [[N&#x2011;69](#n69-polymorphic-functions-make-security-audits-more-time-consuming-and-error-prone)] | Polymorphic functions make security audits more time-consuming and error-prone | 6 | 
| [[N&#x2011;70](#n70-imports-could-be-organized-more-systematically)] | Imports could be organized more systematically | 4 | 
| [[N&#x2011;71](#n71-use-the-latest-solidity-prior-to-0820-if-on-l2s-for-deployment)] | Use the latest solidity (prior to 0.8.20 if on L2s) for deployment | 23 | 
| [[N&#x2011;72](#n72-consider-moving-msgsender-checks-to-a-common-authorization-modifier)] | Consider moving `msg.sender` checks to a common authorization `modifier` | 7 | 
| [[N&#x2011;73](#n73-non-libraryinterface-files-should-use-fixed-compiler-versions-not-floating-ones)] | Non-library/interface files should use fixed compiler versions, not floating ones | 23 | 
| [[N&#x2011;74](#n74-consider-adding-emergency-stop-functionality)] | Consider adding emergency-stop functionality | 13 | 
| [[N&#x2011;75](#n75-natspec-function-return-is-missing)] | NatSpec: Function `@return` is missing | 46 | 
| [[N&#x2011;76](#n76-natspec-function-param-is-missing)] | NatSpec: Function `@param` is missing | 111 | 
| [[N&#x2011;77](#n77-consider-bounding-input-array-length)] | Consider bounding input array length | 7 | 
| [[N&#x2011;78](#n78-named-imports-of-parent-contracts-are-missing)] | Named imports of parent contracts are missing | 1 | 
| [[N&#x2011;79](#n79-complex-casting)] | Complex casting | 59 | 
| [[N&#x2011;80](#n80-events-may-be-emitted-out-of-order-due-to-reentrancy)] | Events may be emitted out of order due to reentrancy | 7 | 
| [[N&#x2011;81](#n81-non-assembly-method-available)] | Non-assembly method available | 1 | 
| [[N&#x2011;82](#n82-missing-checks-constructorinitializer-assignments)] | Missing checks constructor/initializer assignments | 9 | 

Total: 1855 instances over 82 issues

### Gas Optimizations

| |Issue|Instances|Total Gas Saved|
|-|:-|:-:|:-:|
| [[G&#x2011;01](#g01-enable-ir-based-code-generation)] | Enable IR-based code generation | 1 |  - |
| [[G&#x2011;02](#g02-multiple-addressid-mappings-can-be-combined-into-a-single-mapping-of-an-addressid-to-a-struct-where-appropriate)] | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate | 5 |  - |
| [[G&#x2011;03](#g03-state-variables-only-set-in-the-constructor-should-be-declared-immutable)] | State variables only set in the constructor should be declared `immutable` | 3 |  6291 |
| [[G&#x2011;04](#g04-avoid-contract-existence-checks-by-using-low-level-calls)] | Avoid contract existence checks by using low-level calls | 52 |  5200 |
| [[G&#x2011;05](#g05-state-variables-should-be-cached-in-stack-variables-rather-than-re-reading-them-from-storage)] | State variables should be cached in stack variables rather than re-reading them from storage | 1 |  97 |
| [[G&#x2011;06](#g06-internal-functions-only-called-once-can-be-inlined-to-save-gas)] | `internal` functions only called once can be inlined to save gas | 14 |  280 |
| [[G&#x2011;07](#g07-arraylength-should-not-be-looked-up-in-every-loop-of-a-for-looparray)] | `<array>.length` should not be looked up in every loop of a `for`-loop | 8 |  24 |
| [[G&#x2011;08](#g08-requirerevert-strings-longer-than-32-bytes-cost-extra-gas)] | `require()`/`revert()` strings longer than 32 bytes cost extra gas | 22 |  66 |
| [[G&#x2011;09](#g09-optimize-names-to-save-gas)] | Optimize names to save gas | 24 |  528 |
| [[G&#x2011;10](#g10-i-costs-less-gas-than-i-especially-when-its-used-in-for-loops---ii---too)] | `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too) | 1 |  5 |
| [[G&#x2011;11](#g11-usage-of-uintsints-smaller-than-32-bytes-256-bits-incurs-overhead)] | Usage of `uints`/`ints` smaller than 32 bytes (256 bits) incurs overhead | 21 |  462 |
| [[G&#x2011;12](#g12-using-private-rather-than-public-for-constants-saves-gas)] | Using `private` rather than `public` for constants, saves gas | 12 |  - |
| [[G&#x2011;13](#g13-inverting-the-condition-of-an-if-else-statement-wastes-gas)] | Inverting the condition of an `if`-`else`-statement wastes gas | 1 |  - |
| [[G&#x2011;14](#g14-require-or-revert-statements-that-check-input-arguments-should-be-at-the-top-of-the-function)] | `require()` or `revert()` statements that check input arguments should be at the top of the function | 11 |  - |
| [[G&#x2011;15](#g15-use-custom-errors-rather-than-revertrequire-strings-to-save-gas)] | Use custom errors rather than `revert()`/`require()` strings to save gas | 49 |  - |
| [[G&#x2011;16](#g16-functions-guaranteed-to-revert-when-called-by-normal-users-can-be-marked-payable)] | Functions guaranteed to revert when called by normal users can be marked `payable` | 21 |  441 |
| [[G&#x2011;17](#g17-constructors-can-be-marked-payable)] | Constructors can be marked `payable` | 22 |  462 |
| [[G&#x2011;18](#g18-reduce-gas-usage-by-moving-to-solidity-0819-or-later)] | Reduce gas usage by moving to Solidity 0.8.19 or later | 44 |  - |
| [[G&#x2011;19](#g19--costs-less-gas-than-)] | `>=` costs less gas than `>` | 33 |  99 |
| [[G&#x2011;20](#g20-nesting-if-statements-is-cheaper-than-using-)] | Nesting `if`-statements is cheaper than using `&&` | 1 |  6 |
| [[G&#x2011;21](#g21-use-assembly-to-emit-events-in-order-to-save-gas)] | Use assembly to emit events, in order to save gas | 19 |  722 |
| [[G&#x2011;22](#g22-use--for-mappings)] | Use `+=` for `mapping`s | 5 |  200 |
| [[G&#x2011;23](#g23-using-bools-for-storage-incurs-overhead)] | Using `bool`s for storage incurs overhead | 13 |  1300 |
| [[G&#x2011;24](#g24-use-uint2561uint2562-instead-of-truefalse-to-save-gas-for-changes)] | Use `uint256(1)`/`uint256(2)` instead of `true`/`false` to save gas for changes | 13 |  222300 |
| [[G&#x2011;25](#g25-simple-checks-for-zero-can-be-done-using-assembly-to-save-gas)] | Simple checks for zero can be done using assembly to save gas | 25 |  150 |
| [[G&#x2011;26](#g26-avoid-updating-storage-when-the-value-hasnt-changed)] | Avoid updating storage when the value hasn't changed | 11 |  8800 |
| [[G&#x2011;27](#g27-unchecked---can-be-used-on-the-division-of-two-uints-in-order-to-save-gas)] | `unchecked {}`  can be used on the division of two `uint`s in order to save gas | 1 |  20 |
| [[G&#x2011;28](#g28-using-this-to-access-functions-results-in-an-external-call-wasting-gas)] | Using `this` to access functions results in an external call, wasting gas | 2 |  200 |
| [[G&#x2011;29](#g29-use-assembly-for-small-keccak256-hashes-in-order-to-save-gas)] | Use assembly for small keccak256 hashes, in order to save gas | 1 |  80 |
| [[G&#x2011;30](#g30-using-calldata-instead-of-memory-for-read-only-arguments-in-external-functions-saves-gas)] | Using `calldata` instead of `memory` for read-only arguments in `external` functions saves gas | 23 |  2760 |
| [[G&#x2011;31](#g31-avoid-transferring-amounts-of-zero-in-order-to-save-gas)] | Avoid transferring amounts of zero in order to save gas | 10 |  1000 |
| [[G&#x2011;32](#g32-avoid-fetching-a-low-level-calls-return-data-by-using-assembly)] | Avoid fetching a low-level call's return data by using assembly | 9 |  1431 |

Total: 478 instances over 32 issues with **252924 gas** saved

Gas totals are estimates based on data from the Ethereum Yellowpaper. The estimates use the lower bounds of ranges and count two iterations of each `for`-loop. All values above are runtime, not deployment, values; deployment values are listed in the individual issue descriptions. The table above as well as its gas numbers do not include any of the excluded findings.

### Disputed Issues

The issues below may be reported by other bots/wardens, but can be penalized/ignored since either the rule or the specified instances are invalid

| |Issue|Instances|
|-|:-|:-:|
| [[D&#x2011;01](#d01-unchecked-return-value-of-low-level-calldelegatecall)] | ~~Unchecked return value of low-level `call()`/`delegatecall()`~~ | 9 | 
| [[D&#x2011;02](#d02-return-values-of-approve-not-checked)] | ~~Return values of `approve()` not checked~~ | 1 | 
| [[D&#x2011;03](#d03-unsafe-downcast)] | ~~Unsafe downcast~~ | 5 | 
| [[D&#x2011;04](#d04-loss-of-precision)] | ~~Loss of precision~~ | 1 | 
| [[D&#x2011;05](#d05-solidity-version-0820-may-not-work-on-other-chains-due-to-push0)] | ~~Solidity version 0.8.20 may not work on other chains due to `PUSH0`~~ | 44 | 
| [[D&#x2011;06](#d06-approvesafeapprove-may-revert-if-the-current-approval-is-not-zero)] | ~~`approve()`/`safeApprove()` may revert if the current approval is not zero~~ | 1 | 
| [[D&#x2011;07](#d07-missing-contract-existence-checks-before-low-level-calls)] | ~~Missing contract-existence checks before low-level calls~~ | 27 | 
| [[D&#x2011;08](#d08-duplicated-requirerevert-checks-should-be-refactored-to-a-modifier-or-function-to-save-gas)] | ~~Duplicated require()/revert() checks should be refactored to a modifier Or function to save gas~~ | 12 | 
| [[D&#x2011;09](#d09-duplicated-requirerevert-checks-should-be-refactored-to-a-modifier-or-function)] | ~~Duplicated `require()`/`revert()` checks should be refactored to a modifier or function~~ | 56 | 
| [[D&#x2011;10](#d10-spdx-identifier-should-be-the-in-the-first-line-of-a-solidity-file)] | ~~SPDX identifier should be the in the first line of a solidity file~~ | 44 | 
| [[D&#x2011;11](#d11-overly-complicated-arithmetic)] | ~~Overly complicated arithmetic~~ | 18 | 
| [[D&#x2011;12](#d12-prefer-double-quotes-for-string-quoting)] | ~~Prefer double quotes for string quoting~~ | 3 | 
| [[D&#x2011;13](#d13-public-functions-not-used-internally-can-be-marked-as-external-to-save-gas)] | ~~Public functions not used internally can be marked as external to save gas~~ | 6 | 
| [[D&#x2011;14](#d14-require--revert-statements-should-have-descriptive-reason-strings)] | ~~`require()` / `revert()` statements should have descriptive reason strings~~ | 155 | 
| [[D&#x2011;15](#d15-solmates-safetransferlib-doesnt-check-whether-the-erc20-contract-exists)] | ~~Solmate's SafeTransferLib doesn't check whether the ERC20 contract exists~~ | 3 | 
| [[D&#x2011;16](#d16-natspec-contract-declarations-should-have-notice-tags)] | ~~NatSpec: Contract declarations should have `@notice` tags~~ | 44 | 
| [[D&#x2011;17](#d17-event-names-should-use-camelcase)] | ~~Event names should use CamelCase~~ | 28 | 
| [[D&#x2011;18](#d18-unnecessary-look-up-in-if-condition)] | ~~Unnecessary look up in if condition~~ | 3 | 
| [[D&#x2011;19](#d19-natspec-function-declarations-should-have-notice-tags)] | ~~NatSpec: Function declarations should have `@notice` tags~~ | 305 | 
| [[D&#x2011;20](#d20-timestamp-may-be-manipulation)] | ~~Timestamp may be manipulation~~ | 2 | 
| [[D&#x2011;21](#d21-using-bitmap-to-store-bool-states-can-save-gas)] | ~~Using bitmap to store bool states can save gas~~ | 10 | 
| [[D&#x2011;22](#d22-all-interfaces-used-within-a-project-should-be-imported)] | ~~All interfaces used within a project should be imported~~ | 21 | 
| [[D&#x2011;23](#d23-its-not-standard-to-end-and-begin-a-code-object-on-the-same-line)] | ~~It's not standard to end and begin a code object on the same line~~ | 99 | 
| [[D&#x2011;24](#d24-save-gas-with-the-use-of-specific-import-statements)] | ~~Save gas with the use of specific import statements~~ | 1 | 
| [[D&#x2011;25](#d25-use-safeapprove)] | ~~Use `safeApprove()`~~ | 2 | 
| [[D&#x2011;26](#d26-use-assembly-to-write-addresscontract-type-storage-values)] | ~~Use `assembly` to write address/contract type storage values~~ | 25 | 
| [[D&#x2011;27](#d27-use-multiple-require-and-if-statements-instead-of-)] | ~~Use multiple `require()` and `if` statements instead of `&&`~~ | 1 | 
| [[D&#x2011;28](#d28-it-is-standard-for-all-external-and-public-functions-to-be-override-from-an-interface)] | ~~It is standard for all external and public functions to be override from an interface~~ | 117 | 
| [[D&#x2011;29](#d29-must-approve-or-increase-allowance-first)] | ~~Must approve or increase allowance first~~ | 9 | 
| [[D&#x2011;30](#d30-cast-to-bytes-or-bytes32-for-clearer-semantic-meaning)] | ~~Cast to `bytes` or `bytes32` for clearer semantic meaning~~ | 42 | 
| [[D&#x2011;31](#d31-return-values-of-transfertransferfrom-not-checked)] | ~~Return values of transfer()/transferFrom() not checked~~ | 1 | 
| [[D&#x2011;32](#d32-array-lengths-not-checked)] | ~~Array lengths not checked~~ | 6 | 
| [[D&#x2011;33](#d33-use-bytesconcat-on-bytes-instead-of-abiencodepacked-for-clearer-semantic-meaning)] | ~~Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning~~ | 28 | 
| [[D&#x2011;34](#d34-use-inheritdoc-rather-than-using-a-non-standard-annotation)] | ~~Use `@inheritdoc` rather than using a non-standard annotation~~ | 10 | 
| [[D&#x2011;35](#d35-empty-function-body)] | ~~Empty function body~~ | 4 | 
| [[D&#x2011;36](#d36-operator--costs-more-gas-than---for-state-variables)] | ~~Operator += costs more gas than = + for state variables~~ | 5 | 
| [[D&#x2011;37](#d37-using-named-function-calls-is-a-much-safer)] | ~~Using named function calls is a much safer~~ | 4 | 
| [[D&#x2011;38](#d38-selfbalance-is-cheaper-than-addressthisbalance)] | ~~`selfbalance()` is cheaper than `address(this).balance`~~ | 9 | 
| [[D&#x2011;39](#d39-contract-should-expose-an-interface)] | ~~Contract should expose an `interface`~~ | 4 | 
| [[D&#x2011;40](#d40-storage-write-removal-bug-on-conditional-early-termination)] | ~~Storage Write Removal Bug On Conditional Early Termination~~ | 1 | 
| [[D&#x2011;41](#d41-low-level-calls-with-solidity-before-0814-result-in-an-optimiser-bug)] | ~~Low level calls with Solidity before 0.8.14 result in an optimiser bug~~ | 1 | 
| [[D&#x2011;42](#d42-abiencode-is-less-efficient-than-abiencodepacked)] | ~~`abi.encode()` is less efficient than `abi.encodepacked()`~~ | 15 | 
| [[D&#x2011;43](#d43-large-approvals-may-not-work-with-some-erc20-tokens)] | ~~Large approvals may not work with some ERC20 tokens~~ | 4 | 
| [[D&#x2011;44](#d44-not-initializing-local-variables-to-zero-saves-gas)] | ~~Not initializing local variables to zero saves gas~~ | 15 | 
| [[D&#x2011;45](#d45-using-this-to-access-functions-results-in-an-external-call-wasting-gas)] | ~~Using `this` to access functions results in an external call, wasting gas~~ | 5 | 
| [[D&#x2011;46](#d46-using-storage-instead-of-memory-for-structsarrays-saves-gas)] | ~~Using `storage` instead of `memory` for structs/arrays saves gas~~ | 14 | 
| [[D&#x2011;47](#d47-use-replace-and-pop-instead-of-the-delete-keyword-to-removing-an-item-from-an-array)] | ~~Use replace and pop instead of the delete keyword to removing an item from an array~~ | 2 | 
| [[D&#x2011;48](#d48-events-that-mark-critical-parameter-changes-should-contain-both-the-old-and-the-new-value)] | ~~Events that mark critical parameter changes should contain both the old and the new value~~ | 15 | 
| [[D&#x2011;49](#d49-style-guide-function-names-not-in-mixedcase)] | ~~Style guide: Function Names Not in mixedCase~~ | 49 | 
| [[D&#x2011;50](#d50-bad-bot-rules)] | ~~Bad bot rules~~ | 1 | 
| [[D&#x2011;51](#d51-the-result-of-function-calls-should-be-cached-rather-than-re-calling-the-function)] | ~~The result of function calls should be cached rather than re-calling the function~~ | 4 | 
| [[D&#x2011;52](#d52-contracts-do-not-work-with-fee-on-transfer-tokens)] | ~~Contracts do not work with fee-on-transfer tokens~~ | 17 | 
| [[D&#x2011;53](#d53-re-org-attack)] | ~~Re-org attack~~ | 10 | 
| [[D&#x2011;54](#d54-safetransferlib-does-not-ensure-that-the-token-contract-exists)] | ~~`SafeTransferLib` does not ensure that the token contract exists~~ | 6 | 
| [[D&#x2011;55](#d55-use-_safemint-instead-of-_mint-for-erc721)] | ~~Use `_safeMint` instead of `_mint` for ERC721~~ | 2 | 
| [[D&#x2011;56](#d56-default-bool-values-are-manually-reset)] | ~~Default `bool` values are manually reset~~ | 21 | 
| [[D&#x2011;57](#d57-interfaces-should-be-defined-in-separate-files-from-their-usage)] | ~~Interfaces should be defined in separate files from their usage~~ | 21 | 
| [[D&#x2011;58](#d58-non-libraryinterface-files-should-use-fixed-compiler-versions-not-floating-ones)] | ~~Non-library/interface files should use fixed compiler versions, not floating ones~~ | 21 | 
| [[D&#x2011;59](#d59-using-calldata-instead-of-memory-for-read-only-arguments-in-external-functions-saves-gas)] | ~~Using `calldata` instead of `memory` for read-only arguments in `external` functions saves gas~~ | 8 | 
| [[D&#x2011;60](#d60-unusual-loop-variable)] | ~~Unusual loop variable~~ | 15 | 
| [[D&#x2011;61](#d61-missing-contract-existence-checks-before-low-level-calls)] | ~~Missing contract-existence checks before low-level calls~~ | 3 | 
| [[D&#x2011;62](#d62-shorten-the-array-rather-than-copying-to-a-new-one)] | ~~Shorten the array rather than copying to a new one~~ | 14 | 
| [[D&#x2011;63](#d63-avoid-fetching-a-low-level-calls-return-data-by-using-assembly)] | ~~Avoid fetching a low-level call's return data by using assembly~~ | 4 | 
| [[D&#x2011;64](#d64-change-public-function-visibility-to-external-to-save-gas)] | ~~Change `public` function visibility to `external` to save gas~~ | 2 | 
| [[D&#x2011;65](#d65-use--0-instead-of--0-for-unsigned-integer-comparison)] | ~~Use != 0 instead of > 0 for unsigned integer comparison~~ | 18 | 
| [[D&#x2011;66](#d66-unused-function-parameter)] | ~~Unused function parameter~~ | 1 | 
| [[D&#x2011;67](#d67-state-variables-not-capped-at-reasonable-values)] | ~~State variables not capped at reasonable values~~ | 2 | 
| [[D&#x2011;68](#d68-unused-import)] | ~~Unused import~~ | 187 | 
| [[D&#x2011;69](#d69-safemint-should-be-used-in-place-of-mint)] | ~~safeMint should be used in place of mint~~ | 3 | 
| [[D&#x2011;70](#d70-unused-event-definition)] | ~~Unused `event` definition~~ | 28 | 
| [[D&#x2011;71](#d71-unused-error-definition)] | ~~Unused `error` definition~~ | 73 | 
| [[D&#x2011;72](#d72-unused-struct-definition)] | ~~Unused `struct` definition~~ | 15 | 
| [[D&#x2011;73](#d73-internal-functions-not-called-by-the-contract-should-be-removed)] | ~~`internal` functions not called by the contract should be removed~~ | 6 | 
| [[D&#x2011;74](#d74-unused-contract-variables)] | ~~Unused contract variables~~ | 20 | 
| [[D&#x2011;75](#d75-initialization-can-be-front-run)] | ~~Initialization can be front-run~~ | 1 | 

Total: 1789 instances over 75 issues





## Medium Risk Issues


### [M&#x2011;01] Unchecked return value of low-level `call()`/`delegatecall()`
The function being called may revert, which will be indicated by the return value to `call()`/`delegatecall()`. If the return value is not checked, the code will continue on as if there was no error, rather than reverting with the error encountered.

*There are 3 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

103:          _rootBridgeAgentAddress.call{value: msg.value}("");

```
*GitHub*: [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L103)

```solidity
File: src/RootBridgeAgent.sol

835:              callee.call{value: msg.value}("");

927:              callee.call{value: _value}("");

```
*GitHub*: [835](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L835), [927](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L927)


### [M&#x2011;02] Use of `transferFrom()` rather than `safeTransferFrom()` for NFTs in will lead to the loss of NFTs
The EIP-721 standard says the following about `transferFrom()`:
```solidity
    /// @notice Transfer ownership of an NFT -- THE CALLER IS RESPONSIBLE
    ///  TO CONFIRM THAT `_to` IS CAPABLE OF RECEIVING NFTS OR ELSE
    ///  THEY MAY BE PERMANENTLY LOST
    /// @dev Throws unless `msg.sender` is the current owner, an authorized
    ///  operator, or the approved address for this NFT. Throws if `_from` is
    ///  not the current owner. Throws if `_to` is the zero address. Throws if
    ///  `_tokenId` is not a valid NFT.
    /// @param _from The current owner of the NFT
    /// @param _to The new owner
    /// @param _tokenId The NFT to transfer
    function transferFrom(address _from, address _to, uint256 _tokenId) external payable;
```
https://github.com/ethereum/EIPs/blob/78e2c297611f5e92b6a5112819ab71f74041ff25/EIPS/eip-721.md?plain=1#L103-L113

Code must use the `safeTransferFrom()` flavor if it hasn't otherwise verified that the receiving address can handle it

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

62:           ERC721(_token).transferFrom(address(this), msg.sender, _tokenId);

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L62)


### [M&#x2011;03] The `owner` is a single point of failure and a centralization risk
Having a single EOA as the only owner of contracts is a large centralization risk and a single point of failure. A single private key may be taken in a hack, or the sole holder of the key may become unable to retrieve the key when necessary, or the single owner can become malicious and perform a rug-pull. Consider changing to a multi-signature setup, and or having a role-based authorization model.

*There are 38 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

60:      function initialize(address _localBridgeAgentAddress) external onlyOwner {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L60-L60)

```solidity
File: src/BranchBridgeAgentExecutor.sol

53:      function executeNoSettlement(address _router, bytes calldata _payload) external payable onlyOwner {

66       function executeWithSettlement(address _recipient, address _router, bytes calldata _payload)
67           external
68           payable
69           onlyOwner
70:      {

104      function executeWithSettlementMultiple(address _recipient, address _router, bytes calldata _payload)
105          external
106          payable
107          onlyOwner
108:     {

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L53-L53), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L66-L70), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L104-L108)

```solidity
File: src/BranchPort.sol

122:     function initialize(address _coreBranchRouter, address _bridgeAgentFactory) external virtual onlyOwner {

135:     function renounceOwnership() public payable override onlyOwner {

```
*GitHub*: [122](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L122-L122), [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L135-L135)

```solidity
File: src/CoreRootRouter.sol

83:      function initialize(address _bridgeAgentAddress, address _hTokenFactory) external onlyOwner {

156      function toggleBranchBridgeAgentFactory(
157          address _rootBridgeAgentFactory,
158          address _branchBridgeAgentFactory,
159          address _refundee,
160          uint16 _dstChainId,
161          GasParams calldata _gParams
162:     ) external payable onlyOwner {

186      function removeBranchBridgeAgent(
187          address _branchBridgeAgent,
188          address _refundee,
189          uint16 _dstChainId,
190          GasParams calldata _gParams
191:     ) external payable onlyOwner {

212      function manageStrategyToken(
213          address _underlyingToken,
214          uint256 _minimumReservesRatio,
215          address _refundee,
216          uint16 _dstChainId,
217          GasParams calldata _gParams
218:     ) external payable onlyOwner {

241      function managePortStrategy(
242          address _portStrategy,
243          address _underlyingToken,
244          uint256 _dailyManagementLimit,
245          bool _isUpdateDailyLimit,
246          address _refundee,
247          uint16 _dstChainId,
248          GasParams calldata _gParams
249:     ) external payable onlyOwner {

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83-L83), [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L156-L162), [186](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L186-L191), [212](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L212-L218), [241](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L241-L249)

```solidity
File: src/MulticallRootRouter.sol

109:     function initialize(address _bridgeAgentAddress) external onlyOwner {

```
*GitHub*: [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L109-L109)

```solidity
File: src/RootBridgeAgentExecutor.sol

50       function executeSystemRequest(address _router, bytes calldata _payload, uint16 _srcChainId)
51           external
52           payable
53           onlyOwner
54:      {

66       function executeNoDeposit(address _router, bytes calldata _payload, uint16 _srcChainId)
67           external
68           payable
69           onlyOwner
70:      {

82       function executeWithDeposit(address _router, bytes calldata _payload, uint16 _srcChainId)
83           external
84           payable
85           onlyOwner
86:      {

115      function executeWithDepositMultiple(address _router, bytes calldata _payload, uint16 _srcChainId)
116          external
117          payable
118          onlyOwner
119:     {

150      function executeSignedNoDeposit(address _account, address _router, bytes calldata _payload, uint16 _srcChainId)
151          external
152          payable
153          onlyOwner
154:     {

167      function executeSignedWithDeposit(address _account, address _router, bytes calldata _payload, uint16 _srcChainId)
168          external
169          payable
170          onlyOwner
171:     {

201      function executeSignedWithDepositMultiple(
202          address _account,
203          address _router,
204          bytes calldata _payload,
205          uint16 _srcChainId
206:     ) external payable onlyOwner {

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L50-L54), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L66-L70), [82](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L82-L86), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L115-L119), [150](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L150-L154), [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L167-L171), [201](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L201-L206)

```solidity
File: src/RootPort.sol

129:     function initialize(address _bridgeAgentFactory, address _coreRootRouter) external onlyOwner {

147      function initializeCore(
148          address _coreRootBridgeAgent,
149          address _coreLocalBranchBridgeAgent,
150          address _localBranchPortAddress
151:     ) external onlyOwner {

166:     function renounceOwnership() public payable override onlyOwner {

414:     function toggleBridgeAgent(address _bridgeAgent) external override onlyOwner {

421:     function addBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

431:     function toggleBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

438      function addNewChain(
439          address _coreBranchBridgeAgentAddress,
440          uint256 _chainId,
441          string memory _wrappedGasTokenName,
442          string memory _wrappedGasTokenSymbol,
443          uint8 _wrappedGasTokenDecimals,
444          address _newLocalBranchWrappedNativeTokenAddress,
445          address _newUnderlyingBranchWrappedNativeTokenAddress
446:     ) external override onlyOwner {

483:     function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {

509:     function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {

521      function setCoreBranchRouter(
522          address _refundee,
523          address _coreBranchRouter,
524          address _coreBranchBridgeAgent,
525          uint16 _dstChainId,
526          GasParams calldata _gParams
527:     ) external payable override onlyOwner {

539      function syncNewCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent, uint16 _dstChainId)
540          external
541          override
542          onlyOwner
543:     {

```
*GitHub*: [129](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L129-L129), [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L147-L151), [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L166-L166), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L414-L414), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L421-L421), [431](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L431-L431), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L438-L446), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483-L483), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509-L509), [521](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L521-L527), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L539-L543)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

56:      function initialize(address _coreRootBridgeAgent) external override onlyOwner {

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L56-L56)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

87:      function initialize(address _coreRootBridgeAgent) external virtual onlyOwner {

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L87-L87)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

60:      function initialize(address _wrappedNativeTokenAddress, address _coreRouter) external onlyOwner {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L60-L60)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

49:      function initialize(address _coreRouter) external onlyOwner {

```
*GitHub*: [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L49-L49)

```solidity
File: src/token/ERC20hTokenBranch.sol

29:      function mint(address account, uint256 amount) external override onlyOwner returns (bool) {

35:      function burn(uint256 amount) public override onlyOwner {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L29-L29), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L35-L35)

```solidity
File: src/token/ERC20hTokenRoot.sol

57:      function mint(address to, uint256 amount, uint256 chainId) external onlyOwner returns (bool) {

69:      function burn(address from, uint256 amount, uint256 chainId) external onlyOwner {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L57-L57), [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L69-L69)

</details>




### [M&#x2011;04] Return values of `approve()` not checked
Not all `IERC20` implementations `revert()` when there's a failure in `approve()`. The function signature has a `boolean` return value and they indicate errors that way instead. By not checking the return value, operations that should have marked as failed, may potentially go through without actually approving anything

*There is one instance of this issue:*

```solidity
File: src/BaseBranchRouter.sol

175:             ERC20(_token).approve(_localPortAddress, _deposit);

```
*GitHub*: [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L175-L175)

## Low Risk Issues


### [L&#x2011;01] `addStrategyToken()` does note remove old entries before adding new ones
Each time `addStrategyToken()` is called, new entries are added to the array, but doing so does not remove any old entries. By calling the function multiple times, an attacker can can increase their voting power indefinitely, without having to acquire new tokens.

*There are 2 instances of this issue:*

```solidity
File: src/BranchPort.sol

361      /// @inheritdoc IBranchPort
362      function addStrategyToken(address _token, uint256 _minimumReservesRatio) external override requiresCoreRouter {
363          if (_minimumReservesRatio >= DIVISIONER || _minimumReservesRatio < MIN_RESERVE_RATIO) {
364              revert InvalidMinimumReservesRatio();
365          }
366  
367          strategyTokens.push(_token);
368          getMinimumTokenReserveRatio[_token] = _minimumReservesRatio;
369          isStrategyToken[_token] = true;
370: 

413      /// @inheritdoc IBranchPort
414      function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent)
415          external
416          override
417          requiresCoreRouter
418      {
419          coreBranchRouterAddress = _coreBranchRouter;
420          isBridgeAgent[_coreBranchBridgeAgent] = true;
421          bridgeAgents.push(_coreBranchBridgeAgent);
422  
423          emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent);
424:     }

```
*GitHub*: [361](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L361-L370), [413](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L413-L424)


### [L&#x2011;02] Unsafe downcast
When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs

*There are 8 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit uint8
243:              uint8(_dParams.hTokens.length),

/// @audit uint8
320:              uint8(_dParams.hTokens.length),

/// @audit uint8
359:          if (uint8(deposit.hTokens.length) == 1) {

/// @audit uint8
383:          } else if (uint8(deposit.hTokens.length) > 1) {

/// @audit uint8
389:                      uint8(deposit.hTokens.length),

/// @audit uint8
400:                      uint8(deposit.hTokens.length),

```
*GitHub*: [243](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L243), [320](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L320), [359](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L359), [383](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L383), [389](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L389), [400](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L400)

```solidity
File: src/RootBridgeAgent.sol

/// @audit uint8
896:                  uint8(_hTokens.length),

/// @audit uint8
1092:             uint8(hTokens.length),

```
*GitHub*: [896](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L896), [1092](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1092)


### [L&#x2011;03] Array lengths not checked
If the length of the arrays are not required to be of the same length, user operations may not be fully executed due to a mismatch in the number of items iterated over, versus the number of items provided in the second array

*There is one instance of this issue:*

```solidity
File: src/BranchPort.sol

246       function bridgeInMultiple(
247           address _recipient,
248           address[] memory _localAddresses,
249           address[] memory _underlyingAddresses,
250           uint256[] memory _amounts,
251           uint256[] memory _deposits
252:      ) external override requiresBridgeAgent {

```
*GitHub*: [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L246-L252)


### [L&#x2011;04] `receive()`/`payable fallback()` function does not authorize requests
Having no access control on the function (e.g. `require(msg.sender == address(weth))`) means that someone may send Ether to the contract, and have no way to get anything back out, which is a loss of funds. If the concern is having to spend a small amount of gas to check the sender against an immutable address, the code should at least have a function to rescue mistakenly-sent Ether.

*There are 3 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

149:      receive() external payable {}

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L149)

```solidity
File: src/RootBridgeAgent.sol

128:      receive() external payable {}

```
*GitHub*: [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L128)

```solidity
File: src/VirtualAccount.sol

44:       receive() external payable {}

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L44)


### [L&#x2011;05] `safeApprove()` is deprecated
[Deprecated](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/bfff03c0d2a59bcd8e2ead1da9aed9edf0080d05/contracts/token/ERC20/utils/SafeERC20.sol#L38-L45) in favor of `safeIncreaseAllowance()` and `safeDecreaseAllowance()`. If only setting the initial allowance to the value that means infinite, `safeIncreaseAllowance()` can be used instead. The function may currently work, but if a bug is found in this version of OpenZeppelin, and the version that you're forced to upgrade to no longer has this function, you'll encounter unnecessary delays in porting and testing replacement contracts.

*There are 2 instances of this issue:*

```solidity
File: src/MulticallRootRouter.sol

521:          outputToken.safeApprove(_bridgeAgentAddress, amountOut);

559:              outputTokens[i].safeApprove(_bridgeAgentAddress, amountsOut[i]);

```
*GitHub*: [521](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L521), [559](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L559)


### [L&#x2011;06] Use `Ownable2Step` rather than `Ownable`
[`Ownable2Step`](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/3d7a93876a2e5e1d7fe29b5a0e96e222afdc4cfa/contracts/access/Ownable2Step.sol#L31-L56) and [`Ownable2StepUpgradeable`](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/blob/25aabd286e002a1526c345c8db259d57bdf0ad28/contracts/access/Ownable2StepUpgradeable.sol#L47-L63) prevent the contract ownership from mistakenly being transferred to an address that cannot handle it (e.g. due to a typo in the address), by requiring that the recipient of the owner permissions actively accept via a contract call of its own.

*There are 12 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

25:   contract BaseBranchRouter is IBranchRouter, Ownable {

```
*GitHub*: [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L25)

```solidity
File: src/BranchBridgeAgentExecutor.sol

29:   contract BranchBridgeAgentExecutor is Ownable, BridgeAgentConstants {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L29)

```solidity
File: src/BranchPort.sol

17:   contract BranchPort is Ownable, IBranchPort {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L17)

```solidity
File: src/CoreRootRouter.sol

38    contract CoreRootRouter is IRootRouter, Ownable {
39        /*///////////////////////////////////////////////////////////////
40                        CORE ROOT ROUTER STATE
41        //////////////////////////////////////////////////////////////*/
42    
43:       /// @notice Boolean to indicate if the contract is in set up mode.

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L38-L43)

```solidity
File: src/MulticallRootRouter.sol

57:   contract MulticallRootRouter is IRootRouter, Ownable {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L57)

```solidity
File: src/RootBridgeAgentExecutor.sol

27    contract RootBridgeAgentExecutor is Ownable, BridgeAgentConstants {
28        /*///////////////////////////////////////////////////////////////
29                                    CONSTRUCTOR
30        //////////////////////////////////////////////////////////////*/
31        /**
32         * @notice Constructor for Root Bridge Agent Executor.
33         * @param _rootBridgeAgent the owner of the contract in charge of calling the different execution functions.
34         */
35        constructor(address _rootBridgeAgent) {
36:           _initializeOwner(_rootBridgeAgent);

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L27-L36)

```solidity
File: src/RootPort.sol

16:   contract RootPort is Ownable, IRootPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L16)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

19    contract BranchBridgeAgentFactory is Ownable, IBranchBridgeAgentFactory {
20:       /// @notice Local Chain Id.

```
*GitHub*: [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L19-L20)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

12    contract ERC20hTokenBranchFactory is Ownable, IERC20hTokenBranchFactory {
13:       /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L12-L13)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

12    contract ERC20hTokenRootFactory is Ownable, IERC20hTokenRootFactory {
13:       /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L12-L13)

```solidity
File: src/token/ERC20hTokenBranch.sol

12    contract ERC20hTokenBranch is ERC20, Ownable, IERC20hTokenBranch {
13        constructor(
14            string memory chainName,
15            string memory chainSymbol,
16            string memory _name,
17            string memory _symbol,
18            uint8 _decimals,
19            address _owner
20        ) ERC20(string(string.concat(chainName, _name)), string(string.concat(chainSymbol, _symbol)), _decimals) {
21:           _initializeOwner(_owner);

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L12-L21)

```solidity
File: src/token/ERC20hTokenRoot.sol

12    contract ERC20hTokenRoot is ERC20, Ownable, IERC20hTokenRoot {
13:       /// @inheritdoc IERC20hTokenRoot

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L12-L13)

</details>




### [L&#x2011;07] Empty `receive()`/`fallback()` function
If the intention is for Ether sent by a caller to be used for an actual purpose (i.e. the function is not just a WETH `withdraw()` handler), the function should call another function (e.g. call `weth.deposit()` and use the token on the caller's behalf) or at least emit an event to track that funds were sent directly to it.

*There are 3 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

149:     receive() external payable {}

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L149-L149)

```solidity
File: src/RootBridgeAgent.sol

128:     receive() external payable {}

```
*GitHub*: [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L128-L128)

```solidity
File: src/VirtualAccount.sol

44:      receive() external payable {}

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L44-L44)


### [L&#x2011;08] External calls in an un-bounded `for-`loop may result in a DOS
Consider limiting the number of iterations in `for-`loops that make external calls

*There are 4 instances of this issue:*

```solidity
File: src/RootBridgeAgent.sol

328                  IPort(localPortAddress).bridgeToRoot(
329                      msg.sender,
330                      IPort(localPortAddress).getGlobalTokenFromLocal(_hToken, _dstChainId),
331                      settlement.amounts[i],
332                      settlement.deposits[i],
333                      _dstChainId
334:                 );

330:                     IPort(localPortAddress).getGlobalTokenFromLocal(_hToken, _dstChainId),

1072:            hTokens[i] = IPort(localPortAddress).getLocalTokenFromGlobal(_globalAddresses[i], _dstChainId);

1073:            tokens[i] = IPort(localPortAddress).getUnderlyingTokenFromLocal(hTokens[i], _dstChainId);

```
*GitHub*: [328](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L328-L334), [330](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L330-L330), [1072](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1072-L1072), [1073](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1073-L1073)


### [L&#x2011;09] Consider implementing two-step procedure for updating protocol addresses
A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.

*There are 10 instances of this issue:*

```solidity
File: src/BranchPort.sol

331      function setCoreRouter(address _newCoreRouter) external override requiresCoreRouter {
332          require(coreBranchRouterAddress != address(0), "CoreRouter address is zero");
333          require(_newCoreRouter != address(0), "New CoreRouter address is zero");
334          coreBranchRouterAddress = _newCoreRouter;
335:     }

362      function addStrategyToken(address _token, uint256 _minimumReservesRatio) external override requiresCoreRouter {
363          if (_minimumReservesRatio >= DIVISIONER || _minimumReservesRatio < MIN_RESERVE_RATIO) {
364              revert InvalidMinimumReservesRatio();
365          }
366  
367          strategyTokens.push(_token);
368          getMinimumTokenReserveRatio[_token] = _minimumReservesRatio;
369          isStrategyToken[_token] = true;
370  
371          emit StrategyTokenAdded(_token, _minimumReservesRatio);
372:     }

382      function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
383          external
384          override
385          requiresCoreRouter
386      {
387          if (!isStrategyToken[_token]) revert UnrecognizedStrategyToken();
388          portStrategies.push(_portStrategy);
389          strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;
390          isPortStrategy[_portStrategy][_token] = true;
391  
392          emit PortStrategyAdded(_portStrategy, _token, _dailyManagementLimit);
393:     }

403      function updatePortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
404          external
405          override
406          requiresCoreRouter
407      {
408          strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;
409  
410          emit PortStrategyUpdated(_portStrategy, _token, _dailyManagementLimit);
411:     }

414      function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent)
415          external
416          override
417          requiresCoreRouter
418      {
419          coreBranchRouterAddress = _coreBranchRouter;
420          isBridgeAgent[_coreBranchBridgeAgent] = true;
421          bridgeAgents.push(_coreBranchBridgeAgent);
422  
423          emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent);
424:     }

```
*GitHub*: [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L331-L335), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L362-L372), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L382-L393), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L403-L411), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L414-L424)

```solidity
File: src/RootPort.sol

239      function setAddresses(
240          address _globalAddress,
241          address _localAddress,
242          address _underlyingAddress,
243          uint256 _srcChainId
244      ) external override requiresCoreRootRouter {
245          if (_globalAddress == address(0)) revert InvalidGlobalAddress();
246          if (_localAddress == address(0)) revert InvalidLocalAddress();
247          if (_underlyingAddress == address(0)) revert InvalidUnderlyingAddress();
248  
249          isGlobalAddress[_globalAddress] = true;
250          getGlobalTokenFromLocal[_localAddress][_srcChainId] = _globalAddress;
251          getLocalTokenFromGlobal[_globalAddress][_srcChainId] = _localAddress;
252          getLocalTokenFromUnderlying[_underlyingAddress][_srcChainId] = _localAddress;
253          getUnderlyingTokenFromLocal[_localAddress][_srcChainId] = _underlyingAddress;
254  
255          emit LocalTokenAdded(_underlyingAddress, _localAddress, _globalAddress, _srcChainId);
256:     }

259      function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId)
260          external
261          override
262          requiresCoreRootRouter
263      {
264          if (_localAddress == address(0)) revert InvalidLocalAddress();
265  
266          getGlobalTokenFromLocal[_localAddress][_srcChainId] = _globalAddress;
267          getLocalTokenFromGlobal[_globalAddress][_srcChainId] = _localAddress;
268  
269          emit GlobalTokenAdded(_localAddress, _globalAddress, _srcChainId);
270:     }

382      function addBridgeAgent(address _manager, address _bridgeAgent) external override requiresBridgeAgentFactory {
383          if (isBridgeAgent[_bridgeAgent]) revert AlreadyAddedBridgeAgent();
384  
385          bridgeAgents.push(_bridgeAgent);
386          getBridgeAgentManager[_bridgeAgent] = _manager;
387          isBridgeAgent[_bridgeAgent] = true;
388  
389          emit BridgeAgentAdded(_bridgeAgent, _manager);
390:     }

483      function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {
484          // Check if token already added
485          if (isGlobalAddress[_ecoTokenGlobalAddress]) revert AlreadyAddedEcosystemToken();
486  
487          // Check if token is already a underlying token in current chain
488          if (getUnderlyingTokenFromLocal[_ecoTokenGlobalAddress][localChainId] != address(0)) {
489              revert AlreadyAddedEcosystemToken();
490          }
491  
492          // Check if token is already a local branch token in current chain
493          if (getLocalTokenFromUnderlying[_ecoTokenGlobalAddress][localChainId] != address(0)) {
494              revert AlreadyAddedEcosystemToken();
495          }
496  
497          // Update State
498          // 1. Add new global token to global address mapping
499          isGlobalAddress[_ecoTokenGlobalAddress] = true;
500          // 2. Add new branch local token address to global token mapping
501          getGlobalTokenFromLocal[_ecoTokenGlobalAddress][localChainId] = _ecoTokenGlobalAddress;
502          // 3. Add new global token to branch local token address mapping
503          getLocalTokenFromGlobal[_ecoTokenGlobalAddress][localChainId] = _ecoTokenGlobalAddress;
504  
505          emit EcosystemTokenAdded(_ecoTokenGlobalAddress);
506:     }

509      function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {
510          if (_coreRootRouter == address(0)) revert InvalidCoreRootRouter();
511          if (_coreRootBridgeAgent == address(0)) revert InvalidCoreRootBridgeAgent();
512  
513          coreRootRouterAddress = _coreRootRouter;
514          coreRootBridgeAgentAddress = _coreRootBridgeAgent;
515          getBridgeAgentManager[_coreRootBridgeAgent] = owner();
516  
517          emit CoreRootSet(_coreRootRouter, _coreRootBridgeAgent);
518:     }

```
*GitHub*: [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L239-L256), [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L259-L270), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L382-L390), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483-L506), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509-L518)


### [L&#x2011;10] `name()` is not a part of the ERC-20 standard
The `name()` function is not a part of the [ERC-20 standard](https://eips.ethereum.org/EIPS/eip-20), and was added later as an [optional extension](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/extensions/IERC20Metadata.sol). As such, some valid ERC20 tokens do not support this interface, so it is unsafe to blindly cast all tokens to this interface, and then call this function.

*There are 5 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

56:              string.concat("Arbitrum Ulysses ", ERC20(_underlyingAddress).name()),

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L56-L56)

```solidity
File: src/CoreBranchRouter.sol

68:              ERC20(_underlyingAddress).name(), ERC20(_underlyingAddress).symbol(), decimals, true

72:          bytes memory params = abi.encode(_underlyingAddress, newToken, newToken.name(), newToken.symbol(), decimals);

```
*GitHub*: [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L68-L68), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L72-L72)

```solidity
File: src/CoreRootRouter.sol

426:             ERC20(_globalAddress).name(),

```
*GitHub*: [426](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L426-L426)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

66:              ERC20(_wrappedNativeTokenAddress).name(),

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L66-L66)


### [L&#x2011;11] `symbol()` is not a part of the ERC-20 standard
The `symbol()` function is not a part of the [ERC-20 standard](https://eips.ethereum.org/EIPS/eip-20), and was added later as an [optional extension](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/extensions/IERC20Metadata.sol). As such, some valid ERC20 tokens do not support this interface, so it is unsafe to blindly cast all tokens to this interface, and then call this function.

*There are 5 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

57:              string.concat("arb-u", ERC20(_underlyingAddress).symbol()),

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L57-L57)

```solidity
File: src/CoreBranchRouter.sol

68:              ERC20(_underlyingAddress).name(), ERC20(_underlyingAddress).symbol(), decimals, true

72:          bytes memory params = abi.encode(_underlyingAddress, newToken, newToken.name(), newToken.symbol(), decimals);

```
*GitHub*: [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L68-L68), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L72-L72)

```solidity
File: src/CoreRootRouter.sol

427:             ERC20(_globalAddress).symbol(),

```
*GitHub*: [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L427-L427)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

67:              ERC20(_wrappedNativeTokenAddress).symbol(),

```
*GitHub*: [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L67-L67)


### [L&#x2011;12] `decimals()` is not a part of the ERC-20 standard
The `decimals()` function is not a part of the [ERC-20 standard](https://eips.ethereum.org/EIPS/eip-20), and was added later as an [optional extension](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/extensions/IERC20Metadata.sol). As such, some valid ERC20 tokens do not support this interface, so it is unsafe to blindly cast all tokens to this interface, and then call this function.

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

58:              ERC20(_underlyingAddress).decimals()

```
*GitHub*: [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L58-L58)

```solidity
File: src/CoreBranchRouter.sol

64:          uint8 decimals = ERC20(_underlyingAddress).decimals();

```
*GitHub*: [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L64-L64)

```solidity
File: src/CoreRootRouter.sol

428:             ERC20(_globalAddress).decimals(),

```
*GitHub*: [428](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L428-L428)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

68:              ERC20(_wrappedNativeTokenAddress).decimals(),

```
*GitHub*: [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L68-L68)


### [L&#x2011;13] `SafeTransferLib` does not ensure that the token contract exists
`SafeTransferLib.sol` has functions named similarly to functions that OpenZeppelin has, but they act differently. At the top of the file is the following comment:
```solidity
/// @dev Note that none of the functions in this library check that a token has code at all! That responsibility is delegated to the caller.
```
https://github.com/transmissions11/solmate/blob/bfc9c25865a274a7827fea5abf6e4fb64fc64e6c/src/utils/SafeTransferLib.sol#L9

This means that if one of the transfer functions is called on a contract that doesn't exist or that got selfdestructed, the call will succeede without any warning/revert, which may cause implicit token holdings validations to be ineffective. Consider using the OpenZeppelin version instead.

*There are 2 instances of this issue:*

```solidity
File: src/ArbitrumBranchPort.sol

66:          _underlyingAddress.safeTransferFrom(_depositor, address(this), _deposit);

128:             _underlyingAddress.safeTransferFrom(_depositor, address(this), _deposit);

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L66-L66), [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L128-L128)


### [L&#x2011;14] Functions calling contracts/addresses with transfer hooks are missing reentrancy guards
Even if the function follows the best practice of check-effects-interaction, not using a reentrancy guard when there may be transfer hooks will open the users of this protocol up to [read-only reentrancies](https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/) with no way to protect against it, except by block-listing the whole protocol.

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

/// @audit `withdrawERC721()`
62:          ERC721(_token).transferFrom(address(this), msg.sender, _tokenId);

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L62-L62)


### [L&#x2011;15] `approve()`/`safeApprove()` may revert if the current approval is not zero
Calling `approve()` without first calling `approve(0)` if the current approval is non-zero will revert with some tokens, such as Tether (USDT). While Tether is known to do this, it applies to other tokens as well, which are trying to protect against [this attack vector](https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM/edit). `safeApprove()` itself also implements this protection.
Always reset the approval to zero before changing it to a new value (`SafeERC20.forceApprove()` does this for you), or use `safeIncreaseAllowance()`/`safeDecreaseAllowance()`

*There are 3 instances of this issue:*

```solidity
File: src/BaseBranchRouter.sol

175:             ERC20(_token).approve(_localPortAddress, _deposit);

```
*GitHub*: [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L175-L175)

```solidity
File: src/MulticallRootRouter.sol

521:         outputToken.safeApprove(_bridgeAgentAddress, amountOut);

559:             outputTokens[i].safeApprove(_bridgeAgentAddress, amountsOut[i]);

```
*GitHub*: [521](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L521-L521), [559](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L559-L559)


### [L&#x2011;16] External call recipient may consume all transaction gas
There is no limit specified on the amount of gas used, so the recipient can use up all of the transaction's gas, causing it to revert. Use `addr.call{gas: <amount>}("")` or [this](https://github.com/nomad-xyz/ExcessivelySafeCall) library instead.

*There are 8 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit `_execute()`
717:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

/// @audit `_execute()`
737:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

```
*GitHub*: [717](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L717-L717), [737](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L737-L737)

```solidity
File: src/RootBridgeAgent.sol

/// @audit `_execute()`
754:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

/// @audit `_execute()`
779:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

/// @audit `_performCall()`
835:             callee.call{value: msg.value}("");

/// @audit `_performRetrySettlementCall()`
927:             callee.call{value: _value}("");

```
*GitHub*: [754](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L754-L754), [779](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L779-L779), [835](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L835-L835), [927](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L927-L927)

```solidity
File: src/VirtualAccount.sol

/// @audit `call()`
74:              if (isContract(_call.target)) (success, returnData[i]) = _call.target.call(_call.callData);

/// @audit `payableCall()`
101:             if (isContract(_call.target)) (success, returnData[i]) = _call.target.call{value: val}(_call.callData);

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L74-L74), [101](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L101-L101)


### [L&#x2011;17] Missing contract-existence checks before low-level calls
Low-level calls return success if there is no code present at the specified address. In addition to the zero-address checks, add a check to verify that `<address>.code.length > 0`

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

65           IBridgeAgent(localBridgeAgentAddress).callOutSystem(payable(msg.sender), payload, GasParams(0, 0));
66:      }

118          IBridgeAgent(localBridgeAgentAddress).callOutSystem(payable(_refundee), payload, _gParams);
119:     }

```
*GitHub*: [65](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L65-L66), [118](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L118-L119)

```solidity
File: src/BaseBranchRouter.sol

84           IBridgeAgent(localBridgeAgentAddress).callOut{value: msg.value}(payable(msg.sender), _params, _gParams);
85:      }

```
*GitHub*: [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L84-L85)

```solidity
File: src/BranchBridgeAgent.sol

737          (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);
738  
739          //Update tx state if execution failed
740          if (!success) {
741              //Read the fallback flag and perform the fallback call if necessary. If not, allow for retrying deposit.
742:             if (_hasFallbackToggled) {

```
*GitHub*: [737](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L737-L742)


### [L&#x2011;18] Code does not follow the best practice of check-effects-interaction
Code should follow the best-practice of [check-effects-interaction](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.

*There are 43 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

/// @audit approve() called prior to this assignment
64:          bridgeAgentExecutorAddress = IBridgeAgent(_localBridgeAgentAddress).bridgeAgentExecutorAddress();

```
*GitHub*: [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L64-L64)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit bridgeOut() called prior to this assignment
832:         deposit.owner = _refundee;

/// @audit bridgeOut() called prior to this assignment
835:         deposit.hTokens = addressArray;

/// @audit bridgeOut() called prior to this assignment
838:         deposit.tokens = addressArray;

/// @audit bridgeOut() called prior to this assignment
841:         deposit.amounts = uintArray;

/// @audit bridgeOut() called prior to this assignment
844:         deposit.deposits = uintArray;

/// @audit bridgeOut() called prior to this assignment
846:         deposit.status = STATUS_SUCCESS;

/// @audit bridgeOutMultiple() called prior to this assignment
882:         deposit.owner = _refundee;

/// @audit bridgeOutMultiple() called prior to this assignment
883:         deposit.hTokens = _hTokens;

/// @audit bridgeOutMultiple() called prior to this assignment
884:         deposit.tokens = _tokens;

/// @audit bridgeOutMultiple() called prior to this assignment
885:         deposit.amounts = _amounts;

/// @audit bridgeOutMultiple() called prior to this assignment
886:         deposit.deposits = _deposits;

/// @audit bridgeOutMultiple() called prior to this assignment
887:         deposit.status = STATUS_SUCCESS;

```
*GitHub*: [832](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L832-L832), [835](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L835-L835), [838](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L838-L838), [841](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L841-L841), [844](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L844-L844), [846](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L846-L846), [882](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L882-L882), [883](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L883-L883), [884](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L884-L884), [885](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L885-L885), [886](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L886-L886), [887](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L887-L887)

```solidity
File: src/BranchPort.sol

/// @audit withdraw() called prior to this assignment
205:         getPortStrategyTokenDebt[_strategy][_token] = portStrategyTokenDebt - amountToWithdraw;

/// @audit withdraw() called prior to this assignment
207:         getStrategyTokenDebt[_token] = strategyTokenDebt - amountToWithdraw;

```
*GitHub*: [205](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L205-L205), [207](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L207-L207)

```solidity
File: src/CoreRootRouter.sol

/// @audit null() called prior to this assignment
88:          hTokenFactoryAddress = _hTokenFactory;

```
*GitHub*: [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L88-L88)

```solidity
File: src/RootBridgeAgent.sol

/// @audit bridgeToRoot() called prior to this assignment
254:         settlementReference.status = STATUS_SUCCESS;

/// @audit bridgeToRoot() called prior to this assignment
343:         delete getSettlement[_settlementNonce];

/// @audit bridgeToRoot() called prior to this assignment
680:             settlementReference.status = STATUS_SUCCESS;

/// @audit bridgeToRoot() called prior to this assignment
1014:        settlement.owner = _refundee;

/// @audit bridgeToRoot() called prior to this assignment
1015:        settlement.recipient = _recipient;

/// @audit bridgeToRoot() called prior to this assignment
1018:        settlement.hTokens = addressArray;

/// @audit bridgeToRoot() called prior to this assignment
1021:        settlement.tokens = addressArray;

/// @audit bridgeToRoot() called prior to this assignment
1024:        settlement.amounts = uintArray;

/// @audit bridgeToRoot() called prior to this assignment
1027:        settlement.deposits = uintArray;

/// @audit bridgeToRoot() called prior to this assignment
1029:        settlement.dstChainId = _dstChainId;

/// @audit bridgeToRoot() called prior to this assignment
1030:        settlement.status = STATUS_SUCCESS;

/// @audit bridgeToRoot() called prior to this assignment
1106:        settlement.owner = _refundee;

/// @audit bridgeToRoot() called prior to this assignment
1107:        settlement.recipient = _recipient;

/// @audit bridgeToRoot() called prior to this assignment
1108:        settlement.hTokens = hTokens;

/// @audit bridgeToRoot() called prior to this assignment
1109:        settlement.tokens = tokens;

/// @audit bridgeToRoot() called prior to this assignment
1110:        settlement.amounts = _amounts;

/// @audit bridgeToRoot() called prior to this assignment
1111:        settlement.deposits = _deposits;

/// @audit bridgeToRoot() called prior to this assignment
1112:        settlement.dstChainId = _dstChainId;

/// @audit bridgeToRoot() called prior to this assignment
1113:        settlement.status = STATUS_SUCCESS;

```
*GitHub*: [254](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L254-L254), [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L343-L343), [680](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L680-L680), [1014](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1014-L1014), [1015](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1015-L1015), [1018](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1018-L1018), [1021](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1021-L1021), [1024](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1024-L1024), [1027](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1027-L1027), [1029](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1029-L1029), [1030](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1030-L1030), [1106](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1106-L1106), [1107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1107-L1107), [1108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1108-L1108), [1109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1109-L1109), [1110](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1110-L1110), [1111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1111-L1111), [1112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1112-L1112), [1113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1113-L1113)

```solidity
File: src/RootPort.sol

/// @audit syncBranchBridgeAgent() called prior to this assignment
162:         getBridgeAgentManager[_coreRootBridgeAgent] = owner();

/// @audit syncBranchBridgeAgent() called prior to this assignment
465:         isChainId[_chainId] = true;

/// @audit syncBranchBridgeAgent() called prior to this assignment
467:         isGlobalAddress[newGlobalToken] = true;

/// @audit syncBranchBridgeAgent() called prior to this assignment
469:         getGlobalTokenFromLocal[_newLocalBranchWrappedNativeTokenAddress][_chainId] = newGlobalToken;

/// @audit syncBranchBridgeAgent() called prior to this assignment
471:         getLocalTokenFromGlobal[newGlobalToken][_chainId] = _newLocalBranchWrappedNativeTokenAddress;

/// @audit syncBranchBridgeAgent() called prior to this assignment
473          getLocalTokenFromUnderlying[_newUnderlyingBranchWrappedNativeTokenAddress][_chainId] =
474:             _newLocalBranchWrappedNativeTokenAddress;

/// @audit syncBranchBridgeAgent() called prior to this assignment
476          getUnderlyingTokenFromLocal[_newLocalBranchWrappedNativeTokenAddress][_chainId] =
477:             _newUnderlyingBranchWrappedNativeTokenAddress;

```
*GitHub*: [162](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L162-L162), [465](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L465-L465), [467](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L467-L467), [469](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L469-L469), [471](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L471-L471), [473](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L473-L474), [476](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L476-L477)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit push() called prior to this assignment
74:          localCoreRouterAddress = _coreRouter;

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L74-L74)

</details>




### [L&#x2011;19] Missing checks for `address(0x0)` in the constructor/initializer


*There are 7 instances of this issue:*

```solidity
File: src/CoreBranchRouter.sol

31:          hTokenFactoryAddress = _hTokenFactoryAddress;

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L31-L31)

```solidity
File: src/CoreRootRouter.sol

73:          rootPortAddress = _rootPortAddress;

86:          bridgeAgentAddress = payable(_bridgeAgentAddress);

88:          hTokenFactoryAddress = _hTokenFactory;

```
*GitHub*: [73](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L73-L73), [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L86-L86), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L88-L88)

```solidity
File: src/VirtualAccount.sol

36:          userAddress = _userAddress;

37:          localPortAddress = _localPortAddress;

```
*GitHub*: [36](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L36-L36), [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L37-L37)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

35:          lzEndpointAddress = _lzEndpointAddress;

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L35-L35)


### [L&#x2011;20] Missing checks for `address(0x0)` when updating `address` state variables


*There is one instance of this issue:*

```solidity
File: src/BranchPort.sol

419:         coreBranchRouterAddress = _coreBranchRouter;

```
*GitHub*: [419](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L419-L419)


### [L&#x2011;21] State variables not capped at reasonable values
Consider adding minimum/maximum value checks to ensure that the state variables below can never be used to excessively harm users, including via griefing

*There are 2 instances of this issue:*

```solidity
File: src/BranchPort.sol

389:         strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;

408:         strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;

```
*GitHub*: [389](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L389-L389), [408](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L408-L408)


### [L&#x2011;22] Tokens may be minted to `address(0x0)`
Neither the listed functions, nor `_mint()` prevent minting to `address(0x0)`

*There are 2 instances of this issue:*

```solidity
File: src/token/ERC20hTokenBranch.sol

29       function mint(address account, uint256 amount) external override onlyOwner returns (bool) {
30           _mint(account, amount);
31           return true;
32:      }

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L29-L32)

```solidity
File: src/token/ERC20hTokenRoot.sol

57       function mint(address to, uint256 amount, uint256 chainId) external onlyOwner returns (bool) {
58           getTokenBalance[chainId] += amount;
59           _mint(to, amount);
60           return true;
61:      }

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L57-L61)


### [L&#x2011;23] Initialization can be front-run
The `initialize()` functions below are not called by another contract atomically after the contract is deployed, so it's possible for a malicious user to call `initialize()` which, if it's noticed in time, would require the project to re-deploy the contract in order to properly initialize. Consider creating a factory contract, which will `new` and `initialize()` each contract atomically.

*There are 8 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

60:      function initialize(address _localBridgeAgentAddress) external onlyOwner {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L60-L60)

```solidity
File: src/BranchPort.sol

122:     function initialize(address _coreBranchRouter, address _bridgeAgentFactory) external virtual onlyOwner {

```
*GitHub*: [122](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L122-L122)

```solidity
File: src/CoreRootRouter.sol

83:      function initialize(address _bridgeAgentAddress, address _hTokenFactory) external onlyOwner {

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83-L83)

```solidity
File: src/MulticallRootRouter.sol

109:     function initialize(address _bridgeAgentAddress) external onlyOwner {

```
*GitHub*: [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L109-L109)

```solidity
File: src/RootPort.sol

129:     function initialize(address _bridgeAgentFactory, address _coreRootRouter) external onlyOwner {

```
*GitHub*: [129](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L129-L129)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

56:      function initialize(address _coreRootBridgeAgent) external override onlyOwner {

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L56-L56)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

60:      function initialize(address _wrappedNativeTokenAddress, address _coreRouter) external onlyOwner {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L60-L60)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

49:      function initialize(address _coreRouter) external onlyOwner {

```
*GitHub*: [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L49-L49)

</details>



## Non-critical Issues


### [N&#x2011;01] `public` functions not called by the contract should be declared `external` instead
Contracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`.

*There are 6 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

578:      function lzReceive(uint16, bytes calldata _srcAddress, uint64, bytes calldata _payload) public override {

587       function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload)
588           public
589           override
590:          requiresEndpoint(_endpoint, _srcAddress)

```
*GitHub*: [578](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L578), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L587-L590)

```solidity
File: src/RootBridgeAgent.sol

423:      function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64, bytes calldata _payload) public {

434       function lzReceiveNonBlocking(
435           address _endpoint,
436           uint16 _srcChainId,
437           bytes calldata _srcAddress,
438           bytes calldata _payload
439:      ) public override requiresEndpoint(_endpoint, _srcChainId, _srcAddress) {

```
*GitHub*: [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L423), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L434-L439)

```solidity
File: src/VirtualAccount.sol

85:       function payableCall(PayableCall[] calldata calls) public payable returns (bytes[] memory returnData) {

```
*GitHub*: [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L85)

```solidity
File: src/token/ERC20hTokenBranch.sol

35:       function burn(uint256 amount) public override onlyOwner {

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L35)


### [N&#x2011;02] Event is not properly `indexed`
Index event fields make the field more quickly accessible [to off-chain tools](https://ethereum.stackexchange.com/questions/40396/can-somebody-please-explain-the-concept-of-event-indexing) that parse events. This is especially useful when it comes to filtering based on an address. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Where applicable, each `event` should use three `indexed` fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three applicable fields, all of the applicable fields should be indexed.

*There is one instance of this issue:*

```solidity
File: src/interfaces/IRootPort.sol

380:      event VirtualAccountCreated(address indexed user, address account);

```
*GitHub*: [380](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L380)


### [N&#x2011;03] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function
The compiler will inline the function, which will avoid `JUMP` instructions usually associated with functions

*There are 12 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BranchBridgeAgent.sol

441:          if (deposit.owner != msg.sender) revert NotDepositOwner();

624:              if (executionState[nonce] != STATUS_READY) revert AlreadyExecutedTransaction();

```
*GitHub*: [441](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L441), [624](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L624)

```solidity
File: src/BranchPort.sol

560:          if (!isStrategyToken[_token]) revert UnrecognizedStrategyToken();

```
*GitHub*: [560](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L560)

```solidity
File: src/CoreRootRouter.sol

366:          revert();

```
*GitHub*: [366](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L366)

```solidity
File: src/MulticallRootRouter.sol

204:          revert();

```
*GitHub*: [204](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L204)

```solidity
File: src/RootBridgeAgent.sol

670:              if (settlementReference.owner == address(0)) revert SettlementRetryUnavailable();

910:          if (callee == address(0)) revert UnrecognizedBridgeAgent();

```
*GitHub*: [670](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L670), [910](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L910)

```solidity
File: src/RootPort.sol

264:          if (_localAddress == address(0)) revert InvalidLocalAddress();

299:          if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

544:          if (_coreBranchRouter == address(0)) revert InvalidCoreBranchRouter();

545:          if (_coreBranchBridgeAgent == address(0)) revert InvalidCoreBrancBridgeAgent();

```
*GitHub*: [264](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L264), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L299), [544](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L544), [545](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L545)

```solidity
File: src/VirtualAccount.sol

103:              if (!success) revert CallFailed();

```
*GitHub*: [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L103)

</details>




### [N&#x2011;04] Common functions should be refactored to a common base contract
The functions below have the same implementation as is seen in other files. The functions should be refactored into functions of a common base contract

*There is one instance of this issue:*

```solidity
File: src/RootPort.sol

/// @audit seen in src/BranchPort.sol
166       function renounceOwnership() public payable override onlyOwner {
167           revert("Cannot renounce ownership");
168:      }

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L166-L168)


### [N&#x2011;05] Import declarations should import specific identifiers, rather than the whole file
Using import declarations of the form `import {<identifier_name>} from "some/file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation (but does not save any gas)

*There is one instance of this issue:*

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

5:    import "./ILayerZeroUserApplicationConfig.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L5)


### [N&#x2011;06] Events that mark critical parameter changes should contain both the old and the new value
This should especially be done if the new value is not required to be different from the old value

*There are 6 instances of this issue:*

```solidity
File: src/BranchPort.sol

/// @audit updatePortStrategy()
410:          emit PortStrategyUpdated(_portStrategy, _token, _dailyManagementLimit);

/// @audit setCoreBranchRouter()
423:          emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent);

```
*GitHub*: [410](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L410), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L423)

```solidity
File: src/RootPort.sol

/// @audit setAddresses()
255:          emit LocalTokenAdded(_underlyingAddress, _localAddress, _globalAddress, _srcChainId);

/// @audit setLocalAddress()
269:          emit GlobalTokenAdded(_localAddress, _globalAddress, _srcChainId);

/// @audit setCoreRootRouter()
517:          emit CoreRootSet(_coreRootRouter, _coreRootBridgeAgent);

/// @audit setCoreBranchRouter()
535:          emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent, _dstChainId);

```
*GitHub*: [255](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L255), [269](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L269), [517](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L517), [535](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L535)


### [N&#x2011;07] Constant redefined elsewhere
Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A [cheap way](https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678) to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.

*There are 25 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BranchBridgeAgent.sol

/// @audit seen in src/ArbitrumBranchPort.sol 
56:       uint16 public immutable localChainId;

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L56)

```solidity
File: src/CoreRootRouter.sol

/// @audit seen in src/BranchBridgeAgent.sol 
47:       uint256 public immutable rootChainId;

/// @audit seen in src/ArbitrumBranchPort.sol 
51:       address public immutable rootPortAddress;

```
*GitHub*: [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L47), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L51)

```solidity
File: src/MulticallRootRouter.sol

/// @audit seen in src/BranchBridgeAgent.sol 
65:       uint256 public immutable localChainId;

/// @audit seen in src/BranchBridgeAgent.sol 
68:       address public immutable localPortAddress;

```
*GitHub*: [65](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L65), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L68)

```solidity
File: src/RootBridgeAgent.sol

/// @audit seen in src/MulticallRootRouter.sol 
40:       uint16 public immutable localChainId;

/// @audit seen in src/BranchBridgeAgent.sol 
46:       address public immutable localRouterAddress;

/// @audit seen in src/MulticallRootRouter.sol 
49:       address public immutable localPortAddress;

/// @audit seen in src/BranchBridgeAgent.sol 
52:       address public immutable lzEndpointAddress;

/// @audit seen in src/BranchBridgeAgent.sol 
55:       address public immutable bridgeAgentExecutorAddress;

```
*GitHub*: [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L40), [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L46), [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L49), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L52), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L55)

```solidity
File: src/RootPort.sol

/// @audit seen in src/RootBridgeAgent.sol 
34:       uint256 public immutable localChainId;

```
*GitHub*: [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L34)

```solidity
File: src/VirtualAccount.sol

/// @audit seen in src/RootBridgeAgent.sol 
24:       address public immutable override localPortAddress;

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L24)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

/// @audit seen in src/RootPort.sol 
21:       uint16 public immutable localChainId;

/// @audit seen in src/CoreRootRouter.sol 
24:       uint16 public immutable rootChainId;

/// @audit seen in src/VirtualAccount.sol 
33:       address public immutable localPortAddress;

/// @audit seen in src/RootBridgeAgent.sol 
36:       address public immutable lzEndpointAddress;

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L21), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L24), [33](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L33), [36](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L36)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit seen in src/factories/BranchBridgeAgentFactory.sol 
14:       uint24 public immutable localChainId;

/// @audit seen in src/factories/BranchBridgeAgentFactory.sol 
17:       address public immutable localPortAddress;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L14), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L17)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

/// @audit seen in src/factories/ERC20hTokenBranchFactory.sol 
14:       uint16 public immutable localChainId;

/// @audit seen in src/CoreRootRouter.sol 
17:       address public immutable rootPortAddress;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L14), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L17)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

/// @audit seen in src/factories/BranchBridgeAgentFactory.sol 
13:       uint16 public immutable rootChainId;

/// @audit seen in src/factories/ERC20hTokenRootFactory.sol 
16:       address public immutable rootPortAddress;

/// @audit seen in src/factories/BranchBridgeAgentFactory.sol 
19:       address public immutable lzEndpointAddress;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L13), [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L16), [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L19)

```solidity
File: src/token/ERC20hTokenRoot.sol

/// @audit seen in src/factories/ERC20hTokenRootFactory.sol 
14:       uint16 public immutable override localChainId;

/// @audit seen in src/RootBridgeAgent.sol 
17:       address public immutable override factoryAddress;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L14), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L17)

</details>




### [N&#x2011;08] Inconsistent spacing in comments
Some lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file

*There are 145 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

113:          //Sends message to Root Bridge Agent

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L113)

```solidity
File: src/ArbitrumBranchPort.sol

49:       ///@inheritdoc IArbitrumBranchPort

72:       ///@inheritdoc IArbitrumBranchPort

126:          //Store Underlying Tokens

131:          //Burn hTokens if any are being used

```
*GitHub*: [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L49), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L72), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L126), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L131)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

50:       ///@inheritdoc CoreBranchRouter

52:           //Encode Data, no need to create local token since we are already in the global environment

64:           //Send Cross-Chain request (System Response/Request)

117:          //Send Cross-Chain request

125:      ///@inheritdoc CoreBranchRouter

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L50), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L52), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L64), [117](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L117), [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L125)

```solidity
File: src/BaseBranchRouter.sol

94:           //Transfer tokens to this contract.

97:           //Perform call to bridge agent.

109:          //Transfer tokens to this contract.

112:          //Perform call to bridge agent.

```
*GitHub*: [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L94), [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L97), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L109), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L112)

```solidity
File: src/BranchBridgeAgent.sol

187:          //Encode Data for cross-chain call.

190:          //Perform Call

201:          //Encode Data for cross-chain call.

204:          //Perform Call

215:          //Cache Deposit Nonce

218:          //Encode Data for cross-chain call.

223:          //Create Deposit and Send Cross-Chain request

226:          //Perform Call

237:          //Cache Deposit Nonce

240:          //Encode Data for cross-chain call.

252:          //Create Deposit and Send Cross-Chain request

257:          //Perform Call

268:          //Encode Data for cross-chain call.

271:          //Perform Signed Call without deposit

283:          //Cache Deposit Nonce

286:          //Encode Data for cross-chain call.

298:          //Create Deposit and Send Cross-Chain request

301:          //Perform Call

334:          //Perform Call

353:          //Check if deposit belongs to message sender

356:          //Encode Data for cross-chain call.

361:                  //Pack new Data

385:                  //Pack new Data

426:          //Encode Data for cross-chain call.

429:          //Update State and Perform Call

592:          //Save Action Flag

603:              //Check if tx has already been executed

606:              //Try to execute the remote request

607:              //Flag 0 - BranchBridgeAgentExecutor(bridgeAgentExecutorAddress).executeNoSettlement(localRouterAddress, _payload)

623:              //Check if tx has already been executed

626:              //Try to execute the remote request

627:              //Flag 1 - BranchBridgeAgentExecutor(bridgeAgentExecutorAddress).executeWithSettlement(recipient, localRouterAddress, _payload)

645:              //Check if tx has already been executed

648:              //Try to execute remote request

662:              //DEPOSIT FLAG: 3 (Retrieve Settlement)

667:              //Get nonce

670:              //Check if settlement is in retrieve mode

674:                  //Set settlement to retrieve mode, if not already set.

676:                  //Trigger fallback/Retry failed fallback

680:              //DEPOSIT FLAG: 4 (Fallback)

682:              //Get nonce

694:              //Unrecognized Function Selector

713:          //Update tx state as executed

716:          //Try to execute the remote request

733:          //Update tx state as executed

736:          //Try to execute the remote request

739:          //Update tx state if execution failed

741:              //Read the fallback flag and perform the fallback call if necessary. If not, allow for retrying deposit.

769:          //Sends message to LayerZero messaging layer

786:          //Sends message to LayerZero messaging layer

937:          //Verify Endpoint

941:          //Verify Remote Caller

```
*GitHub*: [187](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L187), [190](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L190), [201](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L201), [204](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L204), [215](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L215), [218](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L218), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L223), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L226), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L237), [240](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L240), [252](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L252), [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L257), [268](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L268), [271](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L271), [283](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L283), [286](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L286), [298](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L298), [301](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L301), [334](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L334), [353](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L353), [356](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L356), [361](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L361), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L385), [426](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L426), [429](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L429), [592](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L592), [603](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L603), [606](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L606), [607](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L607), [623](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L623), [626](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L626), [627](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L627), [645](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L645), [648](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L648), [662](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L662), [667](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L667), [670](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L670), [674](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L674), [676](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L676), [680](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L680), [682](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L682), [694](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L694), [713](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L713), [716](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L716), [733](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L733), [736](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L736), [739](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L739), [741](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L741), [769](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L769), [786](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L786), [937](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L937), [941](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L941)

```solidity
File: src/CoreBranchRouter.sol

63:           //Get Token Info

66:           //Create Token

71:           //Encode Data

77:           //Send Cross-Chain request (System Response/Request)

174:          //Create Token

183:          //Send Cross-Chain request

231:          //Send Cross-Chain request

```
*GitHub*: [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L63), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L66), [71](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L71), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L77), [174](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L174), [183](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L183), [231](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L231)

```solidity
File: src/CoreRootRouter.sol

138:          //Add new global token to branch chain

173:          //Add new global token to branch chain

192:          //Encode CallData

198:          //Add new global token to branch chain

225:          //Add new global token to branch chain

256:          //Add new global token to branch chain

286:          //Add new global token to branch chain

436:          //Add new global token to branch chain

465:          //Create a new global token

```
*GitHub*: [138](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L138), [173](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L173), [192](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L192), [198](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L198), [225](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L225), [256](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L256), [286](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L286), [436](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L436), [465](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L465)

```solidity
File: src/MulticallRootRouter.sol

202:      ///@inheritdoc IRootRouter

207:      ///@inheritdoc IRootRouter

523:          //Move output hTokens from Root to Branch and call 'clearToken'.

565:          //Move output hTokens from Root to Branch and call 'clearTokens'.

```
*GitHub*: [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L202), [207](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L207), [523](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L523), [565](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L565)

```solidity
File: src/RootBridgeAgent.sol

167:          //Encode Data for call.

170:          //Perform Call to clear hToken balance on destination branch chain.

197:          //Perform Call.

275:          //Get settlement storage reference

291:          //Encode Data for cross-chain call.

294:          //Retrieve Deposit

491:              //Parse Deposit Nonce

494:              //Check if tx has already been executed

543:              //Check if tx has already been executed

576:              //DEPOSIT FLAG: 5 (Call with Deposit + msg.sender)

581:              //Check if tx has already been executed

679:              //Update Settlement Staus

682:              //Retry settlement call with new params and gas

700:              //Parse deposit nonce

703:              //Check if deposit is in retrieve mode

707:                  //Set settlement to retrieve mode, if not already set.

711:                  //Trigger fallback/Retry failed fallback

717:              //DEPOSIT FLAG: 9 (Fallback)

750:          //Update tx state as executed

753:          //Try to execute the remote request

775:          //Update tx state as executed

778:          //Try to execute the remote request

781:          //Update tx state if execution failed

783:              //Read the fallback flag.

822:              //Sends message to Layerzero Enpoint

834:              //Send Gas to Local Branch Bridge Agent

836:              //Execute locally

878:              //Pack new Data

892:              //Pack new Data

914:              //Sends message to Layerzero Enpoint

926:              //Send Gas to Local Branch Bridge Agent

928:              //Execute locally

939:          //Sends message to LayerZero messaging layer

986:          //Update State to reflect bridgeOut

1063:         //Update Settlement Nonce

```
*GitHub*: [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L167), [170](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L170), [197](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L197), [275](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L275), [291](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L291), [294](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L294), [491](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L491), [494](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L494), [543](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L543), [576](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L576), [581](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L581), [679](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L679), [682](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L682), [700](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L700), [703](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L703), [707](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L707), [711](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L711), [717](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L717), [750](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L750), [753](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L753), [775](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L775), [778](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L778), [781](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L781), [783](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L783), [822](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L822), [834](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L834), [836](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L836), [878](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L878), [892](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L892), [914](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L914), [926](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L926), [928](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L928), [939](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L939), [986](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L986), [1063](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1063)

```solidity
File: src/RootBridgeAgentExecutor.sol

87:           // Read Deposit Params

96:           // Bridge In Assets

99:           // Check if there is additional calldata in the payload

133:          // Check if there is additional calldata in the payload

184:          // Check if there is additional calldata in the payload

218:          // Check if there is additional calldata in the payload

272:          // Parse Parameters

282:              // Cache offset

285:              // Parse Params

337:          // Save Deposit Multiple Params

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L87), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L96), [99](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L99), [133](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L133), [184](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L184), [218](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L218), [272](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L272), [282](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L282), [285](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L285), [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L337)

```solidity
File: src/interfaces/BridgeAgentStructs.sol

9:        uint256 gasLimit; // gas allocated for the cross-chain call.

81:       uint32 settlementNonce; // Settlement nonce.

82:       address recipient; // Recipient of the settlement.

83:       address hToken; // Input Local hTokens Address.

84:       address token; // Input Native / underlying Token Address.

85:       uint256 amount; // Amount of Local hTokens deposited for interaction.

86:       uint256 deposit; // Amount of native tokens deposited for interaction.

90:       uint8 numberOfAssets; // Number of assets to deposit.

91:       address recipient; // Recipient of the settlement.

92:       uint32 settlementNonce; // Settlement nonce.

93:       address[] hTokens; // Input Local hTokens Addresses.

94:       address[] tokens; // Input Native / underlying Token Addresses.

95:       uint256[] amounts; // Amount of Local hTokens deposited for interaction.

96:       uint256[] deposits; // Amount of native tokens deposited for interaction.

```
*GitHub*: [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L9), [81](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L81), [82](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L82), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L83), [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L84), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L85), [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L86), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L90), [91](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L91), [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L92), [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L93), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L94), [95](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L95), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L96)

</details>




### [N&#x2011;09] Lines are too long
Usually lines in source code are limited to [80](https://softwareengineering.stackexchange.com/questions/148677/why-is-80-characters-the-standard-limit-for-code-width) characters. Today's screens are much larger so it's reasonable to stretch this in some cases. The solidity style guide recommends a maximumum line length of [120 characters](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length), so the lines below should be split when they reach that length.

*There are 32 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

60:           address _globalToken = IRootPort(_rootPortAddress).getLocalTokenFromUnderlying(_underlyingAddress, localChainId);

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L60)

```solidity
File: src/BranchBridgeAgent.sol

112:       * @param _lzEndpointAddress Local Layerzero Endpoint Address where cross-chain requests are sent to the Root Chain Router.

548:                              PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets + PARAMS_ENTRY_SIZE * currentIterationOffset

607:              //Flag 0 - BranchBridgeAgentExecutor(bridgeAgentExecutorAddress).executeNoSettlement(localRouterAddress, _payload)

627:              //Flag 1 - BranchBridgeAgentExecutor(bridgeAgentExecutorAddress).executeWithSettlement(recipient, localRouterAddress, _payload)

649:              // Flag 2 - BranchBridgeAgentExecutor(bridgeAgentExecutorAddress).executeWithSettlementMultiple(recipient, localRouterAddress, _payload)

763:       *   @param _gParams LayerZero gas information. (_gasLimit,_remoteBranchExecutionGas,_nativeTokenRecipientOnDstChain)

```
*GitHub*: [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L112), [548](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L548), [607](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L607), [627](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L627), [649](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L649), [763](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L763)

```solidity
File: src/BranchPort.sol

462:       * @notice Internal function to return the minimum amount of reserves of a given Strategy Token the Port should hold.

```
*GitHub*: [462](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L462)

```solidity
File: src/MulticallRootRouter.sol

484:       *   @notice Function to perform a set of actions on the omnichain environment without using the user's Virtual Acccount.

603:      /// @notice Verifies the caller is the Bridge Agent Executor. Internal function used in modifier to reduce contract bytesize.

```
*GitHub*: [484](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L484), [603](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L603)

```solidity
File: src/RootBridgeAgent.sol

61:       /// @notice Chain -> Branch Bridge Agent Address. For N chains, each Root Bridge Agent Address has M =< N Branch Bridge Agent Address.

64:       /// @notice Message Path for each connected Branch Bridge Agent as bytes for Layzer Zero interaction = localAddress + destinationAddress abi.encodePacked()

84:       /// @notice If true, bridge agent has already served a request with this nonce from  a given chain. Chain -> Nonce -> Bool

457:              // Flag 0 - RootBridgeAgentExecutor(bridgeAgentExecutorAddress).executeSystemRequest(_localRouterAddress, _payload, _srcChainId)

480:              // Flag 1 - RootBridgeAgentExecutor(bridgeAgentExecutorAddress).executeNoDeposit(localRouterAddress, payload, _srcChainId)

503:              // Flag 2 - RootBridgeAgentExecutor(bridgeAgentExecutorAddress).executeWithDeposit(localRouterAddress, _payload, _srcChainId)

526:              // Flag 3 - RootBridgeAgentExecutor(bridgeAgentExecutorAddress).executeWithDepositMultiple(localRouterAddress, _payload, _srcChainId)

560:              // Flag 4 - RootBridgeAgentExecutor(bridgeAgentExecutorAddress).executeSignedNoDeposit(address(userAccount), localRouterAddress, data, _srcChainId

598:              // Flag 5 - RootBridgeAgentExecutor(bridgeAgentExecutorAddress).executeSignedWithDeposit(address(userAccount), localRouterAddress, data, _srcChainId)

638:              // Flag 6 - RootBridgeAgentExecutor(bridgeAgentExecutorAddress).executeSignedWithDepositMultiple(address(userAccount), localRouterAddress, data, _srcChainId)

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L64), [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L84), [457](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L457), [480](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L480), [503](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L503), [526](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L526), [560](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L560), [598](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L598), [638](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L638)

```solidity
File: src/VirtualAccount.sol

159:      /// @notice Modifier that verifies msg sender is the approved to use the virtual account. Either the owner or an approved router.

```
*GitHub*: [159](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L159)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

36:    *              (See https://github.com/LayerZero-Labs/solidity-examples/blob/8e62ebc886407aafc89dbd2a778e61b7c0a25ca0/contracts/lzApp/NonblockingLzApp.sol)

```
*GitHub*: [36](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L36)

```solidity
File: src/interfaces/IBranchPort.sol

166:       * @notice Reverts the toggle on the given bridge agent factory. If it's active, it will de-activate it and vice-versa.

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L166)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

12:       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address

14:       // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L12), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L14)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

34:    *              (See https://github.com/LayerZero-Labs/solidity-examples/blob/8e62ebc886407aafc89dbd2a778e61b7c0a25ca0/contracts/lzApp/NonblockingLzApp.sol)

178:       *   @param _refundee the effective owner of the settlement this address receives excess gas deposited on source chain

201:       *   @param _refundee the effective owner of the settlement this address receives excess gas deposited on source chain

```
*GitHub*: [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L34), [178](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L178), [201](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L201)

```solidity
File: src/interfaces/IRootRouter.sol

36:        *   @notice Function responsible of executing a crosschain request which contains cross-chain deposit information attached.

47:        *   @notice Function responsible of executing a crosschain request which contains cross-chain deposit information for multiple assets attached.

66:        * @notice Function responsible of executing a crosschain request which contains cross-chain deposit information and msg.sender attached.

80:        * @notice Function responsible of executing a crosschain request which contains cross-chain deposit information for multiple assets and msg.sender attached.

```
*GitHub*: [36](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L36), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L47), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L66), [80](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L80)

</details>




### [N&#x2011;10] Long functions should be refactored into multiple, smaller, functions


*There are 13 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit 77 lines (69 in the body)
343       function retryDeposit(
344           bool _isSigned,
345           uint32 _depositNonce,
346           bytes calldata _params,
347           GasParams calldata _gParams,
348           bool _hasFallbackToggled
349:      ) external payable override lock {

/// @audit 78 lines (71 in the body)
494       function clearTokens(bytes calldata _sParams, address _recipient)
495           external
496           override
497           requiresAgentExecutor
498:          returns (SettlementMultipleParams memory)

/// @audit 115 lines (109 in the body)
587       function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload)
588           public
589           override
590:          requiresEndpoint(_endpoint, _srcAddress)

```
*GitHub*: [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L343-L349), [494](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L494-L498), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L587-L590)

```solidity
File: src/CoreBranchRouter.sol

/// @audit 64 lines (62 in the body)
86:       function executeNoSettlement(bytes calldata _params) external payable virtual override requiresAgentExecutor {

```
*GitHub*: [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L86)

```solidity
File: src/MulticallRootRouter.sol

/// @audit 64 lines (62 in the body)
137:      function execute(bytes calldata encodedData, uint16) external payable override lock requiresExecutor {

/// @audit 78 lines (70 in the body)
223       function executeSigned(bytes calldata encodedData, address userAccount, uint16)
224           external
225           payable
226           override
227           lock
228:          requiresExecutor

/// @audit 78 lines (70 in the body)
312       function executeSignedDepositSingle(bytes calldata encodedData, DepositParams calldata, address userAccount, uint16)
313           external
314           payable
315           override
316           requiresExecutor
317:          lock

/// @audit 77 lines (70 in the body)
401       function executeSignedDepositMultiple(
402           bytes calldata encodedData,
403           DepositMultipleParams calldata,
404           address userAccount,
405           uint16
406:      ) external payable override requiresExecutor lock {

```
*GitHub*: [137](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L137), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L223-L228), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L312-L317), [401](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L401-L406)

```solidity
File: src/RootBridgeAgent.sol

/// @audit 304 lines (297 in the body)
434       function lzReceiveNonBlocking(
435           address _endpoint,
436           uint16 _srcChainId,
437           bytes calldata _srcAddress,
438           bytes calldata _payload
439:      ) public override requiresEndpoint(_endpoint, _srcChainId, _srcAddress) {

/// @audit 76 lines (61 in the body)
856       function _performRetrySettlementCall(
857           bool _hasFallbackToggled,
858           address[] memory _hTokens,
859           address[] memory _tokens,
860           uint256[] memory _amounts,
861           uint256[] memory _deposits,
862           bytes memory _params,
863           uint32 _settlementNonce,
864           address payable _refundee,
865           address _recipient,
866           uint16 _dstChainId,
867           GasParams memory _gParams,
868:          uint256 _value

/// @audit 66 lines (54 in the body)
966       function _createSettlement(
967           uint32 _settlementNonce,
968           address payable _refundee,
969           address _recipient,
970           uint16 _dstChainId,
971           bytes memory _params,
972           address _globalAddress,
973           uint256 _amount,
974           uint256 _deposit,
975           bool _hasFallbackToggled
976:      ) internal returns (bytes memory _payload) {

/// @audit 70 lines (58 in the body)
1045      function _createSettlementMultiple(
1046          uint32 _settlementNonce,
1047          address payable _refundee,
1048          address _recipient,
1049          uint16 _dstChainId,
1050          address[] memory _globalAddresses,
1051          uint256[] memory _amounts,
1052          uint256[] memory _deposits,
1053          bytes memory _params,
1054          bool _hasFallbackToggled
1055:     ) internal returns (bytes memory _payload) {

```
*GitHub*: [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L434-L439), [856](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L856-L868), [966](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L966-L976), [1045](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1045-L1055)

```solidity
File: src/RootBridgeAgentExecutor.sol

/// @audit 81 lines (76 in the body)
268       function _bridgeInMultiple(address _recipient, bytes calldata _dParams, uint16 _srcChainId)
269           internal
270:          returns (DepositMultipleParams memory dParams)

```
*GitHub*: [268](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L268-L270)


### [N&#x2011;11] Inconsistent method of specifying a floating pragma
Some files use `>=`, some use `^`. The instances below are examples of the method that has the fewest instances for a specific version. Note that using `>=` without also specifying `<=` will lead to failures to compile, or external project incompatability, when the major version changes and there are breaking-changes, so `^` should be preferred regardless of the instance counts

*There are 3 instances of this issue:*

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

3:    pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L3)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

3:    pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L3)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

3:    pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L3)


### [N&#x2011;12] Using `>`/`>=` without specifying an upper bound is unsafe
There _will_ be breaking changes in future versions of solidity, and at that point your code will no longer be compatable. While you may have the specific version to use in a configuration file, others that include your source files may not.

*There are 3 instances of this issue:*

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

3:    pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L3)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

3:    pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L3)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

3:    pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L3)


### [N&#x2011;13] Typos


*There are 37 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BranchBridgeAgent.sol

/// @audit Enpoint
929:      /// @notice Modifier verifies the caller is the Layerzero Enpoint or Local Branch Bridge Agent.

```
*GitHub*: [929](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L929)

```solidity
File: src/BranchBridgeAgentExecutor.sol

/// @audit reamininig
91:               // Send reamininig native / gas token to recipient

/// @audit reamininig
125:              // Send reamininig native / gas token to recipient

```
*GitHub*: [91](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L91), [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L125)

```solidity
File: src/BranchPort.sol

/// @audit overrriden
134:      /// @notice Function being overrriden to prevent mistakenly renouncing ownership.

/// @audit startegy
177:          // Withdraw tokens from startegy

/// @audit startegy
209:          // Withdraw tokens from startegy

```
*GitHub*: [134](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L134), [177](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L177), [209](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L209)

```solidity
File: src/MulticallRootRouter.sol

/// @audit Acccount
484:       *   @notice Function to perform a set of actions on the omnichain environment without using the user's Virtual Acccount.

/// @audit adn
501:       *  @param refundee settlement owner adn excess gas receiver.

/// @audit adn
537:       *  @param refundee settlement owner adn excess gas receiver.

```
*GitHub*: [484](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L484), [501](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L501), [537](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L537)

```solidity
File: src/RootBridgeAgent.sol

/// @audit Layzer
64:       /// @notice Message Path for each connected Branch Bridge Agent as bytes for Layzer Zero interaction = localAddress + destinationAddress abi.encodePacked()

/// @audit setttlement
300:          // Get setttlement storage reference

/// @audit Staus
679:              //Update Settlement Staus

/// @audit Enpoint
822:              //Sends message to Layerzero Enpoint

/// @audit mulitple
890:              // Check if it's mulitple asset settlement

/// @audit Enpoint
914:              //Sends message to Layerzero Enpoint

/// @audit Enpoint
934:       * @notice Internal function performs call to Layerzero Enpoint Contract for cross-chain messaging.

/// @audit Setttlement
1013:         // Update Setttlement

/// @audit Setttlement
1105:         // Update Setttlement

/// @audit Enpoint
1203:     /// @notice Modifier verifies the caller is the Layerzero Enpoint or Local Branch Bridge Agent.

```
*GitHub*: [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L64), [300](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L300), [679](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L679), [822](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L822), [890](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L890), [914](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L914), [934](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L934), [1013](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1013), [1105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1105), [1203](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1203)

```solidity
File: src/RootPort.sol

/// @audit overriden
165:      /// @notice Function being overriden to prevent mistakenly renouncing ownership.

```
*GitHub*: [165](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L165)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

/// @audit Enpoint
18:       /// @notice Local Layerzero Enpoint Address

```
*GitHub*: [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L18)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

/// @audit Redeeem
19:       // Settlement / Deposit Redeeem Status

```
*GitHub*: [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L19)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit Enpoint
130:       * @notice Internal function performs call to Layerzero Enpoint Contract for cross-chain messaging.

/// @audit enconded
145:       *   @param params enconded parameters to execute on the root chain router.

/// @audit enconded
157:       *   @param params enconded parameters to execute on the root chain router.

/// @audit enconded
173:       *   @param params enconded parameters to execute on the root chain router.

/// @audit enconded
189:       *   @param params enconded parameters to execute on the root chain router.

/// @audit enconded
201:       *   @param params enconded parameters to execute on the root chain router.

/// @audit enconded
220:       *   @param params enconded parameters to execute on the root chain router.

/// @audit addresse
299:       *     @param hToken  local hToken addresse to clear balance for.

/// @audit addresse
300:       *     @param token  native / underlying token addresse to clear balance for.

```
*GitHub*: [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L130), [145](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L145), [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L157), [173](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L173), [189](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L189), [201](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L201), [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L220), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L299), [300](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L300)

```solidity
File: src/interfaces/IBranchPort.sol

/// @audit Ulyses
8:     * @notice Ulyses `Port` implementation for Branch Chain deployment. This contract

/// @audit thfe
172:       * @notice Reverts thfe toggle on the given bridge agent  If it's active, it will de-activate it and vice-versa.

```
*GitHub*: [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L8), [172](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L172)

```solidity
File: src/interfaces/IBranchRouter.sol

/// @audit enconded
41:        *   @param params RLP enconded parameters to execute on the root chain.

```
*GitHub*: [41](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L41)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit singned
50:    *       0x04 | Call to Root Router without Deposit + singned message.

/// @audit singned
51:    *       0x05 | Call to Root Router with Deposit + singned message.

/// @audit foricng
245:       * @notice Function that allows retrieval of failed Settlement's foricng fallback to be triggered.

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L50), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L51), [245](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L245)

</details>




### [N&#x2011;14] File is missing NatSpec


*There are 3 instances of this issue:*

```solidity
File: src/interfaces/BridgeAgentStructs.sol


```
*GitHub*: [various](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol)

```solidity
File: src/interfaces/IMulticall2.sol


```
*GitHub*: [various](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol)

```solidity
File: src/token/ERC20hTokenBranch.sol


```
*GitHub*: [various](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol)


### [N&#x2011;15] Function definition modifier order does not follow Solidity style guide
See [this](https://docs.soliditylang.org/en/v0.8.19/style-guide.html#function-declaration) link for an explanation of the correct ordering

*There are 2 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit      function lzReceiveNonBlocking()          public          override          requiresEndpoint()      {          //Save Action Flag          bytes1 flag = _payload[0] & 0x7F;            // Save settlement nonce          uint32 nonce;            // DEPOSIT FLAG: 0 ()          if () {              // Get Settlement Nonce              nonce = uint32());                //Check if tx has already been executed              if () revert AlreadyExecutedTransaction();                //Try to execute the remote request              //Flag 0 - BranchBridgeAgentExecutor().executeNoSettlement()              _execute()              );                // DEPOSIT FLAG: 1 ()          } else if () {              // Parse recipient              address payable recipient = payable())));                // Parse Settlement Nonce              nonce = uint32());                //Check if tx has already been executed              if () revert AlreadyExecutedTransaction();                //Try to execute the remote request              //Flag 1 - BranchBridgeAgentExecutor().executeWithSettlement()              _execute()              );                // DEPOSIT FLAG: 2 ()          } else if () {              // Parse recipient              address payable recipient = payable())));                // Parse deposit nonce              nonce = uint32());                //Check if tx has already been executed              if () revert AlreadyExecutedTransaction();                //Try to execute remote request              // Flag 2 - BranchBridgeAgentExecutor().executeWithSettlementMultiple()              _execute()              );                //DEPOSIT FLAG: 3 ()          } else if () {              // Parse recipient              address payable recipient = payable())));                //Get nonce              nonce = uint32());                //Check if settlement is in retrieve mode              if () {                  revert AlreadyExecutedTransaction();              } else {                  //Set settlement to retrieve mode, if not already set.                  if () executionState[nonce] = STATUS_RETRIEVE;                  //Trigger fallback/Retry failed fallback                  _performFallbackCall();              }                //DEPOSIT FLAG: 4 ()          } else if () {              //Get nonce              nonce = uint32());                // Reopen Deposit for redemption              getDeposit[nonce].status = STATUS_FAILED;                // Emit Fallback Event              emit LogFallback();                // Return to prevent unnecessary logic/emits              return;                //Unrecognized Function Selector          } else {              revert UnknownFlag();          }            // Emit Execution Event          emit LogExecute();      }  : override before constant/payable 
587       function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload)
588           public
589           override
590:          requiresEndpoint(_endpoint, _srcAddress)

```
*GitHub*: [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L587-L590)

```solidity
File: src/RootBridgeAgent.sol

/// @audit      function redeemSettlement() external override lock {          // Get setttlement storage reference          Settlement storage settlement = getSettlement[_settlementNonce];            // Get deposit owner.          address settlementOwner = settlement.owner;            // Check if Settlement is redeemable.          if () revert SettlementRedeemUnavailable();          if ()) revert SettlementRedeemUnavailable();            // Check if Settlement Owner is msg.sender or msg.sender is the virtual account of the settlement owner.          if () {              if ().getUserAccount())) {                  revert NotSettlementOwner();              }          }            // Clear Global hTokens To Recipient on Root Chain cancelling Settlement to Branch          for () {              // Save to memory              address _hToken = settlement.hTokens[i];                // Check if asset              if ()) {                  // Save to memory                  uint24 _dstChainId = settlement.dstChainId;                    // Move hTokens from Branch to Root + Mint Sufficient hTokens to match new port deposit                  IPort().bridgeToRoot().getGlobalTokenFromLocal(),                      settlement.amounts[i],                      settlement.deposits[i],                      _dstChainId                  );              }                unchecked {                  ++i;              }          }            // Delete Settlement          delete getSettlement[_settlementNonce];      }  : override before virtual 
299:      function redeemSettlement(uint32 _settlementNonce) external override lock {

```
*GitHub*: [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L299)


### [N&#x2011;16] Assembly blocks should have extensive comments
Assembly blocks take a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code, and describe why assembly is being used instead of Solidity.

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

149           assembly {
150               size := extcodesize(addr)
151:          }

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L149-L151)


### [N&#x2011;17] Visibility should be set explicitly rather than defaulting to `internal`


*There are 3 instances of this issue:*

```solidity
File: src/BranchPort.sol

83        mapping(address strategy => mapping(address token => uint256 dailyLimitRemaining)) public
84:           strategyDailyLimitRemaining;

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L83-L84)

```solidity
File: src/RootPort.sol

96        mapping(address chainId => mapping(uint256 underlyingAddress => address localAddress)) public
97:           getLocalTokenFromUnderlying;

100       mapping(address chainId => mapping(uint256 localAddress => address underlyingAddress)) public
101:          getUnderlyingTokenFromLocal;

```
*GitHub*: [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L96-L97), [100](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L100-L101)


### [N&#x2011;18] Function ordering does not follow the Solidity style guide
According to the [Solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order :`constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern

*There are 11 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

/// @audit _receiveAddBridgeAgent() came earlier
126:      function executeNoSettlement(bytes calldata _data) external payable override requiresAgentExecutor {

```
*GitHub*: [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L126)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit _execute() came earlier
765:      function _performCall(address payable _refundee, bytes memory _payload, GasParams calldata _gParams)

```
*GitHub*: [765](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L765)

```solidity
File: src/BranchPort.sol

/// @audit renounceOwnership() came earlier
144:      function manage(address _token, uint256 _amount) external override requiresPortStrategy(_token) {

/// @audit withdraw() came earlier
237       function bridgeIn(address _recipient, address _localAddress, uint256 _amount)
238           external
239           override
240:          requiresBridgeAgent

```
*GitHub*: [144](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L144), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L237-L240)

```solidity
File: src/RootBridgeAgent.sol

/// @audit bridgeIn() came earlier
387       function bridgeInMultiple(address _recipient, DepositMultipleParams calldata _dParams, uint256 _srcChainId)
388           external
389           override
390:          requiresAgentExecutor

/// @audit _execute() came earlier
808       function _performCall(
809           uint16 _dstChainId,
810           address payable _refundee,
811           bytes memory _payload,
812:          GasParams calldata _gParams

/// @audit _updateStateOnBridgeOut() came earlier
1170:     function approveBranchBridgeAgent(uint256 _branchChainId) external override requiresManager {

```
*GitHub*: [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L387-L390), [808](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L808-L812), [1170](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1170)

```solidity
File: src/RootPort.sol

/// @audit renounceOwnership() came earlier
175       function getLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
176           external
177           view
178           override
179:          returns (address)

/// @audit _getLocalToken() came earlier
200       function getUnderlyingTokenFromGlobal(address _globalAddress, uint256 _srcChainId)
201           external
202           view
203           override
204:          returns (address)

/// @audit addVirtualAccount() came earlier
369       function toggleVirtualAccountApproved(VirtualAccount _userAccount, address _router)
370           external
371           override
372:          requiresBridgeAgent

```
*GitHub*: [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L175-L179), [200](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L200-L204), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L369-L372)

```solidity
File: src/VirtualAccount.sol

/// @audit payableCall() came earlier
119:      function onERC721Received(address, address, uint256, bytes calldata) external pure override returns (bytes4) {

```
*GitHub*: [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L119)


### [N&#x2011;19] Contract does not follow the Solidity style guide's suggested layout ordering
The [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout) says that, within a contract, the ordering should be 1) Type declarations, 2) State variables, 3) Events, 4) Modifiers, and 5) Functions, but the contract(s) below do not follow this ordering

*There are 15 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

/// @audit function _transferAndApproveMultipleTokens came earlier
206       modifier requiresAgentExecutor() {
207           if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedBridgeAgentExecutor();
208           _;
209:      }

```
*GitHub*: [206](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L206-L209)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit function _clearToken came earlier
922       modifier lock() {
923           require(_unlocked == 1);
924           _unlocked = 2;
925           _;
926           _unlocked = 1;
927:      }

/// @audit function _requiresEndpoint came earlier
947       modifier requiresRouter() {
948           if (msg.sender != localRouterAddress) revert UnrecognizedRouter();
949           _;
950:      }

```
*GitHub*: [922](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L922-L927), [947](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L947-L950)

```solidity
File: src/BranchPort.sol

/// @audit function _bridgeOut came earlier
541       modifier requiresCoreRouter() {
542           if (msg.sender != coreBranchRouterAddress) revert UnrecognizedCore();
543           _;
544:      }

```
*GitHub*: [541](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L541-L544)

```solidity
File: src/CoreRootRouter.sol

/// @audit function _syncBranchBridgeAgent came earlier
511       modifier requiresExecutor() {
512           if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedBridgeAgentExecutor();
513           _;
514:      }

```
*GitHub*: [511](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L511-L514)

```solidity
File: src/MulticallRootRouter.sol

/// @audit function _decode came earlier
590       modifier lock() {
591           require(_unlocked == 1);
592           _unlocked = 2;
593           _;
594           _unlocked = 1;
595:      }

```
*GitHub*: [590](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L590-L595)

```solidity
File: src/RootBridgeAgent.sol

/// @audit function syncBranchBridgeAgent came earlier
1190      modifier lock() {
1191          require(_unlocked == 1);
1192          _unlocked = 2;
1193          _;
1194          _unlocked = 1;
1195:     }

```
*GitHub*: [1190](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1190-L1195)

```solidity
File: src/RootPort.sol

/// @audit function syncNewCoreBranchRouter came earlier
557       modifier requiresBridgeAgentFactory() {
558           if (!isBridgeAgentFactory[msg.sender]) revert UnrecognizedBridgeAgentFactory();
559           _;
560:      }

```
*GitHub*: [557](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L557-L560)

```solidity
File: src/VirtualAccount.sol

/// @audit function isContract came earlier
160       modifier requiresApprovedCaller() {
161           if (!IRootPort(localPortAddress).isRouterApproved(this, msg.sender)) {
162               if (msg.sender != userAddress) {
163                   revert UnauthorizedCaller();
164               }
165           }
166           _;
167:      }

```
*GitHub*: [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L160-L167)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit function createToken came earlier
112       modifier requiresCoreRouter() {
113           if (msg.sender != localCoreRouterAddress) revert UnrecognizedCoreRouter();
114           _;
115:      }

```
*GitHub*: [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L112-L115)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

/// @audit function createToken came earlier
96        modifier requiresCoreRouterOrPort() {
97            if (msg.sender != coreRootRouterAddress) {
98                if (msg.sender != rootPortAddress) {
99                    revert UnrecognizedCoreRouterOrPort();
100               }
101           }
102           _;
103:      }

```
*GitHub*: [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L96-L103)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit function lzReceiveNonBlocking came earlier
332:      event LogExecute(uint256 indexed nonce);

```
*GitHub*: [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L332)

```solidity
File: src/interfaces/IBranchPort.sol

/// @audit function setCoreBranchRouter came earlier
220:      event DebtCreated(address indexed _strategy, address indexed _token, uint256 _amount);

```
*GitHub*: [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L220)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit function syncBranchBridgeAgent came earlier
337:      event LogExecute(uint256 indexed depositNonce, uint256 indexed srcChainId);

```
*GitHub*: [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L337)

```solidity
File: src/interfaces/IRootPort.sol

/// @audit function syncNewCoreBranchRouter came earlier
371:      event BridgeAgentFactoryAdded(address indexed bridgeAgentFactory);

```
*GitHub*: [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L371)

</details>




### [N&#x2011;20] Add inline comments for unnamed variables
`function foo(address x, address)` -> `function foo(address x, address /* y */)`

*There are 18 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

88        /// @dev This functionality should be accessed from Root environment
89:       function retrySettlement(uint32, bytes calldata, GasParams[2] calldata, bool) external payable override lock {}

```
*GitHub*: [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L88-L89)

```solidity
File: src/BranchBridgeAgent.sol

578:      function lzReceive(uint16, bytes calldata _srcAddress, uint64, bytes calldata _payload) public override {

```
*GitHub*: [578](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L578)

```solidity
File: src/CoreRootRouter.sol

332:      function execute(bytes calldata _encodedData, uint16) external payable override requiresExecutor {

350:      function executeDepositSingle(bytes memory, DepositParams memory, uint16)

360:      function executeDepositMultiple(bytes calldata, DepositMultipleParams memory, uint16)

370:      function executeSigned(bytes memory, address, uint16) external payable override requiresExecutor {

375:      function executeSignedDepositSingle(bytes memory, DepositParams memory, address, uint16)

385:      function executeSignedDepositMultiple(bytes memory, DepositMultipleParams memory, address, uint16)

```
*GitHub*: [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L332), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L350), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L360), [370](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L370), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L375), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L385)

```solidity
File: src/MulticallRootRouter.sol

122       /// @dev This function will revert when called.
123:      function executeResponse(bytes memory, uint16) external payable override {

137:      function execute(bytes calldata encodedData, uint16) external payable override lock requiresExecutor {

203:      function executeDepositSingle(bytes calldata, DepositParams calldata, uint16) external payable override {

209:      function executeDepositMultiple(bytes calldata, DepositMultipleParams calldata, uint16) external payable {

223:      function executeSigned(bytes calldata encodedData, address userAccount, uint16)

312:      function executeSignedDepositSingle(bytes calldata encodedData, DepositParams calldata, address userAccount, uint16)

```
*GitHub*: [122](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L122-L123), [137](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L137), [203](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L203), [209](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L209), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L223), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L312)

```solidity
File: src/RootBridgeAgent.sol

423:      function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64, bytes calldata _payload) public {

```
*GitHub*: [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L423)

```solidity
File: src/VirtualAccount.sol

119:      function onERC721Received(address, address, uint256, bytes calldata) external pure override returns (bytes4) {

124:      function onERC1155Received(address, address, uint256, uint256, bytes calldata)

134:      function onERC1155BatchReceived(address, address, uint256[] calldata, uint256[] calldata, bytes calldata)

```
*GitHub*: [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L119), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L124), [134](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L134)


### [N&#x2011;21] Invalid NatSpec comment style
NatSpec must begin with `///`, or use `/* ... */` syntax

*There are 67 instances of this issue:*

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

8:        // @notice send a LayerZero message to the specified address at a LayerZero endpoint.

9:        // @param _dstChainId - the destination chain identifier

10:       // @param _destination - the address on destination chain (in bytes). address length/format may vary by chains

11:       // @param _payload - a custom bytes payload to send to the destination contract

12:       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address

13:       // @param _zroPaymentAddress - the address of the ZRO token holder who would pay for the transaction

14:       // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

24:       // @notice used by the messaging library to publish verified payload

25:       // @param _srcChainId - the source chain identifier

26:       // @param _srcAddress - the source contract (as bytes) at the source chain

27:       // @param _dstAddress - the address on destination chain

28:       // @param _nonce - the unbound message ordering nonce

29:       // @param _gasLimit - the gas limit for external contract execution

30:       // @param _payload - verified payload to send to the destination contract

40:       // @notice get the inboundNonce of a receiver from a source chain which could be EVM or non-EVM chain

41:       // @param _srcChainId - the source chain identifier

42:       // @param _srcAddress - the source chain contract address

45:       // @notice get the outboundNonce from this source chain which, consequently, is always an EVM

46:       // @param _srcAddress - the source chain contract address

49:       // @notice gets a quote in source native gas, for the amount that send() requires to pay for message delivery

50:       // @param _dstChainId - the destination chain identifier

51:       // @param _userApplication - the user app address on this EVM chain

52:       // @param _payload - the custom message to send over LayerZero

53:       // @param _payInZRO - if false, user app pays the protocol fee in native token

54:       // @param _adapterParam - parameters for the adapter service, e.g. send some dust native token to dstChain

63:       // @notice get this Endpoint's immutable source identifier

66:       // @notice the interface to retry failed message on this Endpoint destination

67:       // @param _srcChainId - the source chain identifier

68:       // @param _srcAddress - the source chain contract address

69:       // @param _payload - the payload to be retried

72:       // @notice query if any STORED payload (message blocking) at the endpoint.

73:       // @param _srcChainId - the source chain identifier

74:       // @param _srcAddress - the source chain contract address

77:       // @notice query if the _libraryAddress is valid for sending msgs.

78:       // @param _userApplication - the user app address on this EVM chain

81:       // @notice query if the _libraryAddress is valid for receiving msgs.

82:       // @param _userApplication - the user app address on this EVM chain

85:       // @notice query if the non-reentrancy guard for send() is on

86:       // @return true if the guard is on. false otherwise

89:       // @notice query if the non-reentrancy guard for receive() is on

90:       // @return true if the guard is on. false otherwise

93:       // @notice get the configuration of the LayerZero messaging library of the specified version

94:       // @param _version - messaging library version

95:       // @param _chainId - the chainId for the pending config change

96:       // @param _userApplication - the contract address of the user application

97:       // @param _configType - type of configuration. every messaging library has its own convention.

103:      // @notice get the send() LayerZero messaging library version

104:      // @param _userApplication - the contract address of the user application

107:      // @notice get the lzReceive() LayerZero messaging library version

108:      // @param _userApplication - the contract address of the user application

```
*GitHub*: [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L14), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L24), [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L25), [26](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L26), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L27), [28](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L28), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L29), [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L30), [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L40), [41](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L41), [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L42), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L45), [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L46), [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L49), [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L50), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L51), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L52), [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L53), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L54), [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L63), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L66), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L68), [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L69), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L72), [73](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L73), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L74), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L77), [78](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L78), [81](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L81), [82](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L82), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L85), [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L86), [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L89), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L90), [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L93), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L94), [95](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L95), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L96), [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L97), [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L103), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L104), [107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L107), [108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L108)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

6:        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination

7:        // @param _srcChainId - the source endpoint identifier

8:        // @param _srcAddress - the source sending contract address from the source chain

9:        // @param _nonce - the ordered message nonce

10:       // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L6), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

6:        // @notice set the configuration of the LayerZero messaging library of the specified version

7:        // @param _version - messaging library version

8:        // @param _chainId - the chainId for the pending config change

9:        // @param _configType - type of configuration. every messaging library has its own convention.

10:       // @param _config - configuration in the bytes. can encode arbitrary content.

13:       // @notice set the send() LayerZero messaging library version to _version

14:       // @param _version - new messaging library version

17:       // @notice set the lzReceive() LayerZero messaging library version to _version

18:       // @param _version - new messaging library version

21:       // @notice Only when the UA needs to resume the message flow in blocking mode and clear the stored payload

22:       // @param _srcChainId - the chainId of the source chain

23:       // @param _srcAddress - the contract address of the source contract at the source chain

```
*GitHub*: [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L6), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L10), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L14), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L17), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L18), [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L21), [22](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L22), [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L23)


### [N&#x2011;22] Contracts should have full test coverage
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There is one instance of this issue:*

```solidity
File: Various Files


```


### [N&#x2011;23] Large or complicated code bases should implement invariant tests
Large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts, should implement [invariant fuzzing tests](https://medium.com/coinmonks/smart-contract-fuzzing-d9b88e0b0a05). Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers, with properly and extensively-written invariants, can close this testing gap significantly.

*There is one instance of this issue:*

```solidity
File: Various Files


```


### [N&#x2011;24] Consider adding formal verification proofs
Consider using formal verification to mathematically prove that your code does what is intended, and does not have any edge cases with unexpected behavior. The solidity compiler itself has this functionality [built in](https://docs.soliditylang.org/en/latest/smtchecker.html#smtchecker-and-formal-verification)

*There is one instance of this issue:*

```solidity
File: Various Files


```


### [N&#x2011;25] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability
Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related

*There are 3 instances of this issue:*

```solidity
File: src/BranchPort.sol

74        mapping(address strategy => mapping(address token => uint256 debt)) public getPortStrategyTokenDebt;
75    
76        /// @notice Mapping returns the last time a given Port Strategy managed a given Strategy Token.
77        mapping(address strategy => mapping(address token => uint256 lastManaged)) public lastManaged;
78    
79        /// @notice Mapping returns the time limit a given Port Strategy must wait before managing a Strategy Token.
80        mapping(address strategy => mapping(address token => uint256 dailyLimitAmount)) public strategyDailyLimitAmount;
81    
82        /// @notice Mapping returns the amount of a Strategy Token a given Port Strategy can manage.
83        mapping(address strategy => mapping(address token => uint256 dailyLimitRemaining)) public
84:           strategyDailyLimitRemaining;

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L74-L84)

```solidity
File: src/RootBridgeAgent.sol

62        mapping(uint256 chainId => address branchBridgeAgent) public getBranchBridgeAgent;
63    
64        /// @notice Message Path for each connected Branch Bridge Agent as bytes for Layzer Zero interaction = localAddress + destinationAddress abi.encodePacked()
65        mapping(uint256 chainId => bytes branchBridgeAgentPath) public getBranchBridgeAgentPath;
66    
67        /// @notice If true, bridge agent manager has allowed for a new given branch bridge agent to be synced/added.
68:       mapping(uint256 chainId => bool allowed) public isBranchBridgeAgentAllowed;

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L62-L68)

```solidity
File: src/RootPort.sol

87        mapping(address token => bool isGlobalToken) public isGlobalAddress;
88    
89        /// @notice ChainId -> Local Address -> Global Address
90        mapping(address chainId => mapping(uint256 localAddress => address globalAddress)) public getGlobalTokenFromLocal;
91    
92        /// @notice ChainId -> Global Address -> Local Address
93        mapping(address chainId => mapping(uint256 globalAddress => address localAddress)) public getLocalTokenFromGlobal;
94    
95        /// @notice ChainId -> Underlying Address -> Local Address
96        mapping(address chainId => mapping(uint256 underlyingAddress => address localAddress)) public
97            getLocalTokenFromUnderlying;
98    
99        /// @notice Mapping from Local Address to Underlying Address.
100       mapping(address chainId => mapping(uint256 localAddress => address underlyingAddress)) public
101:          getUnderlyingTokenFromLocal;

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L87-L101)


### [N&#x2011;26] Custom errors should be used rather than `revert()`/`require()`
Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in `try`-`catch` blocks, and are easier to re-use and maintain.

*There are 54 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

39:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L39)

```solidity
File: src/BaseBranchRouter.sol

61:           require(_localBridgeAgentAddress != address(0), "Bridge Agent address cannot be 0");

213:          require(_unlocked == 1);

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L61), [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L213)

```solidity
File: src/BranchBridgeAgent.sol

125:          require(_rootBridgeAgentAddress != address(0), "Root Bridge Agent Address cannot be the zero address.");

126           require(
127               _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
128               "Layerzero Endpoint Address cannot be the zero address."
129:          );

130:          require(_localRouterAddress != address(0), "Local Router Address cannot be the zero address.");

131:          require(_localPortAddress != address(0), "Local Port Address cannot be the zero address.");

923:          require(_unlocked == 1);

```
*GitHub*: [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L125), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L126-L129), [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L131), [923](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L923)

```solidity
File: src/BranchPort.sol

109:          require(_owner != address(0), "Owner is zero address");

123:          require(coreBranchRouterAddress == address(0), "Contract already initialized");

124:          require(!isBridgeAgentFactory[_bridgeAgentFactory], "Contract already initialized");

126:          require(_coreBranchRouter != address(0), "CoreBranchRouter is zero address");

127:          require(_bridgeAgentFactory != address(0), "BridgeAgentFactory is zero address");

181:          require(ERC20(_token).balanceOf(address(this)) - currBalance == _amount, "Port Strategy Withdraw Failed");

213           require(
214               ERC20(_token).balanceOf(address(this)) - currBalance == amountToWithdraw, "Port Strategy Withdraw Failed"
215:          );

332:          require(coreBranchRouterAddress != address(0), "CoreRouter address is zero");

333:          require(_newCoreRouter != address(0), "New CoreRouter address is zero");

567:          require(_unlocked == 1);

```
*GitHub*: [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L109), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L123), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L124), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L126), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L127), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L181), [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L213-L215), [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L332), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L333), [567](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L567)

```solidity
File: src/CoreRootRouter.sol

84:           require(_setup, "Contract is already initialized");

278:          require(msg.sender == rootPortAddress, "Only root port can call");

```
*GitHub*: [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L84), [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L278)

```solidity
File: src/MulticallRootRouter.sol

93:           require(_localPortAddress != address(0), "Local Port Address cannot be 0");

94:           require(_multicallAddress != address(0), "Multicall Address cannot be 0");

110:          require(_bridgeAgentAddress != address(0), "Bridge Agent Address cannot be 0");

591:          require(_unlocked == 1);

```
*GitHub*: [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L93), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L94), [110](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L110), [591](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L591)

```solidity
File: src/RootBridgeAgent.sol

111:          require(_lzEndpointAddress != address(0), "Layerzero Enpoint Address cannot be zero address");

112:          require(_localPortAddress != address(0), "Port Address cannot be zero address");

113:          require(_localRouterAddress != address(0), "Router Address cannot be zero address");

1191:         require(_unlocked == 1);

```
*GitHub*: [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L111), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L112), [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L113), [1191](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1191)

```solidity
File: src/RootPort.sol

130:          require(_bridgeAgentFactory != address(0), "Bridge Agent Factory cannot be 0 address.");

131:          require(_coreRootRouter != address(0), "Core Root Router cannot be 0 address.");

132:          require(_setup, "Setup ended.");

152:          require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0 address.");

153:          require(_coreLocalBranchBridgeAgent != address(0), "Core Local Branch Bridge Agent cannot be 0 address.");

154:          require(_localBranchPortAddress != address(0), "Local Branch Port Address cannot be 0 address.");

155:          require(isBridgeAgent[_coreRootBridgeAgent], "Core Bridge Agent doesn't exist.");

156:          require(_setupCore, "Core Setup ended.");

```
*GitHub*: [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L131), [132](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L132), [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L152), [153](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L153), [154](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L154), [155](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L155), [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L156)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

57:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent Address cannot be 0");

84            require(
85                msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
86:           );

87            require(
88                _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
89                "Root Bridge Agent Factory Address does not match."
90:           );

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L57), [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L84-L86), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L87-L90)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

61:           require(_rootBridgeAgentFactoryAddress != address(0), "Root Bridge Agent Factory Address cannot be 0");

62            require(
63                _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
64                "Layerzero Endpoint Address cannot be the zero address."
65:           );

66:           require(_localCoreBranchRouterAddress != address(0), "Core Branch Router Address cannot be 0");

67:           require(_localPortAddress != address(0), "Port Address cannot be 0");

68:           require(_owner != address(0), "Owner cannot be 0");

88:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0");

120           require(
121               msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
122:          );

123           require(
124               _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
125               "Root Bridge Agent Factory Address does not match."
126:          );

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L61), [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L62-L65), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L66), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L68), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L88), [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L120-L122), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L123-L126)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

43:           require(_localPortAddress != address(0), "Port address cannot be 0");

61:           require(_coreRouter != address(0), "CoreRouter address cannot be 0");

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L43), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L61)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

35:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

50:           require(_coreRouter != address(0), "CoreRouter address cannot be 0");

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L35), [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L50)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

32:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L32)

```solidity
File: src/token/ERC20hTokenRoot.sol

39:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

40:           require(_factoryAddress != address(0), "Factory Address cannot be 0");

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L39), [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L40)

</details>




### [N&#x2011;27] Use `abi.encodeCall()` instead of `abi.encodeWithSignature()`/`abi.encodeWithSelector()`
`abi.encodeCall()` has compiler [type safety](https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3693), whereas the other two functions do not

*There are 12 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

582:             abi.encodeWithSelector(this.lzReceiveNonBlocking.selector, msg.sender, _srcAddress, _payload)

654:                 abi.encodeWithSelector(

632:                 abi.encodeWithSelector(

610:                 abi.encodeWithSelector(

```
*GitHub*: [582](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L582-L582), [654](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L654-L654), [632](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L632-L632), [610](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L610-L610)

```solidity
File: src/RootBridgeAgent.sol

427:             abi.encodeWithSelector(this.lzReceiveNonBlocking.selector, msg.sender, _srcChainId, _srcAddress, _payload)

643:                 abi.encodeWithSelector(

603:                 abi.encodeWithSelector(

563:                 abi.encodeWithSelector(

529:                 abi.encodeWithSelector(

506:                 abi.encodeWithSelector(

483:                 abi.encodeWithSelector(

460:                 abi.encodeWithSelector(

```
*GitHub*: [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L427-L427), [643](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L643-L643), [603](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L603-L603), [563](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L563-L563), [529](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L529-L529), [506](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L506-L506), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L483-L483), [460](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L460-L460)


### [N&#x2011;28] Style guide: Non-`external`/`public` variable names should begin with an underscore
According to the Solidity Style Guide, non-`external`/`public` variable names should begin with an [underscore](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are 23 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

64:      bytes private rootBridgeAgentPath;

```
*GitHub*: [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L64-L64)

```solidity
File: src/BranchPort.sol

97:      uint256 internal constant DIVISIONER = 1e4;

98:      uint256 internal constant MIN_RESERVE_RATIO = 3e3;

```
*GitHub*: [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L97-L97), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L98-L98)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

13:      uint8 internal constant STATUS_READY = 0;

15:      uint8 internal constant STATUS_DONE = 1;

17:      uint8 internal constant STATUS_RETRIEVE = 2;

21:      uint8 internal constant STATUS_FAILED = 1;

23:      uint8 internal constant STATUS_SUCCESS = 0;

27:      uint256 internal constant PARAMS_START = 1;

29:      uint256 internal constant PARAMS_START_SIGNED = 21;

31:      uint256 internal constant PARAMS_TKN_START = 5;

33:      uint256 internal constant PARAMS_TKN_START_SIGNED = 25;

35:      uint256 internal constant PARAMS_ENTRY_SIZE = 32;

37:      uint256 internal constant PARAMS_ADDRESS_SIZE = 20;

39:      uint256 internal constant PARAMS_TKN_SET_SIZE = 109;

41:      uint256 internal constant PARAMS_TKN_SET_SIZE_MULTIPLE = 128;

43:      uint256 internal constant ADDRESS_END_OFFSET = 12;

45:      uint256 internal constant PARAMS_AMT_OFFSET = 64;

47:      uint256 internal constant PARAMS_DEPOSIT_OFFSET = 96;

49:      uint256 internal constant PARAMS_END_OFFSET = 6;

51:      uint256 internal constant PARAMS_END_SIGNED_OFFSET = 26;

53:      uint256 internal constant PARAMS_SETTLEMENT_OFFSET = 129;

57:      uint256 internal constant MAX_TOKENS_LENGTH = 255;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L13-L13), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L15-L15), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L17-L17), [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L21-L21), [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L23-L23), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L27-L27), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L29-L29), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L31-L31), [33](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L33-L33), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L35-L35), [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L37-L37), [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L39-L39), [41](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L41-L41), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L43-L43), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L45-L45), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L47-L47), [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L49-L49), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L51-L51), [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L53-L53), [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L57-L57)


### [N&#x2011;29] Variable names for `immutable`s should use CONSTANT_CASE
For `immutable` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)

*There are 39 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

22:      uint16 public immutable localChainId;

26:      address public immutable rootPortAddress;

```
*GitHub*: [22](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L22-L22), [26](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L26-L26)

```solidity
File: src/BranchBridgeAgent.sol

53:      uint16 public immutable rootChainId;

56:      uint16 public immutable localChainId;

60:      address public immutable rootBridgeAgentAddress;

67:      address public immutable lzEndpointAddress;

70:      address public immutable localRouterAddress;

74:      address public immutable localPortAddress;

77:      address public immutable bridgeAgentExecutorAddress;

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L53-L53), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L56-L56), [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L60-L60), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L67-L67), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L70-L70), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L74-L74), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L77-L77)

```solidity
File: src/CoreBranchRouter.sol

20:      address public immutable hTokenFactoryAddress;

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L20-L20)

```solidity
File: src/CoreRootRouter.sol

47:      uint256 public immutable rootChainId;

51:      address public immutable rootPortAddress;

```
*GitHub*: [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L47-L47), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L51-L51)

```solidity
File: src/MulticallRootRouter.sol

65:      uint256 public immutable localChainId;

68:      address public immutable localPortAddress;

71:      address public immutable multicallAddress;

```
*GitHub*: [65](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L65-L65), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L68-L68), [71](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L71-L71)

```solidity
File: src/RootBridgeAgent.sol

40:      uint16 public immutable localChainId;

43:      address public immutable factoryAddress;

46:      address public immutable localRouterAddress;

49:      address public immutable localPortAddress;

52:      address public immutable lzEndpointAddress;

55:      address public immutable bridgeAgentExecutorAddress;

```
*GitHub*: [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L40-L40), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L43-L43), [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L46-L46), [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L49-L49), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L52-L52), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L55-L55)

```solidity
File: src/RootPort.sol

34:      uint256 public immutable localChainId;

```
*GitHub*: [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L34-L34)

```solidity
File: src/VirtualAccount.sol

21:      address public immutable override userAddress;

24:      address public immutable override localPortAddress;

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L21-L21), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L24-L24)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

21:      uint16 public immutable localChainId;

24:      uint16 public immutable rootChainId;

27:      address public immutable rootBridgeAgentFactoryAddress;

30:      address public immutable localCoreBranchRouterAddress;

33:      address public immutable localPortAddress;

36:      address public immutable lzEndpointAddress;

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L21-L21), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L24-L24), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L27-L27), [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L30-L30), [33](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L33-L33), [36](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L36-L36)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

14:      uint24 public immutable localChainId;

17:      address public immutable localPortAddress;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L14-L14), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L17-L17)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

14:      uint16 public immutable localChainId;

17:      address public immutable rootPortAddress;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L14-L14), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L17-L17)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

13:      uint16 public immutable rootChainId;

16:      address public immutable rootPortAddress;

19:      address public immutable lzEndpointAddress;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L13-L13), [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L16-L16), [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L19-L19)

```solidity
File: src/token/ERC20hTokenRoot.sol

14:      uint16 public immutable override localChainId;

17:      address public immutable override factoryAddress;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L14-L14), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L17-L17)

</details>




### [N&#x2011;30] Array indicies should be referenced via `enum`s rather than via numeric literals


*There are 66 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumCoreBranchRouter.sol

127:         if (_data[0] == 0x02) {

146:         } else if (_data[0] == 0x03) {

152:         } else if (_data[0] == 0x04) {

157:         } else if (_data[0] == 0x05) {

162:         } else if (_data[0] == 0x06) {

```
*GitHub*: [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L127-L127), [146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L146-L146), [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L152-L152), [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L157-L157), [162](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L162-L162)

```solidity
File: src/BranchBridgeAgent.sol

376:                     deposit.hTokens[0],

377:                     deposit.tokens[0],

378:                     deposit.amounts[0],

379:                     deposit.deposits[0],

366:                     deposit.hTokens[0],

367:                     deposit.tokens[0],

368:                     deposit.amounts[0],

369:                     deposit.deposits[0],

471:         bytes memory params = abi.encode(_settlementNonce, msg.sender, _params, _gParams[1]);

477:         _performCall(payable(msg.sender), payload, _gParams[0]);

501:         uint8 numOfAssets = uint8(bytes1(_sParams[0]));

593:         bytes1 flag = _payload[0] & 0x7F;

651:                 _payload[0] == 0x82,

629:                 _payload[0] == 0x81,

834:         addressArray[0] = _hToken;

837:         addressArray[0] = _token;

840:         uintArray[0] = _amount;

843:         uintArray[0] = _deposit;

```
*GitHub*: [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L376-L376), [377](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L377-L377), [378](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L378-L378), [379](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L379-L379), [366](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L366-L366), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L367-L367), [368](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L368-L368), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L369-L369), [471](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L471-L471), [477](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L477-L477), [501](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L501-L501), [593](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L593-L593), [651](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L651-L651), [629](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L629-L629), [834](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L834-L834), [837](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L837-L837), [840](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L840-L840), [843](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L843-L843)

```solidity
File: src/CoreBranchRouter.sol

48:          bytes memory params = abi.encode(msg.sender, _globalAddress, _dstChainId, [_gParams[1], _gParams[2]]);

54:          IBridgeAgent(localBridgeAgentAddress).callOut{value: msg.value}(payable(msg.sender), payload, _gParams[0]);

88:          if (_params[0] == 0x01) {

100:         } else if (_params[0] == 0x02) {

115:         } else if (_params[0] == 0x03) {

121:         } else if (_params[0] == 0x04) {

127:         } else if (_params[0] == 0x05) {

133:         } else if (_params[0] == 0x06) {

140:         } else if (_params[0] == 0x07) {

```
*GitHub*: [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L48-L48), [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L48-L48), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L54-L54), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L88-L88), [100](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L100-L100), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L115-L115), [121](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L121-L121), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L127-L127), [133](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L133-L133), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L140-L140)

```solidity
File: src/CoreRootRouter.sol

132:             _gParams[1]

140:             payable(_refundee), _refundee, _dstChainId, payload, _gParams[0]

304:         bytes1 funcId = _encodedData[0];

334:         bytes1 funcId = _encodedData[0];

339:                 abi.decode(_encodedData[1:], (address, address, uint16, GasParams[2]));

430:             _gParams[1]

438:             payable(_refundee), _refundee, _dstChainId, payload, _gParams[0]

```
*GitHub*: [132](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L132-L132), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L140-L140), [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L304-L304), [334](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L334-L334), [339](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L339-L339), [430](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L430-L430), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L438-L438)

```solidity
File: src/MulticallRootRouter.sol

139:         bytes1 funcId = encodedData[0];

231:         bytes1 funcId = encodedData[0];

320:         bytes1 funcId = encodedData[0];

408:         bytes1 funcId = encodedData[0];

```
*GitHub*: [139](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L139-L139), [231](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L231-L231), [320](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L320-L320), [408](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L408-L408)

```solidity
File: src/RootBridgeAgent.sol

444:         if (_payload[0] == 0x00) {

467:         } else if (_payload[0] == 0x01) {

490:         } else if (_payload[0] == 0x02) {

513:         } else if (_payload[0] == 0x03) {

539:         } else if (_payload[0] == 0x04) {

577:         } else if (_payload[0] & 0x7F == 0x05) {

617:         } else if (_payload[0] & 0x7F == 0x06) {

657:         } else if (_payload[0] & 0x7F == 0x07) {

699:         } else if (_payload[0] == 0x08) {

718:         } else if (_payload[0] == 0x09) {

684:                 _payload[0] == 0x87,

640:                 _payload[0] == 0x86,

600:                 _payload[0] == 0x85,

883:                 _hTokens[0],

884:                 _tokens[0],

885:                 _amounts[0],

886:                 _deposits[0],

1017:        addressArray[0] = localAddress;

1020:        addressArray[0] = underlyingAddress;

1023:        uintArray[0] = _amount;

1026:        uintArray[0] = _deposit;

```
*GitHub*: [444](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L444-L444), [467](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L467-L467), [490](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L490-L490), [513](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L513-L513), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L539-L539), [577](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L577-L577), [617](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L617-L617), [657](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L657-L657), [699](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L699-L699), [718](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L718-L718), [684](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L684-L684), [640](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L640-L640), [600](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L600-L600), [883](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L883-L883), [884](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L884-L884), [885](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L885-L885), [886](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L886-L886), [1017](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1017-L1017), [1020](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1020-L1020), [1023](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1023-L1023), [1026](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1026-L1026)

```solidity
File: src/RootBridgeAgentExecutor.sol

273:         uint8 numOfAssets = uint8(bytes1(_dParams[0]));

```
*GitHub*: [273](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L273-L273)

</details>




### [N&#x2011;31] Consider using named mappings
Consider moving to solidity version 0.8.18 or later, and using [named mappings](https://ethereum.stackexchange.com/a/145555) to make it easier to understand the purpose of each mapping

*There are 40 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

87:      mapping(uint256 depositNonce => Deposit depositInfo) public getDeposit;

94:      mapping(uint256 settlementNonce => uint256 state) public executionState;

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L87-L87), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L94-L94)

```solidity
File: src/BranchPort.sol

32:      mapping(address bridgeAgent => bool isActiveBridgeAgent) public isBridgeAgent;

42:      mapping(address bridgeAgentFactory => bool isActiveBridgeAgentFactory) public isBridgeAgentFactory;

52:      mapping(address token => bool allowsStrategies) public isStrategyToken;

58:      mapping(address token => uint256 debt) public getStrategyTokenDebt;

61:      mapping(address token => uint256 minimumReserveRatio) public getMinimumTokenReserveRatio;

68:      mapping(address strategy => mapping(address token => bool isActiveStrategy)) public isPortStrategy;

74:      mapping(address strategy => mapping(address token => uint256 debt)) public getPortStrategyTokenDebt;

77:      mapping(address strategy => mapping(address token => uint256 lastManaged)) public lastManaged;

80:      mapping(address strategy => mapping(address token => uint256 dailyLimitAmount)) public strategyDailyLimitAmount;

83:      mapping(address strategy => mapping(address token => uint256 dailyLimitRemaining)) public

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L32-L32), [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L42-L42), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L52-L52), [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L58-L58), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L61-L61), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L68-L68), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L68-L68), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L74-L74), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L74-L74), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L77-L77), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L77-L77), [80](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L80-L80), [80](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L80-L80), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L83-L83), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L83-L83)

```solidity
File: src/RootBridgeAgent.sol

62:      mapping(uint256 chainId => address branchBridgeAgent) public getBranchBridgeAgent;

65:      mapping(uint256 chainId => bytes branchBridgeAgentPath) public getBranchBridgeAgentPath;

68:      mapping(uint256 chainId => bool allowed) public isBranchBridgeAgentAllowed;

78:      mapping(uint256 nonce => Settlement settlementInfo) public getSettlement;

85:      mapping(uint256 chainId => mapping(uint256 nonce => uint256 state)) public executionState;

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L62-L62), [65](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L65-L65), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L68-L68), [78](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L78-L78), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L85-L85), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L85-L85)

```solidity
File: src/RootPort.sol

50:      mapping(address user => VirtualAccount account) public getUserAccount;

54:      mapping(VirtualAccount acount => mapping(address router => bool allowed)) public isRouterApproved;

61:      mapping(uint256 chainId => bool isActive) public isChainId;

64:      mapping(address bridgeAgent => bool isActive) public isBridgeAgent;

70:      mapping(address bridgeAgent => address bridgeAgentManager) public getBridgeAgentManager;

77:      mapping(address bridgeAgentFactory => bool isActive) public isBridgeAgentFactory;

87:      mapping(address token => bool isGlobalToken) public isGlobalAddress;

90:      mapping(address chainId => mapping(uint256 localAddress => address globalAddress)) public getGlobalTokenFromLocal;

93:      mapping(address chainId => mapping(uint256 globalAddress => address localAddress)) public getLocalTokenFromGlobal;

96:      mapping(address chainId => mapping(uint256 underlyingAddress => address localAddress)) public

100:     mapping(address chainId => mapping(uint256 localAddress => address underlyingAddress)) public

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L50-L50), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L54-L54), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L54-L54), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L61-L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L64-L64), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L70-L70), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L77-L77), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L87-L87), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L90-L90), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L90-L90), [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L93-L93), [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L93-L93), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L96-L96), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L96-L96), [100](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L100-L100), [100](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L100-L100)

```solidity
File: src/token/ERC20hTokenRoot.sol

20:      mapping(uint256 chainId => uint256 balance) public override getTokenBalance;

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L20-L20)


### [N&#x2011;32] Use of `override` is unnecessary
Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.

*There are 117 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

89:      function retrySettlement(uint32, bytes calldata, GasParams[2] calldata, bool) external payable override lock {}

99:      function _performCall(address payable, bytes memory _calldata, GasParams calldata) internal override {

112:     function _performFallbackCall(address payable, uint32 _settlementNonce) internal override {

125:     function _requiresEndpoint(address _endpoint, bytes calldata) internal view override {

```
*GitHub*: [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L89-L89), [99](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L99-L99), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L112-L112), [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L125-L125)

```solidity
File: src/ArbitrumBranchPort.sol

50       function depositToPort(address _depositor, address _recipient, address _underlyingAddress, uint256 _deposit)
51           external
52           override
53           lock
54           requiresBridgeAgent
55:      {

73       function withdrawFromPort(address _depositor, address _recipient, address _globalAddress, uint256 _amount)
74           external
75           override
76           lock
77           requiresBridgeAgent
78:      {

107:     function _bridgeIn(address _recipient, address _localAddress, uint256 _amount) internal override {

119      function _bridgeOut(
120          address _depositor,
121          address _localAddress,
122          address _underlyingAddress,
123          uint256 _amount,
124          uint256 _deposit
125:     ) internal override {

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L50-L55), [73](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L73-L78), [107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L107-L107), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L119-L125)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

51:      function addLocalToken(address _underlyingAddress, GasParams calldata) external payable override {

85       function _receiveAddBridgeAgent(
86           address _newBranchRouter,
87           address _branchBridgeAgentFactory,
88           address _rootBridgeAgent,
89           address _rootBridgeAgentFactory,
90           address _refundee,
91           GasParams memory _gParams
92:      ) internal override {

126:     function executeNoSettlement(bytes calldata _data) external payable override requiresAgentExecutor {

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L51-L51), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L85-L92), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L126-L126)

```solidity
File: src/BaseBranchRouter.sol

74:      function getDepositEntry(uint32 _depositNonce) external view override returns (Deposit memory) {

83:      function callOut(bytes calldata _params, GasParams calldata _gParams) external payable override lock {

88       function callOutAndBridge(bytes calldata _params, DepositInput calldata _dParams, GasParams calldata _gParams)
89           external
90           payable
91           override
92           lock
93:      {

104      function callOutAndBridgeMultiple(
105          bytes calldata _params,
106          DepositMultipleInput calldata _dParams,
107          GasParams calldata _gParams
108:     ) external payable override lock {

123:     function executeNoSettlement(bytes calldata) external payable virtual override requiresAgentExecutor {

128      function executeSettlement(bytes calldata, SettlementParams memory)
129          external
130          payable
131          virtual
132          override
133          requiresAgentExecutor
134:     {

139      function executeSettlementMultiple(bytes calldata, SettlementMultipleParams memory)
140          external
141          payable
142          virtual
143          override
144          requiresAgentExecutor
145:     {

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L74-L74), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L83-L83), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L88-L93), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L104-L108), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L123-L123), [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L128-L134), [139](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L139-L145)

```solidity
File: src/BranchBridgeAgent.sol

156:     function getDepositEntry(uint32 _depositNonce) external view override returns (Deposit memory) {

180      function callOutSystem(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
181          external
182          payable
183          override
184          lock
185          requiresRouter
186:     {

195      function callOut(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
196          external
197          payable
198          override
199          lock
200:     {

209      function callOutAndBridge(
210          address payable _refundee,
211          bytes calldata _params,
212          DepositInput memory _dParams,
213          GasParams calldata _gParams
214:     ) external payable override lock {

231      function callOutAndBridgeMultiple(
232          address payable _refundee,
233          bytes calldata _params,
234          DepositMultipleInput memory _dParams,
235          GasParams calldata _gParams
236:     ) external payable override lock {

262      function callOutSigned(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
263          external
264          payable
265          override
266          lock
267:     {

276      function callOutSignedAndBridge(
277          address payable _refundee,
278          bytes calldata _params,
279          DepositInput memory _dParams,
280          GasParams calldata _gParams,
281          bool _hasFallbackToggled
282:     ) external payable override lock {

306      function callOutSignedAndBridgeMultiple(
307          address payable _refundee,
308          bytes calldata _params,
309          DepositMultipleInput memory _dParams,
310          GasParams calldata _gParams,
311          bool _hasFallbackToggled
312:     ) external payable override lock {

343      function retryDeposit(
344          bool _isSigned,
345          uint32 _depositNonce,
346          bytes calldata _params,
347          GasParams calldata _gParams,
348          bool _hasFallbackToggled
349:     ) external payable override lock {

422:     function retrieveDeposit(uint32 _depositNonce, GasParams calldata _gParams) external payable override lock {

434:     function redeemDeposit(uint32 _depositNonce) external override lock {

464      function retrySettlement(
465          uint32 _settlementNonce,
466          bytes calldata _params,
467          GasParams[2] calldata _gParams,
468          bool _hasFallbackToggled
469:     ) external payable virtual override lock {

485      function clearToken(address _recipient, address _hToken, address _token, uint256 _amount, uint256 _deposit)
486          external
487          override
488          requiresAgentExecutor
489:     {

494      function clearTokens(bytes calldata _sParams, address _recipient)
495          external
496          override
497          requiresAgentExecutor
498          returns (SettlementMultipleParams memory)
499:     {

578:     function lzReceive(uint16, bytes calldata _srcAddress, uint64, bytes calldata _payload) public override {

587      function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload)
588          public
589          override
590          requiresEndpoint(_endpoint, _srcAddress)
591:     {

```
*GitHub*: [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L156-L156), [180](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L180-L186), [195](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L195-L200), [209](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L209-L214), [231](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L231-L236), [262](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L262-L267), [276](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L276-L282), [306](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L306-L312), [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L343-L349), [422](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L422-L422), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L434-L434), [464](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L464-L469), [485](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L485-L489), [494](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L494-L499), [578](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L578-L578), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L587-L591)

```solidity
File: src/BranchPort.sol

135:     function renounceOwnership() public payable override onlyOwner {

144:     function manage(address _token, uint256 _amount) external override requiresPortStrategy(_token) {

167:     function replenishReserves(address _token, uint256 _amount) external override lock {

188:     function replenishReserves(address _strategy, address _token) external override lock {

226      function withdraw(address _recipient, address _underlyingAddress, uint256 _deposit)
227          public
228          virtual
229          override
230          lock
231          requiresBridgeAgent
232:     {

237      function bridgeIn(address _recipient, address _localAddress, uint256 _amount)
238          external
239          override
240          requiresBridgeAgent
241:     {

246      function bridgeInMultiple(
247          address _recipient,
248          address[] memory _localAddresses,
249          address[] memory _underlyingAddresses,
250          uint256[] memory _amounts,
251          uint256[] memory _deposits
252:     ) external override requiresBridgeAgent {

277      function bridgeOut(
278          address _depositor,
279          address _localAddress,
280          address _underlyingAddress,
281          uint256 _amount,
282          uint256 _deposit
283:     ) external override lock requiresBridgeAgent {

288      function bridgeOutMultiple(
289          address _depositor,
290          address[] memory _localAddresses,
291          address[] memory _underlyingAddresses,
292          uint256[] memory _amounts,
293          uint256[] memory _deposits
294:     ) external override lock requiresBridgeAgent {

319:     function addBridgeAgent(address _bridgeAgent) external override requiresBridgeAgentFactory {

331:     function setCoreRouter(address _newCoreRouter) external override requiresCoreRouter {

338:     function addBridgeAgentFactory(address _newBridgeAgentFactory) external override requiresCoreRouter {

348:     function toggleBridgeAgentFactory(address _newBridgeAgentFactory) external override requiresCoreRouter {

355:     function toggleBridgeAgent(address _bridgeAgent) external override requiresCoreRouter {

362:     function addStrategyToken(address _token, uint256 _minimumReservesRatio) external override requiresCoreRouter {

375:     function toggleStrategyToken(address _token) external override requiresCoreRouter {

382      function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
383          external
384          override
385          requiresCoreRouter
386:     {

396:     function togglePortStrategy(address _portStrategy, address _token) external override requiresCoreRouter {

403      function updatePortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
404          external
405          override
406          requiresCoreRouter
407:     {

414      function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent)
415          external
416          override
417          requiresCoreRouter
418:     {

```
*GitHub*: [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L135-L135), [144](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L144-L144), [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L167-L167), [188](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L188-L188), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L226-L232), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L237-L241), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L246-L252), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L277-L283), [288](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L288-L294), [319](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L319-L319), [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L331-L331), [338](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L338-L338), [348](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L348-L348), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L355-L355), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L362-L362), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L375-L375), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L382-L386), [396](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L396-L396), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L403-L407), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L414-L418)

```solidity
File: src/CoreBranchRouter.sol

86:      function executeNoSettlement(bytes calldata _params) external payable virtual override requiresAgentExecutor {

```
*GitHub*: [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L86-L86)

```solidity
File: src/CoreRootRouter.sol

297      function executeResponse(bytes calldata _encodedData, uint16 _srcChainId)
298          external
299          payable
300          override
301          requiresExecutor
302:     {

332:     function execute(bytes calldata _encodedData, uint16) external payable override requiresExecutor {

350      function executeDepositSingle(bytes memory, DepositParams memory, uint16)
351          external
352          payable
353          override
354          requiresExecutor
355:     {

360      function executeDepositMultiple(bytes calldata, DepositMultipleParams memory, uint16)
361          external
362          payable
363          override
364          requiresExecutor
365:     {

370:     function executeSigned(bytes memory, address, uint16) external payable override requiresExecutor {

375      function executeSignedDepositSingle(bytes memory, DepositParams memory, address, uint16)
376          external
377          payable
378          override
379          requiresExecutor
380:     {

385      function executeSignedDepositMultiple(bytes memory, DepositMultipleParams memory, address, uint16)
386          external
387          payable
388          override
389          requiresExecutor
390:     {

```
*GitHub*: [297](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L297-L302), [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L332-L332), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L350-L355), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L360-L365), [370](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L370-L370), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L375-L380), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L385-L390)

```solidity
File: src/MulticallRootRouter.sol

123:     function executeResponse(bytes memory, uint16) external payable override {

137:     function execute(bytes calldata encodedData, uint16) external payable override lock requiresExecutor {

203:     function executeDepositSingle(bytes calldata, DepositParams calldata, uint16) external payable override {

223      function executeSigned(bytes calldata encodedData, address userAccount, uint16)
224          external
225          payable
226          override
227          lock
228          requiresExecutor
229:     {

312      function executeSignedDepositSingle(bytes calldata encodedData, DepositParams calldata, address userAccount, uint16)
313          external
314          payable
315          override
316          requiresExecutor
317          lock
318:     {

401      function executeSignedDepositMultiple(
402          bytes calldata encodedData,
403          DepositMultipleParams calldata,
404          address userAccount,
405          uint16
406:     ) external payable override requiresExecutor lock {

```
*GitHub*: [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L123-L123), [137](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L137-L137), [203](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L203-L203), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L223-L229), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L312-L318), [401](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L401-L406)

```solidity
File: src/MulticallRootRouterLibZip.sol

37:      function _decode(bytes calldata data) internal pure override returns (bytes memory) {

```
*GitHub*: [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L37-L37)

```solidity
File: src/RootBridgeAgent.sol

135:     function getSettlementEntry(uint32 _settlementNonce) external view override returns (Settlement memory) {

160      function callOut(
161          address payable _refundee,
162          address _recipient,
163          uint16 _dstChainId,
164          bytes calldata _params,
165          GasParams calldata _gParams
166:     ) external payable override lock requiresRouter {

175      function callOutAndBridge(
176          address payable _refundee,
177          address _recipient,
178          uint16 _dstChainId,
179          bytes calldata _params,
180          SettlementInput calldata _sParams,
181          GasParams calldata _gParams,
182          bool _hasFallbackToggled
183:     ) external payable override lock requiresRouter {

202      function callOutAndBridgeMultiple(
203          address payable _refundee,
204          address _recipient,
205          uint16 _dstChainId,
206          bytes calldata _params,
207          SettlementMultipleInput calldata _sParams,
208          GasParams calldata _gParams,
209          bool _hasFallbackToggled
210:     ) external payable override lock requiresRouter {

233      function retrySettlement(
234          uint32 _settlementNonce,
235          address _recipient,
236          bytes calldata _params,
237          GasParams calldata _gParams,
238          bool _hasFallbackToggled
239:     ) external payable override lock {

299:     function redeemSettlement(uint32 _settlementNonce) external override lock {

351      function bridgeIn(address _recipient, DepositParams memory _dParams, uint256 _srcChainId)
352          public
353          override
354          requiresAgentExecutor
355:     {

387      function bridgeInMultiple(address _recipient, DepositMultipleParams calldata _dParams, uint256 _srcChainId)
388          external
389          override
390          requiresAgentExecutor
391:     {

434      function lzReceiveNonBlocking(
435          address _endpoint,
436          uint16 _srcChainId,
437          bytes calldata _srcAddress,
438          bytes calldata _payload
439:     ) public override requiresEndpoint(_endpoint, _srcChainId, _srcAddress) {

1170:    function approveBranchBridgeAgent(uint256 _branchChainId) external override requiresManager {

1176     function syncBranchBridgeAgent(address _newBranchBridgeAgent, uint256 _branchChainId)
1177         external
1178         override
1179         requiresPort
1180:    {

```
*GitHub*: [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L135-L135), [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L160-L166), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L175-L183), [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L202-L210), [233](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L233-L239), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L299-L299), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L351-L355), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L387-L391), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L434-L439), [1170](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1170-L1170), [1176](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1176-L1180)

```solidity
File: src/RootPort.sol

166:     function renounceOwnership() public payable override onlyOwner {

175      function getLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
176          external
177          view
178          override
179          returns (address)
180:     {

200      function getUnderlyingTokenFromGlobal(address _globalAddress, uint256 _srcChainId)
201          external
202          view
203          override
204          returns (address)
205:     {

211:     function isGlobalToken(address _globalAddress, uint256 _srcChainId) external view override returns (bool) {

216:     function isLocalToken(address _localAddress, uint256 _srcChainId) external view override returns (bool) {

230:     function isUnderlyingToken(address _underlyingToken, uint256 _srcChainId) external view override returns (bool) {

239      function setAddresses(
240          address _globalAddress,
241          address _localAddress,
242          address _underlyingAddress,
243          uint256 _srcChainId
244:     ) external override requiresCoreRootRouter {

259      function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId)
260          external
261          override
262          requiresCoreRootRouter
263:     {

277      function bridgeToRoot(address _recipient, address _hToken, uint256 _amount, uint256 _deposit, uint256 _srcChainId)
278          external
279          override
280          requiresBridgeAgent
281:     {

294      function bridgeToRootFromLocalBranch(address _from, address _hToken, uint256 _amount)
295          external
296          override
297          requiresLocalBranchPort
298:     {

304      function bridgeToLocalBranchFromRoot(address _to, address _hToken, uint256 _amount)
305          external
306          override
307          requiresLocalBranchPort
308:     {

315      function burn(address _from, address _hToken, uint256 _amount, uint256 _srcChainId)
316          external
317          override
318          requiresBridgeAgent
319:     {

325      function burnFromLocalBranch(address _from, address _hToken, uint256 _amount)
326          external
327          override
328          requiresLocalBranchPort
329:     {

336      function mintToLocalBranch(address _to, address _hToken, uint256 _amount)
337          external
338          override
339          requiresLocalBranchPort
340:     {

350:     function fetchVirtualAccount(address _user) external override returns (VirtualAccount account) {

369      function toggleVirtualAccountApproved(VirtualAccount _userAccount, address _router)
370          external
371          override
372          requiresBridgeAgent
373:     {

382:     function addBridgeAgent(address _manager, address _bridgeAgent) external override requiresBridgeAgentFactory {

393      function syncBranchBridgeAgentWithRoot(
394          address _newBranchBridgeAgent,
395          address _rootBridgeAgent,
396          uint256 _branchChainId
397:     ) external override requiresCoreRootRouter {

414:     function toggleBridgeAgent(address _bridgeAgent) external override onlyOwner {

421:     function addBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

431:     function toggleBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

438      function addNewChain(
439          address _coreBranchBridgeAgentAddress,
440          uint256 _chainId,
441          string memory _wrappedGasTokenName,
442          string memory _wrappedGasTokenSymbol,
443          uint8 _wrappedGasTokenDecimals,
444          address _newLocalBranchWrappedNativeTokenAddress,
445          address _newUnderlyingBranchWrappedNativeTokenAddress
446:     ) external override onlyOwner {

483:     function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {

509:     function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {

521      function setCoreBranchRouter(
522          address _refundee,
523          address _coreBranchRouter,
524          address _coreBranchBridgeAgent,
525          uint16 _dstChainId,
526          GasParams calldata _gParams
527:     ) external payable override onlyOwner {

539      function syncNewCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent, uint16 _dstChainId)
540          external
541          override
542          onlyOwner
543:     {

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L166-L166), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L175-L180), [200](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L200-L205), [211](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L211-L211), [216](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L216-L216), [230](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L230-L230), [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L239-L244), [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L259-L263), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L277-L281), [294](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L294-L298), [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L304-L308), [315](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L315-L319), [325](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L325-L329), [336](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L336-L340), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L350-L350), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L369-L373), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L382-L382), [393](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L393-L397), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L414-L414), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L421-L421), [431](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L431-L431), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L438-L446), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483-L483), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509-L509), [521](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L521-L527), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L539-L543)

```solidity
File: src/VirtualAccount.sol

51:      function withdrawNative(uint256 _amount) external override requiresApprovedCaller {

56:      function withdrawERC20(address _token, uint256 _amount) external override requiresApprovedCaller {

61:      function withdrawERC721(address _token, uint256 _tokenId) external override requiresApprovedCaller {

66:      function call(Call[] calldata calls) external override requiresApprovedCaller returns (bytes[] memory returnData) {

119:     function onERC721Received(address, address, uint256, bytes calldata) external pure override returns (bytes4) {

124      function onERC1155Received(address, address, uint256, uint256, bytes calldata)
125          external
126          pure
127          override
128          returns (bytes4)
129:     {

134      function onERC1155BatchReceived(address, address, uint256[] calldata, uint256[] calldata, bytes calldata)
135          external
136          pure
137          override
138          returns (bytes4)
139:     {

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L51-L51), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L56-L56), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L61-L61), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L66-L66), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L119-L119), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L124-L129), [134](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L134-L139)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

56:      function initialize(address _coreRootBridgeAgent) external override onlyOwner {

79       function createBridgeAgent(
80           address _newBranchRouterAddress,
81           address _rootBridgeAgentAddress,
82           address _rootBridgeAgentFactoryAddress
83:      ) external virtual override returns (address newBridgeAgent) {

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L56-L56), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L79-L83)

```solidity
File: src/token/ERC20hTokenBranch.sol

29:      function mint(address account, uint256 amount) external override onlyOwner returns (bool) {

35:      function burn(uint256 amount) public override onlyOwner {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L29-L29), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L35-L35)

</details>




### [N&#x2011;33] Consider using descriptive `constant`s when passing zero as a function argument
Passing zero as a function argument can sometimes result in a security issue (e.g. passing zero as the slippage parameter). Consider using a `constant` variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

105:         IRootBridgeAgent(_rootBridgeAgentAddress).lzReceive(rootChainId, "", 0, _calldata);

114          IRootBridgeAgent(rootBridgeAgentAddress).lzReceive(
115              rootChainId, "", 0, abi.encodePacked(bytes1(0x09), _settlementNonce)
116:         );

```
*GitHub*: [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L105-L105), [114](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L114-L116)

```solidity
File: src/RootBridgeAgent.sol

837:             IBranchBridgeAgent(callee).lzReceive(0, "", 0, _payload);

929:             IBranchBridgeAgent(callee).lzReceive(0, "", 0, payload);

```
*GitHub*: [837](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L837-L837), [929](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L929-L929)


### [N&#x2011;34] Variables need not be initialized to zero
The default value for variables is zero, so initializing them to zero is superfluous.

*There are 17 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

192:         for (uint256 i = 0; i < _hTokens.length;) {

```
*GitHub*: [192](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L192-L192)

```solidity
File: src/BranchBridgeAgent.sol

447:         for (uint256 i = 0; i < deposit.tokens.length;) {

513:         for (uint256 i = 0; i < numOfAssets;) {

```
*GitHub*: [447](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L447-L447), [513](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L513-L513)

```solidity
File: src/BranchPort.sol

257:         for (uint256 i = 0; i < length;) {

305:         for (uint256 i = 0; i < length;) {

```
*GitHub*: [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L257-L257), [305](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L305-L305)

```solidity
File: src/MulticallRootRouter.sol

278:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

367:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

455:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

557:         for (uint256 i = 0; i < outputTokens.length;) {

```
*GitHub*: [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L278-L278), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L367-L367), [455](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L455-L455), [557](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L557-L557)

```solidity
File: src/RootBridgeAgent.sol

318:         for (uint256 i = 0; i < settlement.hTokens.length;) {

399:         for (uint256 i = 0; i < length;) {

1070:        for (uint256 i = 0; i < hTokens.length;) {

```
*GitHub*: [318](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L318-L318), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L399-L399), [1070](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1070-L1070)

```solidity
File: src/RootBridgeAgentExecutor.sol

281:         for (uint256 i = 0; i < uint256(uint8(numOfAssets));) {

```
*GitHub*: [281](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L281-L281)

```solidity
File: src/VirtualAccount.sol

70:          for (uint256 i = 0; i < length;) {

90:          for (uint256 i = 0; i < length;) {

```
*GitHub*: [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L70-L70), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L90-L90)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

13:      uint8 internal constant STATUS_READY = 0;

23:      uint8 internal constant STATUS_SUCCESS = 0;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L13-L13), [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L23-L23)

</details>




### [N&#x2011;35] `require()`/`revert()` statements should have descriptive reason strings


*There are 13 instances of this issue:*

```solidity
File: src/BaseBranchRouter.sol

213:         require(_unlocked == 1);

```
*GitHub*: [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L213-L213)

```solidity
File: src/BranchBridgeAgent.sol

923:         require(_unlocked == 1);

```
*GitHub*: [923](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L923-L923)

```solidity
File: src/BranchPort.sol

567:         require(_unlocked == 1);

```
*GitHub*: [567](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L567-L567)

```solidity
File: src/CoreRootRouter.sol

356:         revert();

366:         revert();

371:         revert();

381:         revert();

391:         revert();

```
*GitHub*: [356](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L356-L356), [366](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L366-L366), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L371-L371), [381](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L381-L381), [391](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L391-L391)

```solidity
File: src/MulticallRootRouter.sol

124:         revert();

204:         revert();

210:         revert();

591:         require(_unlocked == 1);

```
*GitHub*: [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L124-L124), [204](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L204-L204), [210](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L210-L210), [591](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L591-L591)

```solidity
File: src/RootBridgeAgent.sol

1191:        require(_unlocked == 1);

```
*GitHub*: [1191](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1191-L1191)


### [N&#x2011;36] Contracts/libraries should each be defined in separate files
This helps to make tracking changes across commits easier, among other reasons. The instances below are the second+ contract/library within each file

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

31   contract ArbitrumBranchBridgeAgent is BranchBridgeAgent {
32       /*///////////////////////////////////////////////////////////////
33                               CONSTRUCTOR
34       //////////////////////////////////////////////////////////////*/
35   
36       /**
37        * @notice Constructor for Arbitrum Branch Bridge Agent.
38        *  @param _localChainId Local Chain Layer Zero Id.
39        *  @param _rootBridgeAgentAddress Root Bridge Agent Address.
40        *  @param _localRouterAddress Local Core Branch Router Address.
41        *  @param _localPortAddress Local Branch Port Address.
42:       */

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L31-L42)

```solidity
File: src/BranchBridgeAgent.sol

45:  contract BranchBridgeAgent is IBranchBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L45-L45)

```solidity
File: src/BranchBridgeAgentExecutor.sol

29:  contract BranchBridgeAgentExecutor is Ownable, BridgeAgentConstants {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L29-L29)

```solidity
File: src/RootBridgeAgentExecutor.sol

27   contract RootBridgeAgentExecutor is Ownable, BridgeAgentConstants {
28       /*///////////////////////////////////////////////////////////////
29                                   CONSTRUCTOR
30       //////////////////////////////////////////////////////////////*/
31       /**
32        * @notice Constructor for Root Bridge Agent Executor.
33        * @param _rootBridgeAgent the owner of the contract in charge of calling the different execution functions.
34:       */

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L27-L34)


### [N&#x2011;37] Contract uses both `require()`/`revert()` as well as custom errors
Consider using just one method in a single file

*There are 10 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

14:  contract ArbitrumBranchPort is BranchPort, IArbitrumBranchPort {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L14-L14)

```solidity
File: src/BaseBranchRouter.sol

25:  contract BaseBranchRouter is IBranchRouter, Ownable {

```
*GitHub*: [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L25-L25)

```solidity
File: src/BranchBridgeAgent.sol

45:  contract BranchBridgeAgent is IBranchBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L45-L45)

```solidity
File: src/BranchPort.sol

17:  contract BranchPort is Ownable, IBranchPort {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L17-L17)

```solidity
File: src/CoreRootRouter.sol

38   contract CoreRootRouter is IRootRouter, Ownable {
39       /*///////////////////////////////////////////////////////////////
40                       CORE ROOT ROUTER STATE
41       //////////////////////////////////////////////////////////////*/
42   
43:      /// @notice Boolean to indicate if the contract is in set up mode.

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L38-L43)

```solidity
File: src/MulticallRootRouter.sol

57:  contract MulticallRootRouter is IRootRouter, Ownable {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L57-L57)

```solidity
File: src/RootBridgeAgent.sol

32:  contract RootBridgeAgent is IRootBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L32-L32)

```solidity
File: src/RootPort.sol

16:  contract RootPort is Ownable, IRootPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L16-L16)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

12   contract ERC20hTokenBranchFactory is Ownable, IERC20hTokenBranchFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L12-L13)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

12   contract ERC20hTokenRootFactory is Ownable, IERC20hTokenRootFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L12-L13)

</details>




### [N&#x2011;38] Contract doesn't handle all NFT types
There are two primary standards for NFTs - [ERC-721](https://eips.ethereum.org/EIPS/eip-721) and [ERC-1155](https://eips.ethereum.org/EIPS/eip-1155). Supporting one but not the other excludes half of the available market.

*There are 2 instances of this issue:*

```solidity
File: src/VirtualAccount.sol

17   contract VirtualAccount is IVirtualAccount, ERC1155Receiver {
18       using SafeTransferLib for address;
19   
20       /// @inheritdoc IVirtualAccount
21       address public immutable override userAddress;
22   
23       /// @inheritdoc IVirtualAccount
24       address public immutable override localPortAddress;
25   
26       /*//////////////////////////////////////////////////////////////
27                               CONSTRUCTOR
28       //////////////////////////////////////////////////////////////*/
29   
30       /**
31        * @notice Constructor for Virtual Account.
32        * @param _userAddress Address of the user account.
33        * @param _localPortAddress Address of the root port contract.
34        */
35       constructor(address _userAddress, address _localPortAddress) {
36           userAddress = _userAddress;
37           localPortAddress = _localPortAddress;
38       }
39   
40       /*//////////////////////////////////////////////////////////////
41                               FALLBACK FUNCTIONS
42       //////////////////////////////////////////////////////////////*/
43   
44       receive() external payable {}
45   
46       /*//////////////////////////////////////////////////////////////
47                               EXTERNAL FUNCTIONS
48       //////////////////////////////////////////////////////////////*/
49   
50       /// @inheritdoc IVirtualAccount
51       function withdrawNative(uint256 _amount) external override requiresApprovedCaller {
52           msg.sender.safeTransferETH(_amount);
53       }
54   
55       /// @inheritdoc IVirtualAccount
56       function withdrawERC20(address _token, uint256 _amount) external override requiresApprovedCaller {
57           _token.safeTransfer(msg.sender, _amount);
58       }
59   
60       /// @inheritdoc IVirtualAccount
61       function withdrawERC721(address _token, uint256 _tokenId) external override requiresApprovedCaller {
62           ERC721(_token).transferFrom(address(this), msg.sender, _tokenId);
63       }
64   
65       /// @inheritdoc IVirtualAccount
66       function call(Call[] calldata calls) external override requiresApprovedCaller returns (bytes[] memory returnData) {
67           uint256 length = calls.length;
68           returnData = new bytes[](length);
69   
70           for (uint256 i = 0; i < length;) {
71               bool success;
72               Call calldata _call = calls[i];
73   
74               if (isContract(_call.target)) (success, returnData[i]) = _call.target.call(_call.callData);
75   
76               if (!success) revert CallFailed();
77   
78               unchecked {
79                   ++i;
80               }
81           }
82       }
83   
84       /// @inheritdoc IVirtualAccount
85       function payableCall(PayableCall[] calldata calls) public payable returns (bytes[] memory returnData) {
86           uint256 valAccumulator;
87           uint256 length = calls.length;
88           returnData = new bytes[](length);
89           PayableCall calldata _call;
90           for (uint256 i = 0; i < length;) {
91               _call = calls[i];
92               uint256 val = _call.value;
93               // Humanity will be a Type V Kardashev Civilization before this overflows - andreas
94               // ~ 10^25 Wei in existence << ~ 10^76 size uint fits in a uint256
95               unchecked {
96                   valAccumulator += val;
97               }
98   
99               bool success;
100  
101              if (isContract(_call.target)) (success, returnData[i]) = _call.target.call{value: val}(_call.callData);
102  
103              if (!success) revert CallFailed();
104  
105              unchecked {
106                  ++i;
107              }
108          }
109  
110          // Finally, make sure the msg.value = SUM(call[0...i].value)
111          if (msg.value != valAccumulator) revert CallFailed();
112      }
113  
114      /*//////////////////////////////////////////////////////////////
115                              EXTERNAL HOOKS
116      //////////////////////////////////////////////////////////////*/
117  
118      /// @inheritdoc IERC721Receiver
119      function onERC721Received(address, address, uint256, bytes calldata) external pure override returns (bytes4) {
120          return this.onERC721Received.selector;
121      }
122  
123      /// @inheritdoc IERC1155Receiver
124      function onERC1155Received(address, address, uint256, uint256, bytes calldata)
125          external
126          pure
127          override
128          returns (bytes4)
129      {
130          return this.onERC1155Received.selector;
131      }
132  
133      /// @inheritdoc IERC1155Receiver
134      function onERC1155BatchReceived(address, address, uint256[] calldata, uint256[] calldata, bytes calldata)
135          external
136          pure
137          override
138          returns (bytes4)
139      {
140          return this.onERC1155BatchReceived.selector;
141      }
142  
143      /*//////////////////////////////////////////////////////////////
144                              INTERNAL HELPERS
145      //////////////////////////////////////////////////////////////*/
146  
147      function isContract(address addr) internal view returns (bool) {
148          uint256 size;
149          assembly {
150              size := extcodesize(addr)
151          }
152          return size > 0;
153      }
154  
155      /*///////////////////////////////////////////////////////////////
156                                  MODIFIERS
157      //////////////////////////////////////////////////////////////*/
158  
159      /// @notice Modifier that verifies msg sender is the approved to use the virtual account. Either the owner or an approved router.
160      modifier requiresApprovedCaller() {
161          if (!IRootPort(localPortAddress).isRouterApproved(this, msg.sender)) {
162              if (msg.sender != userAddress) {
163                  revert UnauthorizedCaller();
164              }
165          }
166          _;
167      }
168: }

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L17-L168)

```solidity
File: src/interfaces/IVirtualAccount.sol

27   interface IVirtualAccount is IERC721Receiver {
28       /**
29        * @notice Returns the address of the user that owns the VirtualAccount.
30        * @return The address of the user that owns the VirtualAccount.
31        */
32       function userAddress() external view returns (address);
33   
34       /**
35        * @notice Returns the address of the local port.
36        * @return The address of the local port.
37        */
38       function localPortAddress() external view returns (address);
39   
40       /**
41        * @notice Withdraws native tokens from the VirtualAccount.
42        * @param _amount The amount of tokens to withdraw.
43        */
44       function withdrawNative(uint256 _amount) external;
45   
46       /**
47        * @notice Withdraws ERC20 tokens from the VirtualAccount.
48        * @param _token The address of the ERC20 token to withdraw.
49        * @param _amount The amount of tokens to withdraw.
50        */
51       function withdrawERC20(address _token, uint256 _amount) external;
52   
53       /**
54        * @notice Withdraws ERC721 tokens from the VirtualAccount.
55        * @param _token The address of the ERC721 token to withdraw.
56        * @param _tokenId The id of the token to withdraw.
57        */
58       function withdrawERC721(address _token, uint256 _tokenId) external;
59   
60       /**
61        * @notice Aggregate calls ensuring each call is successful. Inspired by `Multicall2` contract.
62        * @param callInput The call to make.
63        * @return The return data of the call.
64        */
65       function call(Call[] calldata callInput) external returns (bytes[] memory);
66   
67       /**
68        * @notice Aggregate calls with a msg value ensuring each call is successful. Inspired by `Multicall3` contract.
69        * @param calls The calls to make.
70        * @return The return data of the calls.
71        * @dev Reverts if msg.value is less than the sum of the call values.
72        */
73       function payableCall(PayableCall[] calldata calls) external payable returns (bytes[] memory);
74   
75       /*///////////////////////////////////////////////////////////////
76                                   ERRORS
77       //////////////////////////////////////////////////////////////*/
78   
79       error CallFailed();
80   
81       error UnauthorizedCaller();
82:  }

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L27-L82)


### [N&#x2011;39] Style guide: Non-`external`/`public` function names should begin with an underscore
According to the Solidity Style Guide, non-`external`/`public` function names should begin with an [underscore](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are 2 instances of this issue:*

```solidity
File: src/RootPort.sol

359:     function addVirtualAccount(address _user) internal returns (VirtualAccount newAccount) {

```
*GitHub*: [359](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L359-L359)

```solidity
File: src/VirtualAccount.sol

147:     function isContract(address addr) internal view returns (bool) {

```
*GitHub*: [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L147-L147)


### [N&#x2011;40] `constant`s should be defined rather than using magic numbers
Even [assembly](https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39) can benefit from using readable constants instead of hex/numeric literals

*There are 125 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

115:             rootChainId, "", 0, abi.encodePacked(bytes1(0x09), _settlementNonce)

```
*GitHub*: [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L115-L115)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

62:          bytes memory payload = abi.encodePacked(bytes1(0x02), params);

115:         bytes memory payload = abi.encodePacked(bytes1(0x04), data);

127:         if (_data[0] == 0x02) {

146:         } else if (_data[0] == 0x03) {

152:         } else if (_data[0] == 0x04) {

157:         } else if (_data[0] == 0x05) {

162:         } else if (_data[0] == 0x06) {

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L62-L62), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L115-L115), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L127-L127), [146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L146-L146), [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L152-L152), [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L157-L157), [162](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L162-L162)

```solidity
File: src/BranchBridgeAgent.sol

188:         bytes memory payload = abi.encodePacked(bytes1(0x00), depositNonce++, _params);

202:         bytes memory payload = abi.encodePacked(bytes1(0x01), depositNonce++, _params);

220:             bytes1(0x02), _depositNonce, _dParams.hToken, _dParams.token, _dParams.amount, _dParams.deposit, _params

242:             bytes1(0x03),

269:         bytes memory payload = abi.encodePacked(bytes1(0x04), msg.sender, depositNonce++, _params);

288:             _hasFallbackToggled ? bytes1(0x85) : bytes1(0x05),

318:             _hasFallbackToggled ? bytes1(0x86) : bytes1(0x06),

399:                     bytes1(0x03),

387:                     _hasFallbackToggled ? bytes1(0x86) : bytes1(0x06),

374:                     bytes1(0x02),

363:                     _hasFallbackToggled ? bytes1(0x85) : bytes1(0x05),

427:         bytes memory payload = abi.encodePacked(bytes1(0x08), msg.sender, _depositNonce);

474:         bytes memory payload = abi.encodePacked(_hasFallbackToggled ? bytes1(0x87) : bytes1(0x07), params);

581:             150,

593:         bytes1 flag = _payload[0] & 0x7F;

599:         if (flag == 0x00) {

616:         } else if (flag == 0x01) {

638:         } else if (flag == 0x02) {

663:         } else if (flag == 0x03) {

681:         } else if (flag == 0x04) {

643:             nonce = uint32(bytes4(_payload[22:26]));

651:                 _payload[0] == 0x82,

629:                 _payload[0] == 0x81,

790:             abi.encodePacked(bytes1(0x09), _settlementNonce),

942:         if (_srcAddress.length != 40) revert LayerZeroUnauthorizedCaller();

943:         if (rootBridgeAgentAddress != address(uint160(bytes20(_srcAddress[20:])))) revert LayerZeroUnauthorizedCaller();

```
*GitHub*: [188](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L188-L188), [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L202-L202), [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L220-L220), [242](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L242-L242), [269](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L269-L269), [288](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L288-L288), [288](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L288-L288), [318](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L318-L318), [318](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L318-L318), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L399-L399), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L387-L387), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L387-L387), [374](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L374-L374), [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L363-L363), [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L363-L363), [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L427-L427), [474](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L474-L474), [474](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L474-L474), [581](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L581-L581), [593](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L593-L593), [599](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L599-L599), [616](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L616-L616), [638](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L638-L638), [663](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L663-L663), [681](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L681-L681), [643](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L643-L643), [643](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L643-L643), [651](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L651-L651), [629](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L629-L629), [790](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L790-L790), [942](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L942-L942), [943](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L943-L943)

```solidity
File: src/BranchBridgeAgentExecutor.sol

75:              hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),

76:              token: address(uint160(bytes20(_payload[45:65]))),

77:              amount: uint256(bytes32(_payload[65:97])),

78:              deposit: uint256(bytes32(_payload[97:PARAMS_SETTLEMENT_OFFSET]))

```
*GitHub*: [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L75-L75), [76](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L76-L76), [76](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L76-L76), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L77-L77), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L77-L77), [78](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L78-L78)

```solidity
File: src/BranchPort.sol

299:         if (length > 255) revert InvalidInputArrays();

```
*GitHub*: [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L299-L299)

```solidity
File: src/CoreBranchRouter.sol

51:          bytes memory payload = abi.encodePacked(bytes1(0x01), params);

43:      function addGlobalToken(address _globalAddress, uint256 _dstChainId, GasParams[3] calldata _gParams)

75:          bytes memory payload = abi.encodePacked(bytes1(0x02), params);

88:          if (_params[0] == 0x01) {

100:         } else if (_params[0] == 0x02) {

115:         } else if (_params[0] == 0x03) {

121:         } else if (_params[0] == 0x04) {

127:         } else if (_params[0] == 0x05) {

133:         } else if (_params[0] == 0x06) {

140:         } else if (_params[0] == 0x07) {

181:         bytes memory payload = abi.encodePacked(bytes1(0x03), params);

229:         bytes memory payload = abi.encodePacked(bytes1(0x04), params);

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L51-L51), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L43-L43), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L75-L75), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L88-L88), [100](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L100-L100), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L115-L115), [121](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L121-L121), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L127-L127), [133](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L133-L133), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L140-L140), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L181-L181), [229](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L229-L229)

```solidity
File: src/CoreRootRouter.sol

136:         bytes memory payload = abi.encodePacked(bytes1(0x02), params);

171:         bytes memory payload = abi.encodePacked(bytes1(0x03), params);

196:         bytes memory payload = abi.encodePacked(bytes1(0x04), params);

223:         bytes memory payload = abi.encodePacked(bytes1(0x05), params);

254:         bytes memory payload = abi.encodePacked(bytes1(0x06), params);

284:         bytes memory payload = abi.encodePacked(bytes1(0x07), params);

307:         if (funcId == 0x02) {

314:         } else if (funcId == 0x03) {

320:         } else if (funcId == 0x04) {

337:         if (funcId == 0x01) {

434:         bytes memory payload = abi.encodePacked(bytes1(0x01), params);

```
*GitHub*: [136](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L136-L136), [171](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L171-L171), [196](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L196-L196), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L223-L223), [254](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L254-L254), [284](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L284-L284), [307](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L307-L307), [314](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L314-L314), [320](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L320-L320), [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L337-L337), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L434-L434)

```solidity
File: src/MulticallRootRouter.sol

142:         if (funcId == 0x01) {

150:         } else if (funcId == 0x02) {

174:         } else if (funcId == 0x03) {

234:         if (funcId == 0x01) {

242:         } else if (funcId == 0x02) {

265:         } else if (funcId == 0x03) {

323:         if (funcId == 0x01) {

331:         } else if (funcId == 0x02) {

354:         } else if (funcId == 0x03) {

411:         if (funcId == 0x01) {

419:         } else if (funcId == 0x02) {

442:         } else if (funcId == 0x03) {

```
*GitHub*: [142](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L142-L142), [150](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L150-L150), [174](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L174-L174), [234](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L234-L234), [242](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L242-L242), [265](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L265-L265), [323](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L323-L323), [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L331-L331), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L354-L354), [411](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L411-L411), [419](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L419-L419), [442](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L442-L442)

```solidity
File: src/RootBridgeAgent.sol

168:         bytes memory payload = abi.encodePacked(bytes1(0x00), _recipient, settlementNonce++, _params);

292:         bytes memory payload = abi.encodePacked(bytes1(0x03), settlementOwner, _settlementNonce);

426:             150,

444:         if (_payload[0] == 0x00) {

467:         } else if (_payload[0] == 0x01) {

490:         } else if (_payload[0] == 0x02) {

513:         } else if (_payload[0] == 0x03) {

539:         } else if (_payload[0] == 0x04) {

577:         } else if (_payload[0] & 0x7F == 0x05) {

617:         } else if (_payload[0] & 0x7F == 0x06) {

657:         } else if (_payload[0] & 0x7F == 0x07) {

699:         } else if (_payload[0] == 0x08) {

718:         } else if (_payload[0] == 0x09) {

684:                 _payload[0] == 0x87,

640:                 _payload[0] == 0x86,

600:                 _payload[0] == 0x85,

515:             nonce = uint32(bytes4(_payload[2:6]));

894:                 _hasFallbackToggled ? bytes1(0x82) : bytes1(0x02),

880:                 _hasFallbackToggled ? bytes1(0x81) : bytes1(0x01),

943:             abi.encodePacked(bytes1(0x04), _depositNonce),

993:             _hasFallbackToggled ? bytes1(0x81) : bytes1(0x01),

1090:            _hasFallbackToggled ? bytes1(0x02) & 0x0F : bytes1(0x02),

1210:            if (_srcAddress.length != 40) revert LayerZeroUnauthorizedCaller();

```
*GitHub*: [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L168-L168), [292](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L292-L292), [426](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L426-L426), [444](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L444-L444), [467](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L467-L467), [490](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L490-L490), [513](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L513-L513), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L539-L539), [577](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L577-L577), [577](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L577-L577), [617](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L617-L617), [617](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L617-L617), [657](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L657-L657), [657](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L657-L657), [699](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L699-L699), [718](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L718-L718), [684](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L684-L684), [640](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L640-L640), [600](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L600-L600), [515](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L515-L515), [894](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L894-L894), [894](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L894-L894), [880](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L880-L880), [880](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L880-L880), [943](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L943-L943), [993](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L993-L993), [993](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L993-L993), [1090](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1090-L1090), [1090](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1090-L1090), [1090](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1090-L1090), [1210](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1210-L1210)

```solidity
File: src/RootBridgeAgentExecutor.sol

91:              token: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),

92:              amount: uint256(bytes32(_payload[45:77])),

93:              deposit: uint256(bytes32(_payload[77:PARAMS_TKN_SET_SIZE]))

175:             hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),

176:             token: address(uint160(bytes20(_payload[45:65]))),

177:             amount: uint256(bytes32(_payload[65:97])),

178:             deposit: uint256(bytes32(_payload[97:PARAMS_SETTLEMENT_OFFSET]))

274:         uint32 nonce = uint32(bytes4(_dParams[PARAMS_START:5]));

```
*GitHub*: [91](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L91-L91), [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L92-L92), [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L92-L92), [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L93-L93), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L175-L175), [176](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L176-L176), [176](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L176-L176), [177](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L177-L177), [177](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L177-L177), [178](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L178-L178), [274](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L274-L274)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

38:      function addGlobalToken(address _globalAddress, uint256 _dstChainId, GasParams[3] calldata _gasParams)

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L38-L38)

</details>




### [N&#x2011;41] Events are missing sender information
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

*There are 27 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

689:             emit LogFallback(nonce);

700:         emit LogExecute(nonce);

```
*GitHub*: [689](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L689-L689), [700](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L700-L700)

```solidity
File: src/BranchPort.sol

218:         emit DebtRepaid(_strategy, _token, amountToWithdraw);

344:         emit BridgeAgentFactoryAdded(_newBridgeAgentFactory);

351:         emit BridgeAgentFactoryToggled(_newBridgeAgentFactory);

358:         emit BridgeAgentToggled(_bridgeAgent);

371:         emit StrategyTokenAdded(_token, _minimumReservesRatio);

378:         emit StrategyTokenToggled(_token);

392:         emit PortStrategyAdded(_portStrategy, _token, _dailyManagementLimit);

399:         emit PortStrategyToggled(_portStrategy, _token);

410:         emit PortStrategyUpdated(_portStrategy, _token, _dailyManagementLimit);

423:         emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent);

```
*GitHub*: [218](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L218-L218), [344](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L344-L344), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L351-L351), [358](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L358-L358), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L371-L371), [378](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L378-L378), [392](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L392-L392), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L399-L399), [410](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L410-L410), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L423-L423)

```solidity
File: src/RootBridgeAgent.sol

726:             emit LogFallback(nonce, _srcChainId);

736:         emit LogExecute(nonce, _srcChainId);

```
*GitHub*: [726](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L726-L726), [736](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L736-L736)

```solidity
File: src/RootPort.sol

255:         emit LocalTokenAdded(_underlyingAddress, _localAddress, _globalAddress, _srcChainId);

269:         emit GlobalTokenAdded(_localAddress, _globalAddress, _srcChainId);

365:         emit VirtualAccountCreated(_user, address(newAccount));

389:         emit BridgeAgentAdded(_bridgeAgent, _manager);

406:         emit BridgeAgentSynced(_newBranchBridgeAgent, _rootBridgeAgent, _branchChainId);

417:         emit BridgeAgentToggled(_bridgeAgent);

427:         emit BridgeAgentFactoryAdded(_bridgeAgentFactory);

434:         emit BridgeAgentFactoryToggled(_bridgeAgentFactory);

479:         emit NewChainAdded(_chainId);

505:         emit EcosystemTokenAdded(_ecoTokenGlobalAddress);

517:         emit CoreRootSet(_coreRootRouter, _coreRootBridgeAgent);

535:         emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent, _dstChainId);

549:         emit CoreBranchSynced(_coreBranchRouter, _coreBranchBridgeAgent, _dstChainId);

```
*GitHub*: [255](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L255-L255), [269](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L269-L269), [365](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L365-L365), [389](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L389-L389), [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L406-L406), [417](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L417-L417), [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L427-L427), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L434-L434), [479](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L479-L479), [505](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L505-L505), [517](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L517-L517), [535](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L535-L535), [549](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L549-L549)


### [N&#x2011;42] Consider adding a block/deny-list
Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens

*There are 12 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumCoreBranchRouter.sol

37   contract ArbitrumCoreBranchRouter is CoreBranchRouter {
38       /*///////////////////////////////////////////////////////////////
39                                CONSTRUCTOR
40       //////////////////////////////////////////////////////////////*/
41       /**
42        * @notice Constructor for Arbitrum Core Branch Router.
43:       */

```
*GitHub*: [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L37-L43)

```solidity
File: src/BaseBranchRouter.sol

25:  contract BaseBranchRouter is IBranchRouter, Ownable {

```
*GitHub*: [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L25-L25)

```solidity
File: src/BranchPort.sol

17:  contract BranchPort is Ownable, IBranchPort {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L17-L17)

```solidity
File: src/CoreBranchRouter.sol

18   contract CoreBranchRouter is ICoreBranchRouter, BaseBranchRouter {
19:      /// @notice hToken Factory Address.

```
*GitHub*: [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L18-L19)

```solidity
File: src/CoreRootRouter.sol

38   contract CoreRootRouter is IRootRouter, Ownable {
39       /*///////////////////////////////////////////////////////////////
40                       CORE ROOT ROUTER STATE
41       //////////////////////////////////////////////////////////////*/
42   
43:      /// @notice Boolean to indicate if the contract is in set up mode.

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L38-L43)

```solidity
File: src/RootBridgeAgent.sol

32:  contract RootBridgeAgent is IRootBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L32-L32)

```solidity
File: src/RootPort.sol

16:  contract RootPort is Ownable, IRootPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L16-L16)

```solidity
File: src/VirtualAccount.sol

17:  contract VirtualAccount is IVirtualAccount, ERC1155Receiver {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L17-L17)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

12   contract ERC20hTokenBranchFactory is Ownable, IERC20hTokenBranchFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L12-L13)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

12   contract ERC20hTokenRootFactory is Ownable, IERC20hTokenRootFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L12-L13)

```solidity
File: src/token/ERC20hTokenBranch.sol

12:  contract ERC20hTokenBranch is ERC20, Ownable, IERC20hTokenBranch {

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L12-L12)

```solidity
File: src/token/ERC20hTokenRoot.sol

12   contract ERC20hTokenRoot is ERC20, Ownable, IERC20hTokenRoot {
13:      /// @inheritdoc IERC20hTokenRoot

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L12-L13)

</details>




### [N&#x2011;43] Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning
These Functions indicate their purpose with their name more clearly than using low-level calls.

*There are 3 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

103:         _rootBridgeAgentAddress.call{value: msg.value}("");

```
*GitHub*: [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L103-L103)

```solidity
File: src/RootBridgeAgent.sol

835:             callee.call{value: msg.value}("");

927:             callee.call{value: _value}("");

```
*GitHub*: [835](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L835-L835), [927](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L927-L927)


### [N&#x2011;44] Unused import
The identifier is imported but never used within the file

*There are 15 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

/// @audit IBranchBridgeAgent
6:   import {GasParams, IBranchBridgeAgent} from "./interfaces/IBranchBridgeAgent.sol";

```
*GitHub*: [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L6-L6)

```solidity
File: src/BaseBranchRouter.sol

/// @audit DepositParams
16:      DepositParams,

/// @audit DepositMultipleParams
18:      DepositMultipleParams,

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L16-L16), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L18-L18)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit ILayerZeroReceiver
15:      ILayerZeroReceiver,

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L15-L15)

```solidity
File: src/CoreBranchRouter.sol

/// @audit IBranchRouter
9:   import {IBranchRouter} from "./interfaces/IBranchRouter.sol";

```
*GitHub*: [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L9-L9)

```solidity
File: src/RootBridgeAgent.sol

/// @audit ILayerZeroReceiver
18:      ILayerZeroReceiver,

```
*GitHub*: [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L18-L18)

```solidity
File: src/RootBridgeAgentExecutor.sol

/// @audit IRootBridgeAgent
7:   import {IRootBridgeAgent} from "./interfaces/IRootBridgeAgent.sol";

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L7-L7)

```solidity
File: src/VirtualAccount.sol

/// @audit IERC1155Receiver
10:  import {IERC1155Receiver} from "@openzeppelin/contracts/token/ERC1155/IERC1155Receiver.sol";

/// @audit IERC721Receiver
11:  import {IERC721Receiver} from "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L11-L11)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

/// @audit ArbitrumBranchBridgeAgent
6:   import {ArbitrumBranchBridgeAgent, DeployArbitrumBranchBridgeAgent} from "../ArbitrumBranchBridgeAgent.sol";

```
*GitHub*: [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L6-L6)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

/// @audit ERC20
6:   import {ERC20} from "solmate/tokens/ERC20.sol";

```
*GitHub*: [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L6-L6)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit DepositParams
11:      DepositParams,

/// @audit DepositMultipleParams
12:      DepositMultipleParams,

/// @audit SettlementParams
13:      SettlementParams,

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L13-L13)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit SettlementParams
13:      SettlementParams

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L13-L13)

</details>




### [N&#x2011;45] Array is `push()`ed but not `pop()`ed
Array entries are added but are never removed. Consider whether this should be the case, or whether there should be a maximum, or whether old entries should be removed. Cases where there are specific potential problems will be flagged separately under a different issue.

*There are 12 instances of this issue:*

```solidity
File: src/BranchPort.sol

131:         bridgeAgentFactories.push(_bridgeAgentFactory);

323:         bridgeAgents.push(_bridgeAgent);

342:         bridgeAgentFactories.push(_newBridgeAgentFactory);

367:         strategyTokens.push(_token);

388:         portStrategies.push(_portStrategy);

421:         bridgeAgents.push(_coreBranchBridgeAgent);

```
*GitHub*: [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L131-L131), [323](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L323-L323), [342](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L342-L342), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L367-L367), [388](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L388-L388), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L421-L421)

```solidity
File: src/RootPort.sol

136:         bridgeAgentFactories.push(_bridgeAgentFactory);

385:         bridgeAgents.push(_bridgeAgent);

424:         bridgeAgentFactories.push(_bridgeAgentFactory);

```
*GitHub*: [136](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L136-L136), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L385-L385), [424](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L424-L424)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

72:          hTokens.push(newToken);

104:         hTokens.push(newToken);

```
*GitHub*: [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L72-L72), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L104-L104)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

89:          hTokens.push(newToken);

```
*GitHub*: [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L89-L89)


### [N&#x2011;46] Unused `struct` definition
Note that there may be cases where a struct superficially appears to be used, but this is only because there are multiple definitions of the struct in different files. In such cases, the struct definition should be moved into a separate file. The instances below are the unused definitions.

*There is one instance of this issue:*

```solidity
File: src/interfaces/IMulticall2.sol

15       struct Result {
16           bool success;
17           bytes returnData;
18:      }

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L15-L18)


### [N&#x2011;47] Unused `error` definition
Note that there may be cases where an error superficially appears to be used, but this is only because there are multiple definitions of the error in different files. In such cases, the error definition should be moved into a separate file. The instances below are the unused definitions.

*There are 7 instances of this issue:*

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

348:     error InsufficientGas();

```
*GitHub*: [348](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L348-L348)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

345:     error GasErrorOrRepeatedTx();

349:     error NotDao();

358:     error UnrecognizedLocalBridgeAgent();

372:     error InsufficientGasForFees();

376:     error CallerIsNotPool();

377:     error AmountsAreZero();

```
*GitHub*: [345](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L345-L345), [349](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L349-L349), [358](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L358-L358), [372](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L372-L372), [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L376-L376), [377](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L377-L377)


### [N&#x2011;48] NatSpec: Contract declarations should have NatSpec descriptions
e.g. `@dev` or `@notice`, and it must appear above the contract definition braces in order to be identified by the compiler as NatSpec

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

10:  library DeployArbitrumBranchBridgeAgent {

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L10-L10)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

7    interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {
8        // @notice send a LayerZero message to the specified address at a LayerZero endpoint.
9        // @param _dstChainId - the destination chain identifier
10       // @param _destination - the address on destination chain (in bytes). address length/format may vary by chains
11       // @param _payload - a custom bytes payload to send to the destination contract
12       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address
13       // @param _zroPaymentAddress - the address of the ZRO token holder who would pay for the transaction
14:      // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7-L14)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

5    interface ILayerZeroReceiver {
6        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination
7        // @param _srcChainId - the source endpoint identifier
8        // @param _srcAddress - the source sending contract address from the source chain
9        // @param _nonce - the ordered message nonce
10:      // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L5-L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

5    interface ILayerZeroUserApplicationConfig {
6        // @notice set the configuration of the LayerZero messaging library of the specified version
7        // @param _version - messaging library version
8        // @param _chainId - the chainId for the pending config change
9        // @param _configType - type of configuration. every messaging library has its own convention.
10:      // @param _config - configuration in the bytes. can encode arbitrary content.

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5-L10)


### [N&#x2011;49] NatSpec: Contract declarations should have `@notice` tags
`@notice` is used to explain to end users what the contract does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

10:  library DeployArbitrumBranchBridgeAgent {

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L10-L10)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

7    interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {
8        // @notice send a LayerZero message to the specified address at a LayerZero endpoint.
9        // @param _dstChainId - the destination chain identifier
10       // @param _destination - the address on destination chain (in bytes). address length/format may vary by chains
11       // @param _payload - a custom bytes payload to send to the destination contract
12       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address
13       // @param _zroPaymentAddress - the address of the ZRO token holder who would pay for the transaction
14:      // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7-L14)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

5    interface ILayerZeroReceiver {
6        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination
7        // @param _srcChainId - the source endpoint identifier
8        // @param _srcAddress - the source sending contract address from the source chain
9        // @param _nonce - the ordered message nonce
10:      // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L5-L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

5    interface ILayerZeroUserApplicationConfig {
6        // @notice set the configuration of the LayerZero messaging library of the specified version
7        // @param _version - messaging library version
8        // @param _chainId - the chainId for the pending config change
9        // @param _configType - type of configuration. every messaging library has its own convention.
10:      // @param _config - configuration in the bytes. can encode arbitrary content.

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5-L10)


### [N&#x2011;50] NatSpec: Error declarations should have NatSpec descriptions


*There are 90 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/CoreRootRouter.sol

520:     error InvalidChainId();

522:     error UnauthorizedChainId();

524:     error UnauthorizedCallerNotManager();

526:     error TokenAlreadyAdded();

528:     error UnrecognizedGlobalToken();

530:     error UnrecognizedBridgeAgentFactory();

```
*GitHub*: [520](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L520-L520), [522](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L522-L522), [524](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L524-L524), [526](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L526-L526), [528](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L528-L528), [530](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L530-L530)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

45:      error UnknownGlobalToken();

46:      error UnknownUnderlyingToken();

```
*GitHub*: [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L45-L45), [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L46-L46)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

339:     error UnknownFlag();

340:     error ExecutionFailure();

342:     error LayerZeroUnauthorizedCaller();

343:     error LayerZeroUnauthorizedEndpoint();

345:     error AlreadyExecutedTransaction();

347:     error InvalidInput();

348:     error InsufficientGas();

350:     error NotDepositOwner();

351:     error DepositRetryUnavailableUseCallout();

352:     error DepositRedeemUnavailable();

354:     error UnrecognizedRouter();

355:     error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [339](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L339-L339), [340](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L340-L340), [342](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L342-L342), [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L343-L343), [345](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L345-L345), [347](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L347-L347), [348](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L348-L348), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L350-L350), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L351-L351), [352](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L352-L352), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L354-L354), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L355-L355)

```solidity
File: src/interfaces/IBranchPort.sol

245:     error AlreadyAddedBridgeAgent();

246:     error AlreadyAddedBridgeAgentFactory();

247:     error InvalidMinimumReservesRatio();

248:     error InvalidInputArrays();

249:     error InsufficientReserves();

250:     error UnrecognizedCore();

251:     error UnrecognizedBridgeAgent();

252:     error UnrecognizedBridgeAgentFactory();

253:     error UnrecognizedPortStrategy();

254:     error UnrecognizedStrategyToken();

255:     error NotEnoughDebtToRepay();

```
*GitHub*: [245](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L245-L245), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L246-L246), [247](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L247-L247), [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L248-L248), [249](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L249-L249), [250](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L250-L250), [251](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L251-L251), [252](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L252-L252), [253](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L253-L253), [254](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L254-L254), [255](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L255-L255)

```solidity
File: src/interfaces/IBranchRouter.sol

113:     error UnrecognizedFunctionId();

115:     error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L113-L113), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L115-L115)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

53:      error UnrecognizedBridgeAgent();

54:      error UnrecognizedBridgeAgentFactory();

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L53-L53), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L54-L54)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

32:      error UnrecognizedCoreRouter();

34:      error UnrecognizedPort();

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L32-L32), [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L34-L34)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

57:      error UnrecognizedPort();

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L57-L57)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

32:      error UnrecognizedCoreRouterOrPort();

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L32-L32)

```solidity
File: src/interfaces/IPortStrategy.sol

29:      error UnrecognizedPort();

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L29-L29)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

344:     error ExecutionFailure();

345:     error GasErrorOrRepeatedTx();

346:     error AlreadyExecutedTransaction();

347:     error UnknownFlag();

349:     error NotDao();

351:     error LayerZeroUnauthorizedEndpoint();

352:     error LayerZeroUnauthorizedCaller();

354:     error AlreadyAddedBridgeAgent();

355:     error UnrecognizedExecutor();

356:     error UnrecognizedPort();

357:     error UnrecognizedBridgeAgent();

358:     error UnrecognizedLocalBridgeAgent();

359:     error UnrecognizedBridgeAgentManager();

360:     error UnrecognizedRouter();

362:     error UnrecognizedUnderlyingAddress();

363:     error UnrecognizedLocalAddress();

365:     error SettlementRetryUnavailable();

366:     error SettlementRetryUnavailableUseCallout();

367:     error SettlementRedeemUnavailable();

368:     error SettlementRetrieveUnavailable();

369:     error NotSettlementOwner();

371:     error InsufficientBalanceForSettlement();

372:     error InsufficientGasForFees();

373:     error InvalidInputParams();

374:     error InvalidInputParamsLength();

376:     error CallerIsNotPool();

377:     error AmountsAreZero();

```
*GitHub*: [344](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L344-L344), [345](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L345-L345), [346](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L346-L346), [347](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L347-L347), [349](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L349-L349), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L351-L351), [352](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L352-L352), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L354-L354), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L355-L355), [356](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L356-L356), [357](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L357-L357), [358](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L358-L358), [359](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L359-L359), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L360-L360), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L362-L362), [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L363-L363), [365](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L365-L365), [366](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L366-L366), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L367-L367), [368](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L368-L368), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L369-L369), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L371-L371), [372](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L372-L372), [373](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L373-L373), [374](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L374-L374), [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L376-L376), [377](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L377-L377)

```solidity
File: src/interfaces/IRootPort.sol

399:     error InvalidGlobalAddress();

400:     error InvalidLocalAddress();

401:     error InvalidUnderlyingAddress();

403:     error InvalidUserAddress();

405:     error InvalidCoreRootRouter();

406:     error InvalidCoreRootBridgeAgent();

407:     error InvalidCoreBranchRouter();

408:     error InvalidCoreBrancBridgeAgent();

410:     error UnrecognizedBridgeAgentFactory();

411:     error UnrecognizedBridgeAgent();

413:     error UnrecognizedToken();

414:     error UnableToMint();

416:     error AlreadyAddedChain();

417:     error AlreadyAddedEcosystemToken();

419:     error AlreadyAddedBridgeAgent();

420:     error AlreadyAddedBridgeAgentFactory();

421:     error BridgeAgentNotAllowed();

422:     error UnrecognizedCoreRootRouter();

423:     error UnrecognizedLocalBranchPort();

```
*GitHub*: [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L399-L399), [400](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L400-L400), [401](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L401-L401), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L403-L403), [405](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L405-L405), [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L406-L406), [407](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L407-L407), [408](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L408-L408), [410](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L410-L410), [411](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L411-L411), [413](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L413-L413), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L414-L414), [416](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L416-L416), [417](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L417-L417), [419](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L419-L419), [420](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L420-L420), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L421-L421), [422](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L422-L422), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L423-L423)

```solidity
File: src/interfaces/IRootRouter.sol

97:      error UnrecognizedFunctionId();

98:      error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L97-L97), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L98-L98)

```solidity
File: src/interfaces/IVirtualAccount.sol

79:      error CallFailed();

81:      error UnauthorizedCaller();

```
*GitHub*: [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L79-L79), [81](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L81-L81)

</details>




### [N&#x2011;51] NatSpec: Event declarations should have NatSpec descriptions


*There are 28 instances of this issue:*

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

332:     event LogExecute(uint256 indexed nonce);

333:     event LogFallback(uint256 indexed nonce);

```
*GitHub*: [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L332-L332), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L333-L333)

```solidity
File: src/interfaces/IBranchPort.sol

220:     event DebtCreated(address indexed _strategy, address indexed _token, uint256 _amount);

221:     event DebtRepaid(address indexed _strategy, address indexed _token, uint256 _amount);

223:     event StrategyTokenAdded(address indexed _token, uint256 indexed _minimumReservesRatio);

224:     event StrategyTokenToggled(address indexed _token);

226      event PortStrategyAdded(
227          address indexed _portStrategy, address indexed _token, uint256 indexed _dailyManagementLimit
228:     );

229:     event PortStrategyToggled(address indexed _portStrategy, address indexed _token);

230      event PortStrategyUpdated(
231          address indexed _portStrategy, address indexed _token, uint256 indexed _dailyManagementLimit
232:     );

234:     event BridgeAgentFactoryAdded(address indexed _bridgeAgentFactory);

235:     event BridgeAgentFactoryToggled(address indexed _bridgeAgentFactory);

237:     event BridgeAgentToggled(address indexed _bridgeAgent);

239:     event CoreBranchSet(address indexed _coreBranchRouter, address indexed _coreBranchBridgeAgent);

```
*GitHub*: [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L220-L220), [221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L221-L221), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L223-L223), [224](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L224-L224), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L226-L228), [229](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L229-L229), [230](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L230-L232), [234](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L234-L234), [235](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L235-L235), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L237-L237), [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L239-L239)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

337:     event LogExecute(uint256 indexed depositNonce, uint256 indexed srcChainId);

338:     event LogFallback(uint256 indexed settlementNonce, uint256 indexed dstChainId);

```
*GitHub*: [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L337-L337), [338](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L338-L338)

```solidity
File: src/interfaces/IRootPort.sol

371:     event BridgeAgentFactoryAdded(address indexed bridgeAgentFactory);

372:     event BridgeAgentFactoryToggled(address indexed bridgeAgentFactory);

374:     event BridgeAgentAdded(address indexed bridgeAgent, address indexed manager);

375:     event BridgeAgentToggled(address indexed bridgeAgent);

376:     event BridgeAgentSynced(address indexed bridgeAgent, address indexed rootBridgeAgent, uint256 indexed srcChainId);

378:     event NewChainAdded(uint256 indexed chainId);

380:     event VirtualAccountCreated(address indexed user, address account);

382      event LocalTokenAdded(
383          address indexed underlyingAddress, address indexed localAddress, address indexed globalAddress, uint256 chainId
384:     );

385:     event GlobalTokenAdded(address indexed localAddress, address indexed globalAddress, uint256 indexed chainId);

386:     event EcosystemTokenAdded(address indexed ecoTokenGlobalAddress);

387:     event CoreRootSet(address indexed coreRootRouter, address indexed coreRootBridgeAgent);

388      event CoreBranchSet(
389          address indexed coreBranchRouter, address indexed coreBranchBridgeAgent, uint16 indexed dstChainId
390:     );

391      event CoreBranchSynced(
392          address indexed coreBranchRouter, address indexed coreBranchBridgeAgent, uint16 indexed dstChainId
393:     );

```
*GitHub*: [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L371-L371), [372](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L372-L372), [374](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L374-L374), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L375-L375), [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L376-L376), [378](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L378-L378), [380](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L380-L380), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L382-L384), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L385-L385), [386](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L386-L386), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L387-L387), [388](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L388-L390), [391](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L391-L393)


### [N&#x2011;52] NatSpec: State variable declarations should have NatSpec descriptions
e.g. `@notice` for public state variables, and `@dev` for [non-public](https://docs.soliditylang.org/en/latest/natspec-format.html#tags) ones

*There are 22 instances of this issue:*

```solidity
File: src/BranchPort.sol

97:      uint256 internal constant DIVISIONER = 1e4;

98:      uint256 internal constant MIN_RESERVE_RATIO = 3e3;

```
*GitHub*: [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L97-L97), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L98-L98)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

13:      uint8 internal constant STATUS_READY = 0;

15:      uint8 internal constant STATUS_DONE = 1;

17:      uint8 internal constant STATUS_RETRIEVE = 2;

21:      uint8 internal constant STATUS_FAILED = 1;

23:      uint8 internal constant STATUS_SUCCESS = 0;

27:      uint256 internal constant PARAMS_START = 1;

29:      uint256 internal constant PARAMS_START_SIGNED = 21;

31:      uint256 internal constant PARAMS_TKN_START = 5;

33:      uint256 internal constant PARAMS_TKN_START_SIGNED = 25;

35:      uint256 internal constant PARAMS_ENTRY_SIZE = 32;

37:      uint256 internal constant PARAMS_ADDRESS_SIZE = 20;

39:      uint256 internal constant PARAMS_TKN_SET_SIZE = 109;

41:      uint256 internal constant PARAMS_TKN_SET_SIZE_MULTIPLE = 128;

43:      uint256 internal constant ADDRESS_END_OFFSET = 12;

45:      uint256 internal constant PARAMS_AMT_OFFSET = 64;

47:      uint256 internal constant PARAMS_DEPOSIT_OFFSET = 96;

49:      uint256 internal constant PARAMS_END_OFFSET = 6;

51:      uint256 internal constant PARAMS_END_SIGNED_OFFSET = 26;

53:      uint256 internal constant PARAMS_SETTLEMENT_OFFSET = 129;

57:      uint256 internal constant MAX_TOKENS_LENGTH = 255;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L13-L13), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L15-L15), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L17-L17), [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L21-L21), [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L23-L23), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L27-L27), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L29-L29), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L31-L31), [33](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L33-L33), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L35-L35), [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L37-L37), [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L39-L39), [41](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L41-L41), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L43-L43), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L45-L45), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L47-L47), [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L49-L49), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L51-L51), [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L53-L53), [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L57-L57)


### [N&#x2011;53] NatSpec: Function declarations should have NatSpec descriptions


*There are 37 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

11       function deploy(uint16 _localChainId, address _daoAddress, address _localRouterAddress, address _localPortAddress)
12           external
13           returns (ArbitrumBranchBridgeAgent)
14:      {

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L14)

```solidity
File: src/BaseBranchRouter.sol

48:      constructor() {

```
*GitHub*: [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L48-L48)

```solidity
File: src/BranchBridgeAgent.sol

24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27           address _rootBridgeAgentAddress,
28           address _lzEndpointAddress,
29           address _localRouterAddress,
30           address _localPortAddress
31:      ) external returns (BranchBridgeAgent) {

149:     receive() external payable {}

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L31), [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L149-L149)

```solidity
File: src/BranchBridgeAgentExecutor.sol

16:      function deploy() external returns (address) {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L16-L16)

```solidity
File: src/CoreRootRouter.sol

83:      function initialize(address _bridgeAgentAddress, address _hTokenFactory) external onlyOwner {

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83-L83)

```solidity
File: src/MulticallRootRouterLibZip.sol

29       constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress)
30           MulticallRootRouter(_localChainId, _localPortAddress, _multicallAddress)
31:      {}

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L31)

```solidity
File: src/RootBridgeAgent.sol

128:     receive() external payable {}

```
*GitHub*: [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L128-L128)

```solidity
File: src/RootBridgeAgentExecutor.sol

14:      function deploy(address _rootBridgeAgent) external returns (address) {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L14-L14)

```solidity
File: src/RootPort.sol

304      function bridgeToLocalBranchFromRoot(address _to, address _hToken, uint256 _amount)
305          external
306          override
307          requiresLocalBranchPort
308:     {

```
*GitHub*: [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L304-L308)

```solidity
File: src/VirtualAccount.sol

44:      receive() external payable {}

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L44-L44)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

15       function send(
16           uint16 _dstChainId,
17           bytes calldata _destination,
18           bytes calldata _payload,
19           address payable _refundAddress,
20           address _zroPaymentAddress,
21           bytes calldata _adapterParams
22:      ) external payable;

31       function receivePayload(
32           uint16 _srcChainId,
33           bytes calldata _srcAddress,
34           address _dstAddress,
35           uint64 _nonce,
36           uint256 _gasLimit,
37           bytes calldata _payload
38:      ) external;

43:      function getInboundNonce(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (uint64);

47:      function getOutboundNonce(uint16 _dstChainId, address _srcAddress) external view returns (uint64);

55       function estimateFees(
56           uint16 _dstChainId,
57           address _userApplication,
58           bytes calldata _payload,
59           bool _payInZRO,
60           bytes calldata _adapterParam
61:      ) external view returns (uint256 nativeFee, uint256 zroFee);

64:      function getChainId() external view returns (uint16);

70:      function retryPayload(uint16 _srcChainId, bytes calldata _srcAddress, bytes calldata _payload) external;

75:      function hasStoredPayload(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (bool);

79:      function getSendLibraryAddress(address _userApplication) external view returns (address);

83:      function getReceiveLibraryAddress(address _userApplication) external view returns (address);

87:      function isSendingPayload() external view returns (bool);

91:      function isReceivingPayload() external view returns (bool);

98       function getConfig(uint16 _version, uint16 _chainId, address _userApplication, uint256 _configType)
99           external
100          view
101:         returns (bytes memory);

105:     function getSendVersion(address _userApplication) external view returns (uint16);

109:     function getReceiveVersion(address _userApplication) external view returns (uint16);

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L22), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L38), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L43-L43), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L47-L47), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L64-L64), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L70-L70), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L75-L75), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L79-L79), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L83-L83), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L87-L87), [91](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L91-L91), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L98-L101), [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L105-L105), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L109-L109)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

11:      function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64 _nonce, bytes calldata _payload) external;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L11-L11)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

11:      function setConfig(uint16 _version, uint16 _chainId, uint256 _configType, bytes calldata _config) external;

15:      function setSendVersion(uint16 _version) external;

19:      function setReceiveVersion(uint16 _version) external;

24:      function forceResumeReceive(uint16 _srcChainId, bytes calldata _srcAddress) external;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L11-L11), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L15-L15), [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L19-L19), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L24-L24)

```solidity
File: src/interfaces/IMulticall2.sol

20:      function aggregate(Call[] memory calls) external returns (uint256 blockNumber, bytes[] memory returnData);

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L20-L20)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

16:      function createBridgeAgent(address newRootRouterAddress) external returns (address newBridgeAgent);

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L16-L16)

```solidity
File: src/interfaces/IRootPort.sol

11:      function bridgeAgentAddress() external view returns (address);

12:      function hTokenFactoryAddress() external view returns (address);

13       function setCoreBranch(
14           address _refundee,
15           address _coreBranchRouter,
16           address _coreBranchBridgeAgent,
17           uint16 _dstChainId,
18           GasParams calldata _gParams
19:      ) external payable;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L13-L19)

```solidity
File: src/token/ERC20hTokenBranch.sol

13       constructor(
14           string memory chainName,
15           string memory chainSymbol,
16           string memory _name,
17           string memory _symbol,
18           uint8 _decimals,
19           address _owner
20:      ) ERC20(string(string.concat(chainName, _name)), string(string.concat(chainSymbol, _symbol)), _decimals) {

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L20)

</details>




### [N&#x2011;54] NatSpec: Function declarations should have `@notice` tags
`@notice` is used to explain to end users what the function does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided

*There are 37 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

11       function deploy(uint16 _localChainId, address _daoAddress, address _localRouterAddress, address _localPortAddress)
12           external
13           returns (ArbitrumBranchBridgeAgent)
14:      {

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L14)

```solidity
File: src/BaseBranchRouter.sol

48:      constructor() {

```
*GitHub*: [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L48-L48)

```solidity
File: src/BranchBridgeAgent.sol

24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27           address _rootBridgeAgentAddress,
28           address _lzEndpointAddress,
29           address _localRouterAddress,
30           address _localPortAddress
31:      ) external returns (BranchBridgeAgent) {

149:     receive() external payable {}

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L31), [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L149-L149)

```solidity
File: src/BranchBridgeAgentExecutor.sol

16:      function deploy() external returns (address) {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L16-L16)

```solidity
File: src/CoreRootRouter.sol

83:      function initialize(address _bridgeAgentAddress, address _hTokenFactory) external onlyOwner {

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83-L83)

```solidity
File: src/MulticallRootRouterLibZip.sol

29       constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress)
30           MulticallRootRouter(_localChainId, _localPortAddress, _multicallAddress)
31:      {}

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L31)

```solidity
File: src/RootBridgeAgent.sol

128:     receive() external payable {}

```
*GitHub*: [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L128-L128)

```solidity
File: src/RootBridgeAgentExecutor.sol

14:      function deploy(address _rootBridgeAgent) external returns (address) {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L14-L14)

```solidity
File: src/RootPort.sol

304      function bridgeToLocalBranchFromRoot(address _to, address _hToken, uint256 _amount)
305          external
306          override
307          requiresLocalBranchPort
308:     {

```
*GitHub*: [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L304-L308)

```solidity
File: src/VirtualAccount.sol

44:      receive() external payable {}

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L44-L44)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

15       function send(
16           uint16 _dstChainId,
17           bytes calldata _destination,
18           bytes calldata _payload,
19           address payable _refundAddress,
20           address _zroPaymentAddress,
21           bytes calldata _adapterParams
22:      ) external payable;

31       function receivePayload(
32           uint16 _srcChainId,
33           bytes calldata _srcAddress,
34           address _dstAddress,
35           uint64 _nonce,
36           uint256 _gasLimit,
37           bytes calldata _payload
38:      ) external;

43:      function getInboundNonce(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (uint64);

47:      function getOutboundNonce(uint16 _dstChainId, address _srcAddress) external view returns (uint64);

55       function estimateFees(
56           uint16 _dstChainId,
57           address _userApplication,
58           bytes calldata _payload,
59           bool _payInZRO,
60           bytes calldata _adapterParam
61:      ) external view returns (uint256 nativeFee, uint256 zroFee);

64:      function getChainId() external view returns (uint16);

70:      function retryPayload(uint16 _srcChainId, bytes calldata _srcAddress, bytes calldata _payload) external;

75:      function hasStoredPayload(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (bool);

79:      function getSendLibraryAddress(address _userApplication) external view returns (address);

83:      function getReceiveLibraryAddress(address _userApplication) external view returns (address);

87:      function isSendingPayload() external view returns (bool);

91:      function isReceivingPayload() external view returns (bool);

98       function getConfig(uint16 _version, uint16 _chainId, address _userApplication, uint256 _configType)
99           external
100          view
101:         returns (bytes memory);

105:     function getSendVersion(address _userApplication) external view returns (uint16);

109:     function getReceiveVersion(address _userApplication) external view returns (uint16);

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L22), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L38), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L43-L43), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L47-L47), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L64-L64), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L70-L70), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L75-L75), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L79-L79), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L83-L83), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L87-L87), [91](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L91-L91), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L98-L101), [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L105-L105), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L109-L109)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

11:      function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64 _nonce, bytes calldata _payload) external;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L11-L11)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

11:      function setConfig(uint16 _version, uint16 _chainId, uint256 _configType, bytes calldata _config) external;

15:      function setSendVersion(uint16 _version) external;

19:      function setReceiveVersion(uint16 _version) external;

24:      function forceResumeReceive(uint16 _srcChainId, bytes calldata _srcAddress) external;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L11-L11), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L15-L15), [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L19-L19), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L24-L24)

```solidity
File: src/interfaces/IMulticall2.sol

20:      function aggregate(Call[] memory calls) external returns (uint256 blockNumber, bytes[] memory returnData);

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L20-L20)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

16:      function createBridgeAgent(address newRootRouterAddress) external returns (address newBridgeAgent);

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L16-L16)

```solidity
File: src/interfaces/IRootPort.sol

11:      function bridgeAgentAddress() external view returns (address);

12:      function hTokenFactoryAddress() external view returns (address);

13       function setCoreBranch(
14           address _refundee,
15           address _coreBranchRouter,
16           address _coreBranchBridgeAgent,
17           uint16 _dstChainId,
18           GasParams calldata _gParams
19:      ) external payable;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L13-L19)

```solidity
File: src/token/ERC20hTokenBranch.sol

13       constructor(
14           string memory chainName,
15           string memory chainSymbol,
16           string memory _name,
17           string memory _symbol,
18           uint8 _decimals,
19           address _owner
20:      ) ERC20(string(string.concat(chainName, _name)), string(string.concat(chainSymbol, _symbol)), _decimals) {

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L20)

</details>




### [N&#x2011;55] Constants in comparisons should appear on the left side
Doing so will prevent [typo bugs](https://www.moserware.com/2008/01/constants-on-left-are-better-but-this.html)

*There are 62 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumCoreBranchRouter.sol

127:         if (_data[0] == 0x02) {

146:         } else if (_data[0] == 0x03) {

152:         } else if (_data[0] == 0x04) {

157:         } else if (_data[0] == 0x05) {

162:         } else if (_data[0] == 0x06) {

```
*GitHub*: [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L127-L127), [146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L146-L146), [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L152-L152), [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L157-L157), [162](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L162-L162)

```solidity
File: src/BaseBranchRouter.sol

213:         require(_unlocked == 1);

```
*GitHub*: [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L213-L213)

```solidity
File: src/BranchBridgeAgent.sol

359:         if (uint8(deposit.hTokens.length) == 1) {

412:         if (payload.length == 0) revert DepositRetryUnavailableUseCallout();

599:         if (flag == 0x00) {

616:         } else if (flag == 0x01) {

638:         } else if (flag == 0x02) {

663:         } else if (flag == 0x03) {

681:         } else if (flag == 0x04) {

651:                 _payload[0] == 0x82,

629:                 _payload[0] == 0x81,

923:         require(_unlocked == 1);

942:         if (_srcAddress.length != 40) revert LayerZeroUnauthorizedCaller();

```
*GitHub*: [359](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L359-L359), [412](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L412-L412), [599](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L599-L599), [616](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L616-L616), [638](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L638-L638), [663](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L663-L663), [681](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L681-L681), [651](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L651-L651), [629](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L629-L629), [923](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L923-L923), [942](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L942-L942)

```solidity
File: src/BranchPort.sol

487:         if (block.timestamp - lastManaged[msg.sender][_token] >= 1 days) {

567:         require(_unlocked == 1);

```
*GitHub*: [487](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L487-L487), [567](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L567-L567)

```solidity
File: src/CoreBranchRouter.sol

88:          if (_params[0] == 0x01) {

100:         } else if (_params[0] == 0x02) {

115:         } else if (_params[0] == 0x03) {

121:         } else if (_params[0] == 0x04) {

127:         } else if (_params[0] == 0x05) {

133:         } else if (_params[0] == 0x06) {

140:         } else if (_params[0] == 0x07) {

```
*GitHub*: [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L88-L88), [100](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L100-L100), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L115-L115), [121](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L121-L121), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L127-L127), [133](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L133-L133), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L140-L140)

```solidity
File: src/CoreRootRouter.sol

307:         if (funcId == 0x02) {

314:         } else if (funcId == 0x03) {

320:         } else if (funcId == 0x04) {

337:         if (funcId == 0x01) {

```
*GitHub*: [307](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L307-L307), [314](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L314-L314), [320](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L320-L320), [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L337-L337)

```solidity
File: src/MulticallRootRouter.sol

142:         if (funcId == 0x01) {

150:         } else if (funcId == 0x02) {

174:         } else if (funcId == 0x03) {

234:         if (funcId == 0x01) {

242:         } else if (funcId == 0x02) {

265:         } else if (funcId == 0x03) {

323:         if (funcId == 0x01) {

331:         } else if (funcId == 0x02) {

354:         } else if (funcId == 0x03) {

411:         if (funcId == 0x01) {

419:         } else if (funcId == 0x02) {

442:         } else if (funcId == 0x03) {

591:         require(_unlocked == 1);

```
*GitHub*: [142](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L142-L142), [150](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L150-L150), [174](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L174-L174), [234](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L234-L234), [242](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L242-L242), [265](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L265-L265), [323](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L323-L323), [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L331-L331), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L354-L354), [411](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L411-L411), [419](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L419-L419), [442](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L442-L442), [591](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L591-L591)

```solidity
File: src/RootBridgeAgent.sol

444:         if (_payload[0] == 0x00) {

467:         } else if (_payload[0] == 0x01) {

490:         } else if (_payload[0] == 0x02) {

513:         } else if (_payload[0] == 0x03) {

539:         } else if (_payload[0] == 0x04) {

577:         } else if (_payload[0] & 0x7F == 0x05) {

617:         } else if (_payload[0] & 0x7F == 0x06) {

657:         } else if (_payload[0] & 0x7F == 0x07) {

699:         } else if (_payload[0] == 0x08) {

718:         } else if (_payload[0] == 0x09) {

684:                 _payload[0] == 0x87,

640:                 _payload[0] == 0x86,

600:                 _payload[0] == 0x85,

871:         if (_hTokens.length == 0) revert SettlementRetryUnavailableUseCallout();

877:         if (_hTokens.length == 1) {

1141:        if (_amount == 0 && _deposit == 0) revert InvalidInputParams();

1191:        require(_unlocked == 1);

1210:            if (_srcAddress.length != 40) revert LayerZeroUnauthorizedCaller();

```
*GitHub*: [444](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L444-L444), [467](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L467-L467), [490](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L490-L490), [513](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L513-L513), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L539-L539), [577](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L577-L577), [617](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L617-L617), [657](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L657-L657), [699](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L699-L699), [718](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L718-L718), [684](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L684-L684), [640](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L640-L640), [600](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L600-L600), [871](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L871-L871), [877](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L877-L877), [1141](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1141-L1141), [1141](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1141-L1141), [1191](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1191-L1191), [1210](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1210-L1210)

</details>




### [N&#x2011;56] Custom error has no error details
Consider adding parameters to the error to indicate which user or values caused the failure

*There are 90 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/CoreRootRouter.sol

520:     error InvalidChainId();

522:     error UnauthorizedChainId();

524:     error UnauthorizedCallerNotManager();

526:     error TokenAlreadyAdded();

528:     error UnrecognizedGlobalToken();

530:     error UnrecognizedBridgeAgentFactory();

```
*GitHub*: [520](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L520-L520), [522](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L522-L522), [524](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L524-L524), [526](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L526-L526), [528](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L528-L528), [530](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L530-L530)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

45:      error UnknownGlobalToken();

46:      error UnknownUnderlyingToken();

```
*GitHub*: [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L45-L45), [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L46-L46)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

339:     error UnknownFlag();

340:     error ExecutionFailure();

342:     error LayerZeroUnauthorizedCaller();

343:     error LayerZeroUnauthorizedEndpoint();

345:     error AlreadyExecutedTransaction();

347:     error InvalidInput();

348:     error InsufficientGas();

350:     error NotDepositOwner();

351:     error DepositRetryUnavailableUseCallout();

352:     error DepositRedeemUnavailable();

354:     error UnrecognizedRouter();

355:     error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [339](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L339-L339), [340](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L340-L340), [342](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L342-L342), [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L343-L343), [345](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L345-L345), [347](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L347-L347), [348](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L348-L348), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L350-L350), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L351-L351), [352](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L352-L352), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L354-L354), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L355-L355)

```solidity
File: src/interfaces/IBranchPort.sol

245:     error AlreadyAddedBridgeAgent();

246:     error AlreadyAddedBridgeAgentFactory();

247:     error InvalidMinimumReservesRatio();

248:     error InvalidInputArrays();

249:     error InsufficientReserves();

250:     error UnrecognizedCore();

251:     error UnrecognizedBridgeAgent();

252:     error UnrecognizedBridgeAgentFactory();

253:     error UnrecognizedPortStrategy();

254:     error UnrecognizedStrategyToken();

255:     error NotEnoughDebtToRepay();

```
*GitHub*: [245](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L245-L245), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L246-L246), [247](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L247-L247), [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L248-L248), [249](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L249-L249), [250](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L250-L250), [251](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L251-L251), [252](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L252-L252), [253](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L253-L253), [254](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L254-L254), [255](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L255-L255)

```solidity
File: src/interfaces/IBranchRouter.sol

113:     error UnrecognizedFunctionId();

115:     error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L113-L113), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L115-L115)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

53:      error UnrecognizedBridgeAgent();

54:      error UnrecognizedBridgeAgentFactory();

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L53-L53), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L54-L54)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

32:      error UnrecognizedCoreRouter();

34:      error UnrecognizedPort();

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L32-L32), [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L34-L34)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

57:      error UnrecognizedPort();

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L57-L57)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

32:      error UnrecognizedCoreRouterOrPort();

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L32-L32)

```solidity
File: src/interfaces/IPortStrategy.sol

29:      error UnrecognizedPort();

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L29-L29)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

344:     error ExecutionFailure();

345:     error GasErrorOrRepeatedTx();

346:     error AlreadyExecutedTransaction();

347:     error UnknownFlag();

349:     error NotDao();

351:     error LayerZeroUnauthorizedEndpoint();

352:     error LayerZeroUnauthorizedCaller();

354:     error AlreadyAddedBridgeAgent();

355:     error UnrecognizedExecutor();

356:     error UnrecognizedPort();

357:     error UnrecognizedBridgeAgent();

358:     error UnrecognizedLocalBridgeAgent();

359:     error UnrecognizedBridgeAgentManager();

360:     error UnrecognizedRouter();

362:     error UnrecognizedUnderlyingAddress();

363:     error UnrecognizedLocalAddress();

365:     error SettlementRetryUnavailable();

366:     error SettlementRetryUnavailableUseCallout();

367:     error SettlementRedeemUnavailable();

368:     error SettlementRetrieveUnavailable();

369:     error NotSettlementOwner();

371:     error InsufficientBalanceForSettlement();

372:     error InsufficientGasForFees();

373:     error InvalidInputParams();

374:     error InvalidInputParamsLength();

376:     error CallerIsNotPool();

377:     error AmountsAreZero();

```
*GitHub*: [344](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L344-L344), [345](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L345-L345), [346](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L346-L346), [347](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L347-L347), [349](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L349-L349), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L351-L351), [352](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L352-L352), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L354-L354), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L355-L355), [356](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L356-L356), [357](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L357-L357), [358](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L358-L358), [359](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L359-L359), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L360-L360), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L362-L362), [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L363-L363), [365](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L365-L365), [366](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L366-L366), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L367-L367), [368](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L368-L368), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L369-L369), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L371-L371), [372](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L372-L372), [373](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L373-L373), [374](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L374-L374), [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L376-L376), [377](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L377-L377)

```solidity
File: src/interfaces/IRootPort.sol

399:     error InvalidGlobalAddress();

400:     error InvalidLocalAddress();

401:     error InvalidUnderlyingAddress();

403:     error InvalidUserAddress();

405:     error InvalidCoreRootRouter();

406:     error InvalidCoreRootBridgeAgent();

407:     error InvalidCoreBranchRouter();

408:     error InvalidCoreBrancBridgeAgent();

410:     error UnrecognizedBridgeAgentFactory();

411:     error UnrecognizedBridgeAgent();

413:     error UnrecognizedToken();

414:     error UnableToMint();

416:     error AlreadyAddedChain();

417:     error AlreadyAddedEcosystemToken();

419:     error AlreadyAddedBridgeAgent();

420:     error AlreadyAddedBridgeAgentFactory();

421:     error BridgeAgentNotAllowed();

422:     error UnrecognizedCoreRootRouter();

423:     error UnrecognizedLocalBranchPort();

```
*GitHub*: [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L399-L399), [400](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L400-L400), [401](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L401-L401), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L403-L403), [405](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L405-L405), [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L406-L406), [407](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L407-L407), [408](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L408-L408), [410](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L410-L410), [411](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L411-L411), [413](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L413-L413), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L414-L414), [416](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L416-L416), [417](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L417-L417), [419](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L419-L419), [420](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L420-L420), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L421-L421), [422](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L422-L422), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L423-L423)

```solidity
File: src/interfaces/IRootRouter.sol

97:      error UnrecognizedFunctionId();

98:      error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L97-L97), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L98-L98)

```solidity
File: src/interfaces/IVirtualAccount.sol

79:      error CallFailed();

81:      error UnauthorizedCaller();

```
*GitHub*: [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L79-L79), [81](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L81-L81)

</details>




### [N&#x2011;57] NatSpec: Contract declarations should have `@author` tags


*There are 9 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

10:  library DeployArbitrumBranchBridgeAgent {

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L10-L10)

```solidity
File: src/BranchBridgeAgent.sol

23:  library DeployBranchBridgeAgent {

```
*GitHub*: [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L23-L23)

```solidity
File: src/BranchBridgeAgentExecutor.sol

15:  library DeployBranchBridgeAgentExecutor {

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L15-L15)

```solidity
File: src/RootBridgeAgentExecutor.sol

13:  library DeployRootBridgeAgentExecutor {

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L13-L13)

```solidity
File: src/VirtualAccount.sol

17:  contract VirtualAccount is IVirtualAccount, ERC1155Receiver {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L17-L17)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

7    interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {
8        // @notice send a LayerZero message to the specified address at a LayerZero endpoint.
9        // @param _dstChainId - the destination chain identifier
10       // @param _destination - the address on destination chain (in bytes). address length/format may vary by chains
11       // @param _payload - a custom bytes payload to send to the destination contract
12       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address
13       // @param _zroPaymentAddress - the address of the ZRO token holder who would pay for the transaction
14:      // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7-L14)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

5    interface ILayerZeroReceiver {
6        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination
7        // @param _srcChainId - the source endpoint identifier
8        // @param _srcAddress - the source sending contract address from the source chain
9        // @param _nonce - the ordered message nonce
10:      // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L5-L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

5    interface ILayerZeroUserApplicationConfig {
6        // @notice set the configuration of the LayerZero messaging library of the specified version
7        // @param _version - messaging library version
8        // @param _chainId - the chainId for the pending config change
9        // @param _configType - type of configuration. every messaging library has its own convention.
10:      // @param _config - configuration in the bytes. can encode arbitrary content.

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5-L10)

```solidity
File: src/interfaces/IRootPort.sol

10:  interface ICoreRootRouter {

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L10-L10)

</details>




### [N&#x2011;58] NatSpec: Contract declarations should have `@dev` tags
`@dev` is used to explain extra details to developers

*There are 34 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

10:  library DeployArbitrumBranchBridgeAgent {

31   contract ArbitrumBranchBridgeAgent is BranchBridgeAgent {
32       /*///////////////////////////////////////////////////////////////
33                               CONSTRUCTOR
34       //////////////////////////////////////////////////////////////*/
35   
36       /**
37        * @notice Constructor for Arbitrum Branch Bridge Agent.
38        *  @param _localChainId Local Chain Layer Zero Id.
39        *  @param _rootBridgeAgentAddress Root Bridge Agent Address.
40        *  @param _localRouterAddress Local Core Branch Router Address.
41        *  @param _localPortAddress Local Branch Port Address.
42:       */

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L10-L10), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L31-L42)

```solidity
File: src/ArbitrumBranchPort.sol

14:  contract ArbitrumBranchPort is BranchPort, IArbitrumBranchPort {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L14-L14)

```solidity
File: src/BaseBranchRouter.sol

25:  contract BaseBranchRouter is IBranchRouter, Ownable {

```
*GitHub*: [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L25-L25)

```solidity
File: src/BranchBridgeAgent.sol

23:  library DeployBranchBridgeAgent {

45:  contract BranchBridgeAgent is IBranchBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L23-L23), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L45-L45)

```solidity
File: src/BranchBridgeAgentExecutor.sol

15:  library DeployBranchBridgeAgentExecutor {

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L15-L15)

```solidity
File: src/BranchPort.sol

17:  contract BranchPort is Ownable, IBranchPort {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L17-L17)

```solidity
File: src/CoreBranchRouter.sol

18   contract CoreBranchRouter is ICoreBranchRouter, BaseBranchRouter {
19:      /// @notice hToken Factory Address.

```
*GitHub*: [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L18-L19)

```solidity
File: src/RootBridgeAgent.sol

32:  contract RootBridgeAgent is IRootBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L32-L32)

```solidity
File: src/RootBridgeAgentExecutor.sol

13:  library DeployRootBridgeAgentExecutor {

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L13-L13)

```solidity
File: src/RootPort.sol

16:  contract RootPort is Ownable, IRootPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L16-L16)

```solidity
File: src/VirtualAccount.sol

17:  contract VirtualAccount is IVirtualAccount, ERC1155Receiver {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L17-L17)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

17   contract ArbitrumBranchBridgeAgentFactory is BranchBridgeAgentFactory {
18       /*///////////////////////////////////////////////////////////////
19                                CONSTRUCTOR
20       //////////////////////////////////////////////////////////////*/
21   
22       /**
23        * @notice Constructor for Bridge Agent Factory Contract.
24        *  @param _rootChainId Root Chain Layer Zero Id.
25        *  @param _rootBridgeAgentFactoryAddress Root Bridge Agent Factory Address.
26        *  @param _localCoreBranchRouterAddress Local Core Branch Router Address.
27        *  @param _localPortAddress Local Branch Port Address.
28        *  @param _owner Owner of the contract.
29:       */

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L17-L29)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

19   contract BranchBridgeAgentFactory is Ownable, IBranchBridgeAgentFactory {
20:      /// @notice Local Chain Id.

```
*GitHub*: [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L19-L20)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

12   contract ERC20hTokenBranchFactory is Ownable, IERC20hTokenBranchFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L12-L13)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

12   contract ERC20hTokenRootFactory is Ownable, IERC20hTokenRootFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L12-L13)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

11   contract RootBridgeAgentFactory is IRootBridgeAgentFactory {
12:      /// @notice Root Chain Id

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L11-L12)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

16   interface IArbitrumBranchPort is IBranchPort {
17       /*///////////////////////////////////////////////////////////////
18                           EXTERNAL FUNCTIONS
19       //////////////////////////////////////////////////////////////*/
20   
21       /**
22        * @notice Function to deposit underlying/native token amount into Port in exchange for Local hToken.
23        *     @param _depositor underlying/native token depositor.
24        *     @param _recipient hToken receiver.
25        *     @param _underlyingAddress underlying/native token address.
26        *     @param _amount amount of tokens.
27:       */

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L16-L27)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

12   interface IBranchBridgeAgentFactory {
13       /*///////////////////////////////////////////////////////////////
14                           BRIDGE AGENT FUNCTIONS
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Creates a new Branch Bridge Agent.
19        * @param newRootRouterAddress New Root Router Address.
20        * @param rootBridgeAgentAddress Root Bridge Agent Address.
21        * @param _rootBridgeAgentFactoryAddress Root Bridge Agent Factory Address.
22        * @return newBridgeAgent New Bridge Agent Address.
23:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L12-L23)

```solidity
File: src/interfaces/IBranchPort.sol

14   interface IBranchPort {
15       /*///////////////////////////////////////////////////////////////
16                               VIEW FUNCTIONS
17       //////////////////////////////////////////////////////////////*/
18       /**
19        * @notice Returns true if the address is a Bridge Agent.
20        *   @param _bridgeAgent Bridge Agent address.
21        *   @return bool.
22:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L14-L22)

```solidity
File: src/interfaces/IBranchRouter.sol

21   interface IBranchRouter {
22       /*///////////////////////////////////////////////////////////////
23                               VIEW / STATE
24       //////////////////////////////////////////////////////////////*/
25   
26:      /// @notice External function to return the Branch Chain's Local Port Address.

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L21-L26)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

11   interface IERC20hTokenBranch {
12       /*///////////////////////////////////////////////////////////////
13                           ERC20 LOGIC
14       //////////////////////////////////////////////////////////////*/
15   
16       /**
17        * @notice Function to mint tokens in the Branch Chain.
18        * @param account Address of the account to receive the tokens.
19        * @param amount Amount of tokens to be minted.
20        * @return Boolean indicating if the operation was successful.
21:       */

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L11-L21)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

7    interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {
8        // @notice send a LayerZero message to the specified address at a LayerZero endpoint.
9        // @param _dstChainId - the destination chain identifier
10       // @param _destination - the address on destination chain (in bytes). address length/format may vary by chains
11       // @param _payload - a custom bytes payload to send to the destination contract
12       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address
13       // @param _zroPaymentAddress - the address of the ZRO token holder who would pay for the transaction
14:      // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7-L14)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

5    interface ILayerZeroReceiver {
6        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination
7        // @param _srcChainId - the source endpoint identifier
8        // @param _srcAddress - the source sending contract address from the source chain
9        // @param _nonce - the ordered message nonce
10:      // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L5-L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

5    interface ILayerZeroUserApplicationConfig {
6        // @notice set the configuration of the LayerZero messaging library of the specified version
7        // @param _version - messaging library version
8        // @param _chainId - the chainId for the pending config change
9        // @param _configType - type of configuration. every messaging library has its own convention.
10:      // @param _config - configuration in the bytes. can encode arbitrary content.

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5-L10)

```solidity
File: src/interfaces/IMulticall2.sol

9:   interface IMulticall2 {

```
*GitHub*: [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L9-L9)

```solidity
File: src/interfaces/IPortStrategy.sol

12   interface IPortStrategy {
13       /*///////////////////////////////////////////////////////////////
14                             TOKEN MANAGEMENT
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Function to withdraw underlying/native token amount back into Branch Port.
19        *   @param _recipient hToken receiver.
20        *   @param _token native token address.
21        *   @param _amount amount of tokens.
22:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L12-L22)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

11   interface IRootBridgeAgentFactory {
12       /*///////////////////////////////////////////////////////////////
13                           BRIDGE AGENT FUNCTIONS
14       //////////////////////////////////////////////////////////////*/
15:  

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L11-L15)

```solidity
File: src/interfaces/IRootPort.sol

10:  interface ICoreRootRouter {

31   interface IRootPort {
32       /*///////////////////////////////////////////////////////////////
33                           VIEW FUNCTIONS
34       //////////////////////////////////////////////////////////////*/
35       /**
36        * @notice View Function returns True if the chain Id has been added to the system.
37        *  @param _chainId The Layer Zero chainId of the chain.
38        * @return bool True if the chain Id has been added to the system.
39:       */

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L10-L10), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L31-L39)

```solidity
File: src/interfaces/IRootRouter.sol

14   interface IRootRouter {
15       /*///////////////////////////////////////////////////////////////
16                           LAYERZERO FUNCTIONS
17       ///////////////////////////////////////////////////////////////*/
18   
19       /**
20        *     @notice Function to execute Branch Bridge Agent system initiated requests with no asset deposit.
21        *     @param params data received from messaging layer.
22        *     @param srcChainId chain where the request originated from.
23        *
24:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L14-L24)

```solidity
File: src/token/ERC20hTokenBranch.sol

12:  contract ERC20hTokenBranch is ERC20, Ownable, IERC20hTokenBranch {

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L12-L12)

```solidity
File: src/token/ERC20hTokenRoot.sol

12   contract ERC20hTokenRoot is ERC20, Ownable, IERC20hTokenRoot {
13:      /// @inheritdoc IERC20hTokenRoot

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L12-L13)

</details>




### [N&#x2011;59] NatSpec: Contract declarations should have `@title` tags


*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

10:  library DeployArbitrumBranchBridgeAgent {

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L10-L10)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

7    interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {
8        // @notice send a LayerZero message to the specified address at a LayerZero endpoint.
9        // @param _dstChainId - the destination chain identifier
10       // @param _destination - the address on destination chain (in bytes). address length/format may vary by chains
11       // @param _payload - a custom bytes payload to send to the destination contract
12       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address
13       // @param _zroPaymentAddress - the address of the ZRO token holder who would pay for the transaction
14:      // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7-L14)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

5    interface ILayerZeroReceiver {
6        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination
7        // @param _srcChainId - the source endpoint identifier
8        // @param _srcAddress - the source sending contract address from the source chain
9        // @param _nonce - the ordered message nonce
10:      // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L5-L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

5    interface ILayerZeroUserApplicationConfig {
6        // @notice set the configuration of the LayerZero messaging library of the specified version
7        // @param _version - messaging library version
8        // @param _chainId - the chainId for the pending config change
9        // @param _configType - type of configuration. every messaging library has its own convention.
10:      // @param _config - configuration in the bytes. can encode arbitrary content.

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5-L10)


### [N&#x2011;60] Empty function body
Consider adding a comment about why the function body is empty

*There is one instance of this issue:*

```solidity
File: src/MulticallRootRouterLibZip.sol

29       constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress)
30           MulticallRootRouter(_localChainId, _localPortAddress, _multicallAddress)
31:      {}

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L31)


### [N&#x2011;61] Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning
Starting with version 0.8.4, Solidity has the `bytes.concat()` function, which allows one to concatenate a list of bytes/strings, without extra padding. Using this function rather than `abi.encodePacked()` makes the intended operation more clear, leading to less reviewer confusion.

*There are 14 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

62:          bytes memory payload = abi.encodePacked(bytes1(0x02), params);

115:         bytes memory payload = abi.encodePacked(bytes1(0x04), data);

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L62-L62), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L115-L115)

```solidity
File: src/BranchBridgeAgent.sol

474:         bytes memory payload = abi.encodePacked(_hasFallbackToggled ? bytes1(0x87) : bytes1(0x07), params);

```
*GitHub*: [474](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L474-L474)

```solidity
File: src/CoreBranchRouter.sol

51:          bytes memory payload = abi.encodePacked(bytes1(0x01), params);

75:          bytes memory payload = abi.encodePacked(bytes1(0x02), params);

181:         bytes memory payload = abi.encodePacked(bytes1(0x03), params);

229:         bytes memory payload = abi.encodePacked(bytes1(0x04), params);

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L51-L51), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L75-L75), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L181-L181), [229](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L229-L229)

```solidity
File: src/CoreRootRouter.sol

136:         bytes memory payload = abi.encodePacked(bytes1(0x02), params);

171:         bytes memory payload = abi.encodePacked(bytes1(0x03), params);

196:         bytes memory payload = abi.encodePacked(bytes1(0x04), params);

223:         bytes memory payload = abi.encodePacked(bytes1(0x05), params);

254:         bytes memory payload = abi.encodePacked(bytes1(0x06), params);

284:         bytes memory payload = abi.encodePacked(bytes1(0x07), params);

434:         bytes memory payload = abi.encodePacked(bytes1(0x01), params);

```
*GitHub*: [136](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L136-L136), [171](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L171-L171), [196](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L196-L196), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L223-L223), [254](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L254-L254), [284](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L284-L284), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L434-L434)


### [N&#x2011;62] `if`-statement can be converted to a ternary
The code can be made more compact while also increasing readability by converting the following `if`-statements to ternaries (e.g. `foo += (x > y) ? a : b`)

*There are 2 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

384              if (_isSigned) {
385                  //Pack new Data
386                  payload = abi.encodePacked(
387                      _hasFallbackToggled ? bytes1(0x86) : bytes1(0x06),
388                      msg.sender,
389                      uint8(deposit.hTokens.length),
390                      _depositNonce,
391                      deposit.hTokens,
392                      deposit.tokens,
393                      deposit.amounts,
394                      deposit.deposits,
395                      _params
396                  );
397              } else {
398                  payload = abi.encodePacked(
399                      bytes1(0x03),
400                      uint8(deposit.hTokens.length),
401                      _depositNonce,
402                      deposit.hTokens,
403                      deposit.tokens,
404                      deposit.amounts,
405                      deposit.deposits,
406                      _params
407                  );
408:             }

360              if (_isSigned) {
361                  //Pack new Data
362                  payload = abi.encodePacked(
363                      _hasFallbackToggled ? bytes1(0x85) : bytes1(0x05),
364                      msg.sender,
365                      _depositNonce,
366                      deposit.hTokens[0],
367                      deposit.tokens[0],
368                      deposit.amounts[0],
369                      deposit.deposits[0],
370                      _params
371                  );
372              } else {
373                  payload = abi.encodePacked(
374                      bytes1(0x02),
375                      _depositNonce,
376                      deposit.hTokens[0],
377                      deposit.tokens[0],
378                      deposit.amounts[0],
379                      deposit.deposits[0],
380                      _params
381                  );
382:             }

```
*GitHub*: [384](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L384-L408), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L360-L382)


### [N&#x2011;63] Overflows in unchecked blocks
While integers with a large number of bits are unlikely to overflow on human time scales, it is not strictly correct to use an `unchecked` block around them, because _eventually_ they will overflow, and `unchecked` blocks are meant for cases where it's mathematically impossible for an operation to trigger an overflow (e.g. a prior `require()` statement prevents the overflow case)

*There are 15 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

196:                 ++i;

```
*GitHub*: [196](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L196-L196)

```solidity
File: src/BranchBridgeAgent.sol

451:                 ++i;

564:                 ++i;

```
*GitHub*: [451](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L451-L451), [564](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L564-L564)

```solidity
File: src/BranchPort.sol

271:                 ++i;

309:                 i++;

```
*GitHub*: [271](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L271-L271), [309](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L309-L309)

```solidity
File: src/MulticallRootRouter.sol

282:                     ++i;

371:                     ++i;

459:                     ++i;

561:                 ++i;

```
*GitHub*: [282](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L282-L282), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L371-L371), [459](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L459-L459), [561](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L561-L561)

```solidity
File: src/RootBridgeAgent.sol

338:                 ++i;

413:                 ++i;

1084:                ++i;

```
*GitHub*: [338](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L338-L338), [413](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L413-L413), [1084](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1084-L1084)

```solidity
File: src/RootBridgeAgentExecutor.sol

333:                 ++i;

```
*GitHub*: [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L333-L333)

```solidity
File: src/VirtualAccount.sol

79:                  ++i;

106:                 ++i;

```
*GitHub*: [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L79-L79), [106](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L106-L106)

</details>




### [N&#x2011;64] Consider splitting long calculations
The longer a string of operations is, the harder it is to understand it. Consider splitting the full calculation into more steps, with more descriptive temporary variable names, and add extensive comments.

*There are 8 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

518              _hTokens[i] = address(
519                  uint160(
520                      bytes20(
521                          bytes32(
522                              _sParams[
523                                  PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * i) + ADDRESS_END_OFFSET:
524                                      PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * currentIterationOffset)
525                              ]
526                          )
527                      )
528                  )
529:             );

531              _tokens[i] = address(
532                  uint160(
533                      bytes20(
534                          bytes32(
535                              _sParams[
536                                  PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (i + numOfAssets) + ADDRESS_END_OFFSET:
537                                      PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (currentIterationOffset + numOfAssets)
538                              ]
539                          )
540                      )
541                  )
542:             );

544              _amounts[i] = uint256(
545                  bytes32(
546                      _sParams[
547                          PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets + PARAMS_ENTRY_SIZE * i:
548                              PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets + PARAMS_ENTRY_SIZE * currentIterationOffset
549                      ]
550                  )
551:             );

553              _deposits[i] = uint256(
554                  bytes32(
555                      _sParams[
556                          PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets + PARAMS_ENTRY_SIZE * i:
557                              PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets
558                                  + PARAMS_ENTRY_SIZE * currentIterationOffset
559                      ]
560                  )
561:             );

```
*GitHub*: [518](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L518-L529), [531](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L531-L542), [544](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L544-L551), [553](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L553-L561)

```solidity
File: src/RootBridgeAgentExecutor.sol

286              hTokens[i] = address(
287                  uint160(
288                      bytes20(
289                          bytes32(
290                              _dParams[
291                                  PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * i) + ADDRESS_END_OFFSET:
292                                      PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * currentIterationOffset)
293                              ]
294                          )
295                      )
296                  )
297:             );

299              tokens[i] = address(
300                  uint160(
301                      bytes20(
302                          bytes32(
303                              _dParams[
304                                  PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (i + numOfAssets) + ADDRESS_END_OFFSET:
305                                      PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (currentIterationOffset + numOfAssets)
306                              ]
307                          )
308                      )
309                  )
310:             );

312              amounts[i] = uint256(
313                  bytes32(
314                      _dParams[
315                          PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets + (PARAMS_ENTRY_SIZE * i):
316                              PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets
317                                  + (PARAMS_ENTRY_SIZE * currentIterationOffset)
318                      ]
319                  )
320:             );

322              deposits[i] = uint256(
323                  bytes32(
324                      _dParams[
325                          PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets + (PARAMS_ENTRY_SIZE * i):
326                              PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets
327                                  + PARAMS_ENTRY_SIZE * currentIterationOffset
328                      ]
329                  )
330:             );

```
*GitHub*: [286](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L286-L297), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L299-L310), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L312-L320), [322](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L322-L330)


### [N&#x2011;65] Contract should expose an `interface`
The `contract`s should expose an `interface` so that other projects can more easily integrate with it, without having to develop their own non-standard variants.

*There are 47 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

69:      function depositToPort(address underlyingAddress, uint256 amount) external payable lock {

79:      function withdrawFromPort(address localAddress, uint256 amount) external payable lock {

```
*GitHub*: [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L69-L69), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L79-L79)

```solidity
File: src/BaseBranchRouter.sol

60:      function initialize(address _localBridgeAgentAddress) external onlyOwner {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L60-L60)

```solidity
File: src/BranchBridgeAgent.sol

149:     receive() external payable {}

161      function getFeeEstimate(uint256 _gasLimit, uint256 _remoteBranchExecutionGas, bytes calldata _payload)
162          external
163          view
164          returns (uint256 _fee)
165:     {

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L149-L149), [161](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L161-L165)

```solidity
File: src/BranchBridgeAgentExecutor.sol

53:      function executeNoSettlement(address _router, bytes calldata _payload) external payable onlyOwner {

66       function executeWithSettlement(address _recipient, address _router, bytes calldata _payload)
67           external
68           payable
69           onlyOwner
70:      {

104      function executeWithSettlementMultiple(address _recipient, address _router, bytes calldata _payload)
105          external
106          payable
107          onlyOwner
108:     {

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L53-L53), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L66-L70), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L104-L108)

```solidity
File: src/BranchPort.sol

122:     function initialize(address _coreBranchRouter, address _bridgeAgentFactory) external virtual onlyOwner {

```
*GitHub*: [122](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L122-L122)

```solidity
File: src/CoreBranchRouter.sol

43       function addGlobalToken(address _globalAddress, uint256 _dstChainId, GasParams[3] calldata _gParams)
44           external
45           payable
46:      {

62:      function addLocalToken(address _underlyingAddress, GasParams calldata _gParams) external payable virtual {

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L43-L46), [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L62-L62)

```solidity
File: src/CoreRootRouter.sol

83:      function initialize(address _bridgeAgentAddress, address _hTokenFactory) external onlyOwner {

103      function addBranchToBridgeAgent(
104          address _rootBridgeAgent,
105          address _branchBridgeAgentFactory,
106          address _newBranchRouter,
107          address _refundee,
108          uint16 _dstChainId,
109          GasParams[2] calldata _gParams
110:     ) external payable {

156      function toggleBranchBridgeAgentFactory(
157          address _rootBridgeAgentFactory,
158          address _branchBridgeAgentFactory,
159          address _refundee,
160          uint16 _dstChainId,
161          GasParams calldata _gParams
162:     ) external payable onlyOwner {

186      function removeBranchBridgeAgent(
187          address _branchBridgeAgent,
188          address _refundee,
189          uint16 _dstChainId,
190          GasParams calldata _gParams
191:     ) external payable onlyOwner {

212      function manageStrategyToken(
213          address _underlyingToken,
214          uint256 _minimumReservesRatio,
215          address _refundee,
216          uint16 _dstChainId,
217          GasParams calldata _gParams
218:     ) external payable onlyOwner {

241      function managePortStrategy(
242          address _portStrategy,
243          address _underlyingToken,
244          uint256 _dailyManagementLimit,
245          bool _isUpdateDailyLimit,
246          address _refundee,
247          uint16 _dstChainId,
248          GasParams calldata _gParams
249:     ) external payable onlyOwner {

270      function setCoreBranch(
271          address _refundee,
272          address _coreBranchRouter,
273          address _coreBranchBridgeAgent,
274          uint16 _dstChainId,
275          GasParams calldata _gParams
276:     ) external payable {

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83-L83), [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L103-L110), [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L156-L162), [186](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L186-L191), [212](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L212-L218), [241](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L241-L249), [270](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L270-L276)

```solidity
File: src/MulticallRootRouter.sol

109:     function initialize(address _bridgeAgentAddress) external onlyOwner {

209:     function executeDepositMultiple(bytes calldata, DepositMultipleParams calldata, uint16) external payable {

```
*GitHub*: [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L109-L109), [209](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L209-L209)

```solidity
File: src/RootBridgeAgent.sol

128:     receive() external payable {}

140      function getFeeEstimate(
141          uint256 _gasLimit,
142          uint256 _remoteBranchExecutionGas,
143          bytes calldata _payload,
144          uint16 _dstChainId
145:     ) external view returns (uint256 _fee) {

274:     function retrieveSettlement(uint32 _settlementNonce, GasParams calldata _gParams) external payable lock {

423:     function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64, bytes calldata _payload) public {

```
*GitHub*: [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L128-L128), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L140-L145), [274](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L274-L274), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L423-L423)

```solidity
File: src/RootBridgeAgentExecutor.sol

50       function executeSystemRequest(address _router, bytes calldata _payload, uint16 _srcChainId)
51           external
52           payable
53           onlyOwner
54:      {

66       function executeNoDeposit(address _router, bytes calldata _payload, uint16 _srcChainId)
67           external
68           payable
69           onlyOwner
70:      {

82       function executeWithDeposit(address _router, bytes calldata _payload, uint16 _srcChainId)
83           external
84           payable
85           onlyOwner
86:      {

115      function executeWithDepositMultiple(address _router, bytes calldata _payload, uint16 _srcChainId)
116          external
117          payable
118          onlyOwner
119:     {

150      function executeSignedNoDeposit(address _account, address _router, bytes calldata _payload, uint16 _srcChainId)
151          external
152          payable
153          onlyOwner
154:     {

167      function executeSignedWithDeposit(address _account, address _router, bytes calldata _payload, uint16 _srcChainId)
168          external
169          payable
170          onlyOwner
171:     {

201      function executeSignedWithDepositMultiple(
202          address _account,
203          address _router,
204          bytes calldata _payload,
205          uint16 _srcChainId
206:     ) external payable onlyOwner {

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L50-L54), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L66-L70), [82](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L82-L86), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L115-L119), [150](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L150-L154), [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L167-L171), [201](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L201-L206)

```solidity
File: src/RootPort.sol

129:     function initialize(address _bridgeAgentFactory, address _coreRootRouter) external onlyOwner {

147      function initializeCore(
148          address _coreRootBridgeAgent,
149          address _coreLocalBranchBridgeAgent,
150          address _localBranchPortAddress
151:     ) external onlyOwner {

221      function isLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
222          external
223          view
224          returns (bool)
225:     {

```
*GitHub*: [129](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L129-L129), [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L147-L151), [221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L221-L225)

```solidity
File: src/VirtualAccount.sol

44:      receive() external payable {}

85:      function payableCall(PayableCall[] calldata calls) public payable returns (bytes[] memory returnData) {

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L44-L44), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L85-L85)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

87:      function initialize(address _coreRootBridgeAgent) external virtual onlyOwner {

115      function createBridgeAgent(
116          address _newBranchRouterAddress,
117          address _rootBridgeAgentAddress,
118          address _rootBridgeAgentFactoryAddress
119:     ) external virtual returns (address newBridgeAgent) {

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L87-L87), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L115-L119)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

60:      function initialize(address _wrappedNativeTokenAddress, address _coreRouter) external onlyOwner {

87:      function getHTokens() external view returns (ERC20hTokenBranch[] memory) {

96       function createToken(string memory _name, string memory _symbol, uint8 _decimals, bool _addPrefix)
97           external
98           requiresCoreRouter
99           returns (ERC20hTokenBranch newToken)
100:     {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L60-L60), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L87-L87), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L96-L100)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

49:      function initialize(address _coreRouter) external onlyOwner {

63:      function getHTokens() external view returns (ERC20hTokenRoot[] memory) {

76       function createToken(string memory _name, string memory _symbol, uint8 _decimals)
77           external
78           requiresCoreRouterOrPort
79           returns (ERC20hTokenRoot newToken)
80:      {

```
*GitHub*: [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L49-L49), [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L63-L63), [76](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L76-L80)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

48:      function createBridgeAgent(address _newRootRouterAddress) external returns (address newBridgeAgent) {

```
*GitHub*: [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L48-L48)

```solidity
File: src/token/ERC20hTokenRoot.sol

57:      function mint(address to, uint256 amount, uint256 chainId) external onlyOwner returns (bool) {

69:      function burn(address from, uint256 amount, uint256 chainId) external onlyOwner {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L57-L57), [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L69-L69)

</details>




### [N&#x2011;66] `else`-block not required
One level of nesting can be removed by not having an `else` block when the `if`-block returns, and `if (foo) { return 1; } else { return 2; }` becomes `if (foo) { return 1; } return 2;`. A following `else if` can become `if`

*There are 2 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

671              if (executionState[nonce] == STATUS_DONE) {
672                  revert AlreadyExecutedTransaction();
673              } else {
674                  //Set settlement to retrieve mode, if not already set.
675                  if (executionState[nonce] == STATUS_READY) executionState[nonce] = STATUS_RETRIEVE;
676                  //Trigger fallback/Retry failed fallback
677                  _performFallbackCall(recipient, nonce);
678:             }

```
*GitHub*: [671](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L671-L678)

```solidity
File: src/RootBridgeAgent.sol

704              if (executionState[_srcChainId][nonce] == STATUS_DONE) {
705                  revert AlreadyExecutedTransaction();
706              } else {
707                  //Set settlement to retrieve mode, if not already set.
708                  if (executionState[_srcChainId][nonce] == STATUS_READY) {
709                      executionState[_srcChainId][nonce] = STATUS_RETRIEVE;
710                  }
711                  //Trigger fallback/Retry failed fallback
712                  _performFallbackCall(
713                      payable(address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED])))), nonce, _srcChainId
714                  );
715:             }

```
*GitHub*: [704](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L704-L715)


### [N&#x2011;67] Missing event and or timelock for critical parameter change
Events help non-contract tools to track changes, and timelocks prevent users from being surprised by changes

*There is one instance of this issue:*

```solidity
File: src/BranchPort.sol

331      function setCoreRouter(address _newCoreRouter) external override requiresCoreRouter {
332          require(coreBranchRouterAddress != address(0), "CoreRouter address is zero");
333          require(_newCoreRouter != address(0), "New CoreRouter address is zero");
334          coreBranchRouterAddress = _newCoreRouter;
335:     }

```
*GitHub*: [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L331-L335)


### [N&#x2011;68] Setters should prevent re-setting of the same value
This especially problematic when the setter also emits the same value, which may be confusing to offline parsers

*There are 11 instances of this issue:*

```solidity
File: src/BranchPort.sol

331      function setCoreRouter(address _newCoreRouter) external override requiresCoreRouter {
332          require(coreBranchRouterAddress != address(0), "CoreRouter address is zero");
333          require(_newCoreRouter != address(0), "New CoreRouter address is zero");
334          coreBranchRouterAddress = _newCoreRouter;
335:     }

362      function addStrategyToken(address _token, uint256 _minimumReservesRatio) external override requiresCoreRouter {
363          if (_minimumReservesRatio >= DIVISIONER || _minimumReservesRatio < MIN_RESERVE_RATIO) {
364              revert InvalidMinimumReservesRatio();
365          }
366  
367          strategyTokens.push(_token);
368          getMinimumTokenReserveRatio[_token] = _minimumReservesRatio;
369          isStrategyToken[_token] = true;
370  
371          emit StrategyTokenAdded(_token, _minimumReservesRatio);
372:     }

382      function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
383          external
384          override
385          requiresCoreRouter
386      {
387          if (!isStrategyToken[_token]) revert UnrecognizedStrategyToken();
388          portStrategies.push(_portStrategy);
389          strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;
390          isPortStrategy[_portStrategy][_token] = true;
391  
392          emit PortStrategyAdded(_portStrategy, _token, _dailyManagementLimit);
393:     }

403      function updatePortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
404          external
405          override
406          requiresCoreRouter
407      {
408          strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;
409  
410          emit PortStrategyUpdated(_portStrategy, _token, _dailyManagementLimit);
411:     }

414      function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent)
415          external
416          override
417          requiresCoreRouter
418      {
419          coreBranchRouterAddress = _coreBranchRouter;
420          isBridgeAgent[_coreBranchBridgeAgent] = true;
421          bridgeAgents.push(_coreBranchBridgeAgent);
422  
423          emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent);
424:     }

```
*GitHub*: [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L331-L335), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L362-L372), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L382-L393), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L403-L411), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L414-L424)

```solidity
File: src/RootPort.sol

239      function setAddresses(
240          address _globalAddress,
241          address _localAddress,
242          address _underlyingAddress,
243          uint256 _srcChainId
244      ) external override requiresCoreRootRouter {
245          if (_globalAddress == address(0)) revert InvalidGlobalAddress();
246          if (_localAddress == address(0)) revert InvalidLocalAddress();
247          if (_underlyingAddress == address(0)) revert InvalidUnderlyingAddress();
248  
249          isGlobalAddress[_globalAddress] = true;
250          getGlobalTokenFromLocal[_localAddress][_srcChainId] = _globalAddress;
251          getLocalTokenFromGlobal[_globalAddress][_srcChainId] = _localAddress;
252          getLocalTokenFromUnderlying[_underlyingAddress][_srcChainId] = _localAddress;
253          getUnderlyingTokenFromLocal[_localAddress][_srcChainId] = _underlyingAddress;
254  
255          emit LocalTokenAdded(_underlyingAddress, _localAddress, _globalAddress, _srcChainId);
256:     }

259      function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId)
260          external
261          override
262          requiresCoreRootRouter
263      {
264          if (_localAddress == address(0)) revert InvalidLocalAddress();
265  
266          getGlobalTokenFromLocal[_localAddress][_srcChainId] = _globalAddress;
267          getLocalTokenFromGlobal[_globalAddress][_srcChainId] = _localAddress;
268  
269          emit GlobalTokenAdded(_localAddress, _globalAddress, _srcChainId);
270:     }

382      function addBridgeAgent(address _manager, address _bridgeAgent) external override requiresBridgeAgentFactory {
383          if (isBridgeAgent[_bridgeAgent]) revert AlreadyAddedBridgeAgent();
384  
385          bridgeAgents.push(_bridgeAgent);
386          getBridgeAgentManager[_bridgeAgent] = _manager;
387          isBridgeAgent[_bridgeAgent] = true;
388  
389          emit BridgeAgentAdded(_bridgeAgent, _manager);
390:     }

438      function addNewChain(
439          address _coreBranchBridgeAgentAddress,
440          uint256 _chainId,
441          string memory _wrappedGasTokenName,
442          string memory _wrappedGasTokenSymbol,
443          uint8 _wrappedGasTokenDecimals,
444          address _newLocalBranchWrappedNativeTokenAddress,
445          address _newUnderlyingBranchWrappedNativeTokenAddress
446      ) external override onlyOwner {
447          // Check if chain already added
448          if (isChainId[_chainId]) revert AlreadyAddedChain();
449  
450          // Create new global token for new chain's wrapped native token
451          address newGlobalToken = address(
452              IERC20hTokenRootFactory(ICoreRootRouter(coreRootRouterAddress).hTokenFactoryAddress()).createToken(
453                  _wrappedGasTokenName, _wrappedGasTokenSymbol, _wrappedGasTokenDecimals
454              )
455          );
456  
457          // Sync new branch bridge agent with root core bridge agent
458          IBridgeAgent(ICoreRootRouter(coreRootRouterAddress).bridgeAgentAddress()).syncBranchBridgeAgent(
459              _coreBranchBridgeAgentAddress, _chainId
460          );
461  
462          // Update State
463  
464          // 1. Add new chain to chainId mapping
465          isChainId[_chainId] = true;
466          // 2. Add new chain to global address mapping
467          isGlobalAddress[newGlobalToken] = true;
468          // 3. Add new branch local token to global token address mapping
469          getGlobalTokenFromLocal[_newLocalBranchWrappedNativeTokenAddress][_chainId] = newGlobalToken;
470          // 4. Add new global token to branch local token address mapping
471          getLocalTokenFromGlobal[newGlobalToken][_chainId] = _newLocalBranchWrappedNativeTokenAddress;
472          // 5. Add new branch underlying token to branch local token address mapping
473          getLocalTokenFromUnderlying[_newUnderlyingBranchWrappedNativeTokenAddress][_chainId] =
474              _newLocalBranchWrappedNativeTokenAddress;
475          // 6. Add new branch local token to branch underlying token address mapping
476          getUnderlyingTokenFromLocal[_newLocalBranchWrappedNativeTokenAddress][_chainId] =
477              _newUnderlyingBranchWrappedNativeTokenAddress;
478  
479          emit NewChainAdded(_chainId);
480:     }

483      function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {
484          // Check if token already added
485          if (isGlobalAddress[_ecoTokenGlobalAddress]) revert AlreadyAddedEcosystemToken();
486  
487          // Check if token is already a underlying token in current chain
488          if (getUnderlyingTokenFromLocal[_ecoTokenGlobalAddress][localChainId] != address(0)) {
489              revert AlreadyAddedEcosystemToken();
490          }
491  
492          // Check if token is already a local branch token in current chain
493          if (getLocalTokenFromUnderlying[_ecoTokenGlobalAddress][localChainId] != address(0)) {
494              revert AlreadyAddedEcosystemToken();
495          }
496  
497          // Update State
498          // 1. Add new global token to global address mapping
499          isGlobalAddress[_ecoTokenGlobalAddress] = true;
500          // 2. Add new branch local token address to global token mapping
501          getGlobalTokenFromLocal[_ecoTokenGlobalAddress][localChainId] = _ecoTokenGlobalAddress;
502          // 3. Add new global token to branch local token address mapping
503          getLocalTokenFromGlobal[_ecoTokenGlobalAddress][localChainId] = _ecoTokenGlobalAddress;
504  
505          emit EcosystemTokenAdded(_ecoTokenGlobalAddress);
506:     }

509      function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {
510          if (_coreRootRouter == address(0)) revert InvalidCoreRootRouter();
511          if (_coreRootBridgeAgent == address(0)) revert InvalidCoreRootBridgeAgent();
512  
513          coreRootRouterAddress = _coreRootRouter;
514          coreRootBridgeAgentAddress = _coreRootBridgeAgent;
515          getBridgeAgentManager[_coreRootBridgeAgent] = owner();
516  
517          emit CoreRootSet(_coreRootRouter, _coreRootBridgeAgent);
518:     }

```
*GitHub*: [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L239-L256), [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L259-L270), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L382-L390), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L438-L480), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483-L506), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509-L518)


### [N&#x2011;69] Polymorphic functions make security audits more time-consuming and error-prone
The instances below point to one of two functions with the same name. Consider naming each function differently, in order to make code navigation and analysis easier.

*There are 6 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

730      function _execute(bool _hasFallbackToggled, uint32 _settlementNonce, address _refundee, bytes memory _calldata)
731          private
732:     {

```
*GitHub*: [730](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L730-L732)

```solidity
File: src/BranchPort.sol

188:     function replenishReserves(address _strategy, address _token) external override lock {

```
*GitHub*: [188](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L188-L188)

```solidity
File: src/RootBridgeAgent.sol

768      function _execute(
769          bool _hasFallbackToggled,
770          uint32 _depositNonce,
771          address _refundee,
772          bytes memory _calldata,
773          uint16 _srcChainId
774:     ) private {

```
*GitHub*: [768](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L768-L774)

```solidity
File: src/RootPort.sol

221      function isLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
222          external
223          view
224          returns (bool)
225:     {

```
*GitHub*: [221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L221-L225)

```solidity
File: src/interfaces/IBranchPort.sol

72:      function replenishReserves(address _strategy, address _token) external;

```
*GitHub*: [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L72-L72)

```solidity
File: src/interfaces/IRootPort.sol

144      function isLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
145          external
146          view
147:         returns (bool);

```
*GitHub*: [144](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L144-L147)


### [N&#x2011;70] Imports could be organized more systematically
The contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.

*There are 4 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

9    import {
10       Deposit,
11       DepositInput,
12       DepositMultipleInput,
13       GasParams,
14       IBranchBridgeAgent,
15       ILayerZeroReceiver,
16       SettlementMultipleParams
17:  } from "./interfaces/IBranchBridgeAgent.sol";

```
*GitHub*: [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L9-L17)

```solidity
File: src/BranchBridgeAgentExecutor.sol

12:  import {SettlementParams, SettlementMultipleParams} from "./interfaces/IBranchBridgeAgent.sol";

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L12-L12)

```solidity
File: src/RootBridgeAgent.sol

14   import {
15       GasParams,
16       DepositParams,
17       DepositMultipleParams,
18       ILayerZeroReceiver,
19       IRootBridgeAgent,
20       Settlement,
21       SettlementInput,
22       SettlementMultipleInput
23:  } from "./interfaces/IRootBridgeAgent.sol";

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L14-L23)

```solidity
File: src/VirtualAccount.sol

10:  import {IERC1155Receiver} from "@openzeppelin/contracts/token/ERC1155/IERC1155Receiver.sol";

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L10-L10)


### [N&#x2011;71] Use the latest solidity (prior to 0.8.20 if on L2s) for deployment
```
When deploying contracts, you should use the latest released version of Solidity. Apart from exceptional cases, only the latest version receives security fixes.
```
https://docs.soliditylang.org/en/v0.8.20/

Since deployed contracts should not use floating pragmas, I've flagged all instances where a version prior to 0.8.19 is allowed by the version pragma

*There are 23 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L2-L2)

```solidity
File: src/ArbitrumBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L3-L3)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L2-L2)

```solidity
File: src/BaseBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L2-L2)

```solidity
File: src/BranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L2-L2)

```solidity
File: src/BranchBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/BranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L3-L3)

```solidity
File: src/CoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L2-L2)

```solidity
File: src/CoreRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouterLibZip.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L2-L2)

```solidity
File: src/RootBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L2-L2)

```solidity
File: src/RootBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/RootPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L3-L3)

```solidity
File: src/VirtualAccount.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L3-L3)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L2-L2)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenBranch.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L2-L2)

</details>




### [N&#x2011;72] Consider moving `msg.sender` checks to a common authorization `modifier`


*There are 7 instances of this issue:*

```solidity
File: src/CoreRootRouter.sol

112          if (msg.sender != IPort(rootPortAddress).getBridgeAgentManager(_rootBridgeAgent)) {
113              revert UnauthorizedCallerNotManager();
114:         }

278:         require(msg.sender == rootPortAddress, "Only root port can call");

```
*GitHub*: [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L112-L114), [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L278-L278)

```solidity
File: src/RootBridgeAgent.sol

248              if (msg.sender != address(IPort(localPortAddress).getUserAccount(settlementReference.owner))) {
249                  revert NotSettlementOwner();
250:             }

286              if (msg.sender != address(IPort(localPortAddress).getUserAccount(settlementOwner))) {
287                  revert NotSettlementOwner();
288:             }

312              if (msg.sender != address(IPort(localPortAddress).getUserAccount(settlementOwner))) {
313                  revert NotSettlementOwner();
314:             }

```
*GitHub*: [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L248-L250), [286](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L286-L288), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L312-L314)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

84           require(
85               msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
86:          );

```
*GitHub*: [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L84-L86)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

120          require(
121              msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
122:         );

```
*GitHub*: [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L120-L122)


### [N&#x2011;73] Non-library/interface files should use fixed compiler versions, not floating ones
Note that some file names may indicate an interface, but actually contain abstract contracts

*There are 23 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L2-L2)

```solidity
File: src/ArbitrumBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L3-L3)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L2-L2)

```solidity
File: src/BaseBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L2-L2)

```solidity
File: src/BranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L2-L2)

```solidity
File: src/BranchBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/BranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L3-L3)

```solidity
File: src/CoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L2-L2)

```solidity
File: src/CoreRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouterLibZip.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L2-L2)

```solidity
File: src/RootBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L2-L2)

```solidity
File: src/RootBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/RootPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L3-L3)

```solidity
File: src/VirtualAccount.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L3-L3)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L2-L2)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenBranch.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L2-L2)

</details>




### [N&#x2011;74] Consider adding emergency-stop functionality
Adding a way to quickly halt protocol functionality in an emergency, rather than having to pause individual contracts one-by-one, will make in-progress hack mitigation faster and much less stressful.

*There are 13 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

25:  contract BaseBranchRouter is IBranchRouter, Ownable {

```
*GitHub*: [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L25-L25)

```solidity
File: src/BranchBridgeAgentExecutor.sol

29:  contract BranchBridgeAgentExecutor is Ownable, BridgeAgentConstants {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L29-L29)

```solidity
File: src/BranchPort.sol

17:  contract BranchPort is Ownable, IBranchPort {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L17-L17)

```solidity
File: src/CoreRootRouter.sol

38   contract CoreRootRouter is IRootRouter, Ownable {
39       /*///////////////////////////////////////////////////////////////
40                       CORE ROOT ROUTER STATE
41       //////////////////////////////////////////////////////////////*/
42   
43:      /// @notice Boolean to indicate if the contract is in set up mode.

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L38-L43)

```solidity
File: src/MulticallRootRouter.sol

57:  contract MulticallRootRouter is IRootRouter, Ownable {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L57-L57)

```solidity
File: src/RootBridgeAgentExecutor.sol

27   contract RootBridgeAgentExecutor is Ownable, BridgeAgentConstants {
28       /*///////////////////////////////////////////////////////////////
29                                   CONSTRUCTOR
30       //////////////////////////////////////////////////////////////*/
31       /**
32        * @notice Constructor for Root Bridge Agent Executor.
33        * @param _rootBridgeAgent the owner of the contract in charge of calling the different execution functions.
34:       */

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L27-L34)

```solidity
File: src/RootPort.sol

16:  contract RootPort is Ownable, IRootPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L16-L16)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

17   contract ArbitrumBranchBridgeAgentFactory is BranchBridgeAgentFactory {
18       /*///////////////////////////////////////////////////////////////
19                                CONSTRUCTOR
20       //////////////////////////////////////////////////////////////*/
21   
22       /**
23        * @notice Constructor for Bridge Agent Factory Contract.
24        *  @param _rootChainId Root Chain Layer Zero Id.
25        *  @param _rootBridgeAgentFactoryAddress Root Bridge Agent Factory Address.
26        *  @param _localCoreBranchRouterAddress Local Core Branch Router Address.
27        *  @param _localPortAddress Local Branch Port Address.
28        *  @param _owner Owner of the contract.
29:       */

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L17-L29)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

19   contract BranchBridgeAgentFactory is Ownable, IBranchBridgeAgentFactory {
20:      /// @notice Local Chain Id.

```
*GitHub*: [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L19-L20)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

12   contract ERC20hTokenBranchFactory is Ownable, IERC20hTokenBranchFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L12-L13)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

12   contract ERC20hTokenRootFactory is Ownable, IERC20hTokenRootFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L12-L13)

```solidity
File: src/token/ERC20hTokenBranch.sol

12:  contract ERC20hTokenBranch is ERC20, Ownable, IERC20hTokenBranch {

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L12-L12)

```solidity
File: src/token/ERC20hTokenRoot.sol

12   contract ERC20hTokenRoot is ERC20, Ownable, IERC20hTokenRoot {
13:      /// @inheritdoc IERC20hTokenRoot

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L12-L13)

</details>




### [N&#x2011;75] NatSpec: Function `@return` is missing


*There are 46 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

/// @audit Missing '@return '
11       function deploy(uint16 _localChainId, address _daoAddress, address _localRouterAddress, address _localPortAddress)
12           external
13:          returns (ArbitrumBranchBridgeAgent)

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L13)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit Missing '@return '
24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27           address _rootBridgeAgentAddress,
28           address _lzEndpointAddress,
29           address _localRouterAddress,
30           address _localPortAddress
31:      ) external returns (BranchBridgeAgent) {

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L31)

```solidity
File: src/BranchBridgeAgentExecutor.sol

/// @audit Missing '@return '
16:      function deploy() external returns (address) {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L16-L16)

```solidity
File: src/MulticallRootRouter.sol

/// @audit Missing '@return blockNumber'
/// @audit Missing '@return returnData'
483      /**
484       *   @notice Function to perform a set of actions on the omnichain environment without using the user's Virtual Acccount.
485       *   @param calls to be executed.
486       *
487       */
488      function _multicall(IMulticall.Call[] memory calls)
489          internal
490:         returns (uint256 blockNumber, bytes[] memory returnData)

/// @audit Missing '@return '
581:     function _decode(bytes calldata data) internal pure virtual returns (bytes memory) {

```
*GitHub*: [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L483-L490), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L483-L490), [581](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L581-L581)

```solidity
File: src/MulticallRootRouterLibZip.sol

/// @audit Missing '@return '
37:      function _decode(bytes calldata data) internal pure override returns (bytes memory) {

```
*GitHub*: [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L37-L37)

```solidity
File: src/RootBridgeAgent.sol

/// @audit Missing '@return _payload'
966      function _createSettlement(
967          uint32 _settlementNonce,
968          address payable _refundee,
969          address _recipient,
970          uint16 _dstChainId,
971          bytes memory _params,
972          address _globalAddress,
973          uint256 _amount,
974          uint256 _deposit,
975          bool _hasFallbackToggled
976:     ) internal returns (bytes memory _payload) {

/// @audit Missing '@return _payload'
1045     function _createSettlementMultiple(
1046         uint32 _settlementNonce,
1047         address payable _refundee,
1048         address _recipient,
1049         uint16 _dstChainId,
1050         address[] memory _globalAddresses,
1051         uint256[] memory _amounts,
1052         uint256[] memory _deposits,
1053         bytes memory _params,
1054         bool _hasFallbackToggled
1055:    ) internal returns (bytes memory _payload) {

```
*GitHub*: [966](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L966-L976), [1045](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1045-L1055)

```solidity
File: src/RootBridgeAgentExecutor.sol

/// @audit Missing '@return '
14:      function deploy(address _rootBridgeAgent) external returns (address) {

/// @audit Missing '@return dParams'
260       *         4. N * 32 bytes for the amount of underlying tokens to be bridged in.
261       *     5. Each of the 4 token related arrays are of length N and start at the following indexes:
262       *         1. PARAMS_TKN_START [hToken address has no offset from token information start].
263       *         2. PARAMS_TKN_START + (PARAMS_ADDRESS_SIZE * N)
264       *         3. PARAMS_TKN_START + (PARAMS_AMT_OFFSET * N)
265       *         4. PARAMS_TKN_START + (PARAMS_DEPOSIT_OFFSET * N)
266       *
267       */
268      function _bridgeInMultiple(address _recipient, bytes calldata _dParams, uint16 _srcChainId)
269          internal
270:         returns (DepositMultipleParams memory dParams)

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L14-L14), [260](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L260-L270)

```solidity
File: src/RootPort.sol

/// @audit Missing '@return '
184      /**
185       * @notice View Function returns Local Token's Local Address on another chain.
186       * @param _localAddress The address of the token in the local chain.
187       * @param _srcChainId The chainId of the chain where the token is deployed.
188       * @param _dstChainId The chainId of the chain for which the token address is requested.
189       */
190      function _getLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
191          internal
192          view
193:         returns (address)

/// @audit Missing '@return newAccount'
355      /**
356       * @notice Creates a new virtual account for a user.
357       * @param _user address of the user to associate a virtual account with.
358       */
359:     function addVirtualAccount(address _user) internal returns (VirtualAccount newAccount) {

```
*GitHub*: [184](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L184-L193), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L355-L359)

```solidity
File: src/VirtualAccount.sol

/// @audit Missing '@return '
147:     function isContract(address addr) internal view returns (bool) {

```
*GitHub*: [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L147-L147)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

/// @audit Missing '@return newBridgeAgent'
74       /**
75        * @notice Creates a new bridge agent for a branch chain.
76        * @param _newBranchRouterAddress Address of the new branch router.
77        * @param _rootBridgeAgentAddress Address of the root bridge agent to connect to.
78        */
79       function createBridgeAgent(
80           address _newBranchRouterAddress,
81           address _rootBridgeAgentAddress,
82           address _rootBridgeAgentFactoryAddress
83:      ) external virtual override returns (address newBridgeAgent) {

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L74-L83)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

/// @audit Missing '@return newBridgeAgent'
110      /**
111       * @notice Creates a new bridge agent for a new branch chain.
112       * @param _newBranchRouterAddress Address of the new branch router.
113       * @param _rootBridgeAgentAddress Address of the root bridge agent to connect to.
114       */
115      function createBridgeAgent(
116          address _newBranchRouterAddress,
117          address _rootBridgeAgentAddress,
118          address _rootBridgeAgentFactoryAddress
119:     ) external virtual returns (address newBridgeAgent) {

```
*GitHub*: [110](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L110-L119)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

/// @audit Missing '@return newToken'
70       /**
71        * @notice Function to create a new hToken.
72        * @param _name Name of the Token.
73        * @param _symbol Symbol of the Token.
74        * @param _decimals Decimals of the Token.
75        */
76       function createToken(string memory _name, string memory _symbol, uint8 _decimals)
77           external
78           requiresCoreRouterOrPort
79:          returns (ERC20hTokenRoot newToken)

```
*GitHub*: [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L70-L79)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit Missing '@return '
104      /**
105       * @notice External function that returns a given deposit entry.
106       *    @param depositNonce Identifier for user deposit.
107       *
108       */
109:     function getDepositEntry(uint32 depositNonce) external view returns (Deposit memory);

/// @audit Missing '@return '
307      /**
308       * @notice Function to request balance clearance from a Port to a given address.
309       *     @param sParams encode packed multiple settlement info.
310       *
311       */
312      function clearTokens(bytes calldata sParams, address recipient)
313          external
314:         returns (SettlementMultipleParams memory);

```
*GitHub*: [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L104-L109), [307](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L307-L314)

```solidity
File: src/interfaces/IBranchRouter.sol

/// @audit Missing '@return '
26       /// @notice External function to return the Branch Chain's Local Port Address.
27:      function localPortAddress() external view returns (address);

/// @audit Missing '@return '
29       /// @notice Address for local Branch Bridge Agent who processes requests and interacts with local port.
30:      function localBridgeAgentAddress() external view returns (address);

/// @audit Missing '@return '
32       /// @notice Local Bridge Agent Executor Address.
33:      function bridgeAgentExecutorAddress() external view returns (address);

/// @audit Missing '@return '
74       /**
75        * @notice External function that returns a given deposit entry.
76        *     @param depositNonce Identifier for user deposit.
77        *
78        */
79:      function getDepositEntry(uint32 depositNonce) external view returns (Deposit memory);

```
*GitHub*: [26](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L26-L27), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L29-L30), [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L32-L33), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L74-L79)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

/// @audit Missing '@return newToken'
17       /**
18        * @notice Function to create a new Branch hToken.
19        * @param _name Name of the Token.
20        * @param _symbol Symbol of the Token.
21        * @param _decimals Decimals of the Token.
22        * @param _addPrefix Boolean to add or not the chain prefix to the token name and symbol.
23        */
24       function createToken(string memory _name, string memory _symbol, uint8 _decimals, bool _addPrefix)
25           external
26:          returns (ERC20hTokenBranch newToken);

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L17-L26)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

/// @audit Missing '@return newToken'
18       /**
19        * @notice Function to create a new hToken.
20        * @param _name Name of the Token.
21        * @param _symbol Symbol of the Token.
22        * @param _decimals Decimals of the Token.
23        */
24       function createToken(string memory _name, string memory _symbol, uint8 _decimals)
25           external
26:          returns (ERC20hTokenRoot newToken);

```
*GitHub*: [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L18-L26)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

/// @audit Missing '@return '
43:      function getInboundNonce(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (uint64);

/// @audit Missing '@return '
47:      function getOutboundNonce(uint16 _dstChainId, address _srcAddress) external view returns (uint64);

/// @audit Missing '@return nativeFee'
/// @audit Missing '@return zroFee'
55       function estimateFees(
56           uint16 _dstChainId,
57           address _userApplication,
58           bytes calldata _payload,
59           bool _payInZRO,
60           bytes calldata _adapterParam
61:      ) external view returns (uint256 nativeFee, uint256 zroFee);

/// @audit Missing '@return '
64:      function getChainId() external view returns (uint16);

/// @audit Missing '@return '
75:      function hasStoredPayload(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (bool);

/// @audit Missing '@return '
79:      function getSendLibraryAddress(address _userApplication) external view returns (address);

/// @audit Missing '@return '
83:      function getReceiveLibraryAddress(address _userApplication) external view returns (address);

/// @audit Missing '@return '
87:      function isSendingPayload() external view returns (bool);

/// @audit Missing '@return '
91:      function isReceivingPayload() external view returns (bool);

/// @audit Missing '@return '
98       function getConfig(uint16 _version, uint16 _chainId, address _userApplication, uint256 _configType)
99           external
100          view
101:         returns (bytes memory);

/// @audit Missing '@return '
105:     function getSendVersion(address _userApplication) external view returns (uint16);

/// @audit Missing '@return '
109:     function getReceiveVersion(address _userApplication) external view returns (uint16);

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L43-L43), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L47-L47), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L61), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L64-L64), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L75-L75), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L79-L79), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L83-L83), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L87-L87), [91](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L91-L91), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L98-L101), [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L105-L105), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L109-L109)

```solidity
File: src/interfaces/IMulticall2.sol

/// @audit Missing '@return blockNumber'
/// @audit Missing '@return returnData'
20:      function aggregate(Call[] memory calls) external returns (uint256 blockNumber, bytes[] memory returnData);

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L20-L20), [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L20-L20)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit Missing '@return '
106      /**
107       * @notice External function that returns a given settlement entry.
108       *   @param _settlementNonce Identifier for token settlement.
109       *
110       */
111:     function getSettlementEntry(uint32 _settlementNonce) external view returns (Settlement memory);

```
*GitHub*: [106](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L106-L111)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

/// @audit Missing '@return newBridgeAgent'
16:      function createBridgeAgent(address newRootRouterAddress) external returns (address newBridgeAgent);

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L16-L16)

```solidity
File: src/interfaces/IRootPort.sol

/// @audit Missing '@return '
11:      function bridgeAgentAddress() external view returns (address);

/// @audit Missing '@return '
12:      function hTokenFactoryAddress() external view returns (address);

/// @audit Missing '@return account'
257      /**
258       * @notice Gets the virtual account given a user address.
259       * @param _user address of the user to get the virtual account for.
260       */
261:     function fetchVirtualAccount(address _user) external returns (VirtualAccount account);

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L12-L12), [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L257-L261)

```solidity
File: src/token/ERC20hTokenRoot.sol

/// @audit Missing '@return '
51       /**
52        * @notice Mints new tokens and updates the total supply for the given chain.
53        * @param to Address to mint tokens to.
54        * @param amount Amount of tokens to mint.
55        * @param chainId Chain Id of the chain to mint tokens to.
56        */
57:      function mint(address to, uint256 amount, uint256 chainId) external onlyOwner returns (bool) {

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L51-L57)

</details>




### [N&#x2011;76] NatSpec: Function `@param` is missing


*There are 111 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

/// @audit Missing '@param _localChainId'
/// @audit Missing '@param _daoAddress'
/// @audit Missing '@param _localRouterAddress'
/// @audit Missing '@param _localPortAddress'
11:      function deploy(uint16 _localChainId, address _daoAddress, address _localRouterAddress, address _localPortAddress)

/// @audit Missing '@param _endpoint'
123      /// @notice Verifies the caller is the Root Bridge Agent.
124      /// @dev Internal function used in modifier to reduce contract bytesize.
125:     function _requiresEndpoint(address _endpoint, bytes calldata) internal view override {

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L11), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L123-L125)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit Missing '@param _rootChainId'
24       function deploy(
25:          uint16 _rootChainId,

/// @audit Missing '@param _localChainId'
24       function deploy(
25           uint16 _rootChainId,
26:          uint16 _localChainId,

/// @audit Missing '@param _rootBridgeAgentAddress'
24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27:          address _rootBridgeAgentAddress,

/// @audit Missing '@param _lzEndpointAddress'
24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27           address _rootBridgeAgentAddress,
28:          address _lzEndpointAddress,

/// @audit Missing '@param _localRouterAddress'
24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27           address _rootBridgeAgentAddress,
28           address _lzEndpointAddress,
29:          address _localRouterAddress,

/// @audit Missing '@param _localPortAddress'
24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27           address _rootBridgeAgentAddress,
28           address _lzEndpointAddress,
29           address _localRouterAddress,
30:          address _localPortAddress

/// @audit Missing '@param _endpoint'
/// @audit Missing '@param _srcAddress'
935      /// @notice Internal function for caller verification. To be overwritten in `ArbitrumBranchBridgeAgent'.
936:     function _requiresEndpoint(address _endpoint, bytes calldata _srcAddress) internal view virtual {

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L25), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L26), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L27), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L28), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L29), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L30), [935](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L935-L936), [935](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L935-L936)

```solidity
File: src/BranchPort.sol

/// @audit Missing '@param _strategyTokenDebt'
430      /**
431       * @notice Returns amount of Strategy Tokens
432       *   @param _token Address of a given Strategy Token.
433       *   @return uint256 excess reserves
434       */
435:     function _excessReserves(uint256 _strategyTokenDebt, address _token) internal view returns (uint256) {

/// @audit Missing '@param _strategyTokenDebt'
/// @audit Missing '@param currBalance'
444      /**
445       * @notice Returns amount of Strategy Tokens needed to reach minimum reserves
446       *   @param _token Address of a given Strategy Token.
447       *   @return uint256 excess reserves
448       */
449:     function _reservesLacking(uint256 _strategyTokenDebt, address _token, uint256 currBalance)

```
*GitHub*: [430](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L430-L435), [444](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L444-L449), [444](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L444-L449)

```solidity
File: src/CoreBranchRouter.sol

/// @audit Missing '@param _decimals'
160       *  @param _symbol token symbol.
161       *  @param _refundee the address of the excess gas receiver.
162       *  @param _gParams Gas parameters for remote execution.
163       *  @dev FUNC ID: 1
164       *  @dev all hTokens have 18 decimals.
165       */
166      function _receiveAddGlobalToken(
167          address _globalAddress,
168          string memory _name,
169          string memory _symbol,
170:         uint8 _decimals,

```
*GitHub*: [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L160-L170)

```solidity
File: src/CoreRootRouter.sol

/// @audit Missing '@param _bridgeAgentAddress'
/// @audit Missing '@param _hTokenFactory'
83:      function initialize(address _bridgeAgentAddress, address _hTokenFactory) external onlyOwner {

/// @audit Missing '@param _rootBridgeAgent'
95       /**
96        * @notice Add a new Chain (Branch Bridge Agent and respective Router) to a Root Bridge Agent.
97        * @param _branchBridgeAgentFactory Address of the branch Bridge Agent Factory.
98        * @param _newBranchRouter Address of the new branch router.
99        * @param _refundee Address of the excess gas receiver.
100       * @param _dstChainId Chain Id of the branch chain where the new Bridge Agent will be deployed.
101       * @param _gParams Gas parameters for remote execution.
102       */
103      function addBranchToBridgeAgent(
104:         address _rootBridgeAgent,

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83-L83), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83-L83), [95](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L95-L104)

```solidity
File: src/MulticallRootRouter.sol

/// @audit Missing '@param gasParams'
505       *  @param depositOut Amount of output hTokens to deposit.
506       *  @param dstChainId Chain Id of the destination chain.
507       */
508      function _approveAndCallOut(
509          address refundee,
510          address recipient,
511          address outputToken,
512          uint256 amountOut,
513          uint256 depositOut,
514          uint16 dstChainId,
515:         GasParams memory gasParams

/// @audit Missing '@param dstChainId'
540       *  @param amountsOut Total amount of tokens to send.
541       *  @param depositsOut Amounts of tokens to withdraw from the destination port.
542       *
543       */
544      function _approveMultipleAndCallOut(
545          address refundee,
546          address recipient,
547          address[] memory outputTokens,
548          uint256[] memory amountsOut,
549          uint256[] memory depositsOut,
550:         uint16 dstChainId,

/// @audit Missing '@param gasParams'
541       *  @param depositsOut Amounts of tokens to withdraw from the destination port.
542       *
543       */
544      function _approveMultipleAndCallOut(
545          address refundee,
546          address recipient,
547          address[] memory outputTokens,
548          uint256[] memory amountsOut,
549          uint256[] memory depositsOut,
550          uint16 dstChainId,
551:         GasParams memory gasParams

/// @audit Missing '@param data'
581:     function _decode(bytes calldata data) internal pure virtual returns (bytes memory) {

```
*GitHub*: [505](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L505-L515), [540](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L540-L550), [541](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L541-L551), [581](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L581-L581)

```solidity
File: src/MulticallRootRouterLibZip.sol

/// @audit Missing '@param _localChainId'
/// @audit Missing '@param _localPortAddress'
/// @audit Missing '@param _multicallAddress'
29:      constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress)

/// @audit Missing '@param data'
37:      function _decode(bytes calldata data) internal pure override returns (bytes memory) {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L29), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L29), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L29), [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L37-L37)

```solidity
File: src/RootBridgeAgent.sol

/// @audit Missing '@param _value'
858          address[] memory _hTokens,
859          address[] memory _tokens,
860          uint256[] memory _amounts,
861          uint256[] memory _deposits,
862          bytes memory _params,
863          uint32 _settlementNonce,
864          address payable _refundee,
865          address _recipient,
866          uint16 _dstChainId,
867          GasParams memory _gParams,
868:         uint256 _value

/// @audit Missing '@param _refundee'
933      /**
934       * @notice Internal function performs call to Layerzero Enpoint Contract for cross-chain messaging.
935       *   @param _depositNonce branch deposit nonce.
936       *   @param _dstChainId Chain ID of destination chain.
937       */
938:     function _performFallbackCall(address payable _refundee, uint32 _depositNonce, uint16 _dstChainId) internal {

```
*GitHub*: [858](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L858-L868), [933](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L933-L938)

```solidity
File: src/RootBridgeAgentExecutor.sol

/// @audit Missing '@param _rootBridgeAgent'
14:      function deploy(address _rootBridgeAgent) external returns (address) {

/// @audit Missing '@param _recipient'
237      /**
238       * @notice Internal function to move assets from branch chain to root omnichain environment.
239       *   @param _dParams Cross-Chain Deposit of Multiple Tokens Params.
240       *   @param _srcChainId chain to bridge from.
241       *
242       */
243:     function _bridgeIn(address _recipient, DepositParams memory _dParams, uint16 _srcChainId) internal {

/// @audit Missing '@param _recipient'
258       *         2. N * 32 bytes for the underlying token address.
259       *         3. N * 32 bytes for the amount of hTokens to be bridged in.
260       *         4. N * 32 bytes for the amount of underlying tokens to be bridged in.
261       *     5. Each of the 4 token related arrays are of length N and start at the following indexes:
262       *         1. PARAMS_TKN_START [hToken address has no offset from token information start].
263       *         2. PARAMS_TKN_START + (PARAMS_ADDRESS_SIZE * N)
264       *         3. PARAMS_TKN_START + (PARAMS_AMT_OFFSET * N)
265       *         4. PARAMS_TKN_START + (PARAMS_DEPOSIT_OFFSET * N)
266       *
267       */
268:     function _bridgeInMultiple(address _recipient, bytes calldata _dParams, uint16 _srcChainId)

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L14-L14), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L237-L243), [258](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L258-L268)

```solidity
File: src/RootPort.sol

/// @audit Missing '@param _to'
/// @audit Missing '@param _hToken'
/// @audit Missing '@param _amount'
304:     function bridgeToLocalBranchFromRoot(address _to, address _hToken, uint256 _amount)

```
*GitHub*: [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L304-L304), [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L304-L304), [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L304-L304)

```solidity
File: src/VirtualAccount.sol

/// @audit Missing '@param addr'
147:     function isContract(address addr) internal view returns (bool) {

```
*GitHub*: [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L147-L147)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

/// @audit Missing '@param _rootBridgeAgentFactoryAddress'
74       /**
75        * @notice Creates a new bridge agent for a branch chain.
76        * @param _newBranchRouterAddress Address of the new branch router.
77        * @param _rootBridgeAgentAddress Address of the root bridge agent to connect to.
78        */
79       function createBridgeAgent(
80           address _newBranchRouterAddress,
81           address _rootBridgeAgentAddress,
82:          address _rootBridgeAgentFactoryAddress

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L74-L82)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

/// @audit Missing '@param _rootBridgeAgentFactoryAddress'
110      /**
111       * @notice Creates a new bridge agent for a new branch chain.
112       * @param _newBranchRouterAddress Address of the new branch router.
113       * @param _rootBridgeAgentAddress Address of the root bridge agent to connect to.
114       */
115      function createBridgeAgent(
116          address _newBranchRouterAddress,
117          address _rootBridgeAgentAddress,
118:         address _rootBridgeAgentFactoryAddress

```
*GitHub*: [110](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L110-L118)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit Missing '@param recipient'
307      /**
308       * @notice Function to request balance clearance from a Port to a given address.
309       *     @param sParams encode packed multiple settlement info.
310       *
311       */
312:     function clearTokens(bytes calldata sParams, address recipient)

```
*GitHub*: [307](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L307-L312)

```solidity
File: src/interfaces/IBranchPort.sol

/// @audit Missing '@param _underlyingAddresses'
96       /**
97        * @notice Setter function to increase local hToken supply.
98        *   @param _recipient hToken receiver.
99        *   @param _localAddresses token addresses.
100       *   @param _amounts amount of tokens.
101       *
102       */
103      function bridgeInMultiple(
104          address _recipient,
105          address[] memory _localAddresses,
106:         address[] memory _underlyingAddresses,

/// @audit Missing '@param _deposits'
98        *   @param _recipient hToken receiver.
99        *   @param _localAddresses token addresses.
100       *   @param _amounts amount of tokens.
101       *
102       */
103      function bridgeInMultiple(
104          address _recipient,
105          address[] memory _localAddresses,
106          address[] memory _underlyingAddresses,
107          uint256[] memory _amounts,
108:         uint256[] memory _deposits

/// @audit Missing '@param _depositor'
111      /**
112       * @notice Setter function to decrease local hToken supply.
113       *   @param _localAddress token address.
114       *   @param _amount amount of tokens.
115       *   @param _deposit amount of underlying tokens.
116       *
117       */
118      function bridgeOut(
119:         address _depositor,

/// @audit Missing '@param _underlyingAddress'
111      /**
112       * @notice Setter function to decrease local hToken supply.
113       *   @param _localAddress token address.
114       *   @param _amount amount of tokens.
115       *   @param _deposit amount of underlying tokens.
116       *
117       */
118      function bridgeOut(
119          address _depositor,
120          address _localAddress,
121:         address _underlyingAddress,

/// @audit Missing '@param _minimumReservesRatio'
177      /**
178       * @notice Adds a new strategy token.
179       * @param _token address of the token to add to the Strategy Tokens
180       */
181:     function addStrategyToken(address _token, uint256 _minimumReservesRatio) external;

/// @audit Missing '@param _token'
/// @audit Missing '@param _dailyManagementLimit'
189      /**
190       * @notice Adds a new Port strategy to the given port
191       * @param _portStrategy address of the bridge agent factory to add to the Port
192       */
193:     function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit) external;

/// @audit Missing '@param _token'
195      /**
196       * @notice Reverts the toggle on the given port strategy. If it's active, it will de-activate it and vice-versa.
197       * @param _portStrategy address of the bridge agent factory to add to the Port
198       */
199:     function togglePortStrategy(address _portStrategy, address _token) external;

```
*GitHub*: [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L96-L106), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L98-L108), [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L111-L119), [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L111-L121), [177](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L177-L181), [189](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L189-L193), [189](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L189-L193), [195](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L195-L199)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

/// @audit Missing '@param _dstChainId'
15       function send(
16:          uint16 _dstChainId,

/// @audit Missing '@param _destination'
15       function send(
16           uint16 _dstChainId,
17:          bytes calldata _destination,

/// @audit Missing '@param _payload'
15       function send(
16           uint16 _dstChainId,
17           bytes calldata _destination,
18:          bytes calldata _payload,

/// @audit Missing '@param _refundAddress'
15       function send(
16           uint16 _dstChainId,
17           bytes calldata _destination,
18           bytes calldata _payload,
19:          address payable _refundAddress,

/// @audit Missing '@param _zroPaymentAddress'
15       function send(
16           uint16 _dstChainId,
17           bytes calldata _destination,
18           bytes calldata _payload,
19           address payable _refundAddress,
20:          address _zroPaymentAddress,

/// @audit Missing '@param _adapterParams'
15       function send(
16           uint16 _dstChainId,
17           bytes calldata _destination,
18           bytes calldata _payload,
19           address payable _refundAddress,
20           address _zroPaymentAddress,
21:          bytes calldata _adapterParams

/// @audit Missing '@param _srcChainId'
31       function receivePayload(
32:          uint16 _srcChainId,

/// @audit Missing '@param _srcAddress'
31       function receivePayload(
32           uint16 _srcChainId,
33:          bytes calldata _srcAddress,

/// @audit Missing '@param _dstAddress'
31       function receivePayload(
32           uint16 _srcChainId,
33           bytes calldata _srcAddress,
34:          address _dstAddress,

/// @audit Missing '@param _nonce'
31       function receivePayload(
32           uint16 _srcChainId,
33           bytes calldata _srcAddress,
34           address _dstAddress,
35:          uint64 _nonce,

/// @audit Missing '@param _gasLimit'
31       function receivePayload(
32           uint16 _srcChainId,
33           bytes calldata _srcAddress,
34           address _dstAddress,
35           uint64 _nonce,
36:          uint256 _gasLimit,

/// @audit Missing '@param _payload'
31       function receivePayload(
32           uint16 _srcChainId,
33           bytes calldata _srcAddress,
34           address _dstAddress,
35           uint64 _nonce,
36           uint256 _gasLimit,
37:          bytes calldata _payload

/// @audit Missing '@param _srcChainId'
/// @audit Missing '@param _srcAddress'
43:      function getInboundNonce(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (uint64);

/// @audit Missing '@param _dstChainId'
/// @audit Missing '@param _srcAddress'
47:      function getOutboundNonce(uint16 _dstChainId, address _srcAddress) external view returns (uint64);

/// @audit Missing '@param _dstChainId'
55       function estimateFees(
56:          uint16 _dstChainId,

/// @audit Missing '@param _userApplication'
55       function estimateFees(
56           uint16 _dstChainId,
57:          address _userApplication,

/// @audit Missing '@param _payload'
55       function estimateFees(
56           uint16 _dstChainId,
57           address _userApplication,
58:          bytes calldata _payload,

/// @audit Missing '@param _payInZRO'
55       function estimateFees(
56           uint16 _dstChainId,
57           address _userApplication,
58           bytes calldata _payload,
59:          bool _payInZRO,

/// @audit Missing '@param _adapterParam'
55       function estimateFees(
56           uint16 _dstChainId,
57           address _userApplication,
58           bytes calldata _payload,
59           bool _payInZRO,
60:          bytes calldata _adapterParam

/// @audit Missing '@param _srcChainId'
/// @audit Missing '@param _srcAddress'
/// @audit Missing '@param _payload'
70:      function retryPayload(uint16 _srcChainId, bytes calldata _srcAddress, bytes calldata _payload) external;

/// @audit Missing '@param _srcChainId'
/// @audit Missing '@param _srcAddress'
75:      function hasStoredPayload(uint16 _srcChainId, bytes calldata _srcAddress) external view returns (bool);

/// @audit Missing '@param _userApplication'
79:      function getSendLibraryAddress(address _userApplication) external view returns (address);

/// @audit Missing '@param _userApplication'
83:      function getReceiveLibraryAddress(address _userApplication) external view returns (address);

/// @audit Missing '@param _version'
/// @audit Missing '@param _chainId'
/// @audit Missing '@param _userApplication'
/// @audit Missing '@param _configType'
98:      function getConfig(uint16 _version, uint16 _chainId, address _userApplication, uint256 _configType)

/// @audit Missing '@param _userApplication'
105:     function getSendVersion(address _userApplication) external view returns (uint16);

/// @audit Missing '@param _userApplication'
109:     function getReceiveVersion(address _userApplication) external view returns (uint16);

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L16), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L17), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L18), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L19), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L20), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L15-L21), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L32), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L33), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L34), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L35), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L36), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L31-L37), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L43-L43), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L43-L43), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L47-L47), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L47-L47), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L56), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L57), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L58), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L59), [55](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L55-L60), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L70-L70), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L70-L70), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L70-L70), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L75-L75), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L75-L75), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L79-L79), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L83-L83), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L98-L98), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L98-L98), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L98-L98), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L98-L98), [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L105-L105), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L109-L109)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

/// @audit Missing '@param _srcChainId'
/// @audit Missing '@param _srcAddress'
/// @audit Missing '@param _nonce'
/// @audit Missing '@param _payload'
11:      function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64 _nonce, bytes calldata _payload) external;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L11-L11)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

/// @audit Missing '@param _version'
/// @audit Missing '@param _chainId'
/// @audit Missing '@param _configType'
/// @audit Missing '@param _config'
11:      function setConfig(uint16 _version, uint16 _chainId, uint256 _configType, bytes calldata _config) external;

/// @audit Missing '@param _version'
15:      function setSendVersion(uint16 _version) external;

/// @audit Missing '@param _version'
19:      function setReceiveVersion(uint16 _version) external;

/// @audit Missing '@param _srcChainId'
/// @audit Missing '@param _srcAddress'
24:      function forceResumeReceive(uint16 _srcChainId, bytes calldata _srcAddress) external;

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L11-L11), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L11-L11), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L15-L15), [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L19-L19), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L24-L24), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L24-L24)

```solidity
File: src/interfaces/IMulticall2.sol

/// @audit Missing '@param calls'
20:      function aggregate(Call[] memory calls) external returns (uint256 blockNumber, bytes[] memory returnData);

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L20-L20)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit Missing '@param _refundee'
160      /**
161       * @notice External function performs call to LayerZero Endpoint Contract for cross-chain messaging.
162       *   @param _recipient address to receive any outstanding gas on the destination chain.
163       *   @param _dstChainId Chain to bridge to.
164       *   @param _params Calldata for function call.
165       *   @param _gParams Gas Parameters for cross-chain message.
166       *   @dev Internal function performs call to LayerZero Endpoint Contract for cross-chain messaging.
167       */
168      function callOut(
169:         address payable _refundee,

```
*GitHub*: [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L160-L169)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

/// @audit Missing '@param newRootRouterAddress'
16:      function createBridgeAgent(address newRootRouterAddress) external returns (address newBridgeAgent);

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L16-L16)

```solidity
File: src/interfaces/IRootPort.sol

/// @audit Missing '@param _refundee'
13       function setCoreBranch(
14:          address _refundee,

/// @audit Missing '@param _coreBranchRouter'
13       function setCoreBranch(
14           address _refundee,
15:          address _coreBranchRouter,

/// @audit Missing '@param _coreBranchBridgeAgent'
13       function setCoreBranch(
14           address _refundee,
15           address _coreBranchRouter,
16:          address _coreBranchBridgeAgent,

/// @audit Missing '@param _dstChainId'
13       function setCoreBranch(
14           address _refundee,
15           address _coreBranchRouter,
16           address _coreBranchBridgeAgent,
17:          uint16 _dstChainId,

/// @audit Missing '@param _gParams'
13       function setCoreBranch(
14           address _refundee,
15           address _coreBranchRouter,
16           address _coreBranchBridgeAgent,
17           uint16 _dstChainId,
18:          GasParams calldata _gParams

/// @audit Missing '@param _underlyingAddress'
232      /**
233       * @notice Setter function to update a Global hToken's Local hToken Address.
234       *   @param _globalAddress new hToken address to update.
235       *   @param _localAddress new underlying/native token address to set.
236       *
237       */
238      function setAddresses(
239          address _globalAddress,
240          address _localAddress,
241:         address _underlyingAddress,

/// @audit Missing '@param _srcChainId'
232      /**
233       * @notice Setter function to update a Global hToken's Local hToken Address.
234       *   @param _globalAddress new hToken address to update.
235       *   @param _localAddress new underlying/native token address to set.
236       *
237       */
238      function setAddresses(
239          address _globalAddress,
240          address _localAddress,
241          address _underlyingAddress,
242:         uint256 _srcChainId

/// @audit Missing '@param _srcChainId'
245      /**
246       * @notice Setter function to update a Global hToken's Local hToken Address.
247       *   @param _globalAddress new hToken address to update.
248       *   @param _localAddress new underlying/native token address to set.
249       *
250       */
251:     function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId) external;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L13-L14), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L13-L15), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L13-L16), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L13-L17), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L13-L18), [232](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L232-L241), [232](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L232-L242), [245](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L245-L251)

```solidity
File: src/token/ERC20hTokenBranch.sol

/// @audit Missing '@param chainName'
13       constructor(
14:          string memory chainName,

/// @audit Missing '@param chainSymbol'
13       constructor(
14           string memory chainName,
15:          string memory chainSymbol,

/// @audit Missing '@param _name'
13       constructor(
14           string memory chainName,
15           string memory chainSymbol,
16:          string memory _name,

/// @audit Missing '@param _symbol'
13       constructor(
14           string memory chainName,
15           string memory chainSymbol,
16           string memory _name,
17:          string memory _symbol,

/// @audit Missing '@param _decimals'
13       constructor(
14           string memory chainName,
15           string memory chainSymbol,
16           string memory _name,
17           string memory _symbol,
18:          uint8 _decimals,

/// @audit Missing '@param _owner'
13       constructor(
14           string memory chainName,
15           string memory chainSymbol,
16           string memory _name,
17           string memory _symbol,
18           uint8 _decimals,
19:          address _owner

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L14), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L15), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L16), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L17), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L18), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L19)

</details>




### [N&#x2011;77] Consider bounding input array length
The functions below take in an unbounded array, and make function calls for entries in the array. While the function will revert if it eventually runs out of gas, it may be a nicer user experience to `require()` that the length of the array is below some reasonable maximum, so that the user doesn't have to use up a full transaction's gas only to see that the transaction reverts.

*There are 7 instances of this issue:*

```solidity
File: src/BaseBranchRouter.sol

192          for (uint256 i = 0; i < _hTokens.length;) {
193              _transferAndApproveToken(_hTokens[i], _tokens[i], _amounts[i], _deposits[i]);
194  
195              unchecked {
196                  ++i;
197              }
198:         }

```
*GitHub*: [192](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L192-L198)

```solidity
File: src/BranchPort.sol

257          for (uint256 i = 0; i < length;) {
258              // Check if hTokens are being bridged in
259              if (_amounts[i] - _deposits[i] > 0) {
260                  unchecked {
261                      _bridgeIn(_recipient, _localAddresses[i], _amounts[i] - _deposits[i]);
262                  }
263              }
264  
265              // Check if underlying tokens are being cleared
266              if (_deposits[i] > 0) {
267                  withdraw(_recipient, _underlyingAddresses[i], _deposits[i]);
268              }
269  
270              unchecked {
271                  ++i;
272              }
273:         }

305          for (uint256 i = 0; i < length;) {
306              _bridgeOut(_depositor, _localAddresses[i], _underlyingAddresses[i], _amounts[i], _deposits[i]);
307  
308              unchecked {
309                  i++;
310              }
311:         }

```
*GitHub*: [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L257-L273), [305](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L305-L311)

```solidity
File: src/MulticallRootRouter.sol

557          for (uint256 i = 0; i < outputTokens.length;) {
558              // Approve Root Port to spend output hTokens.
559              outputTokens[i].safeApprove(_bridgeAgentAddress, amountsOut[i]);
560              unchecked {
561                  ++i;
562              }
563:         }

```
*GitHub*: [557](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L557-L563)

```solidity
File: src/RootBridgeAgent.sol

1070         for (uint256 i = 0; i < hTokens.length;) {
1071             // Populate Addresses for Settlement
1072             hTokens[i] = IPort(localPortAddress).getLocalTokenFromGlobal(_globalAddresses[i], _dstChainId);
1073             tokens[i] = IPort(localPortAddress).getUnderlyingTokenFromLocal(hTokens[i], _dstChainId);
1074 
1075             // Avoid stack too deep
1076             uint16 destChainId = _dstChainId;
1077 
1078             // Update State to reflect bridgeOut
1079             _updateStateOnBridgeOut(
1080                 msg.sender, _globalAddresses[i], hTokens[i], tokens[i], _amounts[i], _deposits[i], destChainId
1081             );
1082 
1083             unchecked {
1084                 ++i;
1085             }
1086:        }

```
*GitHub*: [1070](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1070-L1086)

```solidity
File: src/VirtualAccount.sol

70           for (uint256 i = 0; i < length;) {
71               bool success;
72               Call calldata _call = calls[i];
73   
74               if (isContract(_call.target)) (success, returnData[i]) = _call.target.call(_call.callData);
75   
76               if (!success) revert CallFailed();
77   
78               unchecked {
79                   ++i;
80               }
81:          }

90           for (uint256 i = 0; i < length;) {
91               _call = calls[i];
92               uint256 val = _call.value;
93               // Humanity will be a Type V Kardashev Civilization before this overflows - andreas
94               // ~ 10^25 Wei in existence << ~ 10^76 size uint fits in a uint256
95               unchecked {
96                   valAccumulator += val;
97               }
98   
99               bool success;
100  
101              if (isContract(_call.target)) (success, returnData[i]) = _call.target.call{value: val}(_call.callData);
102  
103              if (!success) revert CallFailed();
104  
105              unchecked {
106                  ++i;
107              }
108:         }

```
*GitHub*: [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L70-L81), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L90-L108)


### [N&#x2011;78] Named imports of parent contracts are missing


*There is one instance of this issue:*

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

/// @audit ILayerZeroUserApplicationConfig
7:   interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7-L7)


### [N&#x2011;79] Complex casting
Consider whether the number of casts is really necessary, or whether using a different type would be more appropriate. Alternatively, add comments to explain in detail why the casts are necessary, and any implicit reasons why the cast does not introduce an overflow.

*There are 59 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

500          // Parse Tokens Length
501:         uint8 numOfAssets = uint8(bytes1(_sParams[0]));

503          // Parse Nonce
504:         uint32 nonce = uint32(bytes4(_sParams[PARAMS_START:PARAMS_TKN_START]));

517              // Parse Params
518              _hTokens[i] = address(
519                  uint160(
520                      bytes20(
521                          bytes32(
522                              _sParams[
523                                  PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * i) + ADDRESS_END_OFFSET:
524                                      PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * currentIterationOffset)
525                              ]
526                          )
527                      )
528                  )
529:             );

530  
531              _tokens[i] = address(
532                  uint160(
533                      bytes20(
534                          bytes32(
535                              _sParams[
536                                  PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (i + numOfAssets) + ADDRESS_END_OFFSET:
537                                      PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (currentIterationOffset + numOfAssets)
538                              ]
539                          )
540                      )
541                  )
542:             );

543  
544              _amounts[i] = uint256(
545                  bytes32(
546                      _sParams[
547                          PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets + PARAMS_ENTRY_SIZE * i:
548                              PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets + PARAMS_ENTRY_SIZE * currentIterationOffset
549                      ]
550                  )
551:             );

552  
553              _deposits[i] = uint256(
554                  bytes32(
555                      _sParams[
556                          PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets + PARAMS_ENTRY_SIZE * i:
557                              PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets
558                                  + PARAMS_ENTRY_SIZE * currentIterationOffset
559                      ]
560                  )
561:             );

682              //Get nonce
683:             nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

664              // Parse recipient
665:             address payable recipient = payable(address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED]))));

667              //Get nonce
668:             nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

639              // Parse recipient
640:             address payable recipient = payable(address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED]))));

642              // Parse deposit nonce
643:             nonce = uint32(bytes4(_payload[22:26]));

617              // Parse recipient
618:             address payable recipient = payable(address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED]))));

620              // Parse Settlement Nonce
621:             nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

600              // Get Settlement Nonce
601:             nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

942          if (_srcAddress.length != 40) revert LayerZeroUnauthorizedCaller();
943:         if (rootBridgeAgentAddress != address(uint160(bytes20(_srcAddress[20:])))) revert LayerZeroUnauthorizedCaller();

```
*GitHub*: [500](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L500-L501), [503](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L503-L504), [517](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L517-L529), [530](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L530-L542), [543](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L543-L551), [552](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L552-L561), [682](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L682-L683), [664](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L664-L665), [667](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L667-L668), [639](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L639-L640), [642](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L642-L643), [617](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L617-L618), [620](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L620-L621), [600](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L600-L601), [942](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L942-L943)

```solidity
File: src/BranchBridgeAgentExecutor.sol

72           SettlementParams memory sParams = SettlementParams({
73:              settlementNonce: uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED])),

74               recipient: _recipient,
75:              hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),

75               hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),
76:              token: address(uint160(bytes20(_payload[45:65]))),

76               token: address(uint160(bytes20(_payload[45:65]))),
77:              amount: uint256(bytes32(_payload[65:97])),

77               amount: uint256(bytes32(_payload[65:97])),
78:              deposit: uint256(bytes32(_payload[97:PARAMS_SETTLEMENT_OFFSET]))

109          // Parse Values
110:         uint256 assetsOffset = uint8(bytes1(_payload[PARAMS_START_SIGNED])) * PARAMS_TKN_SET_SIZE_MULTIPLE;

```
*GitHub*: [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L72-L73), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L74-L75), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L75-L76), [76](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L76-L77), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L77-L78), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L109-L110)

```solidity
File: src/RootBridgeAgent.sol

719              // Parse nonce
720:             nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

700              //Parse deposit nonce
701:             nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

712                  _performFallbackCall(
713:                     payable(address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED])))), nonce, _srcChainId

618              // Parse deposit nonce
619:             nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED + PARAMS_START:PARAMS_START_SIGNED + PARAMS_TKN_START]));

627              VirtualAccount userAccount = IPort(localPortAddress).fetchVirtualAccount(
628:                 address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED])))

641                  nonce,
642:                 address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED]))),

578              // Parse deposit nonce
579:             nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

587              VirtualAccount userAccount = IPort(localPortAddress).fetchVirtualAccount(
588:                 address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED])))

601                  nonce,
602:                 address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED]))),

540              // Parse deposit nonce
541:             nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

549              VirtualAccount userAccount = IPort(localPortAddress).fetchVirtualAccount(
550:                 address(uint160(bytes20(_payload[PARAMS_START:PARAMS_START_SIGNED])))

514              // Parse deposit nonce
515:             nonce = uint32(bytes4(_payload[2:6]));

491              //Parse Deposit Nonce
492:             nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

468              // Parse Deposit Nonce
469:             nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

445              // Parse deposit nonce
446:             nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

1211 
1212:            if (getBranchBridgeAgent[_srcChain] != address(uint160(bytes20(_srcAddress[PARAMS_ADDRESS_SIZE:])))) {

```
*GitHub*: [719](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L719-L720), [700](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L700-L701), [712](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L712-L713), [618](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L618-L619), [627](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L627-L628), [641](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L641-L642), [578](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L578-L579), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L587-L588), [601](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L601-L602), [540](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L540-L541), [549](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L549-L550), [514](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L514-L515), [491](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L491-L492), [468](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L468-L469), [445](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L445-L446), [1211](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1211-L1212)

```solidity
File: src/RootBridgeAgentExecutor.sol

88           DepositParams memory dParams = DepositParams({
89:              depositNonce: uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START])),

89               depositNonce: uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START])),
90:              hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START:PARAMS_TKN_START_SIGNED]))),

90               hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START:PARAMS_TKN_START_SIGNED]))),
91:              token: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),

91               token: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),
92:              amount: uint256(bytes32(_payload[45:77])),

92               amount: uint256(bytes32(_payload[45:77])),
93:              deposit: uint256(bytes32(_payload[77:PARAMS_TKN_SET_SIZE]))

124                  PARAMS_START:
125:                     PARAMS_END_OFFSET + uint256(uint8(bytes1(_payload[PARAMS_START]))) * PARAMS_TKN_SET_SIZE_MULTIPLE

129  
130:         uint256 numOfAssets = uint8(bytes1(_payload[PARAMS_START]));

173          DepositParams memory dParams = DepositParams({
174:             depositNonce: uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED])),

174              depositNonce: uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED])),
175:             hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),

175              hToken: address(uint160(bytes20(_payload[PARAMS_TKN_START_SIGNED:45]))),
176:             token: address(uint160(bytes20(_payload[45:65]))),

176              token: address(uint160(bytes20(_payload[45:65]))),
177:             amount: uint256(bytes32(_payload[65:97])),

177              amount: uint256(bytes32(_payload[65:97])),
178:             deposit: uint256(bytes32(_payload[97:PARAMS_SETTLEMENT_OFFSET]))

212                      PARAMS_END_SIGNED_OFFSET
213:                         + uint256(uint8(bytes1(_payload[PARAMS_START_SIGNED]))) * PARAMS_TKN_SET_SIZE_MULTIPLE

221                  > PARAMS_END_SIGNED_OFFSET
222:                     + uint256(uint8(bytes1(_payload[PARAMS_START_SIGNED]))) * PARAMS_TKN_SET_SIZE_MULTIPLE

227                      PARAMS_END_SIGNED_OFFSET
228:                         + uint256(uint8(bytes1(_payload[PARAMS_START_SIGNED]))) * PARAMS_TKN_SET_SIZE_MULTIPLE:

272          // Parse Parameters
273:         uint8 numOfAssets = uint8(bytes1(_dParams[0]));

273          uint8 numOfAssets = uint8(bytes1(_dParams[0]));
274:         uint32 nonce = uint32(bytes4(_dParams[PARAMS_START:5]));

285              // Parse Params
286              hTokens[i] = address(
287                  uint160(
288                      bytes20(
289                          bytes32(
290                              _dParams[
291                                  PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * i) + ADDRESS_END_OFFSET:
292                                      PARAMS_TKN_START + (PARAMS_ENTRY_SIZE * currentIterationOffset)
293                              ]
294                          )
295                      )
296                  )
297:             );

298  
299              tokens[i] = address(
300                  uint160(
301                      bytes20(
302                          bytes32(
303                              _dParams[
304                                  PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (i + numOfAssets) + ADDRESS_END_OFFSET:
305                                      PARAMS_TKN_START + PARAMS_ENTRY_SIZE * (currentIterationOffset + numOfAssets)
306                              ]
307                          )
308                      )
309                  )
310:             );

311  
312              amounts[i] = uint256(
313                  bytes32(
314                      _dParams[
315                          PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets + (PARAMS_ENTRY_SIZE * i):
316                              PARAMS_TKN_START + PARAMS_AMT_OFFSET * numOfAssets
317                                  + (PARAMS_ENTRY_SIZE * currentIterationOffset)
318                      ]
319                  )
320:             );

321  
322              deposits[i] = uint256(
323                  bytes32(
324                      _dParams[
325                          PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets + (PARAMS_ENTRY_SIZE * i):
326                              PARAMS_TKN_START + PARAMS_DEPOSIT_OFFSET * numOfAssets
327                                  + PARAMS_ENTRY_SIZE * currentIterationOffset
328                      ]
329                  )
330:             );

280  
281:         for (uint256 i = 0; i < uint256(uint8(numOfAssets));) {

```
*GitHub*: [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L88-L89), [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L89-L90), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L90-L91), [91](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L91-L92), [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L92-L93), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L124-L125), [129](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L129-L130), [173](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L173-L174), [174](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L174-L175), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L175-L176), [176](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L176-L177), [177](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L177-L178), [212](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L212-L213), [221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L221-L222), [227](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L227-L228), [272](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L272-L273), [273](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L273-L274), [285](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L285-L297), [298](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L298-L310), [311](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L311-L320), [321](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L321-L330), [280](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L280-L281)


### [N&#x2011;80] Events may be emitted out of order due to reentrancy
Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls

*There are 7 instances of this issue:*

```solidity
File: src/BranchPort.sol

/// @audit withdraw() prior to emission
184:         emit DebtRepaid(msg.sender, _token, _amount);

/// @audit withdraw() prior to emission
218:         emit DebtRepaid(_strategy, _token, amountToWithdraw);

```
*GitHub*: [184](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L184-L184), [218](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L218-L218)

```solidity
File: src/RootBridgeAgent.sol

/// @audit fetchVirtualAccount() prior to emission
736:         emit LogExecute(nonce, _srcChainId);

```
*GitHub*: [736](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L736-L736)

```solidity
File: src/RootPort.sol

/// @audit syncBranchBridgeAgent() prior to emission
406:         emit BridgeAgentSynced(_newBranchBridgeAgent, _rootBridgeAgent, _branchChainId);

/// @audit syncBranchBridgeAgent() prior to emission
479:         emit NewChainAdded(_chainId);

/// @audit syncBranchBridgeAgent() prior to emission
535:         emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent, _dstChainId);

/// @audit syncBranchBridgeAgent() prior to emission
549:         emit CoreBranchSynced(_coreBranchRouter, _coreBranchBridgeAgent, _dstChainId);

```
*GitHub*: [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L406-L406), [479](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L479-L479), [535](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L535-L535), [549](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L549-L549)


### [N&#x2011;81] Non-assembly method available
`assembly{ id := chainid() }` => `uint256 id = block.chainid`, `assembly { size := extcodesize() }` => `uint256 size = address().code.length`, `assembly { hash := extcodehash() }` => `bytes32 hash = address().codehash`
There are some automated tools that will flag a project as having higher complexity if there is inline-assembly, so it's best to avoid using it where it's not necessary

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

149          assembly {
150              size := extcodesize(addr)
151:         }

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L149-L151)


### [N&#x2011;82] Missing checks constructor/initializer assignments
Consider whether reasonable bounds checks for variables would be useful

*There are 9 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

41:          localChainId = _localChainId;

```
*GitHub*: [41](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L41-L41)

```solidity
File: src/CoreRootRouter.sol

72:          rootChainId = _rootChainId;

```
*GitHub*: [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L72-L72)

```solidity
File: src/MulticallRootRouter.sol

96:          localChainId = _localChainId;

```
*GitHub*: [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L96-L96)

```solidity
File: src/RootBridgeAgent.sol

116:         localChainId = _localChainId;

```
*GitHub*: [116](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L116-L116)

```solidity
File: src/RootPort.sol

112:         localChainId = _localChainId;

```
*GitHub*: [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L112-L112)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

46:          localChainId = _localChainId;

```
*GitHub*: [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L46-L46)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

36:          localChainId = _localChainId;

```
*GitHub*: [36](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L36-L36)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

34:          rootChainId = _rootChainId;

```
*GitHub*: [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L34-L34)

```solidity
File: src/token/ERC20hTokenRoot.sol

42:          localChainId = _localChainId;

```
*GitHub*: [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L42-L42)

</details>



## Gas Optimizations


### [G&#x2011;01] Enable IR-based code generation
By using `--via-ir` or `{"viaIR": true}`, the compiler is able to use more advanced [multi-function optimizations](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html#solidity-ir-based-codegen-changes), for extra gas savings.

*There is one instance of this issue:*

```solidity
File: Various Files


```


### [G&#x2011;02] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, where appropriate
Saves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (**20000 gas**) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot. Finally, if both fields are accessed in the same function, can save **~42 gas per access** due to [not having to recalculate the key's keccak256 hash](https://gist.github.com/IllIllI000/ec23a57daa30a8f8ca8b9681c8ccefb0) (Gkeccak256 - 30 gas) and that calculation's associated stack operations.

*There are 5 instances of this issue:*

```solidity
File: src/BranchPort.sol

58        mapping(address token => uint256 debt) public getStrategyTokenDebt;
59    
60        /// @notice Mapping returns the minimum ratio of a given Strategy Token the Port should hold.
61        mapping(address token => uint256 minimumReserveRatio) public getMinimumTokenReserveRatio;
62    
63        /*///////////////////////////////////////////////////////////////
64                            PORT STRATEGIES STATE
65        //////////////////////////////////////////////////////////////*/
66    
67        /// @notice Mapping returns true if Port Strategy is allowed to manage a given Strategy Token.
68:       mapping(address strategy => mapping(address token => bool isActiveStrategy)) public isPortStrategy;

74        mapping(address strategy => mapping(address token => uint256 debt)) public getPortStrategyTokenDebt;
75    
76        /// @notice Mapping returns the last time a given Port Strategy managed a given Strategy Token.
77        mapping(address strategy => mapping(address token => uint256 lastManaged)) public lastManaged;
78    
79        /// @notice Mapping returns the time limit a given Port Strategy must wait before managing a Strategy Token.
80        mapping(address strategy => mapping(address token => uint256 dailyLimitAmount)) public strategyDailyLimitAmount;
81    
82        /// @notice Mapping returns the amount of a Strategy Token a given Port Strategy can manage.
83        mapping(address strategy => mapping(address token => uint256 dailyLimitRemaining)) public
84:           strategyDailyLimitRemaining;

```
*GitHub*: [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L58-L68), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L74-L84)

```solidity
File: src/RootBridgeAgent.sol

62        mapping(uint256 chainId => address branchBridgeAgent) public getBranchBridgeAgent;
63    
64        /// @notice Message Path for each connected Branch Bridge Agent as bytes for Layzer Zero interaction = localAddress + destinationAddress abi.encodePacked()
65        mapping(uint256 chainId => bytes branchBridgeAgentPath) public getBranchBridgeAgentPath;
66    
67        /// @notice If true, bridge agent manager has allowed for a new given branch bridge agent to be synced/added.
68:       mapping(uint256 chainId => bool allowed) public isBranchBridgeAgentAllowed;

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L62-L68)

```solidity
File: src/RootPort.sol

70        mapping(address bridgeAgent => address bridgeAgentManager) public getBridgeAgentManager;
71    
72        /*///////////////////////////////////////////////////////////////
73                        BRIDGE AGENT FACTORIES
74        //////////////////////////////////////////////////////////////*/
75    
76        /// @notice Mapping from Underlying Address to isUnderlying (bool).
77:       mapping(address bridgeAgentFactory => bool isActive) public isBridgeAgentFactory;

87        mapping(address token => bool isGlobalToken) public isGlobalAddress;
88    
89        /// @notice ChainId -> Local Address -> Global Address
90        mapping(address chainId => mapping(uint256 localAddress => address globalAddress)) public getGlobalTokenFromLocal;
91    
92        /// @notice ChainId -> Global Address -> Local Address
93        mapping(address chainId => mapping(uint256 globalAddress => address localAddress)) public getLocalTokenFromGlobal;
94    
95        /// @notice ChainId -> Underlying Address -> Local Address
96        mapping(address chainId => mapping(uint256 underlyingAddress => address localAddress)) public
97            getLocalTokenFromUnderlying;
98    
99        /// @notice Mapping from Local Address to Underlying Address.
100       mapping(address chainId => mapping(uint256 localAddress => address underlyingAddress)) public
101:          getUnderlyingTokenFromLocal;

```
*GitHub*: [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L70-L77), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L87-L101)


### [G&#x2011;03] State variables only set in the constructor should be declared `immutable`
Avoids a Gsset (**20000 gas**) in the constructor, and replaces the first access in each transaction (Gcoldsload - **2100 gas**) and each access thereafter (Gwarmacces - **100 gas**) with a `PUSH32` (**3 gas**). 

While `string`s are not value types, and therefore cannot be `immutable`/`constant` if not hard-coded outside of the constructor, the same behavior can be achieved by making the current contract `abstract` with `virtual` functions for the `string` accessors, and having a child contract override the functions with the hard-coded implementation-specific values.

*There are 3 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit rootBridgeAgentPath (constructor)
142:          rootBridgeAgentPath = abi.encodePacked(_rootBridgeAgentAddress, address(this));

```
*GitHub*: [142](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L142)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit chainName (constructor)
44:           chainName = string.concat(_chainName, " Ulysses");

/// @audit chainSymbol (constructor)
45:           chainSymbol = string.concat(_chainSymbol, "-u");

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L44), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L45)


### [G&#x2011;04] Avoid contract existence checks by using low-level calls
Prior to 0.8.10 the compiler inserted extra code, including `EXTCODESIZE` (**100 gas**), to check for contract existence for external function calls. In more recent solidity versions, the compiler will not insert these checks if the external call has a return value. Similar behavior can be achieved in earlier versions by using low-level calls, since low-level calls never check for contract existence

*There are 52 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

/// @audit getLocalTokenFromUnderlying()
60:           address _globalToken = IRootPort(_rootPortAddress).getLocalTokenFromUnderlying(_underlyingAddress, localChainId);

/// @audit getUnderlyingTokenFromLocal()
87:               IRootPort(_rootPortAddress).getUnderlyingTokenFromLocal(_globalAddress, localChainId);

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L60), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L87)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

/// @audit name()
56:               string.concat("Arbitrum Ulysses ", ERC20(_underlyingAddress).name()),

/// @audit symbol()
57:               string.concat("arb-u", ERC20(_underlyingAddress).symbol()),

/// @audit decimals()
58:               ERC20(_underlyingAddress).decimals()

/// @audit createBridgeAgent()
102:          address newBridgeAgent = IBridgeAgentFactory(_branchBridgeAgentFactory).createBridgeAgent(

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L56), [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L57), [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L58), [102](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L102)

```solidity
File: src/BaseBranchRouter.sol

/// @audit localPortAddress()
63:           localPortAddress = IBridgeAgent(_localBridgeAgentAddress).localPortAddress();

/// @audit bridgeAgentExecutorAddress()
64:           bridgeAgentExecutorAddress = IBridgeAgent(_localBridgeAgentAddress).bridgeAgentExecutorAddress();

```
*GitHub*: [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L63), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L64)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit estimateFees()
166:          (_fee,) = ILayerZeroEndpoint(lzEndpointAddress).estimateFees(

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L166)

```solidity
File: src/BranchBridgeAgentExecutor.sol

/// @audit clearTokens()
114:          SettlementMultipleParams memory sParams = BranchBridgeAgent(payable(msg.sender)).clearTokens(

```
*GitHub*: [114](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L114)

```solidity
File: src/BranchPort.sol

/// @audit balanceOf()
175:          uint256 currBalance = ERC20(_token).balanceOf(address(this));

/// @audit balanceOf()
181:          require(ERC20(_token).balanceOf(address(this)) - currBalance == _amount, "Port Strategy Withdraw Failed");

/// @audit balanceOf()
193:          uint256 currBalance = ERC20(_token).balanceOf(address(this));

/// @audit balanceOf()
214:              ERC20(_token).balanceOf(address(this)) - currBalance == amountToWithdraw, "Port Strategy Withdraw Failed"

/// @audit balanceOf()
436:          uint256 currBalance = ERC20(_token).balanceOf(address(this));

```
*GitHub*: [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L175), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L181), [193](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L193), [214](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L214), [436](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L436)

```solidity
File: src/CoreBranchRouter.sol

/// @audit decimals()
64:           uint8 decimals = ERC20(_underlyingAddress).decimals();

/// @audit createToken()
67:           ERC20hToken newToken = ITokenFactory(hTokenFactoryAddress).createToken(

/// @audit name()
/// @audit symbol()
68:               ERC20(_underlyingAddress).name(), ERC20(_underlyingAddress).symbol(), decimals, true

/// @audit createToken()
175:          ERC20hToken newToken = ITokenFactory(hTokenFactoryAddress).createToken(_name, _symbol, _decimals, false);

/// @audit createBridgeAgent()
216:          address newBridgeAgent = IBridgeAgentFactory(_branchBridgeAgentFactory).createBridgeAgent(

```
*GitHub*: [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L64), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L68), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L68), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L175), [216](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L216)

```solidity
File: src/CoreRootRouter.sol

/// @audit bridgeAgentExecutorAddress()
87:           bridgeAgentExecutorAddress = IBridgeAgent(_bridgeAgentAddress).bridgeAgentExecutorAddress();

/// @audit getBridgeAgentManager()
112:          if (msg.sender != IPort(rootPortAddress).getBridgeAgentManager(_rootBridgeAgent)) {

/// @audit getBranchBridgeAgent()
120:          if (IBridgeAgent(_rootBridgeAgent).getBranchBridgeAgent(_dstChainId) != address(0)) revert InvalidChainId();

/// @audit factoryAddress()
130:              IBridgeAgent(_rootBridgeAgent).factoryAddress(),

/// @audit name()
426:              ERC20(_globalAddress).name(),

/// @audit symbol()
427:              ERC20(_globalAddress).symbol(),

/// @audit decimals()
428:              ERC20(_globalAddress).decimals(),

/// @audit createToken()
466:          address newToken = address(IFactory(hTokenFactoryAddress).createToken(_name, _symbol, _decimals));

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L87), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L112), [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L120), [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L130), [426](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L426), [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L427), [428](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L428), [466](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L466)

```solidity
File: src/MulticallRootRouter.sol

/// @audit bridgeAgentExecutorAddress()
113:          bridgeAgentExecutorAddress = IBridgeAgent(_bridgeAgentAddress).bridgeAgentExecutorAddress();

/// @audit aggregate()
493:          (blockNumber, returnData) = IMulticall(multicallAddress).aggregate(calls);

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L113), [493](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L493)

```solidity
File: src/RootBridgeAgent.sol

/// @audit estimateFees()
146:          (_fee,) = ILayerZeroEndpoint(lzEndpointAddress).estimateFees(

/// @audit getUserAccount()
248:              if (msg.sender != address(IPort(localPortAddress).getUserAccount(settlementReference.owner))) {

/// @audit getUserAccount()
286:              if (msg.sender != address(IPort(localPortAddress).getUserAccount(settlementOwner))) {

/// @audit getUserAccount()
312:              if (msg.sender != address(IPort(localPortAddress).getUserAccount(settlementOwner))) {

/// @audit getLocalTokenFromUnderlying()
371:              if (IPort(_localPortAddress).getLocalTokenFromUnderlying(_dParams.token, _srcChainId) != _dParams.hToken) {

/// @audit excessivelySafeCall()
424:          (bool success,) = address(this).excessivelySafeCall(

/// @audit fetchVirtualAccount()
549:              VirtualAccount userAccount = IPort(localPortAddress).fetchVirtualAccount(

/// @audit fetchVirtualAccount()
587:              VirtualAccount userAccount = IPort(localPortAddress).fetchVirtualAccount(

/// @audit fetchVirtualAccount()
627:              VirtualAccount userAccount = IPort(localPortAddress).fetchVirtualAccount(

/// @audit getUserAccount()
674:                  if (owner != address(IPort(localPortAddress).getUserAccount(settlementReference.owner))) {

/// @audit getLocalTokenFromGlobal()
981:          address localAddress = IPort(localPortAddress).getLocalTokenFromGlobal(_globalAddress, _dstChainId);

/// @audit getUnderlyingTokenFromLocal()
984:          address underlyingAddress = IPort(localPortAddress).getUnderlyingTokenFromLocal(localAddress, _dstChainId);

/// @audit getLocalTokenFromGlobal()
1072:             hTokens[i] = IPort(localPortAddress).getLocalTokenFromGlobal(_globalAddresses[i], _dstChainId);

/// @audit getUnderlyingTokenFromLocal()
1073:             tokens[i] = IPort(localPortAddress).getUnderlyingTokenFromLocal(hTokens[i], _dstChainId);

/// @audit getTokenBalance()
1158:             if (IERC20hTokenRoot(_globalAddress).getTokenBalance(_dstChainId) < _deposit) {

/// @audit getBridgeAgentManager()
1233:         if (msg.sender != IPort(localPortAddress).getBridgeAgentManager(address(this))) {

```
*GitHub*: [146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L146), [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L248), [286](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L286), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L312), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L371), [424](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L424), [549](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L549), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L587), [627](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L627), [674](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L674), [981](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L981), [984](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L984), [1072](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1072), [1073](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1073), [1158](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1158), [1233](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1233)

```solidity
File: src/RootPort.sol

/// @audit getBranchBridgeAgent()
398:          if (IBridgeAgent(_rootBridgeAgent).getBranchBridgeAgent(_branchChainId) != address(0)) {

/// @audit createToken()
452:              IERC20hTokenRootFactory(ICoreRootRouter(coreRootRouterAddress).hTokenFactoryAddress()).createToken(

```
*GitHub*: [398](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L398), [452](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L452)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit name()
66:               ERC20(_wrappedNativeTokenAddress).name(),

/// @audit symbol()
67:               ERC20(_wrappedNativeTokenAddress).symbol(),

/// @audit decimals()
68:               ERC20(_wrappedNativeTokenAddress).decimals(),

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L66), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L68)

</details>




### [G&#x2011;05] State variables should be cached in stack variables rather than re-reading them from storage
The instances below point to the second+ access of a state variable within a function. Caching of a state variable replaces each Gwarmaccess (**100 gas**) with a much cheaper stack read. Other less obvious fixes/optimizations include having local memory caches of state variable structs, or having local caches of state variable contracts/addresses.

*There is one instance of this issue:*

```solidity
File: src/RootPort.sol

/// @audit coreRootRouterAddress on line 452
458:          IBridgeAgent(ICoreRootRouter(coreRootRouterAddress).bridgeAgentAddress()).syncBranchBridgeAgent(

```
*GitHub*: [458](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L458)


### [G&#x2011;06] `internal` functions only called once can be inlined to save gas
Not inlining costs **20 to 40 gas** because of two extra `JUMP` instructions and additional stack operations needed for function calls.

*There are 14 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumCoreBranchRouter.sol

85        function _receiveAddBridgeAgent(
86            address _newBranchRouter,
87            address _branchBridgeAgentFactory,
88            address _rootBridgeAgent,
89            address _rootBridgeAgentFactory,
90            address _refundee,
91:           GasParams memory _gParams

```
*GitHub*: [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L85-L91)

```solidity
File: src/BaseBranchRouter.sol

186       function _transferAndApproveMultipleTokens(
187           address[] memory _hTokens,
188           address[] memory _tokens,
189           uint256[] memory _amounts,
190:          uint256[] memory _deposits

```
*GitHub*: [186](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L186-L190)

```solidity
File: src/BranchPort.sol

435:      function _excessReserves(uint256 _strategyTokenDebt, address _token) internal view returns (uint256) {

449       function _reservesLacking(uint256 _strategyTokenDebt, address _token, uint256 currBalance)
450           internal
451           view
452:          returns (uint256)

485:      function _checkTimeLimit(address _token, uint256 _amount) internal {

```
*GitHub*: [435](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L435), [449](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L449-L452), [485](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L485)

```solidity
File: src/CoreBranchRouter.sol

166       function _receiveAddGlobalToken(
167           address _globalAddress,
168           string memory _name,
169           string memory _symbol,
170           uint8 _decimals,
171           address _refundee,
172:          GasParams memory _gParams

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L166-L172)

```solidity
File: src/CoreRootRouter.sol

406       function _addGlobalToken(
407           address _refundee,
408           address _globalAddress,
409           uint16 _dstChainId,
410:          GasParams[2] memory _gParams

452       function _addLocalToken(
453           address _underlyingAddress,
454           address _localAddress,
455           string memory _name,
456           string memory _symbol,
457           uint8 _decimals,
458:          uint16 _srcChainId

481:      function _setLocalToken(address _globalAddress, address _localAddress, uint16 _dstChainId) internal {

500:      function _syncBranchBridgeAgent(address _newBranchBridgeAgent, address _rootBridgeAgent, uint256 _srcChainId)

```
*GitHub*: [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L406-L410), [452](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L452-L458), [481](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L481), [500](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L500)

```solidity
File: src/MulticallRootRouter.sol

604       function _requiresExecutor() internal view {
605:          if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [604](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L604-L605)

```solidity
File: src/RootBridgeAgent.sol

966       function _createSettlement(
967           uint32 _settlementNonce,
968           address payable _refundee,
969           address _recipient,
970           uint16 _dstChainId,
971           bytes memory _params,
972           address _globalAddress,
973           uint256 _amount,
974           uint256 _deposit,
975           bool _hasFallbackToggled
976:      ) internal returns (bytes memory _payload) {

1045      function _createSettlementMultiple(
1046          uint32 _settlementNonce,
1047          address payable _refundee,
1048          address _recipient,
1049          uint16 _dstChainId,
1050          address[] memory _globalAddresses,
1051          uint256[] memory _amounts,
1052          uint256[] memory _deposits,
1053          bytes memory _params,
1054          bool _hasFallbackToggled
1055:     ) internal returns (bytes memory _payload) {

```
*GitHub*: [966](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L966-L976), [1045](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1045-L1055)

```solidity
File: src/RootPort.sol

359:      function addVirtualAccount(address _user) internal returns (VirtualAccount newAccount) {

```
*GitHub*: [359](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L359)

</details>




### [G&#x2011;07] `<array>.length` should not be looked up in every loop of a `for`-loop
The overheads outlined below are _PER LOOP_, excluding the first loop
* storage arrays incur a Gwarmaccess (**100 gas**)
* memory arrays use `MLOAD` (**3 gas**)
* calldata arrays use `CALLDATALOAD` (**3 gas**)

Caching the length changes each of these to a `DUP<N>` (**3 gas**), and gets rid of the extra `DUP<N>` needed to store the stack offset

*There are 8 instances of this issue:*

```solidity
File: src/BaseBranchRouter.sol

192:          for (uint256 i = 0; i < _hTokens.length;) {

```
*GitHub*: [192](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L192)

```solidity
File: src/BranchBridgeAgent.sol

447:          for (uint256 i = 0; i < deposit.tokens.length;) {

```
*GitHub*: [447](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L447)

```solidity
File: src/MulticallRootRouter.sol

278:              for (uint256 i = 0; i < outputParams.outputTokens.length;) {

367:              for (uint256 i = 0; i < outputParams.outputTokens.length;) {

455:              for (uint256 i = 0; i < outputParams.outputTokens.length;) {

557:          for (uint256 i = 0; i < outputTokens.length;) {

```
*GitHub*: [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L278), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L367), [455](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L455), [557](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L557)

```solidity
File: src/RootBridgeAgent.sol

318:          for (uint256 i = 0; i < settlement.hTokens.length;) {

1070:         for (uint256 i = 0; i < hTokens.length;) {

```
*GitHub*: [318](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L318), [1070](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1070)


### [G&#x2011;08] `require()`/`revert()` strings longer than 32 bytes cost extra gas
Each extra memory word of bytes past the original 32 [incurs an MSTORE](https://gist.github.com/hrkrshnn/ee8fabd532058307229d65dcd5836ddc#consider-having-short-revert-strings) which costs **3 gas**

*There are 22 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

125:          require(_rootBridgeAgentAddress != address(0), "Root Bridge Agent Address cannot be the zero address.");

126           require(
127               _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
128               "Layerzero Endpoint Address cannot be the zero address."
129:          );

130:          require(_localRouterAddress != address(0), "Local Router Address cannot be the zero address.");

131:          require(_localPortAddress != address(0), "Local Port Address cannot be the zero address.");

```
*GitHub*: [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L125), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L126-L129), [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L131)

```solidity
File: src/BranchPort.sol

127:          require(_bridgeAgentFactory != address(0), "BridgeAgentFactory is zero address");

```
*GitHub*: [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L127)

```solidity
File: src/RootBridgeAgent.sol

111:          require(_lzEndpointAddress != address(0), "Layerzero Enpoint Address cannot be zero address");

112:          require(_localPortAddress != address(0), "Port Address cannot be zero address");

113:          require(_localRouterAddress != address(0), "Router Address cannot be zero address");

```
*GitHub*: [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L111), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L112), [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L113)

```solidity
File: src/RootPort.sol

130:          require(_bridgeAgentFactory != address(0), "Bridge Agent Factory cannot be 0 address.");

131:          require(_coreRootRouter != address(0), "Core Root Router cannot be 0 address.");

152:          require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0 address.");

153:          require(_coreLocalBranchBridgeAgent != address(0), "Core Local Branch Bridge Agent cannot be 0 address.");

154:          require(_localBranchPortAddress != address(0), "Local Branch Port Address cannot be 0 address.");

```
*GitHub*: [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L131), [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L152), [153](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L153), [154](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L154)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

57:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent Address cannot be 0");

84            require(
85                msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
86:           );

87            require(
88                _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
89                "Root Bridge Agent Factory Address does not match."
90:           );

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L57), [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L84-L86), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L87-L90)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

61:           require(_rootBridgeAgentFactoryAddress != address(0), "Root Bridge Agent Factory Address cannot be 0");

62            require(
63                _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
64                "Layerzero Endpoint Address cannot be the zero address."
65:           );

66:           require(_localCoreBranchRouterAddress != address(0), "Core Branch Router Address cannot be 0");

88:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0");

120           require(
121               msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
122:          );

123           require(
124               _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
125               "Root Bridge Agent Factory Address does not match."
126:          );

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L61), [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L62-L65), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L66), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L88), [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L120-L122), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L123-L126)


### [G&#x2011;09] Optimize names to save gas
`public`/`external` function names and `public` member variable names can be optimized to save gas. See [this](https://gist.github.com/IllIllI000/a5d8b486a8259f9f77891a919febd1a9) link for an example of how it works. Below are the interfaces/abstract contracts that can be optimized so that the most frequently-called functions use the least amount of gas possible during method lookup. Method IDs that have two leading zero bytes can save **128 gas** each during deployment, and renaming functions to have lower method IDs will save **22 gas** per call, [per sorted position shifted](https://medium.com/joyso/solidity-how-does-function-name-affect-gas-consumption-in-smart-contract-47d270d8ac92)

*There are 24 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

/// @audit depositToPort(), withdrawFromPort()
31:   contract ArbitrumBranchBridgeAgent is BranchBridgeAgent {

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L31)

```solidity
File: src/BranchBridgeAgentExecutor.sol

/// @audit executeNoSettlement(), executeWithSettlement(), executeWithSettlementMultiple()
29:   contract BranchBridgeAgentExecutor is Ownable, BridgeAgentConstants {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L29)

```solidity
File: src/CoreBranchRouter.sol

/// @audit addGlobalToken(), addLocalToken()
18:   contract CoreBranchRouter is ICoreBranchRouter, BaseBranchRouter {

```
*GitHub*: [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L18)

```solidity
File: src/CoreRootRouter.sol

/// @audit initialize(), addBranchToBridgeAgent(), toggleBranchBridgeAgentFactory(), removeBranchBridgeAgent(), manageStrategyToken(), managePortStrategy(), setCoreBranch()
38:   contract CoreRootRouter is IRootRouter, Ownable {

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L38)

```solidity
File: src/MulticallRootRouter.sol

/// @audit initialize(), executeDepositMultiple()
57:   contract MulticallRootRouter is IRootRouter, Ownable {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L57)

```solidity
File: src/RootBridgeAgent.sol

/// @audit getFeeEstimate(), retrieveSettlement(), lzReceive()
32:   contract RootBridgeAgent is IRootBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L32)

```solidity
File: src/RootBridgeAgentExecutor.sol

/// @audit executeSystemRequest(), executeNoDeposit(), executeWithDeposit(), executeWithDepositMultiple(), executeSignedNoDeposit(), executeSignedWithDeposit(), executeSignedWithDepositMultiple()
27:   contract RootBridgeAgentExecutor is Ownable, BridgeAgentConstants {

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L27)

```solidity
File: src/RootPort.sol

/// @audit initialize(), initializeCore(), isLocalToken()
16:   contract RootPort is Ownable, IRootPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L16)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

/// @audit initialize(), createBridgeAgent()
19:   contract BranchBridgeAgentFactory is Ownable, IBranchBridgeAgentFactory {

```
*GitHub*: [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L19)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit initialize(), getHTokens(), createToken()
12:   contract ERC20hTokenBranchFactory is Ownable, IERC20hTokenBranchFactory {

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L12)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

/// @audit initialize(), getHTokens(), createToken()
12:   contract ERC20hTokenRootFactory is Ownable, IERC20hTokenRootFactory {

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L12)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

/// @audit depositToPort(), withdrawFromPort()
16:   interface IArbitrumBranchPort is IBranchPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L16)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit localPortAddress(), bridgeAgentExecutorAddress(), getDepositEntry(), getFeeEstimate(), callOutSystem(), callOut(), callOutAndBridge(), callOutAndBridgeMultiple(), callOutSigned(), callOutSignedAndBridge(), callOutSignedAndBridgeMultiple(), retryDeposit(), retrieveDeposit(), redeemDeposit(), retrySettlement(), clearToken(), clearTokens(), lzReceiveNonBlocking()
87:   interface IBranchBridgeAgent is ILayerZeroReceiver {

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L87)

```solidity
File: src/interfaces/IBranchPort.sol

/// @audit isBridgeAgent(), isStrategyToken(), isPortStrategy(), isBridgeAgentFactory(), manage(), replenishReserves(), replenishReserves(), withdraw(), bridgeIn(), bridgeInMultiple(), bridgeOut(), bridgeOutMultiple(), addBridgeAgent(), setCoreRouter(), addBridgeAgentFactory(), toggleBridgeAgentFactory(), toggleBridgeAgent(), addStrategyToken(), toggleStrategyToken(), addPortStrategy(), togglePortStrategy(), updatePortStrategy(), setCoreBranchRouter()
14:   interface IBranchPort {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L14)

```solidity
File: src/interfaces/IBranchRouter.sol

/// @audit localPortAddress(), localBridgeAgentAddress(), bridgeAgentExecutorAddress(), callOut(), callOutAndBridge(), callOutAndBridgeMultiple(), getDepositEntry(), executeNoSettlement(), executeSettlement(), executeSettlementMultiple()
21:   interface IBranchRouter {

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L21)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

/// @audit addGlobalToken(), addLocalToken()
27:   interface ICoreBranchRouter {

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L27)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

/// @audit localChainId(), factoryAddress(), getTokenBalance(), burn()
12:   interface IERC20hTokenRoot {

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L12)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

/// @audit send(), receivePayload(), getInboundNonce(), getOutboundNonce(), estimateFees(), getChainId(), retryPayload(), hasStoredPayload(), getSendLibraryAddress(), getReceiveLibraryAddress(), isSendingPayload(), isReceivingPayload(), getConfig(), getSendVersion(), getReceiveVersion()
7:    interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

/// @audit setConfig(), setSendVersion(), setReceiveVersion(), forceResumeReceive()
5:    interface ILayerZeroUserApplicationConfig {

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit settlementNonce(), getSettlementEntry(), bridgeAgentExecutorAddress(), factoryAddress(), getBranchBridgeAgent(), isBranchBridgeAgentAllowed(), getFeeEstimate(), callOut(), callOutAndBridge(), callOutAndBridgeMultiple(), retrySettlement(), retrieveSettlement(), redeemSettlement(), bridgeIn(), bridgeInMultiple(), lzReceiveNonBlocking(), approveBranchBridgeAgent(), syncBranchBridgeAgent()
94:   interface IRootBridgeAgent is ILayerZeroReceiver {

```
*GitHub*: [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L94)

```solidity
File: src/interfaces/IRootPort.sol

/// @audit bridgeAgentAddress(), hTokenFactoryAddress(), setCoreBranch()
10:   interface ICoreRootRouter {

/// @audit isChainId(), getBridgeAgentManager(), isBridgeAgentFactory(), isGlobalAddress(), getGlobalTokenFromLocal(), getLocalTokenFromGlobal(), getLocalTokenFromUnderlying(), getLocalToken(), getUnderlyingTokenFromLocal(), getUnderlyingTokenFromGlobal(), isGlobalToken(), isLocalToken(), isLocalToken(), isUnderlyingToken(), getUserAccount(), isRouterApproved(), bridgeToRoot(), bridgeToRootFromLocalBranch(), bridgeToLocalBranchFromRoot(), mintToLocalBranch(), burnFromLocalBranch(), setAddresses(), setLocalAddress(), fetchVirtualAccount(), toggleVirtualAccountApproved(), syncBranchBridgeAgentWithRoot(), addBridgeAgent(), toggleBridgeAgent(), addBridgeAgentFactory(), toggleBridgeAgentFactory(), addNewChain(), addEcosystemToken(), setCoreRootRouter(), setCoreBranchRouter(), syncNewCoreBranchRouter()
31:   interface IRootPort {

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L10), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L31)

```solidity
File: src/interfaces/IRootRouter.sol

/// @audit executeResponse(), execute(), executeDepositSingle(), executeDepositMultiple(), executeSigned(), executeSignedDepositSingle(), executeSignedDepositMultiple()
14:   interface IRootRouter {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L14)

```solidity
File: src/interfaces/IVirtualAccount.sol

/// @audit userAddress(), localPortAddress(), withdrawNative(), withdrawERC20(), withdrawERC721(), call(), payableCall()
27:   interface IVirtualAccount is IERC721Receiver {

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L27)

</details>




### [G&#x2011;10] `++i` costs less gas than `i++`, especially when it's used in `for`-loops (`--i`/`i--` too)
Saves **5 gas per loop**

*There is one instance of this issue:*

```solidity
File: src/BranchPort.sol

309:                  i++;

```
*GitHub*: [309](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L309)


### [G&#x2011;11] Usage of `uints`/`ints` smaller than 32 bytes (256 bits) incurs overhead
> When using elements that are smaller than 32 bytes, your contract’s gas usage may be higher. This is because the EVM operates on 32 bytes at a time. Therefore, if the element is smaller than that, the EVM must use more operations in order to reduce the size of the element from 32 bytes to the desired size.

https://docs.soliditylang.org/en/v0.8.11/internals/layout_in_storage.html
Each operation involving a `uint8` costs an extra [**22-28 gas**](https://gist.github.com/IllIllI000/9388d20c70f9a4632eb3ca7836f54977) (depending on whether the other operand is also a variable of type `uint8`) as compared to ones involving `uint256`, due to the compiler having to clear the higher bits of the memory word before operating on the `uint8`, as well as the associated stack operations of doing so. Use a larger size then downcast where needed

*There are 21 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit uint32 depositNonce
140:          depositNonce = 1;

/// @audit uint32 nonce
601:              nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

/// @audit uint32 nonce
621:              nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

/// @audit uint32 nonce
643:              nonce = uint32(bytes4(_payload[22:26]));

/// @audit uint32 nonce
668:              nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

/// @audit uint32 nonce
683:              nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

/// @audit uint32 depositNonce
821:          depositNonce = _depositNonce + 1;

/// @audit uint32 depositNonce
875:          depositNonce = _depositNonce + 1;

```
*GitHub*: [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L140), [601](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L601), [621](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L621), [643](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L643), [668](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L668), [683](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L683), [821](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L821), [875](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L875)

```solidity
File: src/RootBridgeAgent.sol

/// @audit uint32 settlementNonce
121:          settlementNonce = 1;

/// @audit uint32 nonce
446:              nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

/// @audit uint32 nonce
469:              nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

/// @audit uint32 nonce
492:              nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

/// @audit uint32 nonce
515:              nonce = uint32(bytes4(_payload[2:6]));

/// @audit uint32 nonce
541:              nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

/// @audit uint32 nonce
579:              nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

/// @audit uint32 nonce
619:              nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED + PARAMS_START:PARAMS_START_SIGNED + PARAMS_TKN_START]));

/// @audit uint32 nonce
701:              nonce = uint32(bytes4(_payload[PARAMS_START_SIGNED:PARAMS_TKN_START_SIGNED]));

/// @audit uint32 nonce
720:              nonce = uint32(bytes4(_payload[PARAMS_START:PARAMS_TKN_START]));

/// @audit uint32 settlementNonce
978:          settlementNonce = _settlementNonce + 1;

/// @audit uint32 settlementNonce
1064:         settlementNonce = _settlementNonce + 1;

```
*GitHub*: [121](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L121), [446](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L446), [469](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L469), [492](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L492), [515](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L515), [541](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L541), [579](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L579), [619](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L619), [701](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L701), [720](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L720), [978](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L978), [1064](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1064)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit uint24 localChainId
46:           localChainId = _localChainId;

```
*GitHub*: [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L46)


### [G&#x2011;12] Using `private` rather than `public` for constants, saves gas
If needed, the values can be read from the verified contract source code, or if there are multiple values there can be a single getter function that [returns a tuple](https://github.com/code-423n4/2022-08-frax/blob/90f55a9ce4e25bceed3a74290b854341d8de6afa/src/contracts/FraxlendPair.sol#L156-L178) of the values of all currently-public constants. Saves **3406-3606 gas** in deployment gas due to the compiler not having to create non-payable getter functions for deployment calldata, not having to store the bytes of the value outside of where it's used, and not adding another entry to the method ID table

*There are 12 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

22:       uint16 public immutable localChainId;

```
*GitHub*: [22](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L22)

```solidity
File: src/BranchBridgeAgent.sol

53:       uint16 public immutable rootChainId;

56:       uint16 public immutable localChainId;

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L53), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L56)

```solidity
File: src/CoreRootRouter.sol

47:       uint256 public immutable rootChainId;

```
*GitHub*: [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L47)

```solidity
File: src/MulticallRootRouter.sol

65:       uint256 public immutable localChainId;

```
*GitHub*: [65](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L65)

```solidity
File: src/RootBridgeAgent.sol

40:       uint16 public immutable localChainId;

```
*GitHub*: [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L40)

```solidity
File: src/RootPort.sol

34:       uint256 public immutable localChainId;

```
*GitHub*: [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L34)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

21:       uint16 public immutable localChainId;

24:       uint16 public immutable rootChainId;

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L21), [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L24)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

14:       uint24 public immutable localChainId;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L14)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

14:       uint16 public immutable localChainId;

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L14)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

13:       uint16 public immutable rootChainId;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L13)

</details>




### [G&#x2011;13] Inverting the condition of an `if`-`else`-statement wastes gas
Flipping the `true` and `false` blocks instead saves ***[3 gas](https://gist.github.com/IllIllI000/44da6fbe9d12b9ab21af82f14add56b9)***

*There is one instance of this issue:*

```solidity
File: src/CoreBranchRouter.sol

317           if (!IPort(_localPortAddress).isPortStrategy(_portStrategy, _underlyingToken)) {
318               // If Port Strategy is not active, add new Port Strategy.
319               IPort(_localPortAddress).addPortStrategy(_portStrategy, _underlyingToken, _dailyManagementLimit);
320           } else if (_isUpdateDailyLimit) {
321               // Or update daily limit.
322               IPort(_localPortAddress).updatePortStrategy(_portStrategy, _underlyingToken, _dailyManagementLimit);
323           } else {
324               // Or Toggle Port Strategy.
325               IPort(_localPortAddress).togglePortStrategy(_portStrategy, _underlyingToken);
326:          }

```
*GitHub*: [317](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L317-L326)


### [G&#x2011;14] `require()` or `revert()` statements that check input arguments should be at the top of the function
Checks that involve constants should come before checks that involve state variables, function calls, and calculations. By doing these checks first, the function is able to revert before wasting a Gcoldsload (**2100 gas***) in a function that may ultimately revert in the unhappy case.

*There are 11 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit expensive op on line 127
130:          require(_localRouterAddress != address(0), "Local Router Address cannot be the zero address.");

/// @audit expensive op on line 127
131:          require(_localPortAddress != address(0), "Local Port Address cannot be the zero address.");

```
*GitHub*: [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L131)

```solidity
File: src/BranchPort.sol

/// @audit expensive op on line 124
126:          require(_coreBranchRouter != address(0), "CoreBranchRouter is zero address");

/// @audit expensive op on line 124
127:          require(_bridgeAgentFactory != address(0), "BridgeAgentFactory is zero address");

/// @audit expensive op on line 178
181:          require(ERC20(_token).balanceOf(address(this)) - currBalance == _amount, "Port Strategy Withdraw Failed");

/// @audit expensive op on line 332
333:          require(_newCoreRouter != address(0), "New CoreRouter address is zero");

```
*GitHub*: [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L126), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L127), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L181), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L333)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

/// @audit expensive op on line 85
87            require(
88                _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
89                "Root Bridge Agent Factory Address does not match."
90:           );

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L87-L90)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

/// @audit expensive op on line 63
66:           require(_localCoreBranchRouterAddress != address(0), "Core Branch Router Address cannot be 0");

/// @audit expensive op on line 63
67:           require(_localPortAddress != address(0), "Port Address cannot be 0");

/// @audit expensive op on line 63
68:           require(_owner != address(0), "Owner cannot be 0");

/// @audit expensive op on line 121
123           require(
124               _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
125               "Root Bridge Agent Factory Address does not match."
126:          );

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L66), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L68), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L123-L126)


### [G&#x2011;15] Use custom errors rather than `revert()`/`require()` strings to save gas
Custom errors are available from solidity version 0.8.4. Custom errors save [**~50 gas**](https://gist.github.com/IllIllI000/ad1bd0d29a0101b25e57c293b4b0c746) each time they're hit by [avoiding having to allocate and store the revert string](https://blog.soliditylang.org/2021/04/21/custom-errors/#errors-in-depth). Not defining the strings also save deployment gas

*There are 49 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

39:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L39)

```solidity
File: src/BaseBranchRouter.sol

61:           require(_localBridgeAgentAddress != address(0), "Bridge Agent address cannot be 0");

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L61)

```solidity
File: src/BranchBridgeAgent.sol

125:          require(_rootBridgeAgentAddress != address(0), "Root Bridge Agent Address cannot be the zero address.");

126           require(
127               _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
128               "Layerzero Endpoint Address cannot be the zero address."
129:          );

130:          require(_localRouterAddress != address(0), "Local Router Address cannot be the zero address.");

131:          require(_localPortAddress != address(0), "Local Port Address cannot be the zero address.");

```
*GitHub*: [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L125), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L126-L129), [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L131)

```solidity
File: src/BranchPort.sol

109:          require(_owner != address(0), "Owner is zero address");

123:          require(coreBranchRouterAddress == address(0), "Contract already initialized");

124:          require(!isBridgeAgentFactory[_bridgeAgentFactory], "Contract already initialized");

126:          require(_coreBranchRouter != address(0), "CoreBranchRouter is zero address");

127:          require(_bridgeAgentFactory != address(0), "BridgeAgentFactory is zero address");

181:          require(ERC20(_token).balanceOf(address(this)) - currBalance == _amount, "Port Strategy Withdraw Failed");

213           require(
214               ERC20(_token).balanceOf(address(this)) - currBalance == amountToWithdraw, "Port Strategy Withdraw Failed"
215:          );

332:          require(coreBranchRouterAddress != address(0), "CoreRouter address is zero");

333:          require(_newCoreRouter != address(0), "New CoreRouter address is zero");

```
*GitHub*: [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L109), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L123), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L124), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L126), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L127), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L181), [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L213-L215), [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L332), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L333)

```solidity
File: src/CoreRootRouter.sol

84:           require(_setup, "Contract is already initialized");

278:          require(msg.sender == rootPortAddress, "Only root port can call");

```
*GitHub*: [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L84), [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L278)

```solidity
File: src/MulticallRootRouter.sol

93:           require(_localPortAddress != address(0), "Local Port Address cannot be 0");

94:           require(_multicallAddress != address(0), "Multicall Address cannot be 0");

110:          require(_bridgeAgentAddress != address(0), "Bridge Agent Address cannot be 0");

```
*GitHub*: [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L93), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L94), [110](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L110)

```solidity
File: src/RootBridgeAgent.sol

111:          require(_lzEndpointAddress != address(0), "Layerzero Enpoint Address cannot be zero address");

112:          require(_localPortAddress != address(0), "Port Address cannot be zero address");

113:          require(_localRouterAddress != address(0), "Router Address cannot be zero address");

```
*GitHub*: [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L111), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L112), [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L113)

```solidity
File: src/RootPort.sol

130:          require(_bridgeAgentFactory != address(0), "Bridge Agent Factory cannot be 0 address.");

131:          require(_coreRootRouter != address(0), "Core Root Router cannot be 0 address.");

132:          require(_setup, "Setup ended.");

152:          require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0 address.");

153:          require(_coreLocalBranchBridgeAgent != address(0), "Core Local Branch Bridge Agent cannot be 0 address.");

154:          require(_localBranchPortAddress != address(0), "Local Branch Port Address cannot be 0 address.");

155:          require(isBridgeAgent[_coreRootBridgeAgent], "Core Bridge Agent doesn't exist.");

156:          require(_setupCore, "Core Setup ended.");

```
*GitHub*: [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L131), [132](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L132), [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L152), [153](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L153), [154](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L154), [155](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L155), [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L156)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

57:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent Address cannot be 0");

84            require(
85                msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
86:           );

87            require(
88                _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
89                "Root Bridge Agent Factory Address does not match."
90:           );

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L57), [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L84-L86), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L87-L90)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

61:           require(_rootBridgeAgentFactoryAddress != address(0), "Root Bridge Agent Factory Address cannot be 0");

62            require(
63                _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
64                "Layerzero Endpoint Address cannot be the zero address."
65:           );

66:           require(_localCoreBranchRouterAddress != address(0), "Core Branch Router Address cannot be 0");

67:           require(_localPortAddress != address(0), "Port Address cannot be 0");

68:           require(_owner != address(0), "Owner cannot be 0");

88:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0");

120           require(
121               msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
122:          );

123           require(
124               _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
125               "Root Bridge Agent Factory Address does not match."
126:          );

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L61), [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L62-L65), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L66), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L68), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L88), [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L120-L122), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L123-L126)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

43:           require(_localPortAddress != address(0), "Port address cannot be 0");

61:           require(_coreRouter != address(0), "CoreRouter address cannot be 0");

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L43), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L61)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

35:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

50:           require(_coreRouter != address(0), "CoreRouter address cannot be 0");

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L35), [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L50)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

32:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L32)

```solidity
File: src/token/ERC20hTokenRoot.sol

39:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

40:           require(_factoryAddress != address(0), "Factory Address cannot be 0");

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L39), [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L40)

</details>




### [G&#x2011;16] Functions guaranteed to revert when called by normal users can be marked `payable`
If a function modifier such as `onlyOwner` is used, the function will revert if a normal user tries to pay the function. Marking the function as `payable` will lower the gas cost for legitimate callers because the compiler will not include checks for whether a payment was provided. The extra opcodes avoided are 
`CALLVALUE`(2),`DUP1`(3),`ISZERO`(3),`PUSH2`(3),`JUMPI`(10),`PUSH1`(3),`DUP1`(3),`REVERT`(0),`JUMPDEST`(1),`POP`(2), which costs an average of about **21 gas per call** to the function, in addition to the extra deployment cost

*There are 21 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

60:       function initialize(address _localBridgeAgentAddress) external onlyOwner {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L60)

```solidity
File: src/BranchPort.sol

122:      function initialize(address _coreBranchRouter, address _bridgeAgentFactory) external virtual onlyOwner {

```
*GitHub*: [122](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L122)

```solidity
File: src/CoreRootRouter.sol

83:       function initialize(address _bridgeAgentAddress, address _hTokenFactory) external onlyOwner {

```
*GitHub*: [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L83)

```solidity
File: src/MulticallRootRouter.sol

109:      function initialize(address _bridgeAgentAddress) external onlyOwner {

```
*GitHub*: [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L109)

```solidity
File: src/RootPort.sol

129:      function initialize(address _bridgeAgentFactory, address _coreRootRouter) external onlyOwner {

147       function initializeCore(
148           address _coreRootBridgeAgent,
149           address _coreLocalBranchBridgeAgent,
150           address _localBranchPortAddress
151:      ) external onlyOwner {

414:      function toggleBridgeAgent(address _bridgeAgent) external override onlyOwner {

421:      function addBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

431:      function toggleBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

438       function addNewChain(
439           address _coreBranchBridgeAgentAddress,
440           uint256 _chainId,
441           string memory _wrappedGasTokenName,
442           string memory _wrappedGasTokenSymbol,
443           uint8 _wrappedGasTokenDecimals,
444           address _newLocalBranchWrappedNativeTokenAddress,
445           address _newUnderlyingBranchWrappedNativeTokenAddress
446:      ) external override onlyOwner {

483:      function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {

509:      function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {

539       function syncNewCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent, uint16 _dstChainId)
540           external
541           override
542:          onlyOwner

```
*GitHub*: [129](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L129), [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L147-L151), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L414), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L421), [431](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L431), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L438-L446), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L539-L542)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

56:       function initialize(address _coreRootBridgeAgent) external override onlyOwner {

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L56)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

87:       function initialize(address _coreRootBridgeAgent) external virtual onlyOwner {

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L87)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

60:       function initialize(address _wrappedNativeTokenAddress, address _coreRouter) external onlyOwner {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L60)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

49:       function initialize(address _coreRouter) external onlyOwner {

```
*GitHub*: [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L49)

```solidity
File: src/token/ERC20hTokenBranch.sol

29:       function mint(address account, uint256 amount) external override onlyOwner returns (bool) {

35:       function burn(uint256 amount) public override onlyOwner {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L29), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L35)

```solidity
File: src/token/ERC20hTokenRoot.sol

57:       function mint(address to, uint256 amount, uint256 chainId) external onlyOwner returns (bool) {

69:       function burn(address from, uint256 amount, uint256 chainId) external onlyOwner {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L57), [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L69)

</details>




### [G&#x2011;17] Constructors can be marked `payable`
Payable functions cost less gas to execute, since the compiler does not have to add extra checks to ensure that a payment wasn't provided. A constructor can safely be marked as payable, since only the deployer would be able to pass funds, and the project itself would not pass any funds.

*There are 22 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

43        constructor(
44            uint16 _localChainId,
45            address _rootBridgeAgentAddress,
46            address _localRouterAddress,
47            address _localPortAddress
48        )
49            BranchBridgeAgent(
50                _localChainId,
51                _localChainId,
52                _rootBridgeAgentAddress,
53                address(0),
54                _localRouterAddress,
55                _localPortAddress
56:           )

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L43-L56)

```solidity
File: src/ArbitrumBranchPort.sol

38:       constructor(uint16 _localChainId, address _rootPortAddress, address _owner) BranchPort(_owner) {

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L38)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

44:       constructor() CoreBranchRouter(address(0)) {}

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L44)

```solidity
File: src/BaseBranchRouter.sol

48        constructor() {
49:           _initializeOwner(msg.sender);

```
*GitHub*: [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L48-L49)

```solidity
File: src/BranchBridgeAgent.sol

117       constructor(
118           uint16 _rootChainId,
119           uint16 _localChainId,
120           address _rootBridgeAgentAddress,
121           address _lzEndpointAddress,
122           address _localRouterAddress,
123:          address _localPortAddress

```
*GitHub*: [117](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L117-L123)

```solidity
File: src/BranchBridgeAgentExecutor.sol

39        constructor() {
40:           _initializeOwner(msg.sender);

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L39-L40)

```solidity
File: src/BranchPort.sol

108:      constructor(address _owner) {

```
*GitHub*: [108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L108)

```solidity
File: src/CoreBranchRouter.sol

30:       constructor(address _hTokenFactoryAddress) BaseBranchRouter() {

```
*GitHub*: [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L30)

```solidity
File: src/CoreRootRouter.sol

71:       constructor(uint256 _rootChainId, address _rootPortAddress) {

```
*GitHub*: [71](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L71)

```solidity
File: src/MulticallRootRouter.sol

92:       constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress) {

```
*GitHub*: [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L92)

```solidity
File: src/MulticallRootRouterLibZip.sol

29        constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress)
30:           MulticallRootRouter(_localChainId, _localPortAddress, _multicallAddress)

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L30)

```solidity
File: src/RootBridgeAgent.sol

105       constructor(
106           uint16 _localChainId,
107           address _lzEndpointAddress,
108           address _localPortAddress,
109:          address _localRouterAddress

```
*GitHub*: [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L105-L109)

```solidity
File: src/RootBridgeAgentExecutor.sol

35:       constructor(address _rootBridgeAgent) {

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L35)

```solidity
File: src/RootPort.sol

111:      constructor(uint256 _localChainId) {

```
*GitHub*: [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L111)

```solidity
File: src/VirtualAccount.sol

35:       constructor(address _userAddress, address _localPortAddress) {

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L35)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

30        constructor(
31            uint16 _rootChainId,
32            address _rootBridgeAgentFactoryAddress,
33            address _localCoreBranchRouterAddress,
34            address _localPortAddress,
35            address _owner
36        )
37            BranchBridgeAgentFactory(
38                _rootChainId,
39                _rootChainId,
40                _rootBridgeAgentFactoryAddress,
41                address(0),
42                _localCoreBranchRouterAddress,
43                _localPortAddress,
44                _owner
45:           )

```
*GitHub*: [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L30-L45)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

52        constructor(
53            uint16 _localChainId,
54            uint16 _rootChainId,
55            address _rootBridgeAgentFactoryAddress,
56            address _lzEndpointAddress,
57            address _localCoreBranchRouterAddress,
58            address _localPortAddress,
59:           address _owner

```
*GitHub*: [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L52-L59)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

42:       constructor(uint16 _localChainId, address _localPortAddress, string memory _chainName, string memory _chainSymbol) {

```
*GitHub*: [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L42)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

34:       constructor(uint16 _localChainId, address _rootPortAddress) {

```
*GitHub*: [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L34)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

31:       constructor(uint16 _rootChainId, address _lzEndpointAddress, address _rootPortAddress) {

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L31)

```solidity
File: src/token/ERC20hTokenBranch.sol

13        constructor(
14            string memory chainName,
15            string memory chainSymbol,
16            string memory _name,
17            string memory _symbol,
18            uint8 _decimals,
19            address _owner
20:       ) ERC20(string(string.concat(chainName, _name)), string(string.concat(chainSymbol, _symbol)), _decimals) {

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L13-L20)

```solidity
File: src/token/ERC20hTokenRoot.sol

31        constructor(
32            uint16 _localChainId,
33            address _factoryAddress,
34            address _rootPortAddress,
35            string memory _name,
36            string memory _symbol,
37            uint8 _decimals
38:       ) ERC20(string(string.concat(_name)), string(string.concat(_symbol)), _decimals) {

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L31-L38)

</details>




### [G&#x2011;18] Reduce gas usage by moving to Solidity 0.8.19 or later
See [this](https://blog.soliditylang.org/2023/02/22/solidity-0.8.19-release-announcement/#preventing-dead-code-in-runtime-bytecode) link for the full details

*There are 44 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L2-L2)

```solidity
File: src/ArbitrumBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L3-L3)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L2-L2)

```solidity
File: src/BaseBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L2-L2)

```solidity
File: src/BranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L2-L2)

```solidity
File: src/BranchBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/BranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L3-L3)

```solidity
File: src/CoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L2-L2)

```solidity
File: src/CoreRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouterLibZip.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L2-L2)

```solidity
File: src/RootBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L2-L2)

```solidity
File: src/RootBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/RootPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L3-L3)

```solidity
File: src/VirtualAccount.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L3-L3)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L2-L2)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L2-L2)

```solidity
File: src/interfaces/BridgeAgentStructs.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L2-L2)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L3-L3)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L2-L2)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/IBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L3-L3)

```solidity
File: src/interfaces/IBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L2-L2)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L2-L2)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L3-L3)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L3-L3)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L3-L3)

```solidity
File: src/interfaces/IMulticall2.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L2-L2)

```solidity
File: src/interfaces/IPortStrategy.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L3-L3)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L2-L2)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/IRootPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L3-L3)

```solidity
File: src/interfaces/IRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L2-L2)

```solidity
File: src/interfaces/IVirtualAccount.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenBranch.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L2-L2)

</details>




### [G&#x2011;19] `>=` costs less gas than `>`
The compiler uses opcodes `GT` and `ISZERO` for solidity code that uses `>`, but only requires `LT` for `>=`, [which saves **3 gas**](https://gist.github.com/IllIllI000/3dc79d25acccfa16dee4e83ffdc6ffde). If `<` is being used, the condition can be inverted.

*There are 33 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

127:         if (_deposit > 0) {

132:         if (_amount - _deposit > 0) {

```
*GitHub*: [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L127-L127), [132](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L132-L132)

```solidity
File: src/BaseBranchRouter.sol

165:         if (_amount - _deposit > 0) {

173:         if (_deposit > 0) {

```
*GitHub*: [165](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L165-L165), [173](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L173-L173)

```solidity
File: src/BranchBridgeAgent.sol

383:         } else if (uint8(deposit.hTokens.length) > 1) {

869:         if (_hTokens.length > MAX_TOKENS_LENGTH) revert InvalidInput();

906:         if (_amount - _deposit > 0) {

912:         if (_deposit > 0) {

```
*GitHub*: [383](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L383-L383), [869](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L869-L869), [906](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L906-L906), [912](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L912-L912)

```solidity
File: src/BranchBridgeAgentExecutor.sol

87:          if (_payload.length > PARAMS_SETTLEMENT_OFFSET) {

119:         if (_payload.length > settlementEndOffset) {

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L87-L87), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L119-L119)

```solidity
File: src/BranchPort.sol

149:         if (_amount > _excessReserves(_strategyTokenDebt, _token)) revert InsufficientReserves();

259:             if (_amounts[i] - _deposits[i] > 0) {

266:             if (_deposits[i] > 0) {

299:         if (length > 255) revert InvalidInputArrays();

525:         if (_hTokenAmount > 0) {

531:         if (_deposit > 0) {

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L149-L149), [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L259-L259), [266](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L266-L266), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L299-L299), [525](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L525-L525), [531](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L531-L531)

```solidity
File: src/RootBridgeAgent.sol

357:         if (_dParams.amount < _dParams.deposit) revert InvalidInputParams();

363:         if (_dParams.amount > 0) {

370:         if (_dParams.deposit > 0) {

396:         if (length > MAX_TOKENS_LENGTH) revert InvalidInputParams();

891:         } else if (_hTokens.length > 1) {

1057:        if (_globalAddresses.length > MAX_TOKENS_LENGTH) revert InvalidInputParamsLength();

1142:        if (_amount < _deposit) revert InvalidInputParams();

1146:        if (_underlyingAddress == address(0)) if (_deposit > 0) revert UnrecognizedUnderlyingAddress();

1149:        if (_amount - _deposit > 0) {

1156:        if (_deposit > 0) {

1158:            if (IERC20hTokenRoot(_globalAddress).getTokenBalance(_dstChainId) < _deposit) {

```
*GitHub*: [357](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L357-L357), [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L363-L363), [370](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L370-L370), [396](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L396-L396), [891](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L891-L891), [1057](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1057-L1057), [1142](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1142-L1142), [1146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1146-L1146), [1149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1149-L1149), [1156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1156-L1156), [1158](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1158-L1158)

```solidity
File: src/RootBridgeAgentExecutor.sol

100:         if (_payload.length > PARAMS_TKN_SET_SIZE) {

134:         if (length > PARAMS_END_OFFSET + (numOfAssets * PARAMS_TKN_SET_SIZE_MULTIPLE)) {

185:         if (_payload.length > PARAMS_SETTLEMENT_OFFSET) {

220              _payload.length
221                  > PARAMS_END_SIGNED_OFFSET
222:                     + uint256(uint8(bytes1(_payload[PARAMS_START_SIGNED]))) * PARAMS_TKN_SET_SIZE_MULTIPLE

```
*GitHub*: [100](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L100-L100), [134](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L134-L134), [185](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L185-L185), [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L220-L222)

```solidity
File: src/RootPort.sol

284:         if (_amount - _deposit > 0) {

290:         if (_deposit > 0) if (!ERC20hTokenRoot(_hToken).mint(_recipient, _deposit, _srcChainId)) revert UnableToMint();

```
*GitHub*: [284](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L284-L284), [290](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L290-L290)

</details>




### [G&#x2011;20] Nesting `if`-statements is cheaper than using `&&`
Nesting `if`-statements avoids the stack operations of setting up and using an extra `jumpdest`, and saves **6 [gas](https://gist.github.com/IllIllI000/7f3b818abecfadbef93b894481ae7d19)**

*There is one instance of this issue:*

```solidity
File: src/RootBridgeAgent.sol

1141:        if (_amount == 0 && _deposit == 0) revert InvalidInputParams();

```
*GitHub*: [1141](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1141-L1141)


### [G&#x2011;21] Use assembly to emit events, in order to save gas
Using the [scratch space](https://github.com/Vectorized/solady/blob/30558f5402f02351b96eeb6eaf32bcea29773841/src/tokens/ERC1155.sol#L501-L504) for event arguments (two words or fewer) will save gas over needing Solidity's full abi memory expansion used for emitting normally.

*There are 19 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

689:             emit LogFallback(nonce);

700:         emit LogExecute(nonce);

```
*GitHub*: [689](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L689-L689), [700](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L700-L700)

```solidity
File: src/BranchPort.sol

344:         emit BridgeAgentFactoryAdded(_newBridgeAgentFactory);

351:         emit BridgeAgentFactoryToggled(_newBridgeAgentFactory);

358:         emit BridgeAgentToggled(_bridgeAgent);

371:         emit StrategyTokenAdded(_token, _minimumReservesRatio);

378:         emit StrategyTokenToggled(_token);

399:         emit PortStrategyToggled(_portStrategy, _token);

423:         emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent);

```
*GitHub*: [344](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L344-L344), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L351-L351), [358](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L358-L358), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L371-L371), [378](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L378-L378), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L399-L399), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L423-L423)

```solidity
File: src/RootBridgeAgent.sol

726:             emit LogFallback(nonce, _srcChainId);

736:         emit LogExecute(nonce, _srcChainId);

```
*GitHub*: [726](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L726-L726), [736](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L736-L736)

```solidity
File: src/RootPort.sol

365:         emit VirtualAccountCreated(_user, address(newAccount));

389:         emit BridgeAgentAdded(_bridgeAgent, _manager);

417:         emit BridgeAgentToggled(_bridgeAgent);

427:         emit BridgeAgentFactoryAdded(_bridgeAgentFactory);

434:         emit BridgeAgentFactoryToggled(_bridgeAgentFactory);

479:         emit NewChainAdded(_chainId);

505:         emit EcosystemTokenAdded(_ecoTokenGlobalAddress);

517:         emit CoreRootSet(_coreRootRouter, _coreRootBridgeAgent);

```
*GitHub*: [365](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L365-L365), [389](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L389-L389), [417](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L417-L417), [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L427-L427), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L434-L434), [479](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L479-L479), [505](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L505-L505), [517](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L517-L517)


### [G&#x2011;22] Use `+=` for `mapping`s
Using `+=` for mappings saves **[40 gas](https://gist.github.com/IllIllI000/4fc5f83a9edc6ed16677258bf58f32a5)** due to not having to recalculate the mapping's value's hash

*There are 5 instances of this issue:*

```solidity
File: src/BranchPort.sol

349:         isBridgeAgentFactory[_newBridgeAgentFactory] = !isBridgeAgentFactory[_newBridgeAgentFactory];

356:         isBridgeAgent[_bridgeAgent] = !isBridgeAgent[_bridgeAgent];

376:         isStrategyToken[_token] = !isStrategyToken[_token];

```
*GitHub*: [349](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L349-L349), [356](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L356-L356), [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L376-L376)

```solidity
File: src/RootPort.sol

415:         isBridgeAgent[_bridgeAgent] = !isBridgeAgent[_bridgeAgent];

432:         isBridgeAgentFactory[_bridgeAgentFactory] = !isBridgeAgentFactory[_bridgeAgentFactory];

```
*GitHub*: [415](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L415-L415), [432](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L432-L432)


### [G&#x2011;23] Using `bool`s for storage incurs overhead
```solidity
    // Booleans are more expensive than uint256 or any type that takes up a full
    // word because each write operation emits an extra SLOAD to first read the
    // slot's contents, replace the bits taken up by the boolean, and then write
    // back. This is the compiler's defense against contract upgrades and
    // pointer aliasing, and it cannot be disabled.
```
https://github.com/OpenZeppelin/openzeppelin-contracts/blob/58f635312aa21f947cae5f8578638a85aa2519f5/contracts/security/ReentrancyGuard.sol#L23-L27
Use `uint256(0)` and `uint256(1)` for true/false to avoid a Gwarmaccess (**[100 gas](https://gist.github.com/IllIllI000/1b70014db712f8572a72378321250058)**) for the extra SLOAD

*There are 13 instances of this issue:*

```solidity
File: src/BranchPort.sol

32:      mapping(address bridgeAgent => bool isActiveBridgeAgent) public isBridgeAgent;

42:      mapping(address bridgeAgentFactory => bool isActiveBridgeAgentFactory) public isBridgeAgentFactory;

52:      mapping(address token => bool allowsStrategies) public isStrategyToken;

68:      mapping(address strategy => mapping(address token => bool isActiveStrategy)) public isPortStrategy;

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L32-L32), [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L42-L42), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L52-L52), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L68-L68)

```solidity
File: src/CoreRootRouter.sol

44:      bool internal _setup;

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L44-L44)

```solidity
File: src/RootBridgeAgent.sol

68:      mapping(uint256 chainId => bool allowed) public isBranchBridgeAgentAllowed;

```
*GitHub*: [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L68-L68)

```solidity
File: src/RootPort.sol

24:      bool internal _setup;

27:      bool internal _setupCore;

54:      mapping(VirtualAccount acount => mapping(address router => bool allowed)) public isRouterApproved;

61:      mapping(uint256 chainId => bool isActive) public isChainId;

64:      mapping(address bridgeAgent => bool isActive) public isBridgeAgent;

77:      mapping(address bridgeAgentFactory => bool isActive) public isBridgeAgentFactory;

87:      mapping(address token => bool isGlobalToken) public isGlobalAddress;

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L24-L24), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L27-L27), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L54-L54), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L61-L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L64-L64), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L77-L77), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L87-L87)


### [G&#x2011;24] Use `uint256(1)`/`uint256(2)` instead of `true`/`false` to save gas for changes
Avoids a Gsset (**20000 gas**) when changing from `false` to `true`, after having been `true` in the past

*There are 13 instances of this issue:*

```solidity
File: src/BranchPort.sol

32:      mapping(address bridgeAgent => bool isActiveBridgeAgent) public isBridgeAgent;

42:      mapping(address bridgeAgentFactory => bool isActiveBridgeAgentFactory) public isBridgeAgentFactory;

52:      mapping(address token => bool allowsStrategies) public isStrategyToken;

68:      mapping(address strategy => mapping(address token => bool isActiveStrategy)) public isPortStrategy;

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L32-L32), [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L42-L42), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L52-L52), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L68-L68)

```solidity
File: src/CoreRootRouter.sol

44:      bool internal _setup;

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L44-L44)

```solidity
File: src/RootBridgeAgent.sol

68:      mapping(uint256 chainId => bool allowed) public isBranchBridgeAgentAllowed;

```
*GitHub*: [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L68-L68)

```solidity
File: src/RootPort.sol

24:      bool internal _setup;

27:      bool internal _setupCore;

54:      mapping(VirtualAccount acount => mapping(address router => bool allowed)) public isRouterApproved;

61:      mapping(uint256 chainId => bool isActive) public isChainId;

64:      mapping(address bridgeAgent => bool isActive) public isBridgeAgent;

77:      mapping(address bridgeAgentFactory => bool isActive) public isBridgeAgentFactory;

87:      mapping(address token => bool isGlobalToken) public isGlobalAddress;

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L24-L24), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L27-L27), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L54-L54), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L61-L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L64-L64), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L77-L77), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L87-L87)


### [G&#x2011;25] Simple checks for zero can be done using assembly to save gas


*There are 25 instances of this issue:*

```solidity
File: src/ArbitrumBranchPort.sol

63:          if (_globalToken == address(0)) revert UnknownGlobalToken();

90:          if (_underlyingAddress == address(0)) revert UnknownUnderlyingToken();

```
*GitHub*: [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L63-L63), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L90-L90)

```solidity
File: src/BranchBridgeAgent.sol

412:         if (payload.length == 0) revert DepositRetryUnavailableUseCallout();

440:         if (deposit.owner == address(0)) revert DepositRedeemUnavailable();

```
*GitHub*: [412](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L412-L412), [440](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L440-L440)

```solidity
File: src/RootBridgeAgent.sol

244:         if (settlementReference.owner == address(0)) revert SettlementRetryUnavailable();

282:         if (settlementOwner == address(0)) revert SettlementRetrieveUnavailable();

308:         if (settlementOwner == address(0)) revert SettlementRedeemUnavailable();

670:             if (settlementReference.owner == address(0)) revert SettlementRetryUnavailable();

818:         if (callee == address(0)) revert UnrecognizedBridgeAgent();

871:         if (_hTokens.length == 0) revert SettlementRetryUnavailableUseCallout();

910:         if (callee == address(0)) revert UnrecognizedBridgeAgent();

1145:        if (_localAddress == address(0)) revert UnrecognizedLocalAddress();

1146:        if (_underlyingAddress == address(0)) if (_deposit > 0) revert UnrecognizedUnderlyingAddress();

```
*GitHub*: [244](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L244-L244), [282](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L282-L282), [308](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L308-L308), [670](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L670-L670), [818](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L818-L818), [871](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L871-L871), [910](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L910-L910), [1145](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1145-L1145), [1146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1146-L1146)

```solidity
File: src/RootPort.sol

245:         if (_globalAddress == address(0)) revert InvalidGlobalAddress();

246:         if (_localAddress == address(0)) revert InvalidLocalAddress();

247:         if (_underlyingAddress == address(0)) revert InvalidUnderlyingAddress();

264:         if (_localAddress == address(0)) revert InvalidLocalAddress();

352:         if (address(account) == address(0)) account = addVirtualAccount(_user);

360:         if (_user == address(0)) revert InvalidUserAddress();

510:         if (_coreRootRouter == address(0)) revert InvalidCoreRootRouter();

511:         if (_coreRootBridgeAgent == address(0)) revert InvalidCoreRootBridgeAgent();

528:         if (_coreBranchRouter == address(0)) revert InvalidCoreBranchRouter();

529:         if (_coreBranchBridgeAgent == address(0)) revert InvalidCoreBrancBridgeAgent();

544:         if (_coreBranchRouter == address(0)) revert InvalidCoreBranchRouter();

545:         if (_coreBranchBridgeAgent == address(0)) revert InvalidCoreBrancBridgeAgent();

```
*GitHub*: [245](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L245-L245), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L246-L246), [247](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L247-L247), [264](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L264-L264), [352](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L352-L352), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L360-L360), [510](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L510-L510), [511](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L511-L511), [528](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L528-L528), [529](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L529-L529), [544](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L544-L544), [545](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L545-L545)


### [G&#x2011;26] Avoid updating storage when the value hasn't changed
If the old value is equal to the new value, not re-storing the value will avoid a Gsreset (**2900 gas**), potentially at the expense of a Gcoldsload (**2100 gas**) or a Gwarmaccess (**100 gas**)

*There are 11 instances of this issue:*

```solidity
File: src/BranchPort.sol

331      function setCoreRouter(address _newCoreRouter) external override requiresCoreRouter {
332          require(coreBranchRouterAddress != address(0), "CoreRouter address is zero");
333          require(_newCoreRouter != address(0), "New CoreRouter address is zero");
334          coreBranchRouterAddress = _newCoreRouter;
335:     }

362      function addStrategyToken(address _token, uint256 _minimumReservesRatio) external override requiresCoreRouter {
363          if (_minimumReservesRatio >= DIVISIONER || _minimumReservesRatio < MIN_RESERVE_RATIO) {
364              revert InvalidMinimumReservesRatio();
365          }
366  
367          strategyTokens.push(_token);
368          getMinimumTokenReserveRatio[_token] = _minimumReservesRatio;
369          isStrategyToken[_token] = true;
370  
371          emit StrategyTokenAdded(_token, _minimumReservesRatio);
372:     }

382      function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
383          external
384          override
385          requiresCoreRouter
386      {
387          if (!isStrategyToken[_token]) revert UnrecognizedStrategyToken();
388          portStrategies.push(_portStrategy);
389          strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;
390          isPortStrategy[_portStrategy][_token] = true;
391  
392          emit PortStrategyAdded(_portStrategy, _token, _dailyManagementLimit);
393:     }

403      function updatePortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
404          external
405          override
406          requiresCoreRouter
407      {
408          strategyDailyLimitAmount[_portStrategy][_token] = _dailyManagementLimit;
409  
410          emit PortStrategyUpdated(_portStrategy, _token, _dailyManagementLimit);
411:     }

414      function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent)
415          external
416          override
417          requiresCoreRouter
418      {
419          coreBranchRouterAddress = _coreBranchRouter;
420          isBridgeAgent[_coreBranchBridgeAgent] = true;
421          bridgeAgents.push(_coreBranchBridgeAgent);
422  
423          emit CoreBranchSet(_coreBranchRouter, _coreBranchBridgeAgent);
424:     }

```
*GitHub*: [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L331-L335), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L362-L372), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L382-L393), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L403-L411), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L414-L424)

```solidity
File: src/RootPort.sol

239      function setAddresses(
240          address _globalAddress,
241          address _localAddress,
242          address _underlyingAddress,
243          uint256 _srcChainId
244      ) external override requiresCoreRootRouter {
245          if (_globalAddress == address(0)) revert InvalidGlobalAddress();
246          if (_localAddress == address(0)) revert InvalidLocalAddress();
247          if (_underlyingAddress == address(0)) revert InvalidUnderlyingAddress();
248  
249          isGlobalAddress[_globalAddress] = true;
250          getGlobalTokenFromLocal[_localAddress][_srcChainId] = _globalAddress;
251          getLocalTokenFromGlobal[_globalAddress][_srcChainId] = _localAddress;
252          getLocalTokenFromUnderlying[_underlyingAddress][_srcChainId] = _localAddress;
253          getUnderlyingTokenFromLocal[_localAddress][_srcChainId] = _underlyingAddress;
254  
255          emit LocalTokenAdded(_underlyingAddress, _localAddress, _globalAddress, _srcChainId);
256:     }

259      function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId)
260          external
261          override
262          requiresCoreRootRouter
263      {
264          if (_localAddress == address(0)) revert InvalidLocalAddress();
265  
266          getGlobalTokenFromLocal[_localAddress][_srcChainId] = _globalAddress;
267          getLocalTokenFromGlobal[_globalAddress][_srcChainId] = _localAddress;
268  
269          emit GlobalTokenAdded(_localAddress, _globalAddress, _srcChainId);
270:     }

382      function addBridgeAgent(address _manager, address _bridgeAgent) external override requiresBridgeAgentFactory {
383          if (isBridgeAgent[_bridgeAgent]) revert AlreadyAddedBridgeAgent();
384  
385          bridgeAgents.push(_bridgeAgent);
386          getBridgeAgentManager[_bridgeAgent] = _manager;
387          isBridgeAgent[_bridgeAgent] = true;
388  
389          emit BridgeAgentAdded(_bridgeAgent, _manager);
390:     }

438      function addNewChain(
439          address _coreBranchBridgeAgentAddress,
440          uint256 _chainId,
441          string memory _wrappedGasTokenName,
442          string memory _wrappedGasTokenSymbol,
443          uint8 _wrappedGasTokenDecimals,
444          address _newLocalBranchWrappedNativeTokenAddress,
445          address _newUnderlyingBranchWrappedNativeTokenAddress
446      ) external override onlyOwner {
447          // Check if chain already added
448          if (isChainId[_chainId]) revert AlreadyAddedChain();
449  
450          // Create new global token for new chain's wrapped native token
451          address newGlobalToken = address(
452              IERC20hTokenRootFactory(ICoreRootRouter(coreRootRouterAddress).hTokenFactoryAddress()).createToken(
453                  _wrappedGasTokenName, _wrappedGasTokenSymbol, _wrappedGasTokenDecimals
454              )
455          );
456  
457          // Sync new branch bridge agent with root core bridge agent
458          IBridgeAgent(ICoreRootRouter(coreRootRouterAddress).bridgeAgentAddress()).syncBranchBridgeAgent(
459              _coreBranchBridgeAgentAddress, _chainId
460          );
461  
462          // Update State
463  
464          // 1. Add new chain to chainId mapping
465          isChainId[_chainId] = true;
466          // 2. Add new chain to global address mapping
467          isGlobalAddress[newGlobalToken] = true;
468          // 3. Add new branch local token to global token address mapping
469          getGlobalTokenFromLocal[_newLocalBranchWrappedNativeTokenAddress][_chainId] = newGlobalToken;
470          // 4. Add new global token to branch local token address mapping
471          getLocalTokenFromGlobal[newGlobalToken][_chainId] = _newLocalBranchWrappedNativeTokenAddress;
472          // 5. Add new branch underlying token to branch local token address mapping
473          getLocalTokenFromUnderlying[_newUnderlyingBranchWrappedNativeTokenAddress][_chainId] =
474              _newLocalBranchWrappedNativeTokenAddress;
475          // 6. Add new branch local token to branch underlying token address mapping
476          getUnderlyingTokenFromLocal[_newLocalBranchWrappedNativeTokenAddress][_chainId] =
477              _newUnderlyingBranchWrappedNativeTokenAddress;
478  
479          emit NewChainAdded(_chainId);
480:     }

483      function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {
484          // Check if token already added
485          if (isGlobalAddress[_ecoTokenGlobalAddress]) revert AlreadyAddedEcosystemToken();
486  
487          // Check if token is already a underlying token in current chain
488          if (getUnderlyingTokenFromLocal[_ecoTokenGlobalAddress][localChainId] != address(0)) {
489              revert AlreadyAddedEcosystemToken();
490          }
491  
492          // Check if token is already a local branch token in current chain
493          if (getLocalTokenFromUnderlying[_ecoTokenGlobalAddress][localChainId] != address(0)) {
494              revert AlreadyAddedEcosystemToken();
495          }
496  
497          // Update State
498          // 1. Add new global token to global address mapping
499          isGlobalAddress[_ecoTokenGlobalAddress] = true;
500          // 2. Add new branch local token address to global token mapping
501          getGlobalTokenFromLocal[_ecoTokenGlobalAddress][localChainId] = _ecoTokenGlobalAddress;
502          // 3. Add new global token to branch local token address mapping
503          getLocalTokenFromGlobal[_ecoTokenGlobalAddress][localChainId] = _ecoTokenGlobalAddress;
504  
505          emit EcosystemTokenAdded(_ecoTokenGlobalAddress);
506:     }

509      function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {
510          if (_coreRootRouter == address(0)) revert InvalidCoreRootRouter();
511          if (_coreRootBridgeAgent == address(0)) revert InvalidCoreRootBridgeAgent();
512  
513          coreRootRouterAddress = _coreRootRouter;
514          coreRootBridgeAgentAddress = _coreRootBridgeAgent;
515          getBridgeAgentManager[_coreRootBridgeAgent] = owner();
516  
517          emit CoreRootSet(_coreRootRouter, _coreRootBridgeAgent);
518:     }

```
*GitHub*: [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L239-L256), [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L259-L270), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L382-L390), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L438-L480), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483-L506), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509-L518)


### [G&#x2011;27] `unchecked {}`  can be used on the division of two `uint`s in order to save gas
The division cannot overflow, since both the numerator and the denominator are non-negative

*There is one instance of this issue:*

```solidity
File: src/BranchPort.sol

473:         return ((_currBalance + _strategyTokenDebt) * getMinimumTokenReserveRatio[_token]) / DIVISIONER;

```
*GitHub*: [473](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L473-L473)


### [G&#x2011;28] Using `this` to access functions results in an external call, wasting gas
External calls have an overhead of **100 gas**, which can be avoided by not referencing the function using `this`. Contracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`, so make this change if it's required in order to call the function internally.

*There are 2 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

579:         address(this).excessivelySafeCall(

```
*GitHub*: [579](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L579-L579)

```solidity
File: src/RootBridgeAgent.sol

424:         (bool success,) = address(this).excessivelySafeCall(

```
*GitHub*: [424](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L424-L424)


### [G&#x2011;29] Use assembly for small keccak256 hashes, in order to save gas
If the arguments to the encode call can fit into the scratch space (two words or fewer), then it's more efficient to use assembly to generate the hash (**80 gas**):
`keccak256(abi.encodePacked(x, y))` -> `assembly {mstore(0x00, a); mstore(0x20, b); let hash := keccak256(0x00, 0x40); }`

*There is one instance of this issue:*

```solidity
File: src/RootPort.sol

362:         newAccount = new VirtualAccount{salt: keccak256(abi.encode(_user))}(_user, address(this));

```
*GitHub*: [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L362-L362)


### [G&#x2011;30] Using `calldata` instead of `memory` for read-only arguments in `external` functions saves gas
When a function with a `memory` array is called externally, the `abi.decode()` step has to copy read each index of the `calldata` to `memory`. **Each copy costs at least 60 gas** (i.e. `60 * <mem_array>.length`). Using `calldata` directly, obviates the need for copies of words of the struct/array not being read. Note that even if an interface defines a function as having `memory` arguments, it's still valid for implementation contracts to use `calldata` arguments instead. 

If the array is passed to an `internal` function which passes the array to another internal function where the array is modified and therefore `memory` is used in the `external` call, it's still more gass-efficient to use `calldata` when the `external` function uses modifiers, since the modifiers may prevent the internal functions from being called. Structs have the same overhead as an array of length one

Note that I've also flagged instances where the function is `public` but can be marked as `external` since it's not called by the contract, and cases where a constructor is involved

*There are 23 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BranchBridgeAgent.sol

/// @audit callOutAndBridge(_dParams)
212:         DepositInput memory _dParams,

/// @audit callOutAndBridgeMultiple(_dParams)
234:         DepositMultipleInput memory _dParams,

/// @audit callOutSignedAndBridge(_dParams)
279:         DepositInput memory _dParams,

/// @audit callOutSignedAndBridgeMultiple(_dParams)
309:         DepositMultipleInput memory _dParams,

```
*GitHub*: [212](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L212-L212), [234](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L234-L234), [279](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L279-L279), [309](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L309-L309)

```solidity
File: src/BranchPort.sol

/// @audit bridgeInMultiple(_amounts)
250:         uint256[] memory _amounts,

/// @audit bridgeInMultiple(_deposits)
251:         uint256[] memory _deposits

/// @audit bridgeOutMultiple(_amounts)
292:         uint256[] memory _amounts,

/// @audit bridgeOutMultiple(_deposits)
293:         uint256[] memory _deposits

```
*GitHub*: [250](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L250-L250), [251](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L251-L251), [292](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L292-L292), [293](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L293-L293)

```solidity
File: src/RootBridgeAgent.sol

/// @audit bridgeIn(_dParams)
351:     function bridgeIn(address _recipient, DepositParams memory _dParams, uint256 _srcChainId)

```
*GitHub*: [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L351-L351)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit callOutAndBridge(depositParams)
166:         DepositInput memory depositParams,

/// @audit callOutAndBridgeMultiple(depositParams)
182:         DepositMultipleInput memory depositParams,

/// @audit callOutSignedAndBridge(depositParams)
211:         DepositInput memory depositParams,

/// @audit callOutSignedAndBridgeMultiple(depositParams)
230:         DepositMultipleInput memory depositParams,

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L166-L166), [182](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L182-L182), [211](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L211-L211), [230](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L230-L230)

```solidity
File: src/interfaces/IBranchPort.sol

/// @audit bridgeInMultiple(_amounts)
107:         uint256[] memory _amounts,

/// @audit bridgeInMultiple(_deposits)
108:         uint256[] memory _deposits

/// @audit bridgeOutMultiple(_amounts)
139:         uint256[] memory _amounts,

/// @audit bridgeOutMultiple(_deposits)
140:         uint256[] memory _deposits

```
*GitHub*: [107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L107-L107), [108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L108-L108), [139](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L139-L139), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L140-L140)

```solidity
File: src/interfaces/IMulticall2.sol

/// @audit aggregate(calls)
20:      function aggregate(Call[] memory calls) external returns (uint256 blockNumber, bytes[] memory returnData);

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L20-L20)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit bridgeIn(_dParams)
271:     function bridgeIn(address _recipient, DepositParams memory _dParams, uint256 _srcChainId) external;

```
*GitHub*: [271](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L271-L271)

```solidity
File: src/interfaces/IRootRouter.sol

/// @audit executeDepositSingle(dParams)
42:      function executeDepositSingle(bytes memory params, DepositParams memory dParams, uint16 srcChainId)

/// @audit executeDepositMultiple(dParams)
53:      function executeDepositMultiple(bytes memory params, DepositMultipleParams memory dParams, uint16 srcChainId)

/// @audit executeSignedDepositSingle(dParams)
74:          DepositParams memory dParams,

/// @audit executeSignedDepositMultiple(dParams)
88:          DepositMultipleParams memory dParams,

```
*GitHub*: [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L42-L42), [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L53-L53), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L74-L74), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L88-L88)

</details>




### [G&#x2011;31] Avoid transferring amounts of zero in order to save gas
Skipping the external call when nothing will be transferred, will save at least **100 gas**

*There are 10 instances of this issue:*

```solidity
File: src/ArbitrumBranchPort.sol

66:          _underlyingAddress.safeTransferFrom(_depositor, address(this), _deposit);

94:          _underlyingAddress.safeTransfer(_recipient, _amount);

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L66-L66), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L94-L94)

```solidity
File: src/BaseBranchRouter.sol

167:                 _hToken.safeTransferFrom(msg.sender, address(this), _amount - _deposit);

```
*GitHub*: [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L167-L167)

```solidity
File: src/BranchPort.sol

233:         _underlyingAddress.safeTransfer(_recipient, _deposit);

```
*GitHub*: [233](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L233-L233)

```solidity
File: src/RootBridgeAgent.sol

1151:                _globalAddress.safeTransferFrom(_depositor, localPortAddress, _amount - _deposit);

```
*GitHub*: [1151](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1151-L1151)

```solidity
File: src/RootPort.sol

286:                 _hToken.safeTransfer(_recipient, _amount - _deposit);

301:         _hToken.safeTransferFrom(_from, address(this), _amount);

311:         _hToken.safeTransfer(_to, _amount);

```
*GitHub*: [286](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L286-L286), [301](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L301-L301), [311](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L311-L311)

```solidity
File: src/VirtualAccount.sol

57:          _token.safeTransfer(msg.sender, _amount);

62:          ERC721(_token).transferFrom(address(this), msg.sender, _tokenId);

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L57-L57), [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L62-L62)


### [G&#x2011;32] Avoid fetching a low-level call's return data by using assembly
Even if you don't assign the call's second return value, it still gets copied to memory. Use assembly instead to prevent this and save **159 [gas](https://gist.github.com/IllIllI000/0e18a40f3afb0b83f9a347b10ee89ad2)**:

`(bool success,) = payable(receiver).call{gas: gas, value: value}("");` -> `bool success; assembly { success := call(gas, receiver, value, 0, 0, 0, 0) }`

*There are 9 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

103:         _rootBridgeAgentAddress.call{value: msg.value}("");

```
*GitHub*: [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L103-L103)

```solidity
File: src/BranchBridgeAgent.sol

717:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

737:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

```
*GitHub*: [717](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L717-L717), [737](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L737-L737)

```solidity
File: src/RootBridgeAgent.sol

754:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

779:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

835:             callee.call{value: msg.value}("");

927:             callee.call{value: _value}("");

```
*GitHub*: [754](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L754-L754), [779](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L779-L779), [835](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L835-L835), [927](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L927-L927)

```solidity
File: src/VirtualAccount.sol

74:              if (isContract(_call.target)) (success, returnData[i]) = _call.target.call(_call.callData);

101:             if (isContract(_call.target)) (success, returnData[i]) = _call.target.call{value: val}(_call.callData);

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L74-L74), [101](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L101-L101)

## Disputed Issues

The issues below may be reported by other bots/wardens, but can be penalized/ignored since either the rule or the specified instances are invalid


### [D&#x2011;01] ~~Unchecked return value of low-level `call()`/`delegatecall()`~~
The function being called may revert, which will be indicated by the return value to `call()`/`delegatecall()`. If the return value is not checked, the code will continue on as if there was no error, rather than reverting with the error encountered.

*There are 9 instances of this issue:*

```solidity
File: src/MulticallRootRouter.sol

239:              IVirtualAccount(userAccount).call(calls);

248:              IVirtualAccount(userAccount).call(calls);

275:              IVirtualAccount(userAccount).call(calls);

328:              IVirtualAccount(userAccount).call(calls);

337:              IVirtualAccount(userAccount).call(calls);

364:              IVirtualAccount(userAccount).call(calls);

416:              IVirtualAccount(userAccount).call(calls);

425:              IVirtualAccount(userAccount).call(calls);

452:              IVirtualAccount(userAccount).call(calls);

```
*GitHub*: [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L239), [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L248), [275](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L275), [328](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L328), [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L337), [364](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L364), [416](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L416), [425](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L425), [452](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L452)


### [D&#x2011;02] ~~Return values of `approve()` not checked~~
The general rule is valid, but the instances below are invalid

*There is one instance of this issue:*

```solidity
File: src/BaseBranchRouter.sol

168:                 ERC20(_hToken).approve(_localPortAddress, _amount - _deposit);

```
*GitHub*: [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L168-L168)


### [D&#x2011;03] ~~Unsafe downcast~~
When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs

*There are 5 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

/// @audit uint16
171:              abi.encodePacked(uint16(2), _gasLimit, _remoteBranchExecutionGas, rootBridgeAgentAddress)

/// @audit uint16
776:              abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, rootBridgeAgentAddress)

```
*GitHub*: [171](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L171), [776](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L776)

```solidity
File: src/RootBridgeAgent.sol

/// @audit uint16
151:              abi.encodePacked(uint16(2), _gasLimit, _remoteBranchExecutionGas, getBranchBridgeAgent[_dstChainId])

/// @audit uint16
829:                  abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)

/// @audit uint16
921:                  abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)

```
*GitHub*: [151](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L151), [829](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L829), [921](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L921)


### [D&#x2011;04] ~~Loss of precision~~
Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator

*There is one instance of this issue:*

```solidity
File: src/BranchPort.sol

490:                  lastManaged[msg.sender][_token] = (block.timestamp / 1 days) * 1 days;

```
*GitHub*: [490](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L490)


### [D&#x2011;05] ~~Solidity version 0.8.20 may not work on other chains due to `PUSH0`~~
The general rule is valid, but the instances below are invalid

*There are 44 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L2-L2)

```solidity
File: src/ArbitrumBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L3-L3)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L2-L2)

```solidity
File: src/BaseBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L2-L2)

```solidity
File: src/BranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L2-L2)

```solidity
File: src/BranchBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/BranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L3-L3)

```solidity
File: src/CoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L2-L2)

```solidity
File: src/CoreRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L2-L2)

```solidity
File: src/MulticallRootRouterLibZip.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L2-L2)

```solidity
File: src/RootBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L2-L2)

```solidity
File: src/RootBridgeAgentExecutor.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L2-L2)

```solidity
File: src/RootPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L3-L3)

```solidity
File: src/VirtualAccount.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L3-L3)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L2-L2)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L2-L2)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L2-L2)

```solidity
File: src/interfaces/BridgeAgentStructs.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L2-L2)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L3-L3)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L2-L2)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/IBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L3-L3)

```solidity
File: src/interfaces/IBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L2-L2)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L2-L2)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L3-L3)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L3-L3)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L3-L3)

```solidity
File: src/interfaces/IMulticall2.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L2-L2)

```solidity
File: src/interfaces/IPortStrategy.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L3-L3)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L2-L2)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/IRootPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L3-L3)

```solidity
File: src/interfaces/IRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L2-L2)

```solidity
File: src/interfaces/IVirtualAccount.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenBranch.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L2-L2)

```solidity
File: src/token/ERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L2-L2)

</details>




### [D&#x2011;06] ~~`approve()`/`safeApprove()` may revert if the current approval is not zero~~
The general rule is valid, but the instances below are invalid

*There is one instance of this issue:*

```solidity
File: src/BaseBranchRouter.sol

168:                 ERC20(_hToken).approve(_localPortAddress, _amount - _deposit);

```
*GitHub*: [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L168-L168)


### [D&#x2011;07] ~~Missing contract-existence checks before low-level calls~~
The general rule is valid, but the instances below are invalid

*There are 27 instances of this issue:*

```solidity
File: src/BaseBranchRouter.sol

98           IBridgeAgent(localBridgeAgentAddress).callOutAndBridge{value: msg.value}(
99               payable(msg.sender), _params, _dParams, _gParams
100          );
101:     }

113          IBridgeAgent(localBridgeAgentAddress).callOutAndBridgeMultiple{value: msg.value}(
114              payable(msg.sender), _params, _dParams, _gParams
115          );
116:     }

```
*GitHub*: [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L98-L101), [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L113-L116)

```solidity
File: src/BranchBridgeAgent.sol

717          (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);
718  
719          //  No fallback is requested revert allowing for settlement retry.
720          if (!success) revert ExecutionFailure();
721:     }

```
*GitHub*: [717](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L717-L721)

```solidity
File: src/CoreBranchRouter.sol

54           IBridgeAgent(localBridgeAgentAddress).callOut{value: msg.value}(payable(msg.sender), payload, _gParams[0]);
55:      }

78           IBridgeAgent(localBridgeAgentAddress).callOutSystem{value: msg.value}(payable(msg.sender), payload, _gParams);
79:      }

184          IBridgeAgent(localBridgeAgentAddress).callOutSystem{value: msg.value}(payable(_refundee), payload, _gParams);
185:     }

232          IBridgeAgent(localBridgeAgentAddress).callOutSystem{value: msg.value}(payable(_refundee), payload, _gParams);
233:     }

```
*GitHub*: [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L54-L55), [78](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L78-L79), [184](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L184-L185), [232](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L232-L233)

```solidity
File: src/CoreRootRouter.sol

139          IBridgeAgent(bridgeAgentAddress).callOut{value: msg.value}(
140              payable(_refundee), _refundee, _dstChainId, payload, _gParams[0]
141          );
142:     }

174          IBridgeAgent(bridgeAgentAddress).callOut{value: msg.value}(
175              payable(_refundee), _refundee, _dstChainId, payload, _gParams
176          );
177:     }

199          IBridgeAgent(bridgeAgentAddress).callOut{value: msg.value}(
200              payable(_refundee), _refundee, _dstChainId, payload, _gParams
201          );
202:     }

226          IBridgeAgent(bridgeAgentAddress).callOut{value: msg.value}(
227              payable(_refundee), _refundee, _dstChainId, payload, _gParams
228          );
229:     }

257          IBridgeAgent(bridgeAgentAddress).callOut{value: msg.value}(
258              payable(_refundee), _refundee, _dstChainId, payload, _gParams
259          );
260:     }

287          IBridgeAgent(bridgeAgentAddress).callOut{value: msg.value}(
288              payable(_refundee), _refundee, _dstChainId, payload, _gParams
289          );
290:     }

437          IBridgeAgent(bridgeAgentAddress).callOut{value: msg.value}(
438              payable(_refundee), _refundee, _dstChainId, payload, _gParams[0]
439          );
440:     }

```
*GitHub*: [139](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L139-L142), [174](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L174-L177), [199](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L199-L202), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L226-L229), [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L257-L260), [287](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L287-L290), [437](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L437-L440)

```solidity
File: src/MulticallRootRouter.sol

275              IVirtualAccount(userAccount).call(calls);
276  
277              // Withdraw assets from Virtual Account
278              for (uint256 i = 0; i < outputParams.outputTokens.length;) {
279                  IVirtualAccount(userAccount).withdrawERC20(outputParams.outputTokens[i], outputParams.amountsOut[i]);
280: 

248              IVirtualAccount(userAccount).call(calls);
249  
250              // Withdraw assets from Virtual Account
251              IVirtualAccount(userAccount).withdrawERC20(outputParams.outputToken, outputParams.amountOut);
252  
253:             // Bridge Out assets

239              IVirtualAccount(userAccount).call(calls);
240  
241              /// FUNC ID: 2 (multicallSingleOutput)
242          } else if (funcId == 0x02) {
243              // Decode Params
244:             (Call[] memory calls, OutputParams memory outputParams, uint16 dstChainId, GasParams memory gasParams) =

364              IVirtualAccount(userAccount).call(calls);
365  
366              // Withdraw assets from Virtual Account
367              for (uint256 i = 0; i < outputParams.outputTokens.length;) {
368                  IVirtualAccount(userAccount).withdrawERC20(outputParams.outputTokens[i], outputParams.amountsOut[i]);
369: 

337              IVirtualAccount(userAccount).call(calls);
338  
339              // Withdraw assets from Virtual Account
340              IVirtualAccount(userAccount).withdrawERC20(outputParams.outputToken, outputParams.amountOut);
341  
342:             // Bridge Out assets

328              IVirtualAccount(userAccount).call(calls);
329  
330              /// FUNC ID: 2 (multicallSingleOutput)
331          } else if (funcId == 0x02) {
332              // Decode Params
333:             (Call[] memory calls, OutputParams memory outputParams, uint16 dstChainId, GasParams memory gasParams) =

452              IVirtualAccount(userAccount).call(calls);
453  
454              // Withdraw assets from Virtual Account
455              for (uint256 i = 0; i < outputParams.outputTokens.length;) {
456                  IVirtualAccount(userAccount).withdrawERC20(outputParams.outputTokens[i], outputParams.amountsOut[i]);
457: 

425              IVirtualAccount(userAccount).call(calls);
426  
427              // Withdraw assets from Virtual Account
428              IVirtualAccount(userAccount).withdrawERC20(outputParams.outputToken, outputParams.amountOut);
429  
430:             // Bridge Out assets

416              IVirtualAccount(userAccount).call(calls);
417  
418              /// FUNC ID: 2 (multicallSingleOutput)
419          } else if (funcId == 0x02) {
420              // Decode Params
421:             (Call[] memory calls, OutputParams memory outputParams, uint16 dstChainId, GasParams memory gasParams) =

524          IBridgeAgent(_bridgeAgentAddress).callOutAndBridge{value: msg.value}(
525              payable(refundee),
526              recipient,
527              dstChainId,
528              "",
529:             SettlementInput(outputToken, amountOut, depositOut),

566          IBridgeAgent(_bridgeAgentAddress).callOutAndBridgeMultiple{value: msg.value}(
567              payable(refundee),
568              recipient,
569              dstChainId,
570              "",
571:             SettlementMultipleInput(outputTokens, amountsOut, depositsOut),

```
*GitHub*: [275](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L275-L280), [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L248-L253), [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L239-L244), [364](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L364-L369), [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L337-L342), [328](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L328-L333), [452](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L452-L457), [425](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L425-L430), [416](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L416-L421), [524](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L524-L529), [566](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L566-L571)

```solidity
File: src/VirtualAccount.sol

74               if (isContract(_call.target)) (success, returnData[i]) = _call.target.call(_call.callData);
75   
76               if (!success) revert CallFailed();
77   
78               unchecked {
79:                  ++i;

101              if (isContract(_call.target)) (success, returnData[i]) = _call.target.call{value: val}(_call.callData);
102  
103              if (!success) revert CallFailed();
104  
105              unchecked {
106:                 ++i;

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L74-L79), [101](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L101-L106)


### [D&#x2011;08] ~~Duplicated require()/revert() checks should be refactored to a modifier Or function to save gas~~
If the compiler inlines the function, there will be no gas savings. If it doesn't, there's extra runtime overhead due to the JUMP instructions. Either way, this suggestion is not helpful.

*There are 12 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BranchBridgeAgent.sol

441:          if (deposit.owner != msg.sender) revert NotDepositOwner();

624:              if (executionState[nonce] != STATUS_READY) revert AlreadyExecutedTransaction();

```
*GitHub*: [441](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L441), [624](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L624)

```solidity
File: src/BranchPort.sol

560:          if (!isStrategyToken[_token]) revert UnrecognizedStrategyToken();

```
*GitHub*: [560](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L560)

```solidity
File: src/CoreRootRouter.sol

366:          revert();

```
*GitHub*: [366](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L366)

```solidity
File: src/MulticallRootRouter.sol

204:          revert();

```
*GitHub*: [204](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L204)

```solidity
File: src/RootBridgeAgent.sol

670:              if (settlementReference.owner == address(0)) revert SettlementRetryUnavailable();

910:          if (callee == address(0)) revert UnrecognizedBridgeAgent();

```
*GitHub*: [670](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L670), [910](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L910)

```solidity
File: src/RootPort.sol

264:          if (_localAddress == address(0)) revert InvalidLocalAddress();

299:          if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

544:          if (_coreBranchRouter == address(0)) revert InvalidCoreBranchRouter();

545:          if (_coreBranchBridgeAgent == address(0)) revert InvalidCoreBrancBridgeAgent();

```
*GitHub*: [264](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L264), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L299), [544](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L544), [545](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L545)

```solidity
File: src/VirtualAccount.sol

103:              if (!success) revert CallFailed();

```
*GitHub*: [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L103)

</details>




### [D&#x2011;09] ~~Duplicated `require()`/`revert()` checks should be refactored to a modifier or function~~
This instance appears only once

*There are 56 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

39:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L39)

```solidity
File: src/BaseBranchRouter.sol

61:           require(_localBridgeAgentAddress != address(0), "Bridge Agent address cannot be 0");

213:          require(_unlocked == 1);

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L61), [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L213)

```solidity
File: src/BranchBridgeAgent.sol

125:          require(_rootBridgeAgentAddress != address(0), "Root Bridge Agent Address cannot be the zero address.");

126           require(
127               _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
128               "Layerzero Endpoint Address cannot be the zero address."
129:          );

130:          require(_localRouterAddress != address(0), "Local Router Address cannot be the zero address.");

131:          require(_localPortAddress != address(0), "Local Port Address cannot be the zero address.");

923:          require(_unlocked == 1);

```
*GitHub*: [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L125), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L126-L129), [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L131), [923](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L923)

```solidity
File: src/BranchPort.sol

109:          require(_owner != address(0), "Owner is zero address");

123:          require(coreBranchRouterAddress == address(0), "Contract already initialized");

124:          require(!isBridgeAgentFactory[_bridgeAgentFactory], "Contract already initialized");

126:          require(_coreBranchRouter != address(0), "CoreBranchRouter is zero address");

127:          require(_bridgeAgentFactory != address(0), "BridgeAgentFactory is zero address");

136:          revert("Cannot renounce ownership");

181:          require(ERC20(_token).balanceOf(address(this)) - currBalance == _amount, "Port Strategy Withdraw Failed");

213           require(
214               ERC20(_token).balanceOf(address(this)) - currBalance == amountToWithdraw, "Port Strategy Withdraw Failed"
215:          );

332:          require(coreBranchRouterAddress != address(0), "CoreRouter address is zero");

333:          require(_newCoreRouter != address(0), "New CoreRouter address is zero");

567:          require(_unlocked == 1);

```
*GitHub*: [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L109), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L123), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L124), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L126), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L127), [136](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L136), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L181), [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L213-L215), [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L332), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L333), [567](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L567)

```solidity
File: src/CoreRootRouter.sol

84:           require(_setup, "Contract is already initialized");

278:          require(msg.sender == rootPortAddress, "Only root port can call");

```
*GitHub*: [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L84), [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L278)

```solidity
File: src/MulticallRootRouter.sol

93:           require(_localPortAddress != address(0), "Local Port Address cannot be 0");

94:           require(_multicallAddress != address(0), "Multicall Address cannot be 0");

110:          require(_bridgeAgentAddress != address(0), "Bridge Agent Address cannot be 0");

591:          require(_unlocked == 1);

```
*GitHub*: [93](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L93), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L94), [110](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L110), [591](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L591)

```solidity
File: src/RootBridgeAgent.sol

111:          require(_lzEndpointAddress != address(0), "Layerzero Enpoint Address cannot be zero address");

112:          require(_localPortAddress != address(0), "Port Address cannot be zero address");

113:          require(_localRouterAddress != address(0), "Router Address cannot be zero address");

1191:         require(_unlocked == 1);

```
*GitHub*: [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L111), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L112), [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L113), [1191](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1191)

```solidity
File: src/RootPort.sol

130:          require(_bridgeAgentFactory != address(0), "Bridge Agent Factory cannot be 0 address.");

131:          require(_coreRootRouter != address(0), "Core Root Router cannot be 0 address.");

132:          require(_setup, "Setup ended.");

152:          require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0 address.");

153:          require(_coreLocalBranchBridgeAgent != address(0), "Core Local Branch Bridge Agent cannot be 0 address.");

154:          require(_localBranchPortAddress != address(0), "Local Branch Port Address cannot be 0 address.");

155:          require(isBridgeAgent[_coreRootBridgeAgent], "Core Bridge Agent doesn't exist.");

156:          require(_setupCore, "Core Setup ended.");

167:          revert("Cannot renounce ownership");

```
*GitHub*: [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L130), [131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L131), [132](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L132), [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L152), [153](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L153), [154](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L154), [155](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L155), [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L156), [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L167)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

57:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent Address cannot be 0");

84            require(
85                msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
86:           );

87            require(
88                _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
89                "Root Bridge Agent Factory Address does not match."
90:           );

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L57), [84](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L84-L86), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L87-L90)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

61:           require(_rootBridgeAgentFactoryAddress != address(0), "Root Bridge Agent Factory Address cannot be 0");

62            require(
63                _lzEndpointAddress != address(0) || _rootChainId == _localChainId,
64                "Layerzero Endpoint Address cannot be the zero address."
65:           );

66:           require(_localCoreBranchRouterAddress != address(0), "Core Branch Router Address cannot be 0");

67:           require(_localPortAddress != address(0), "Port Address cannot be 0");

68:           require(_owner != address(0), "Owner cannot be 0");

88:           require(_coreRootBridgeAgent != address(0), "Core Root Bridge Agent cannot be 0");

120           require(
121               msg.sender == localCoreBranchRouterAddress, "Only the Core Branch Router can create a new Bridge Agent."
122:          );

123           require(
124               _rootBridgeAgentFactoryAddress == rootBridgeAgentFactoryAddress,
125               "Root Bridge Agent Factory Address does not match."
126:          );

```
*GitHub*: [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L61), [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L62-L65), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L66), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L68), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L88), [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L120-L122), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L123-L126)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

43:           require(_localPortAddress != address(0), "Port address cannot be 0");

61:           require(_coreRouter != address(0), "CoreRouter address cannot be 0");

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L43), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L61)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

35:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

50:           require(_coreRouter != address(0), "CoreRouter address cannot be 0");

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L35), [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L50)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

32:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L32)

```solidity
File: src/token/ERC20hTokenRoot.sol

39:           require(_rootPortAddress != address(0), "Root Port Address cannot be 0");

40:           require(_factoryAddress != address(0), "Factory Address cannot be 0");

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L39), [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L40)

</details>




### [D&#x2011;10] ~~SPDX identifier should be the in the first line of a solidity file~~
It's already on the first line

*There are 44 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L1)

```solidity
File: src/ArbitrumBranchPort.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L1)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L1)

```solidity
File: src/BaseBranchRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L1)

```solidity
File: src/BranchBridgeAgent.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L1)

```solidity
File: src/BranchBridgeAgentExecutor.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L1)

```solidity
File: src/BranchPort.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L1)

```solidity
File: src/CoreBranchRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L1)

```solidity
File: src/CoreRootRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L1)

```solidity
File: src/MulticallRootRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L1)

```solidity
File: src/MulticallRootRouterLibZip.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L1)

```solidity
File: src/RootBridgeAgent.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1)

```solidity
File: src/RootBridgeAgentExecutor.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L1)

```solidity
File: src/RootPort.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L1)

```solidity
File: src/VirtualAccount.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L1)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L1)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L1)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L1)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

1:    // // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L1)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L1)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L1)

```solidity
File: src/interfaces/BridgeAgentStructs.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L1)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L1)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L1)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L1)

```solidity
File: src/interfaces/IBranchPort.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L1)

```solidity
File: src/interfaces/IBranchRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L1)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L1)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L1)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L1)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L1)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L1)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

1:    // SPDX-License-Identifier: BUSL-1.1

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L1)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

1:    // SPDX-License-Identifier: BUSL-1.1

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L1)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

1:    // SPDX-License-Identifier: BUSL-1.1

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L1)

```solidity
File: src/interfaces/IMulticall2.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L1)

```solidity
File: src/interfaces/IPortStrategy.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L1)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L1)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L1)

```solidity
File: src/interfaces/IRootPort.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L1)

```solidity
File: src/interfaces/IRootRouter.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L1)

```solidity
File: src/interfaces/IVirtualAccount.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L1)

```solidity
File: src/token/ERC20hTokenBranch.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L1)

```solidity
File: src/token/ERC20hTokenRoot.sol

1:    // SPDX-License-Identifier: MIT

```
*GitHub*: [1](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L1)

</details>




### [D&#x2011;11] ~~Overly complicated arithmetic~~
At least one bot is incorrectly flagging code comments as 'complicated arithmetic'

*There are 18 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumCoreBranchRouter.sol

27:    *         -----------------------------

29:    *         -------------+---------------

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L27), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L29)

```solidity
File: src/CoreRootRouter.sol

29:    *         -----------------------------

31:    *         -------------+---------------

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L29), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L31)

```solidity
File: src/MulticallRootRouter.sol

46:    *         -----------------------------

48:    *         -------------+---------------

```
*GitHub*: [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L46), [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L48)

```solidity
File: src/MulticallRootRouterLibZip.sol

15:    *         -----------------------------

17:    *         -------------+---------------

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L15), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L17)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

45:    *         ------------------------------

47:    *         -----+------------------------

68:    *  | callOut = 0x0                 |  20b(recipient) + 4b(nonce)      |            -------------           |   ---	   |

```
*GitHub*: [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L45), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L47), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L68)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

16:    *         -----------------------------

18:    *         -------------+---------------

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L16), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L18)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

43:    *       ------------------------------

45:    *       -----+------------------------

71:    *      | callOutSystem = 0x0   	    |                 4b(nonce)  |            -------------           |   ---	 |

72:    *      | callOut = 0x1                 |                 4b(nonce)  |            -------------           |   ---	 |

75:    *      | callOutSigned = 0x4           |    20b(recip) + 4b(nonce)  |   	      -------------           |   ---    |

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L43), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L45), [71](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L71), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L72), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L75)

</details>




### [D&#x2011;12] ~~Prefer double quotes for string quoting~~
The examples below are not strings. Furthermore it's perfectly reasonable to use single quotes within text ([p. 16](https://www.ox.ac.uk/sites/files/oxford/media_wysiwyg/University%20of%20Oxford%20Style%20Guide.pdf)).

*There are 3 instances of this issue:*

```solidity
File: src/MulticallRootRouter.sol

499       /**
500:       *  @notice Function to call 'clearToken' on the Root Port.

523:          //Move output hTokens from Root to Branch and call 'clearToken'.

565:          //Move output hTokens from Root to Branch and call 'clearTokens'.

```
*GitHub*: [499](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L499-L500), [523](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L523), [565](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L565)


### [D&#x2011;13] ~~Public functions not used internally can be marked as external to save gas~~
After Solidity version 0.6.9 both `public` and `external` functions save the [same amount of gas](https://ethereum.stackexchange.com/a/107939), and since these files are >0.6.9, these findings are invalid

*There are 6 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

578:      function lzReceive(uint16, bytes calldata _srcAddress, uint64, bytes calldata _payload) public override {

587       function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload)
588           public
589           override
590:          requiresEndpoint(_endpoint, _srcAddress)

```
*GitHub*: [578](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L578), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L587-L590)

```solidity
File: src/RootBridgeAgent.sol

423:      function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64, bytes calldata _payload) public {

434       function lzReceiveNonBlocking(
435           address _endpoint,
436           uint16 _srcChainId,
437           bytes calldata _srcAddress,
438           bytes calldata _payload
439:      ) public override requiresEndpoint(_endpoint, _srcChainId, _srcAddress) {

```
*GitHub*: [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L423), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L434-L439)

```solidity
File: src/VirtualAccount.sol

85:       function payableCall(PayableCall[] calldata calls) public payable returns (bytes[] memory returnData) {

```
*GitHub*: [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L85)

```solidity
File: src/token/ERC20hTokenBranch.sol

35:       function burn(uint256 amount) public override onlyOwner {

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L35)


### [D&#x2011;14] ~~`require()` / `revert()` statements should have descriptive reason strings~~
These are not `revert()` calls, so these findings are invalid

*There are 155 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

126:         if (msg.sender != address(this)) revert LayerZeroUnauthorizedEndpoint();

127:         if (_endpoint != rootBridgeAgentAddress) revert LayerZeroUnauthorizedEndpoint();

```
*GitHub*: [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L126-L126), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L127-L127)

```solidity
File: src/ArbitrumBranchPort.sol

63:          if (_globalToken == address(0)) revert UnknownGlobalToken();

83:          if (!IRootPort(_rootPortAddress).isGlobalToken(_globalAddress, localChainId)) revert UnknownGlobalToken();

90:          if (_underlyingAddress == address(0)) revert UnknownUnderlyingToken();

```
*GitHub*: [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L63-L63), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L83-L83), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L90-L90)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

98:              revert UnrecognizedBridgeAgentFactory();

108:             revert UnrecognizedBridgeAgent();

169:             revert UnrecognizedFunctionId();

```
*GitHub*: [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L98-L98), [108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L108-L108), [169](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L169-L169)

```solidity
File: src/BaseBranchRouter.sol

124:         revert UnrecognizedFunctionId();

135:         revert UnrecognizedFunctionId();

146:         revert UnrecognizedFunctionId();

207:         if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L124-L124), [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L135-L135), [146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L146-L146), [207](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L207-L207)

```solidity
File: src/BranchBridgeAgent.sol

354:         if (deposit.owner != msg.sender) revert NotDepositOwner();

412:         if (payload.length == 0) revert DepositRetryUnavailableUseCallout();

424:         if (getDeposit[_depositNonce].owner != msg.sender) revert NotDepositOwner();

439:         if (deposit.status == STATUS_SUCCESS) revert DepositRedeemUnavailable();

440:         if (deposit.owner == address(0)) revert DepositRedeemUnavailable();

441:         if (deposit.owner != msg.sender) revert NotDepositOwner();

696:             revert UnknownFlag();

672:                 revert AlreadyExecutedTransaction();

646:             if (executionState[nonce] != STATUS_READY) revert AlreadyExecutedTransaction();

624:             if (executionState[nonce] != STATUS_READY) revert AlreadyExecutedTransaction();

604:             if (executionState[nonce] != STATUS_READY) revert AlreadyExecutedTransaction();

720:         if (!success) revert ExecutionFailure();

750:                 revert ExecutionFailure();

869:         if (_hTokens.length > MAX_TOKENS_LENGTH) revert InvalidInput();

870:         if (_hTokens.length != _tokens.length) revert InvalidInput();

871:         if (_tokens.length != _amounts.length) revert InvalidInput();

872:         if (_amounts.length != _deposits.length) revert InvalidInput();

938:         if (msg.sender != address(this)) revert LayerZeroUnauthorizedEndpoint();

939:         if (_endpoint != lzEndpointAddress) revert LayerZeroUnauthorizedEndpoint();

942:         if (_srcAddress.length != 40) revert LayerZeroUnauthorizedCaller();

943:         if (rootBridgeAgentAddress != address(uint160(bytes20(_srcAddress[20:])))) revert LayerZeroUnauthorizedCaller();

948:         if (msg.sender != localRouterAddress) revert UnrecognizedRouter();

954:         if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L354-L354), [412](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L412-L412), [424](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L424-L424), [439](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L439-L439), [440](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L440-L440), [441](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L441-L441), [696](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L696-L696), [672](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L672-L672), [646](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L646-L646), [624](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L624-L624), [604](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L604-L604), [720](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L720-L720), [750](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L750-L750), [869](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L869-L869), [870](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L870-L870), [871](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L871-L871), [872](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L872-L872), [938](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L938-L938), [939](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L939-L939), [942](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L942-L942), [943](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L943-L943), [948](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L948-L948), [954](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L954-L954)

```solidity
File: src/BranchPort.sol

149:         if (_amount > _excessReserves(_strategyTokenDebt, _token)) revert InsufficientReserves();

299:         if (length > 255) revert InvalidInputArrays();

300:         if (length != _underlyingAddresses.length) revert InvalidInputArrays();

301:         if (_underlyingAddresses.length != _amounts.length) revert InvalidInputArrays();

302:         if (_amounts.length != _deposits.length) revert InvalidInputArrays();

320:         if (isBridgeAgent[_bridgeAgent]) revert AlreadyAddedBridgeAgent();

339:         if (isBridgeAgentFactory[_newBridgeAgentFactory]) revert AlreadyAddedBridgeAgentFactory();

364:             revert InvalidMinimumReservesRatio();

387:         if (!isStrategyToken[_token]) revert UnrecognizedStrategyToken();

542:         if (msg.sender != coreBranchRouterAddress) revert UnrecognizedCore();

548:         if (!isBridgeAgent[msg.sender]) revert UnrecognizedBridgeAgent();

554:         if (!isBridgeAgentFactory[msg.sender]) revert UnrecognizedBridgeAgentFactory();

560:         if (!isStrategyToken[_token]) revert UnrecognizedStrategyToken();

561:         if (!isPortStrategy[msg.sender][_token]) revert UnrecognizedPortStrategy();

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L149-L149), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L299-L299), [300](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L300-L300), [301](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L301-L301), [302](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L302-L302), [320](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L320-L320), [339](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L339-L339), [364](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L364-L364), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L387-L387), [542](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L542-L542), [548](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L548-L548), [554](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L554-L554), [560](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L560-L560), [561](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L561-L561)

```solidity
File: src/CoreBranchRouter.sol

147:             revert UnrecognizedFunctionId();

212:             revert UnrecognizedBridgeAgentFactory();

222:             revert UnrecognizedBridgeAgent();

268:         if (!IPort(_localPortAddress).isBridgeAgent(_branchBridgeAgent)) revert UnrecognizedBridgeAgent();

```
*GitHub*: [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L147-L147), [212](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L212-L212), [222](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L222-L222), [268](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L268-L268)

```solidity
File: src/CoreRootRouter.sol

113:             revert UnauthorizedCallerNotManager();

117:         if (!IPort(rootPortAddress).isChainId(_dstChainId)) revert InvalidChainId();

120:         if (IBridgeAgent(_rootBridgeAgent).getBranchBridgeAgent(_dstChainId) != address(0)) revert InvalidChainId();

123:         if (!IBridgeAgent(_rootBridgeAgent).isBranchBridgeAgentAllowed(_dstChainId)) revert UnauthorizedChainId();

164:             revert UnrecognizedBridgeAgentFactory();

327:             revert UnrecognizedFunctionId();

345:             revert UnrecognizedFunctionId();

412:         if (_dstChainId == rootChainId) revert InvalidChainId();

415:             revert UnrecognizedGlobalToken();

420:             revert TokenAlreadyAdded();

461:         if (IPort(rootPortAddress).isGlobalAddress(_underlyingAddress)) revert TokenAlreadyAdded();

462:         if (IPort(rootPortAddress).isLocalToken(_underlyingAddress, _srcChainId)) revert TokenAlreadyAdded();

463:         if (IPort(rootPortAddress).isUnderlyingToken(_underlyingAddress, _srcChainId)) revert TokenAlreadyAdded();

483:         if (IPort(rootPortAddress).isLocalToken(_localAddress, _dstChainId)) revert TokenAlreadyAdded();

512:         if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L113-L113), [117](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L117-L117), [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L120-L120), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L123-L123), [164](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L164-L164), [327](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L327-L327), [345](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L345-L345), [412](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L412-L412), [415](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L415-L415), [420](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L420-L420), [461](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L461-L461), [462](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L462-L462), [463](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L463-L463), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L483-L483), [512](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L512-L512)

```solidity
File: src/MulticallRootRouter.sol

198:             revert UnrecognizedFunctionId();

298:             revert UnrecognizedFunctionId();

387:             revert UnrecognizedFunctionId();

475:             revert UnrecognizedFunctionId();

605:         if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [198](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L198-L198), [298](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L298-L298), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L387-L387), [475](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L475-L475), [605](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L605-L605)

```solidity
File: src/RootBridgeAgent.sol

244:         if (settlementReference.owner == address(0)) revert SettlementRetryUnavailable();

249:                 revert NotSettlementOwner();

282:         if (settlementOwner == address(0)) revert SettlementRetrieveUnavailable();

287:                 revert NotSettlementOwner();

307:         if (settlement.status == STATUS_SUCCESS) revert SettlementRedeemUnavailable();

308:         if (settlementOwner == address(0)) revert SettlementRedeemUnavailable();

313:                 revert NotSettlementOwner();

357:         if (_dParams.amount < _dParams.deposit) revert InvalidInputParams();

365:                 revert InvalidInputParams();

372:                 revert InvalidInputParams();

396:         if (length > MAX_TOKENS_LENGTH) revert InvalidInputParams();

430:         if (!success) if (msg.sender == getBranchBridgeAgent[localChainId]) revert ExecutionFailure();

733:             revert UnknownFlag();

705:                 revert AlreadyExecutedTransaction();

670:             if (settlementReference.owner == address(0)) revert SettlementRetryUnavailable();

675:                     revert NotSettlementOwner();

623:                 revert AlreadyExecutedTransaction();

583:                 revert AlreadyExecutedTransaction();

545:                 revert AlreadyExecutedTransaction();

519:                 revert AlreadyExecutedTransaction();

496:                 revert AlreadyExecutedTransaction();

473:                 revert AlreadyExecutedTransaction();

450:                 revert AlreadyExecutedTransaction();

757:         if (!success) revert ExecutionFailure();

791:                 revert ExecutionFailure();

818:         if (callee == address(0)) revert UnrecognizedBridgeAgent();

871:         if (_hTokens.length == 0) revert SettlementRetryUnavailableUseCallout();

910:         if (callee == address(0)) revert UnrecognizedBridgeAgent();

1057:        if (_globalAddresses.length > MAX_TOKENS_LENGTH) revert InvalidInputParamsLength();

1060:        if (_globalAddresses.length != _amounts.length) revert InvalidInputParamsLength();

1061:        if (_amounts.length != _deposits.length) revert InvalidInputParamsLength();

1141:        if (_amount == 0 && _deposit == 0) revert InvalidInputParams();

1142:        if (_amount < _deposit) revert InvalidInputParams();

1145:        if (_localAddress == address(0)) revert UnrecognizedLocalAddress();

1146:        if (_underlyingAddress == address(0)) if (_deposit > 0) revert UnrecognizedUnderlyingAddress();

1159:                revert InsufficientBalanceForSettlement();

1171:        if (getBranchBridgeAgent[_branchChainId] != address(0)) revert AlreadyAddedBridgeAgent();

1199:        if (msg.sender != localRouterAddress) revert UnrecognizedRouter();

1205:        if (msg.sender != address(this)) revert LayerZeroUnauthorizedEndpoint();

1208:            if (_endpoint != lzEndpointAddress) revert LayerZeroUnauthorizedEndpoint();

1210:            if (_srcAddress.length != 40) revert LayerZeroUnauthorizedCaller();

1213:                revert LayerZeroUnauthorizedCaller();

1221:        if (msg.sender != bridgeAgentExecutorAddress) revert UnrecognizedExecutor();

1227:        if (msg.sender != localPortAddress) revert UnrecognizedPort();

1234:            revert UnrecognizedBridgeAgentManager();

```
*GitHub*: [244](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L244-L244), [249](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L249-L249), [282](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L282-L282), [287](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L287-L287), [307](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L307-L307), [308](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L308-L308), [313](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L313-L313), [357](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L357-L357), [365](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L365-L365), [372](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L372-L372), [396](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L396-L396), [430](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L430-L430), [733](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L733-L733), [705](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L705-L705), [670](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L670-L670), [675](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L675-L675), [623](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L623-L623), [583](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L583-L583), [545](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L545-L545), [519](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L519-L519), [496](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L496-L496), [473](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L473-L473), [450](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L450-L450), [757](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L757-L757), [791](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L791-L791), [818](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L818-L818), [871](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L871-L871), [910](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L910-L910), [1057](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1057-L1057), [1060](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1060-L1060), [1061](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1061-L1061), [1141](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1141-L1141), [1142](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1142-L1142), [1145](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1145-L1145), [1146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1146-L1146), [1159](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1159-L1159), [1171](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1171-L1171), [1199](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1199-L1199), [1205](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1205-L1205), [1208](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1208-L1208), [1210](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1210-L1210), [1213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1213-L1213), [1221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1221-L1221), [1227](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1227-L1227), [1234](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1234-L1234)

```solidity
File: src/RootPort.sol

245:         if (_globalAddress == address(0)) revert InvalidGlobalAddress();

246:         if (_localAddress == address(0)) revert InvalidLocalAddress();

247:         if (_underlyingAddress == address(0)) revert InvalidUnderlyingAddress();

264:         if (_localAddress == address(0)) revert InvalidLocalAddress();

282:         if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

290:         if (_deposit > 0) if (!ERC20hTokenRoot(_hToken).mint(_recipient, _deposit, _srcChainId)) revert UnableToMint();

299:         if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

309:         if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

320:         if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

330:         if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

341:         if (!isGlobalAddress[_hToken]) revert UnrecognizedToken();

342:         if (!ERC20hTokenRoot(_hToken).mint(_to, _amount, localChainId)) revert UnableToMint();

360:         if (_user == address(0)) revert InvalidUserAddress();

383:         if (isBridgeAgent[_bridgeAgent]) revert AlreadyAddedBridgeAgent();

399:             revert AlreadyAddedBridgeAgent();

402:             revert BridgeAgentNotAllowed();

422:         if (isBridgeAgentFactory[_bridgeAgentFactory]) revert AlreadyAddedBridgeAgentFactory();

448:         if (isChainId[_chainId]) revert AlreadyAddedChain();

485:         if (isGlobalAddress[_ecoTokenGlobalAddress]) revert AlreadyAddedEcosystemToken();

489:             revert AlreadyAddedEcosystemToken();

494:             revert AlreadyAddedEcosystemToken();

510:         if (_coreRootRouter == address(0)) revert InvalidCoreRootRouter();

511:         if (_coreRootBridgeAgent == address(0)) revert InvalidCoreRootBridgeAgent();

528:         if (_coreBranchRouter == address(0)) revert InvalidCoreBranchRouter();

529:         if (_coreBranchBridgeAgent == address(0)) revert InvalidCoreBrancBridgeAgent();

544:         if (_coreBranchRouter == address(0)) revert InvalidCoreBranchRouter();

545:         if (_coreBranchBridgeAgent == address(0)) revert InvalidCoreBrancBridgeAgent();

558:         if (!isBridgeAgentFactory[msg.sender]) revert UnrecognizedBridgeAgentFactory();

564:         if (!isBridgeAgent[msg.sender]) revert UnrecognizedBridgeAgent();

570:         if (msg.sender != coreRootRouterAddress) revert UnrecognizedCoreRootRouter();

576:         if (msg.sender != localBranchPortAddress) revert UnrecognizedLocalBranchPort();

```
*GitHub*: [245](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L245-L245), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L246-L246), [247](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L247-L247), [264](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L264-L264), [282](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L282-L282), [290](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L290-L290), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L299-L299), [309](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L309-L309), [320](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L320-L320), [330](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L330-L330), [341](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L341-L341), [342](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L342-L342), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L360-L360), [383](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L383-L383), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L399-L399), [402](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L402-L402), [422](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L422-L422), [448](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L448-L448), [485](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L485-L485), [489](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L489-L489), [494](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L494-L494), [510](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L510-L510), [511](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L511-L511), [528](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L528-L528), [529](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L529-L529), [544](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L544-L544), [545](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L545-L545), [558](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L558-L558), [564](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L564-L564), [570](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L570-L570), [576](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L576-L576)

```solidity
File: src/VirtualAccount.sol

76:              if (!success) revert CallFailed();

103:             if (!success) revert CallFailed();

111:         if (msg.value != valAccumulator) revert CallFailed();

163:                 revert UnauthorizedCaller();

```
*GitHub*: [76](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L76-L76), [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L103-L103), [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L111-L111), [163](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L163-L163)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

113:         if (msg.sender != localCoreRouterAddress) revert UnrecognizedCoreRouter();

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L113-L113)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

99:                  revert UnrecognizedCoreRouterOrPort();

```
*GitHub*: [99](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L99-L99)

</details>




### [D&#x2011;15] ~~Solmate's SafeTransferLib doesn't check whether the ERC20 contract exists~~
`safeTransferETH()` does not call functions on a contract and instead directly sends funds to the contract, so contract existence checks are not needed for these library calls.

*There are 3 instances of this issue:*

```solidity
File: src/BranchBridgeAgentExecutor.sol

92:              _recipient.safeTransferETH(address(this).balance);

126:             _recipient.safeTransferETH(address(this).balance);

```
*GitHub*: [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L92-L92), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L126-L126)

```solidity
File: src/VirtualAccount.sol

52:          msg.sender.safeTransferETH(_amount);

```
*GitHub*: [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L52-L52)


### [D&#x2011;16] ~~NatSpec: Contract declarations should have `@notice` tags~~
The compiler interprets `///` or `/**` comments [as this tag](https://docs.soliditylang.org/en/latest/natspec-format.html#tags) if one wasn't explicitly provided

*There are 44 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

31   contract ArbitrumBranchBridgeAgent is BranchBridgeAgent {
32       /*///////////////////////////////////////////////////////////////
33                               CONSTRUCTOR
34       //////////////////////////////////////////////////////////////*/
35   
36       /**
37        * @notice Constructor for Arbitrum Branch Bridge Agent.
38        *  @param _localChainId Local Chain Layer Zero Id.
39        *  @param _rootBridgeAgentAddress Root Bridge Agent Address.
40        *  @param _localRouterAddress Local Core Branch Router Address.
41        *  @param _localPortAddress Local Branch Port Address.
42:       */

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L31-L42)

```solidity
File: src/ArbitrumBranchPort.sol

14:  contract ArbitrumBranchPort is BranchPort, IArbitrumBranchPort {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L14-L14)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

37   contract ArbitrumCoreBranchRouter is CoreBranchRouter {
38       /*///////////////////////////////////////////////////////////////
39                                CONSTRUCTOR
40       //////////////////////////////////////////////////////////////*/
41       /**
42        * @notice Constructor for Arbitrum Core Branch Router.
43:       */

```
*GitHub*: [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L37-L43)

```solidity
File: src/BaseBranchRouter.sol

25:  contract BaseBranchRouter is IBranchRouter, Ownable {

```
*GitHub*: [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L25-L25)

```solidity
File: src/BranchBridgeAgent.sol

23:  library DeployBranchBridgeAgent {

45:  contract BranchBridgeAgent is IBranchBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L23-L23), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L45-L45)

```solidity
File: src/BranchBridgeAgentExecutor.sol

15:  library DeployBranchBridgeAgentExecutor {

29:  contract BranchBridgeAgentExecutor is Ownable, BridgeAgentConstants {

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L15-L15), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L29-L29)

```solidity
File: src/BranchPort.sol

17:  contract BranchPort is Ownable, IBranchPort {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L17-L17)

```solidity
File: src/CoreBranchRouter.sol

18   contract CoreBranchRouter is ICoreBranchRouter, BaseBranchRouter {
19:      /// @notice hToken Factory Address.

```
*GitHub*: [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L18-L19)

```solidity
File: src/CoreRootRouter.sol

38   contract CoreRootRouter is IRootRouter, Ownable {
39       /*///////////////////////////////////////////////////////////////
40                       CORE ROOT ROUTER STATE
41       //////////////////////////////////////////////////////////////*/
42   
43:      /// @notice Boolean to indicate if the contract is in set up mode.

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L38-L43)

```solidity
File: src/MulticallRootRouter.sol

57:  contract MulticallRootRouter is IRootRouter, Ownable {

```
*GitHub*: [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L57-L57)

```solidity
File: src/MulticallRootRouterLibZip.sol

26:  contract MulticallRootRouterLibZip is MulticallRootRouter {

```
*GitHub*: [26](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L26-L26)

```solidity
File: src/RootBridgeAgent.sol

32:  contract RootBridgeAgent is IRootBridgeAgent, BridgeAgentConstants {

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L32-L32)

```solidity
File: src/RootBridgeAgentExecutor.sol

13:  library DeployRootBridgeAgentExecutor {

27   contract RootBridgeAgentExecutor is Ownable, BridgeAgentConstants {
28       /*///////////////////////////////////////////////////////////////
29                                   CONSTRUCTOR
30       //////////////////////////////////////////////////////////////*/
31       /**
32        * @notice Constructor for Root Bridge Agent Executor.
33        * @param _rootBridgeAgent the owner of the contract in charge of calling the different execution functions.
34:       */

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L13-L13), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L27-L34)

```solidity
File: src/RootPort.sol

16:  contract RootPort is Ownable, IRootPort {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L16-L16)

```solidity
File: src/VirtualAccount.sol

17:  contract VirtualAccount is IVirtualAccount, ERC1155Receiver {

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L17-L17)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

17   contract ArbitrumBranchBridgeAgentFactory is BranchBridgeAgentFactory {
18       /*///////////////////////////////////////////////////////////////
19                                CONSTRUCTOR
20       //////////////////////////////////////////////////////////////*/
21   
22       /**
23        * @notice Constructor for Bridge Agent Factory Contract.
24        *  @param _rootChainId Root Chain Layer Zero Id.
25        *  @param _rootBridgeAgentFactoryAddress Root Bridge Agent Factory Address.
26        *  @param _localCoreBranchRouterAddress Local Core Branch Router Address.
27        *  @param _localPortAddress Local Branch Port Address.
28        *  @param _owner Owner of the contract.
29:       */

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L17-L29)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

19   contract BranchBridgeAgentFactory is Ownable, IBranchBridgeAgentFactory {
20:      /// @notice Local Chain Id.

```
*GitHub*: [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L19-L20)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

12   contract ERC20hTokenBranchFactory is Ownable, IERC20hTokenBranchFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L12-L13)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

12   contract ERC20hTokenRootFactory is Ownable, IERC20hTokenRootFactory {
13:      /// @notice Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L12-L13)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

11   contract RootBridgeAgentFactory is IRootBridgeAgentFactory {
12:      /// @notice Root Chain Id

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L11-L12)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

10   contract BridgeAgentConstants {
11       // Settlement / Deposit Execution Status
12:  

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L10-L12)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

16   interface IArbitrumBranchPort is IBranchPort {
17       /*///////////////////////////////////////////////////////////////
18                           EXTERNAL FUNCTIONS
19       //////////////////////////////////////////////////////////////*/
20   
21       /**
22        * @notice Function to deposit underlying/native token amount into Port in exchange for Local hToken.
23        *     @param _depositor underlying/native token depositor.
24        *     @param _recipient hToken receiver.
25        *     @param _underlyingAddress underlying/native token address.
26        *     @param _amount amount of tokens.
27:       */

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L16-L27)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

87   interface IBranchBridgeAgent is ILayerZeroReceiver {
88       /*///////////////////////////////////////////////////////////////
89                           VIEW FUNCTIONS
90       //////////////////////////////////////////////////////////////*/
91   
92       /**
93        * @notice External function to return the Branch Chain's Local Port Address.
94        * @return address of the Branch Chain's Local Port.
95:       */

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L87-L95)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

12   interface IBranchBridgeAgentFactory {
13       /*///////////////////////////////////////////////////////////////
14                           BRIDGE AGENT FUNCTIONS
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Creates a new Branch Bridge Agent.
19        * @param newRootRouterAddress New Root Router Address.
20        * @param rootBridgeAgentAddress Root Bridge Agent Address.
21        * @param _rootBridgeAgentFactoryAddress Root Bridge Agent Factory Address.
22        * @return newBridgeAgent New Bridge Agent Address.
23:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L12-L23)

```solidity
File: src/interfaces/IBranchPort.sol

14   interface IBranchPort {
15       /*///////////////////////////////////////////////////////////////
16                               VIEW FUNCTIONS
17       //////////////////////////////////////////////////////////////*/
18       /**
19        * @notice Returns true if the address is a Bridge Agent.
20        *   @param _bridgeAgent Bridge Agent address.
21        *   @return bool.
22:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L14-L22)

```solidity
File: src/interfaces/IBranchRouter.sol

21   interface IBranchRouter {
22       /*///////////////////////////////////////////////////////////////
23                               VIEW / STATE
24       //////////////////////////////////////////////////////////////*/
25   
26:      /// @notice External function to return the Branch Chain's Local Port Address.

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L21-L26)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

27   interface ICoreBranchRouter {
28       /*///////////////////////////////////////////////////////////////
29                           EXTERNAL FUNCTIONS
30       //////////////////////////////////////////////////////////////*/
31   
32       /**
33        * @notice Function to deploy/add a token already present in the global environment to a branch chain.
34        * @param _globalAddress the address of the global virtualized token.
35        * @param _dstChainId the chain to which the token will be added.
36        * @param _gasParams Gas parameters for remote execution.
37:       */

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L27-L37)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

11   interface IERC20hTokenBranch {
12       /*///////////////////////////////////////////////////////////////
13                           ERC20 LOGIC
14       //////////////////////////////////////////////////////////////*/
15   
16       /**
17        * @notice Function to mint tokens in the Branch Chain.
18        * @param account Address of the account to receive the tokens.
19        * @param amount Amount of tokens to be minted.
20        * @return Boolean indicating if the operation was successful.
21:       */

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L11-L21)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

13   interface IERC20hTokenBranchFactory {
14       /*///////////////////////////////////////////////////////////////
15                               hTOKEN FUNCTIONS
16       //////////////////////////////////////////////////////////////*/
17       /**
18        * @notice Function to create a new Branch hToken.
19        * @param _name Name of the Token.
20        * @param _symbol Symbol of the Token.
21        * @param _decimals Decimals of the Token.
22        * @param _addPrefix Boolean to add or not the chain prefix to the token name and symbol.
23:       */

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L13-L23)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

12   interface IERC20hTokenRoot {
13       /*///////////////////////////////////////////////////////////////
14                           VIEW FUNCTIONS
15       //////////////////////////////////////////////////////////////*/
16   
17       /// @notice View Function returns Local Network Identifier.
18:      /// @return Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L12-L18)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

13   interface IERC20hTokenRootFactory {
14       /*///////////////////////////////////////////////////////////////
15                               hTOKEN FUNCTIONS
16       //////////////////////////////////////////////////////////////*/
17   
18       /**
19        * @notice Function to create a new hToken.
20        * @param _name Name of the Token.
21        * @param _symbol Symbol of the Token.
22        * @param _decimals Decimals of the Token.
23:       */

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L13-L23)

```solidity
File: src/interfaces/IMulticall2.sol

9:   interface IMulticall2 {

```
*GitHub*: [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L9-L9)

```solidity
File: src/interfaces/IPortStrategy.sol

12   interface IPortStrategy {
13       /*///////////////////////////////////////////////////////////////
14                             TOKEN MANAGEMENT
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Function to withdraw underlying/native token amount back into Branch Port.
19        *   @param _recipient hToken receiver.
20        *   @param _token native token address.
21        *   @param _amount amount of tokens.
22:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L12-L22)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

94   interface IRootBridgeAgent is ILayerZeroReceiver {
95       /*///////////////////////////////////////////////////////////////
96                               VIEW FUNCTIONS
97       //////////////////////////////////////////////////////////////*/
98   
99       /**
100       * @notice Function that returns the current settlement nonce.
101       *   @return nonce bridge agent's current settlement nonce
102       *
103:      */

```
*GitHub*: [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L94-L103)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

11   interface IRootBridgeAgentFactory {
12       /*///////////////////////////////////////////////////////////////
13                           BRIDGE AGENT FUNCTIONS
14       //////////////////////////////////////////////////////////////*/
15:  

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L11-L15)

```solidity
File: src/interfaces/IRootPort.sol

10:  interface ICoreRootRouter {

31   interface IRootPort {
32       /*///////////////////////////////////////////////////////////////
33                           VIEW FUNCTIONS
34       //////////////////////////////////////////////////////////////*/
35       /**
36        * @notice View Function returns True if the chain Id has been added to the system.
37        *  @param _chainId The Layer Zero chainId of the chain.
38        * @return bool True if the chain Id has been added to the system.
39:       */

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L10-L10), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L31-L39)

```solidity
File: src/interfaces/IRootRouter.sol

14   interface IRootRouter {
15       /*///////////////////////////////////////////////////////////////
16                           LAYERZERO FUNCTIONS
17       ///////////////////////////////////////////////////////////////*/
18   
19       /**
20        *     @notice Function to execute Branch Bridge Agent system initiated requests with no asset deposit.
21        *     @param params data received from messaging layer.
22        *     @param srcChainId chain where the request originated from.
23        *
24:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L14-L24)

```solidity
File: src/interfaces/IVirtualAccount.sol

27   interface IVirtualAccount is IERC721Receiver {
28       /**
29        * @notice Returns the address of the user that owns the VirtualAccount.
30        * @return The address of the user that owns the VirtualAccount.
31:       */

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L27-L31)

```solidity
File: src/token/ERC20hTokenBranch.sol

12:  contract ERC20hTokenBranch is ERC20, Ownable, IERC20hTokenBranch {

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L12-L12)

```solidity
File: src/token/ERC20hTokenRoot.sol

12   contract ERC20hTokenRoot is ERC20, Ownable, IERC20hTokenRoot {
13:      /// @inheritdoc IERC20hTokenRoot

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L12-L13)

</details>




### [D&#x2011;17] ~~Event names should use CamelCase~~
The instances below are already CamelCase (events are supposed to use CamelCase, not lowerCamelCase)

*There are 28 instances of this issue:*

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

332:     event LogExecute(uint256 indexed nonce);

333:     event LogFallback(uint256 indexed nonce);

```
*GitHub*: [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L332-L332), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L333-L333)

```solidity
File: src/interfaces/IBranchPort.sol

220:     event DebtCreated(address indexed _strategy, address indexed _token, uint256 _amount);

221:     event DebtRepaid(address indexed _strategy, address indexed _token, uint256 _amount);

223:     event StrategyTokenAdded(address indexed _token, uint256 indexed _minimumReservesRatio);

224:     event StrategyTokenToggled(address indexed _token);

226      event PortStrategyAdded(
227          address indexed _portStrategy, address indexed _token, uint256 indexed _dailyManagementLimit
228:     );

229:     event PortStrategyToggled(address indexed _portStrategy, address indexed _token);

230      event PortStrategyUpdated(
231          address indexed _portStrategy, address indexed _token, uint256 indexed _dailyManagementLimit
232:     );

234:     event BridgeAgentFactoryAdded(address indexed _bridgeAgentFactory);

235:     event BridgeAgentFactoryToggled(address indexed _bridgeAgentFactory);

237:     event BridgeAgentToggled(address indexed _bridgeAgent);

239:     event CoreBranchSet(address indexed _coreBranchRouter, address indexed _coreBranchBridgeAgent);

```
*GitHub*: [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L220-L220), [221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L221-L221), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L223-L223), [224](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L224-L224), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L226-L228), [229](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L229-L229), [230](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L230-L232), [234](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L234-L234), [235](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L235-L235), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L237-L237), [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L239-L239)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

337:     event LogExecute(uint256 indexed depositNonce, uint256 indexed srcChainId);

338:     event LogFallback(uint256 indexed settlementNonce, uint256 indexed dstChainId);

```
*GitHub*: [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L337-L337), [338](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L338-L338)

```solidity
File: src/interfaces/IRootPort.sol

371:     event BridgeAgentFactoryAdded(address indexed bridgeAgentFactory);

372:     event BridgeAgentFactoryToggled(address indexed bridgeAgentFactory);

374:     event BridgeAgentAdded(address indexed bridgeAgent, address indexed manager);

375:     event BridgeAgentToggled(address indexed bridgeAgent);

376:     event BridgeAgentSynced(address indexed bridgeAgent, address indexed rootBridgeAgent, uint256 indexed srcChainId);

378:     event NewChainAdded(uint256 indexed chainId);

380:     event VirtualAccountCreated(address indexed user, address account);

382      event LocalTokenAdded(
383          address indexed underlyingAddress, address indexed localAddress, address indexed globalAddress, uint256 chainId
384:     );

385:     event GlobalTokenAdded(address indexed localAddress, address indexed globalAddress, uint256 indexed chainId);

386:     event EcosystemTokenAdded(address indexed ecoTokenGlobalAddress);

387:     event CoreRootSet(address indexed coreRootRouter, address indexed coreRootBridgeAgent);

388      event CoreBranchSet(
389          address indexed coreBranchRouter, address indexed coreBranchBridgeAgent, uint16 indexed dstChainId
390:     );

391      event CoreBranchSynced(
392          address indexed coreBranchRouter, address indexed coreBranchBridgeAgent, uint16 indexed dstChainId
393:     );

```
*GitHub*: [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L371-L371), [372](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L372-L372), [374](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L374-L374), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L375-L375), [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L376-L376), [378](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L378-L378), [380](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L380-L380), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L382-L384), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L385-L385), [386](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L386-L386), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L387-L387), [388](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L388-L390), [391](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L391-L393)


### [D&#x2011;18] ~~Unnecessary look up in if condition~~


*There are 3 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

127:             _lzEndpointAddress != address(0) || _rootChainId == _localChainId,

```
*GitHub*: [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L127-L127)

```solidity
File: src/BranchPort.sol

363:         if (_minimumReservesRatio >= DIVISIONER || _minimumReservesRatio < MIN_RESERVE_RATIO) {

```
*GitHub*: [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L363-L363)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

63:              _lzEndpointAddress != address(0) || _rootChainId == _localChainId,

```
*GitHub*: [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L63-L63)


### [D&#x2011;19] ~~NatSpec: Function declarations should have `@notice` tags~~
The compiler interprets `///` or `/**` comments [as this tag](https://docs.soliditylang.org/en/latest/natspec-format.html#tags) if one wasn't explicitly provided

*There are 305 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

43       constructor(
44           uint16 _localChainId,
45           address _rootBridgeAgentAddress,
46           address _localRouterAddress,
47           address _localPortAddress
48       )
49           BranchBridgeAgent(
50               _localChainId,
51               _localChainId,
52               _rootBridgeAgentAddress,
53               address(0),
54               _localRouterAddress,
55               _localPortAddress
56           )
57:      {}

69:      function depositToPort(address underlyingAddress, uint256 amount) external payable lock {

79:      function withdrawFromPort(address localAddress, uint256 amount) external payable lock {

89:      function retrySettlement(uint32, bytes calldata, GasParams[2] calldata, bool) external payable override lock {}

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L43-L57), [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L69-L69), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L79-L79), [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L89-L89)

```solidity
File: src/ArbitrumBranchPort.sol

38:      constructor(uint16 _localChainId, address _rootPortAddress, address _owner) BranchPort(_owner) {

50       function depositToPort(address _depositor, address _recipient, address _underlyingAddress, uint256 _deposit)
51           external
52           override
53           lock
54           requiresBridgeAgent
55:      {

73       function withdrawFromPort(address _depositor, address _recipient, address _globalAddress, uint256 _amount)
74           external
75           override
76           lock
77           requiresBridgeAgent
78:      {

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L38-L38), [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L50-L55), [73](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L73-L78)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

44:      constructor() CoreBranchRouter(address(0)) {}

51:      function addLocalToken(address _underlyingAddress, GasParams calldata) external payable override {

126:     function executeNoSettlement(bytes calldata _data) external payable override requiresAgentExecutor {

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L44-L44), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L51-L51), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L126-L126)

```solidity
File: src/BaseBranchRouter.sol

60:      function initialize(address _localBridgeAgentAddress) external onlyOwner {

74:      function getDepositEntry(uint32 _depositNonce) external view override returns (Deposit memory) {

83:      function callOut(bytes calldata _params, GasParams calldata _gParams) external payable override lock {

88       function callOutAndBridge(bytes calldata _params, DepositInput calldata _dParams, GasParams calldata _gParams)
89           external
90           payable
91           override
92           lock
93:      {

104      function callOutAndBridgeMultiple(
105          bytes calldata _params,
106          DepositMultipleInput calldata _dParams,
107          GasParams calldata _gParams
108:     ) external payable override lock {

123:     function executeNoSettlement(bytes calldata) external payable virtual override requiresAgentExecutor {

128      function executeSettlement(bytes calldata, SettlementParams memory)
129          external
130          payable
131          virtual
132          override
133          requiresAgentExecutor
134:     {

139      function executeSettlementMultiple(bytes calldata, SettlementMultipleParams memory)
140          external
141          payable
142          virtual
143          override
144          requiresAgentExecutor
145:     {

```
*GitHub*: [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L60-L60), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L74-L74), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L83-L83), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L88-L93), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L104-L108), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L123-L123), [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L128-L134), [139](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L139-L145)

```solidity
File: src/BranchBridgeAgent.sol

117      constructor(
118          uint16 _rootChainId,
119          uint16 _localChainId,
120          address _rootBridgeAgentAddress,
121          address _lzEndpointAddress,
122          address _localRouterAddress,
123          address _localPortAddress
124:     ) {

156:     function getDepositEntry(uint32 _depositNonce) external view override returns (Deposit memory) {

161      function getFeeEstimate(uint256 _gasLimit, uint256 _remoteBranchExecutionGas, bytes calldata _payload)
162          external
163          view
164          returns (uint256 _fee)
165:     {

180      function callOutSystem(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
181          external
182          payable
183          override
184          lock
185          requiresRouter
186:     {

195      function callOut(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
196          external
197          payable
198          override
199          lock
200:     {

209      function callOutAndBridge(
210          address payable _refundee,
211          bytes calldata _params,
212          DepositInput memory _dParams,
213          GasParams calldata _gParams
214:     ) external payable override lock {

231      function callOutAndBridgeMultiple(
232          address payable _refundee,
233          bytes calldata _params,
234          DepositMultipleInput memory _dParams,
235          GasParams calldata _gParams
236:     ) external payable override lock {

262      function callOutSigned(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
263          external
264          payable
265          override
266          lock
267:     {

276      function callOutSignedAndBridge(
277          address payable _refundee,
278          bytes calldata _params,
279          DepositInput memory _dParams,
280          GasParams calldata _gParams,
281          bool _hasFallbackToggled
282:     ) external payable override lock {

306      function callOutSignedAndBridgeMultiple(
307          address payable _refundee,
308          bytes calldata _params,
309          DepositMultipleInput memory _dParams,
310          GasParams calldata _gParams,
311          bool _hasFallbackToggled
312:     ) external payable override lock {

343      function retryDeposit(
344          bool _isSigned,
345          uint32 _depositNonce,
346          bytes calldata _params,
347          GasParams calldata _gParams,
348          bool _hasFallbackToggled
349:     ) external payable override lock {

422:     function retrieveDeposit(uint32 _depositNonce, GasParams calldata _gParams) external payable override lock {

434:     function redeemDeposit(uint32 _depositNonce) external override lock {

464      function retrySettlement(
465          uint32 _settlementNonce,
466          bytes calldata _params,
467          GasParams[2] calldata _gParams,
468          bool _hasFallbackToggled
469:     ) external payable virtual override lock {

485      function clearToken(address _recipient, address _hToken, address _token, uint256 _amount, uint256 _deposit)
486          external
487          override
488          requiresAgentExecutor
489:     {

494      function clearTokens(bytes calldata _sParams, address _recipient)
495          external
496          override
497          requiresAgentExecutor
498          returns (SettlementMultipleParams memory)
499:     {

578:     function lzReceive(uint16, bytes calldata _srcAddress, uint64, bytes calldata _payload) public override {

587      function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload)
588          public
589          override
590          requiresEndpoint(_endpoint, _srcAddress)
591:     {

```
*GitHub*: [117](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L117-L124), [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L156-L156), [161](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L161-L165), [180](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L180-L186), [195](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L195-L200), [209](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L209-L214), [231](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L231-L236), [262](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L262-L267), [276](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L276-L282), [306](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L306-L312), [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L343-L349), [422](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L422-L422), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L434-L434), [464](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L464-L469), [485](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L485-L489), [494](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L494-L499), [578](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L578-L578), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L587-L591)

```solidity
File: src/BranchBridgeAgentExecutor.sol

39:      constructor() {

53:      function executeNoSettlement(address _router, bytes calldata _payload) external payable onlyOwner {

66       function executeWithSettlement(address _recipient, address _router, bytes calldata _payload)
67           external
68           payable
69           onlyOwner
70:      {

104      function executeWithSettlementMultiple(address _recipient, address _router, bytes calldata _payload)
105          external
106          payable
107          onlyOwner
108:     {

```
*GitHub*: [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L39-L39), [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L53-L53), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L66-L70), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L104-L108)

```solidity
File: src/BranchPort.sol

108:     constructor(address _owner) {

122:     function initialize(address _coreBranchRouter, address _bridgeAgentFactory) external virtual onlyOwner {

135:     function renounceOwnership() public payable override onlyOwner {

144:     function manage(address _token, uint256 _amount) external override requiresPortStrategy(_token) {

167:     function replenishReserves(address _token, uint256 _amount) external override lock {

188:     function replenishReserves(address _strategy, address _token) external override lock {

226      function withdraw(address _recipient, address _underlyingAddress, uint256 _deposit)
227          public
228          virtual
229          override
230          lock
231          requiresBridgeAgent
232:     {

237      function bridgeIn(address _recipient, address _localAddress, uint256 _amount)
238          external
239          override
240          requiresBridgeAgent
241:     {

246      function bridgeInMultiple(
247          address _recipient,
248          address[] memory _localAddresses,
249          address[] memory _underlyingAddresses,
250          uint256[] memory _amounts,
251          uint256[] memory _deposits
252:     ) external override requiresBridgeAgent {

277      function bridgeOut(
278          address _depositor,
279          address _localAddress,
280          address _underlyingAddress,
281          uint256 _amount,
282          uint256 _deposit
283:     ) external override lock requiresBridgeAgent {

288      function bridgeOutMultiple(
289          address _depositor,
290          address[] memory _localAddresses,
291          address[] memory _underlyingAddresses,
292          uint256[] memory _amounts,
293          uint256[] memory _deposits
294:     ) external override lock requiresBridgeAgent {

319:     function addBridgeAgent(address _bridgeAgent) external override requiresBridgeAgentFactory {

331:     function setCoreRouter(address _newCoreRouter) external override requiresCoreRouter {

338:     function addBridgeAgentFactory(address _newBridgeAgentFactory) external override requiresCoreRouter {

348:     function toggleBridgeAgentFactory(address _newBridgeAgentFactory) external override requiresCoreRouter {

355:     function toggleBridgeAgent(address _bridgeAgent) external override requiresCoreRouter {

362:     function addStrategyToken(address _token, uint256 _minimumReservesRatio) external override requiresCoreRouter {

375:     function toggleStrategyToken(address _token) external override requiresCoreRouter {

382      function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
383          external
384          override
385          requiresCoreRouter
386:     {

396:     function togglePortStrategy(address _portStrategy, address _token) external override requiresCoreRouter {

403      function updatePortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
404          external
405          override
406          requiresCoreRouter
407:     {

414      function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent)
415          external
416          override
417          requiresCoreRouter
418:     {

```
*GitHub*: [108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L108-L108), [122](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L122-L122), [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L135-L135), [144](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L144-L144), [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L167-L167), [188](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L188-L188), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L226-L232), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L237-L241), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L246-L252), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L277-L283), [288](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L288-L294), [319](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L319-L319), [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L331-L331), [338](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L338-L338), [348](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L348-L348), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L355-L355), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L362-L362), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L375-L375), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L382-L386), [396](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L396-L396), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L403-L407), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L414-L418)

```solidity
File: src/CoreBranchRouter.sol

30:      constructor(address _hTokenFactoryAddress) BaseBranchRouter() {

43       function addGlobalToken(address _globalAddress, uint256 _dstChainId, GasParams[3] calldata _gParams)
44           external
45           payable
46:      {

62:      function addLocalToken(address _underlyingAddress, GasParams calldata _gParams) external payable virtual {

86:      function executeNoSettlement(bytes calldata _params) external payable virtual override requiresAgentExecutor {

```
*GitHub*: [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L30-L30), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L43-L46), [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L62-L62), [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L86-L86)

```solidity
File: src/CoreRootRouter.sol

71:      constructor(uint256 _rootChainId, address _rootPortAddress) {

103      function addBranchToBridgeAgent(
104          address _rootBridgeAgent,
105          address _branchBridgeAgentFactory,
106          address _newBranchRouter,
107          address _refundee,
108          uint16 _dstChainId,
109          GasParams[2] calldata _gParams
110:     ) external payable {

156      function toggleBranchBridgeAgentFactory(
157          address _rootBridgeAgentFactory,
158          address _branchBridgeAgentFactory,
159          address _refundee,
160          uint16 _dstChainId,
161          GasParams calldata _gParams
162:     ) external payable onlyOwner {

186      function removeBranchBridgeAgent(
187          address _branchBridgeAgent,
188          address _refundee,
189          uint16 _dstChainId,
190          GasParams calldata _gParams
191:     ) external payable onlyOwner {

212      function manageStrategyToken(
213          address _underlyingToken,
214          uint256 _minimumReservesRatio,
215          address _refundee,
216          uint16 _dstChainId,
217          GasParams calldata _gParams
218:     ) external payable onlyOwner {

241      function managePortStrategy(
242          address _portStrategy,
243          address _underlyingToken,
244          uint256 _dailyManagementLimit,
245          bool _isUpdateDailyLimit,
246          address _refundee,
247          uint16 _dstChainId,
248          GasParams calldata _gParams
249:     ) external payable onlyOwner {

270      function setCoreBranch(
271          address _refundee,
272          address _coreBranchRouter,
273          address _coreBranchBridgeAgent,
274          uint16 _dstChainId,
275          GasParams calldata _gParams
276:     ) external payable {

297      function executeResponse(bytes calldata _encodedData, uint16 _srcChainId)
298          external
299          payable
300          override
301          requiresExecutor
302:     {

332:     function execute(bytes calldata _encodedData, uint16) external payable override requiresExecutor {

350      function executeDepositSingle(bytes memory, DepositParams memory, uint16)
351          external
352          payable
353          override
354          requiresExecutor
355:     {

360      function executeDepositMultiple(bytes calldata, DepositMultipleParams memory, uint16)
361          external
362          payable
363          override
364          requiresExecutor
365:     {

370:     function executeSigned(bytes memory, address, uint16) external payable override requiresExecutor {

375      function executeSignedDepositSingle(bytes memory, DepositParams memory, address, uint16)
376          external
377          payable
378          override
379          requiresExecutor
380:     {

385      function executeSignedDepositMultiple(bytes memory, DepositMultipleParams memory, address, uint16)
386          external
387          payable
388          override
389          requiresExecutor
390:     {

```
*GitHub*: [71](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L71-L71), [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L103-L110), [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L156-L162), [186](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L186-L191), [212](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L212-L218), [241](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L241-L249), [270](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L270-L276), [297](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L297-L302), [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L332-L332), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L350-L355), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L360-L365), [370](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L370-L370), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L375-L380), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L385-L390)

```solidity
File: src/MulticallRootRouter.sol

92:      constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress) {

109:     function initialize(address _bridgeAgentAddress) external onlyOwner {

123:     function executeResponse(bytes memory, uint16) external payable override {

137:     function execute(bytes calldata encodedData, uint16) external payable override lock requiresExecutor {

203:     function executeDepositSingle(bytes calldata, DepositParams calldata, uint16) external payable override {

209:     function executeDepositMultiple(bytes calldata, DepositMultipleParams calldata, uint16) external payable {

223      function executeSigned(bytes calldata encodedData, address userAccount, uint16)
224          external
225          payable
226          override
227          lock
228          requiresExecutor
229:     {

312      function executeSignedDepositSingle(bytes calldata encodedData, DepositParams calldata, address userAccount, uint16)
313          external
314          payable
315          override
316          requiresExecutor
317          lock
318:     {

401      function executeSignedDepositMultiple(
402          bytes calldata encodedData,
403          DepositMultipleParams calldata,
404          address userAccount,
405          uint16
406:     ) external payable override requiresExecutor lock {

```
*GitHub*: [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L92-L92), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L109-L109), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L123-L123), [137](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L137-L137), [203](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L203-L203), [209](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L209-L209), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L223-L229), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L312-L318), [401](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L401-L406)

```solidity
File: src/RootBridgeAgent.sol

105      constructor(
106          uint16 _localChainId,
107          address _lzEndpointAddress,
108          address _localPortAddress,
109          address _localRouterAddress
110:     ) {

135:     function getSettlementEntry(uint32 _settlementNonce) external view override returns (Settlement memory) {

140      function getFeeEstimate(
141          uint256 _gasLimit,
142          uint256 _remoteBranchExecutionGas,
143          bytes calldata _payload,
144          uint16 _dstChainId
145:     ) external view returns (uint256 _fee) {

160      function callOut(
161          address payable _refundee,
162          address _recipient,
163          uint16 _dstChainId,
164          bytes calldata _params,
165          GasParams calldata _gParams
166:     ) external payable override lock requiresRouter {

175      function callOutAndBridge(
176          address payable _refundee,
177          address _recipient,
178          uint16 _dstChainId,
179          bytes calldata _params,
180          SettlementInput calldata _sParams,
181          GasParams calldata _gParams,
182          bool _hasFallbackToggled
183:     ) external payable override lock requiresRouter {

202      function callOutAndBridgeMultiple(
203          address payable _refundee,
204          address _recipient,
205          uint16 _dstChainId,
206          bytes calldata _params,
207          SettlementMultipleInput calldata _sParams,
208          GasParams calldata _gParams,
209          bool _hasFallbackToggled
210:     ) external payable override lock requiresRouter {

233      function retrySettlement(
234          uint32 _settlementNonce,
235          address _recipient,
236          bytes calldata _params,
237          GasParams calldata _gParams,
238          bool _hasFallbackToggled
239:     ) external payable override lock {

274:     function retrieveSettlement(uint32 _settlementNonce, GasParams calldata _gParams) external payable lock {

299:     function redeemSettlement(uint32 _settlementNonce) external override lock {

351      function bridgeIn(address _recipient, DepositParams memory _dParams, uint256 _srcChainId)
352          public
353          override
354          requiresAgentExecutor
355:     {

387      function bridgeInMultiple(address _recipient, DepositMultipleParams calldata _dParams, uint256 _srcChainId)
388          external
389          override
390          requiresAgentExecutor
391:     {

423:     function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64, bytes calldata _payload) public {

434      function lzReceiveNonBlocking(
435          address _endpoint,
436          uint16 _srcChainId,
437          bytes calldata _srcAddress,
438          bytes calldata _payload
439:     ) public override requiresEndpoint(_endpoint, _srcChainId, _srcAddress) {

1170:    function approveBranchBridgeAgent(uint256 _branchChainId) external override requiresManager {

1176     function syncBranchBridgeAgent(address _newBranchBridgeAgent, uint256 _branchChainId)
1177         external
1178         override
1179         requiresPort
1180:    {

```
*GitHub*: [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L105-L110), [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L135-L135), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L140-L145), [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L160-L166), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L175-L183), [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L202-L210), [233](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L233-L239), [274](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L274-L274), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L299-L299), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L351-L355), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L387-L391), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L423-L423), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L434-L439), [1170](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1170-L1170), [1176](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1176-L1180)

```solidity
File: src/RootBridgeAgentExecutor.sol

35:      constructor(address _rootBridgeAgent) {

50       function executeSystemRequest(address _router, bytes calldata _payload, uint16 _srcChainId)
51           external
52           payable
53           onlyOwner
54:      {

66       function executeNoDeposit(address _router, bytes calldata _payload, uint16 _srcChainId)
67           external
68           payable
69           onlyOwner
70:      {

82       function executeWithDeposit(address _router, bytes calldata _payload, uint16 _srcChainId)
83           external
84           payable
85           onlyOwner
86:      {

115      function executeWithDepositMultiple(address _router, bytes calldata _payload, uint16 _srcChainId)
116          external
117          payable
118          onlyOwner
119:     {

150      function executeSignedNoDeposit(address _account, address _router, bytes calldata _payload, uint16 _srcChainId)
151          external
152          payable
153          onlyOwner
154:     {

167      function executeSignedWithDeposit(address _account, address _router, bytes calldata _payload, uint16 _srcChainId)
168          external
169          payable
170          onlyOwner
171:     {

201      function executeSignedWithDepositMultiple(
202          address _account,
203          address _router,
204          bytes calldata _payload,
205          uint16 _srcChainId
206:     ) external payable onlyOwner {

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L35-L35), [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L50-L54), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L66-L70), [82](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L82-L86), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L115-L119), [150](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L150-L154), [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L167-L171), [201](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L201-L206)

```solidity
File: src/RootPort.sol

111:     constructor(uint256 _localChainId) {

129:     function initialize(address _bridgeAgentFactory, address _coreRootRouter) external onlyOwner {

147      function initializeCore(
148          address _coreRootBridgeAgent,
149          address _coreLocalBranchBridgeAgent,
150          address _localBranchPortAddress
151:     ) external onlyOwner {

166:     function renounceOwnership() public payable override onlyOwner {

175      function getLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
176          external
177          view
178          override
179          returns (address)
180:     {

200      function getUnderlyingTokenFromGlobal(address _globalAddress, uint256 _srcChainId)
201          external
202          view
203          override
204          returns (address)
205:     {

211:     function isGlobalToken(address _globalAddress, uint256 _srcChainId) external view override returns (bool) {

216:     function isLocalToken(address _localAddress, uint256 _srcChainId) external view override returns (bool) {

221      function isLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
222          external
223          view
224          returns (bool)
225:     {

230:     function isUnderlyingToken(address _underlyingToken, uint256 _srcChainId) external view override returns (bool) {

239      function setAddresses(
240          address _globalAddress,
241          address _localAddress,
242          address _underlyingAddress,
243          uint256 _srcChainId
244:     ) external override requiresCoreRootRouter {

259      function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId)
260          external
261          override
262          requiresCoreRootRouter
263:     {

277      function bridgeToRoot(address _recipient, address _hToken, uint256 _amount, uint256 _deposit, uint256 _srcChainId)
278          external
279          override
280          requiresBridgeAgent
281:     {

294      function bridgeToRootFromLocalBranch(address _from, address _hToken, uint256 _amount)
295          external
296          override
297          requiresLocalBranchPort
298:     {

315      function burn(address _from, address _hToken, uint256 _amount, uint256 _srcChainId)
316          external
317          override
318          requiresBridgeAgent
319:     {

325      function burnFromLocalBranch(address _from, address _hToken, uint256 _amount)
326          external
327          override
328          requiresLocalBranchPort
329:     {

336      function mintToLocalBranch(address _to, address _hToken, uint256 _amount)
337          external
338          override
339          requiresLocalBranchPort
340:     {

350:     function fetchVirtualAccount(address _user) external override returns (VirtualAccount account) {

369      function toggleVirtualAccountApproved(VirtualAccount _userAccount, address _router)
370          external
371          override
372          requiresBridgeAgent
373:     {

382:     function addBridgeAgent(address _manager, address _bridgeAgent) external override requiresBridgeAgentFactory {

393      function syncBranchBridgeAgentWithRoot(
394          address _newBranchBridgeAgent,
395          address _rootBridgeAgent,
396          uint256 _branchChainId
397:     ) external override requiresCoreRootRouter {

414:     function toggleBridgeAgent(address _bridgeAgent) external override onlyOwner {

421:     function addBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

431:     function toggleBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

438      function addNewChain(
439          address _coreBranchBridgeAgentAddress,
440          uint256 _chainId,
441          string memory _wrappedGasTokenName,
442          string memory _wrappedGasTokenSymbol,
443          uint8 _wrappedGasTokenDecimals,
444          address _newLocalBranchWrappedNativeTokenAddress,
445          address _newUnderlyingBranchWrappedNativeTokenAddress
446:     ) external override onlyOwner {

483:     function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {

509:     function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {

521      function setCoreBranchRouter(
522          address _refundee,
523          address _coreBranchRouter,
524          address _coreBranchBridgeAgent,
525          uint16 _dstChainId,
526          GasParams calldata _gParams
527:     ) external payable override onlyOwner {

539      function syncNewCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent, uint16 _dstChainId)
540          external
541          override
542          onlyOwner
543:     {

```
*GitHub*: [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L111-L111), [129](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L129-L129), [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L147-L151), [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L166-L166), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L175-L180), [200](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L200-L205), [211](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L211-L211), [216](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L216-L216), [221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L221-L225), [230](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L230-L230), [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L239-L244), [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L259-L263), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L277-L281), [294](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L294-L298), [315](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L315-L319), [325](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L325-L329), [336](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L336-L340), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L350-L350), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L369-L373), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L382-L382), [393](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L393-L397), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L414-L414), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L421-L421), [431](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L431-L431), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L438-L446), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483-L483), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509-L509), [521](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L521-L527), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L539-L543)

```solidity
File: src/VirtualAccount.sol

35:      constructor(address _userAddress, address _localPortAddress) {

51:      function withdrawNative(uint256 _amount) external override requiresApprovedCaller {

56:      function withdrawERC20(address _token, uint256 _amount) external override requiresApprovedCaller {

61:      function withdrawERC721(address _token, uint256 _tokenId) external override requiresApprovedCaller {

66:      function call(Call[] calldata calls) external override requiresApprovedCaller returns (bytes[] memory returnData) {

85:      function payableCall(PayableCall[] calldata calls) public payable returns (bytes[] memory returnData) {

119:     function onERC721Received(address, address, uint256, bytes calldata) external pure override returns (bytes4) {

124      function onERC1155Received(address, address, uint256, uint256, bytes calldata)
125          external
126          pure
127          override
128          returns (bytes4)
129:     {

134      function onERC1155BatchReceived(address, address, uint256[] calldata, uint256[] calldata, bytes calldata)
135          external
136          pure
137          override
138          returns (bytes4)
139:     {

```
*GitHub*: [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L35-L35), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L51-L51), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L56-L56), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L61-L61), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L66-L66), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L85-L85), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L119-L119), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L124-L129), [134](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L134-L139)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

30       constructor(
31           uint16 _rootChainId,
32           address _rootBridgeAgentFactoryAddress,
33           address _localCoreBranchRouterAddress,
34           address _localPortAddress,
35           address _owner
36       )
37           BranchBridgeAgentFactory(
38               _rootChainId,
39               _rootChainId,
40               _rootBridgeAgentFactoryAddress,
41               address(0),
42               _localCoreBranchRouterAddress,
43               _localPortAddress,
44               _owner
45           )
46:      {}

56:      function initialize(address _coreRootBridgeAgent) external override onlyOwner {

79       function createBridgeAgent(
80           address _newBranchRouterAddress,
81           address _rootBridgeAgentAddress,
82           address _rootBridgeAgentFactoryAddress
83:      ) external virtual override returns (address newBridgeAgent) {

```
*GitHub*: [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L30-L46), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L56-L56), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L79-L83)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

52       constructor(
53           uint16 _localChainId,
54           uint16 _rootChainId,
55           address _rootBridgeAgentFactoryAddress,
56           address _lzEndpointAddress,
57           address _localCoreBranchRouterAddress,
58           address _localPortAddress,
59           address _owner
60:      ) {

87:      function initialize(address _coreRootBridgeAgent) external virtual onlyOwner {

115      function createBridgeAgent(
116          address _newBranchRouterAddress,
117          address _rootBridgeAgentAddress,
118          address _rootBridgeAgentFactoryAddress
119:     ) external virtual returns (address newBridgeAgent) {

```
*GitHub*: [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L52-L60), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L87-L87), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L115-L119)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

42:      constructor(uint16 _localChainId, address _localPortAddress, string memory _chainName, string memory _chainSymbol) {

60:      function initialize(address _wrappedNativeTokenAddress, address _coreRouter) external onlyOwner {

87:      function getHTokens() external view returns (ERC20hTokenBranch[] memory) {

96       function createToken(string memory _name, string memory _symbol, uint8 _decimals, bool _addPrefix)
97           external
98           requiresCoreRouter
99           returns (ERC20hTokenBranch newToken)
100:     {

```
*GitHub*: [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L42-L42), [60](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L60-L60), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L87-L87), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L96-L100)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

34:      constructor(uint16 _localChainId, address _rootPortAddress) {

49:      function initialize(address _coreRouter) external onlyOwner {

63:      function getHTokens() external view returns (ERC20hTokenRoot[] memory) {

76       function createToken(string memory _name, string memory _symbol, uint8 _decimals)
77           external
78           requiresCoreRouterOrPort
79           returns (ERC20hTokenRoot newToken)
80:      {

```
*GitHub*: [34](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L34-L34), [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L49-L49), [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L63-L63), [76](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L76-L80)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

31:      constructor(uint16 _rootChainId, address _lzEndpointAddress, address _rootPortAddress) {

48:      function createBridgeAgent(address _newRootRouterAddress) external returns (address newBridgeAgent) {

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L31-L31), [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L48-L48)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

28       function depositToPort(address _depositor, address _recipient, address _underlyingAddress, uint256 _amount)
29:          external;

38       function withdrawFromPort(address _depositor, address _recipient, address _globalAddress, uint256 _amount)
39:          external;

```
*GitHub*: [28](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L28-L29), [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L38-L39)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

96:      function localPortAddress() external view returns (address);

102:     function bridgeAgentExecutorAddress() external view returns (address);

109:     function getDepositEntry(uint32 depositNonce) external view returns (Deposit memory);

120      function getFeeEstimate(uint256 _gasLimit, uint256 _remoteBranchExecutionGas, bytes calldata _payload)
121          external
122          view
123:         returns (uint256 _fee);

138      function callOutSystem(address payable gasRefundee, bytes calldata params, GasParams calldata gasParams)
139          external
140:         payable;

150      function callOut(address payable gasRefundee, bytes calldata params, GasParams calldata gasParams)
151          external
152:         payable;

163      function callOutAndBridge(
164          address payable gasRefundee,
165          bytes calldata params,
166          DepositInput memory depositParams,
167          GasParams calldata gasParams
168:     ) external payable;

179      function callOutAndBridgeMultiple(
180          address payable gasRefundee,
181          bytes calldata params,
182          DepositMultipleInput memory depositParams,
183          GasParams calldata gasParams
184:     ) external payable;

194      function callOutSigned(address payable gasRefundee, bytes calldata params, GasParams calldata gasParams)
195          external
196:         payable;

208      function callOutSignedAndBridge(
209          address payable gasRefundee,
210          bytes calldata params,
211          DepositInput memory depositParams,
212          GasParams calldata gasParams,
213          bool hasFallbackToggled
214:     ) external payable;

227      function callOutSignedAndBridgeMultiple(
228          address payable gasRefundee,
229          bytes calldata params,
230          DepositMultipleInput memory depositParams,
231          GasParams calldata gasParams,
232          bool hasFallbackToggled
233:     ) external payable;

248      function retryDeposit(
249          bool isSigned,
250          uint32 depositNonce,
251          bytes calldata params,
252          GasParams calldata gasParams,
253          bool hasFallbackToggled
254:     ) external payable;

263:     function retrieveDeposit(uint32 depositNonce, GasParams calldata gasParams) external payable;

270:     function redeemDeposit(uint32 depositNonce) external;

285      function retrySettlement(
286          uint32 settlementNonce,
287          bytes calldata params,
288          GasParams[2] calldata gasParams,
289          bool hasFallbackToggled
290:     ) external payable;

305:     function clearToken(address recipient, address hToken, address token, uint256 amount, uint256 deposit) external;

312      function clearTokens(bytes calldata sParams, address recipient)
313          external
314:         returns (SettlementMultipleParams memory);

326:     function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload) external;

```
*GitHub*: [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L96-L96), [102](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L102-L102), [109](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L109-L109), [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L120-L123), [138](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L138-L140), [150](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L150-L152), [163](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L163-L168), [179](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L179-L184), [194](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L194-L196), [208](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L208-L214), [227](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L227-L233), [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L248-L254), [263](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L263-L263), [270](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L270-L270), [285](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L285-L290), [305](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L305-L305), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L312-L314), [326](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L326-L326)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

24       function createBridgeAgent(
25           address newRootRouterAddress,
26           address rootBridgeAgentAddress,
27           address _rootBridgeAgentFactoryAddress
28:      ) external returns (address newBridgeAgent);

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L24-L28)

```solidity
File: src/interfaces/IBranchPort.sol

23:      function isBridgeAgent(address _bridgeAgent) external view returns (bool);

30:      function isStrategyToken(address _token) external view returns (bool);

38:      function isPortStrategy(address _strategy, address _token) external view returns (bool);

45:      function isBridgeAgentFactory(address _bridgeAgentFactory) external view returns (bool);

56:      function manage(address _token, uint256 _amount) external;

64:      function replenishReserves(address _token, uint256 _amount) external;

72:      function replenishReserves(address _strategy, address _token) external;

85:      function withdraw(address _recipient, address _underlyingAddress, uint256 _amount) external;

94:      function bridgeIn(address _recipient, address _localAddress, uint256 _amount) external;

103      function bridgeInMultiple(
104          address _recipient,
105          address[] memory _localAddresses,
106          address[] memory _underlyingAddresses,
107          uint256[] memory _amounts,
108          uint256[] memory _deposits
109:     ) external;

118      function bridgeOut(
119          address _depositor,
120          address _localAddress,
121          address _underlyingAddress,
122          uint256 _amount,
123          uint256 _deposit
124:     ) external;

135      function bridgeOutMultiple(
136          address _depositor,
137          address[] memory _localAddresses,
138          address[] memory _underlyingAddresses,
139          uint256[] memory _amounts,
140          uint256[] memory _deposits
141:     ) external;

151:     function addBridgeAgent(address _bridgeAgent) external;

157:     function setCoreRouter(address _newCoreRouter) external;

163:     function addBridgeAgentFactory(address _bridgeAgentFactory) external;

169:     function toggleBridgeAgentFactory(address _newBridgeAgentFactory) external;

175:     function toggleBridgeAgent(address _bridgeAgent) external;

181:     function addStrategyToken(address _token, uint256 _minimumReservesRatio) external;

187:     function toggleStrategyToken(address _token) external;

193:     function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit) external;

199:     function togglePortStrategy(address _portStrategy, address _token) external;

207:     function updatePortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit) external;

214:     function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent) external;

```
*GitHub*: [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L23-L23), [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L30-L30), [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L38-L38), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L45-L45), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L56-L56), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L64-L64), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L72-L72), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L85-L85), [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L94-L94), [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L103-L109), [118](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L118-L124), [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L135-L141), [151](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L151-L151), [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L157-L157), [163](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L163-L163), [169](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L169-L169), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L175-L175), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L181-L181), [187](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L187-L187), [193](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L193-L193), [199](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L199-L199), [207](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L207-L207), [214](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L214-L214)

```solidity
File: src/interfaces/IBranchRouter.sol

27:      function localPortAddress() external view returns (address);

30:      function localBridgeAgentAddress() external view returns (address);

33:      function bridgeAgentExecutorAddress() external view returns (address);

46:      function callOut(bytes calldata params, GasParams calldata gParams) external payable;

56       function callOutAndBridge(bytes calldata params, DepositInput calldata dParams, GasParams calldata gParams)
57           external
58:          payable;

68       function callOutAndBridgeMultiple(
69           bytes calldata params,
70           DepositMultipleInput calldata dParams,
71           GasParams calldata gParams
72:      ) external payable;

79:      function getDepositEntry(uint32 depositNonce) external view returns (Deposit memory);

89:      function executeNoSettlement(bytes calldata params) external payable;

96:      function executeSettlement(bytes calldata params, SettlementParams calldata sParams) external payable;

105      function executeSettlementMultiple(bytes calldata params, SettlementMultipleParams calldata sParams)
106          external
107:         payable;

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L27-L27), [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L30-L30), [33](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L33-L33), [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L46-L46), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L56-L58), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L68-L72), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L79-L79), [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L89-L89), [96](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L96-L96), [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L105-L107)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

38       function addGlobalToken(address _globalAddress, uint256 _dstChainId, GasParams[3] calldata _gasParams)
39           external
40:          payable;

47:      function addLocalToken(address _underlyingAddress, GasParams calldata _gasParams) external payable;

```
*GitHub*: [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L38-L40), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L47-L47)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

22:      function mint(address account, uint256 amount) external returns (bool);

28:      function burn(uint256 amount) external;

```
*GitHub*: [22](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L22-L22), [28](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L28-L28)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

24       function createToken(string memory _name, string memory _symbol, uint8 _decimals, bool _addPrefix)
25           external
26:          returns (ERC20hTokenBranch newToken);

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L24-L26)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

19:      function localChainId() external view returns (uint16);

23:      function factoryAddress() external view returns (address);

30:      function getTokenBalance(uint256 chainId) external view returns (uint256);

43:      function mint(address to, uint256 amount, uint256 chainId) external returns (bool);

51:      function burn(address from, uint256 amount, uint256 chainId) external;

```
*GitHub*: [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L19-L19), [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L23-L23), [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L30-L30), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L43-L43), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L51-L51)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

24       function createToken(string memory _name, string memory _symbol, uint8 _decimals)
25           external
26:          returns (ERC20hTokenRoot newToken);

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L24-L26)

```solidity
File: src/interfaces/IPortStrategy.sol

23:      function withdraw(address _recipient, address _token, uint256 _amount) external;

```
*GitHub*: [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L23-L23)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

104:     function settlementNonce() external view returns (uint32 nonce);

111:     function getSettlementEntry(uint32 _settlementNonce) external view returns (Settlement memory);

117:     function bridgeAgentExecutorAddress() external view returns (address);

123:     function factoryAddress() external view returns (address);

130:     function getBranchBridgeAgent(uint256 _chainId) external view returns (address);

138:     function isBranchBridgeAgentAllowed(uint256 _chainId) external view returns (bool);

149      function getFeeEstimate(
150          uint256 _gasLimit,
151          uint256 _remoteBranchExecutionGas,
152          bytes calldata _payload,
153          uint16 _dstChainId
154:     ) external view returns (uint256 _fee);

168      function callOut(
169          address payable _refundee,
170          address _recipient,
171          uint16 _dstChainId,
172          bytes memory _params,
173          GasParams calldata _gParams
174:     ) external payable;

189      function callOutAndBridge(
190          address payable _refundee,
191          address _recipient,
192          uint16 _dstChainId,
193          bytes calldata _params,
194          SettlementInput calldata _sParams,
195          GasParams calldata _gParams,
196          bool _hasFallbackToggled
197:     ) external payable;

213      function callOutAndBridgeMultiple(
214          address payable _refundee,
215          address _recipient,
216          uint16 _dstChainId,
217          bytes calldata _params,
218          SettlementMultipleInput calldata _sParams,
219          GasParams calldata _gParams,
220          bool _hasFallbackToggled
221:     ) external payable;

236      function retrySettlement(
237          uint32 _settlementNonce,
238          address _recipient,
239          bytes calldata _params,
240          GasParams calldata _gParams,
241          bool _hasFallbackToggled
242:     ) external payable;

250:     function retrieveSettlement(uint32 _settlementNonce, GasParams calldata _gParams) external payable;

257:     function redeemSettlement(uint32 _depositNonce) external;

271:     function bridgeIn(address _recipient, DepositParams memory _dParams, uint256 _srcChainId) external;

295      function bridgeInMultiple(address _recipient, DepositMultipleParams calldata _dParams, uint256 _srcChainId)
296:         external;

309      function lzReceiveNonBlocking(
310          address _endpoint,
311          uint16 _srcChainId,
312          bytes calldata _srcAddress,
313          bytes calldata _payload
314:     ) external;

324:     function approveBranchBridgeAgent(uint256 _branchChainId) external;

331:     function syncBranchBridgeAgent(address _newBranchBridgeAgent, uint256 _branchChainId) external;

```
*GitHub*: [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L104-L104), [111](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L111-L111), [117](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L117-L117), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L123-L123), [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L130-L130), [138](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L138-L138), [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L149-L154), [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L168-L174), [189](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L189-L197), [213](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L213-L221), [236](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L236-L242), [250](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L250-L250), [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L257-L257), [271](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L271-L271), [295](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L295-L296), [309](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L309-L314), [324](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L324-L324), [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L331-L331)

```solidity
File: src/interfaces/IRootPort.sol

40:      function isChainId(uint256 _chainId) external view returns (bool);

47:      function getBridgeAgentManager(address _rootBridgeAgent) external view returns (address);

54:      function isBridgeAgentFactory(address _bridgeAgentFactory) external view returns (bool);

61:      function isGlobalAddress(address _globalAddress) external view returns (bool);

69:      function getGlobalTokenFromLocal(address _localAddress, uint256 _srcChainId) external view returns (address);

77:      function getLocalTokenFromGlobal(address _globalAddress, uint256 _srcChainId) external view returns (address);

85       function getLocalTokenFromUnderlying(address _underlyingAddress, uint256 _srcChainId)
86           external
87           view
88:          returns (address);

97       function getLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
98           external
99           view
100:         returns (address);

108:     function getUnderlyingTokenFromLocal(address _localAddress, uint256 _srcChainId) external view returns (address);

116      function getUnderlyingTokenFromGlobal(address _globalAddress, uint256 _srcChainId)
117          external
118          view
119:         returns (address);

127:     function isGlobalToken(address _globalAddress, uint256 _srcChainId) external view returns (bool);

135:     function isLocalToken(address _localAddress, uint256 _srcChainId) external view returns (bool);

144      function isLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
145          external
146          view
147:         returns (bool);

155:     function isUnderlyingToken(address _underlyingToken, uint256 _srcChainId) external view returns (bool);

162:     function getUserAccount(address _user) external view returns (VirtualAccount);

170:     function isRouterApproved(VirtualAccount _userAccount, address _router) external returns (bool);

183:     function burn(address _from, address _hToken, uint256 _amount, uint256 _srcChainId) external;

193      function bridgeToRoot(address _recipient, address _hToken, uint256 _amount, uint256 _deposit, uint256 _srcChainId)
194:         external;

202:     function bridgeToRootFromLocalBranch(address _from, address _hToken, uint256 _amount) external;

210:     function bridgeToLocalBranchFromRoot(address _to, address _hToken, uint256 _amount) external;

218:     function mintToLocalBranch(address _recipient, address _hToken, uint256 _amount) external;

226:     function burnFromLocalBranch(address _from, address _hToken, uint256 _amount) external;

238      function setAddresses(
239          address _globalAddress,
240          address _localAddress,
241          address _underlyingAddress,
242          uint256 _srcChainId
243:     ) external;

251:     function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId) external;

261:     function fetchVirtualAccount(address _user) external returns (VirtualAccount account);

269:     function toggleVirtualAccountApproved(VirtualAccount _userAccount, address _router) external;

281      function syncBranchBridgeAgentWithRoot(address _newBranchBridgeAgent, address _rootBridgeAgent, uint256 _srcChainId)
282:         external;

289:     function addBridgeAgent(address _manager, address _bridgeAgent) external;

295:     function toggleBridgeAgent(address _bridgeAgent) external;

301:     function addBridgeAgentFactory(address _bridgeAgentFactory) external;

307:     function toggleBridgeAgentFactory(address _bridgeAgentFactory) external;

319      function addNewChain(
320          address _coreBranchBridgeAgentAddress,
321          uint256 _chainId,
322          string memory _wrappedGasTokenName,
323          string memory _wrappedGasTokenSymbol,
324          uint8 _wrappedGasTokenDecimals,
325          address _newLocalBranchWrappedNativeTokenAddress,
326          address _newUnderlyingBranchWrappedNativeTokenAddress
327:     ) external;

333:     function addEcosystemToken(address ecoTokenGlobalAddress) external;

340:     function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external;

350      function setCoreBranchRouter(
351          address _refundee,
352          address _coreBranchRouter,
353          address _coreBranchBridgeAgent,
354          uint16 _dstChainId,
355          GasParams calldata _gParams
356:     ) external payable;

364      function syncNewCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent, uint16 _dstChainId)
365:         external;

```
*GitHub*: [40](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L40-L40), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L47-L47), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L54-L54), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L61-L61), [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L69-L69), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L77-L77), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L85-L88), [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L97-L100), [108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L108-L108), [116](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L116-L119), [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L127-L127), [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L135-L135), [144](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L144-L147), [155](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L155-L155), [162](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L162-L162), [170](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L170-L170), [183](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L183-L183), [193](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L193-L194), [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L202-L202), [210](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L210-L210), [218](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L218-L218), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L226-L226), [238](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L238-L243), [251](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L251-L251), [261](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L261-L261), [269](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L269-L269), [281](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L281-L282), [289](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L289-L289), [295](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L295-L295), [301](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L301-L301), [307](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L307-L307), [319](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L319-L327), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L333-L333), [340](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L340-L340), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L350-L356), [364](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L364-L365)

```solidity
File: src/interfaces/IRootRouter.sol

25:      function executeResponse(bytes memory params, uint16 srcChainId) external payable;

33:      function execute(bytes memory params, uint16 srcChainId) external payable;

42       function executeDepositSingle(bytes memory params, DepositParams memory dParams, uint16 srcChainId)
43           external
44:          payable;

53       function executeDepositMultiple(bytes memory params, DepositMultipleParams memory dParams, uint16 srcChainId)
54           external
55:          payable;

63:      function executeSigned(bytes memory params, address userAccount, uint16 srcChainId) external payable;

72       function executeSignedDepositSingle(
73           bytes memory params,
74           DepositParams memory dParams,
75           address userAccount,
76           uint16 srcChainId
77:      ) external payable;

86       function executeSignedDepositMultiple(
87           bytes memory params,
88           DepositMultipleParams memory dParams,
89           address userAccount,
90           uint16 srcChainId
91:      ) external payable;

```
*GitHub*: [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L25-L25), [33](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L33-L33), [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L42-L44), [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L53-L55), [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L63-L63), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L72-L77), [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L86-L91)

```solidity
File: src/interfaces/IVirtualAccount.sol

32:      function userAddress() external view returns (address);

38:      function localPortAddress() external view returns (address);

44:      function withdrawNative(uint256 _amount) external;

51:      function withdrawERC20(address _token, uint256 _amount) external;

58:      function withdrawERC721(address _token, uint256 _tokenId) external;

65:      function call(Call[] calldata callInput) external returns (bytes[] memory);

73:      function payableCall(PayableCall[] calldata calls) external payable returns (bytes[] memory);

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L32-L32), [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L38-L38), [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L44-L44), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L51-L51), [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L58-L58), [65](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L65-L65), [73](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L73-L73)

```solidity
File: src/token/ERC20hTokenBranch.sol

29:      function mint(address account, uint256 amount) external override onlyOwner returns (bool) {

35:      function burn(uint256 amount) public override onlyOwner {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L29-L29), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L35-L35)

```solidity
File: src/token/ERC20hTokenRoot.sol

31       constructor(
32           uint16 _localChainId,
33           address _factoryAddress,
34           address _rootPortAddress,
35           string memory _name,
36           string memory _symbol,
37           uint8 _decimals
38:      ) ERC20(string(string.concat(_name)), string(string.concat(_symbol)), _decimals) {

57:      function mint(address to, uint256 amount, uint256 chainId) external onlyOwner returns (bool) {

69:      function burn(address from, uint256 amount, uint256 chainId) external onlyOwner {

```
*GitHub*: [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L31-L38), [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L57-L57), [69](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L69-L69)

</details>




### [D&#x2011;20] ~~Timestamp may be manipulation~~
Use of `block.timestamp`, in and of itself, is not evidence of an issue; there must be an incorrect usage in the code in order for there to be a vulnerability. There should also be a corresponding suggested fix.

*There are 2 instances of this issue:*

```solidity
File: src/BranchPort.sol

487:         if (block.timestamp - lastManaged[msg.sender][_token] >= 1 days) {

490:                 lastManaged[msg.sender][_token] = (block.timestamp / 1 days) * 1 days;

```
*GitHub*: [487](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L487-L487), [490](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L490-L490)


### [D&#x2011;21] ~~Using bitmap to store bool states can save gas~~
none of these are examples where bitmaps can be used

*There are 10 instances of this issue:*

```solidity
File: src/BranchPort.sol

32:      mapping(address bridgeAgent => bool isActiveBridgeAgent) public isBridgeAgent;

42:      mapping(address bridgeAgentFactory => bool isActiveBridgeAgentFactory) public isBridgeAgentFactory;

52:      mapping(address token => bool allowsStrategies) public isStrategyToken;

68:      mapping(address strategy => mapping(address token => bool isActiveStrategy)) public isPortStrategy;

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L32-L32), [42](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L42-L42), [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L52-L52), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L68-L68)

```solidity
File: src/RootBridgeAgent.sol

68:      mapping(uint256 chainId => bool allowed) public isBranchBridgeAgentAllowed;

```
*GitHub*: [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L68-L68)

```solidity
File: src/RootPort.sol

54:      mapping(VirtualAccount acount => mapping(address router => bool allowed)) public isRouterApproved;

61:      mapping(uint256 chainId => bool isActive) public isChainId;

64:      mapping(address bridgeAgent => bool isActive) public isBridgeAgent;

77:      mapping(address bridgeAgentFactory => bool isActive) public isBridgeAgentFactory;

87:      mapping(address token => bool isGlobalToken) public isGlobalAddress;

```
*GitHub*: [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L54-L54), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L61-L61), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L64-L64), [77](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L77-L77), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L87-L87)


### [D&#x2011;22] ~~All interfaces used within a project should be imported~~
These contracts don't rely on other contracts for their definitions, so there's nothing to import

*There are 21 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

10:  library DeployArbitrumBranchBridgeAgent {

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L10-L10)

```solidity
File: src/BranchBridgeAgent.sol

23:  library DeployBranchBridgeAgent {

```
*GitHub*: [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L23-L23)

```solidity
File: src/BranchBridgeAgentExecutor.sol

15:  library DeployBranchBridgeAgentExecutor {

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L15-L15)

```solidity
File: src/RootBridgeAgentExecutor.sol

13:  library DeployRootBridgeAgentExecutor {

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L13-L13)

```solidity
File: src/interfaces/BridgeAgentConstants.sol

10   contract BridgeAgentConstants {
11       // Settlement / Deposit Execution Status
12:  

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L10-L12)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

12   interface IBranchBridgeAgentFactory {
13       /*///////////////////////////////////////////////////////////////
14                           BRIDGE AGENT FUNCTIONS
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Creates a new Branch Bridge Agent.
19        * @param newRootRouterAddress New Root Router Address.
20        * @param rootBridgeAgentAddress Root Bridge Agent Address.
21        * @param _rootBridgeAgentFactoryAddress Root Bridge Agent Factory Address.
22        * @return newBridgeAgent New Bridge Agent Address.
23:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L12-L23)

```solidity
File: src/interfaces/IBranchPort.sol

14   interface IBranchPort {
15       /*///////////////////////////////////////////////////////////////
16                               VIEW FUNCTIONS
17       //////////////////////////////////////////////////////////////*/
18       /**
19        * @notice Returns true if the address is a Bridge Agent.
20        *   @param _bridgeAgent Bridge Agent address.
21        *   @return bool.
22:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L14-L22)

```solidity
File: src/interfaces/IBranchRouter.sol

21   interface IBranchRouter {
22       /*///////////////////////////////////////////////////////////////
23                               VIEW / STATE
24       //////////////////////////////////////////////////////////////*/
25   
26:      /// @notice External function to return the Branch Chain's Local Port Address.

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L21-L26)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

27   interface ICoreBranchRouter {
28       /*///////////////////////////////////////////////////////////////
29                           EXTERNAL FUNCTIONS
30       //////////////////////////////////////////////////////////////*/
31   
32       /**
33        * @notice Function to deploy/add a token already present in the global environment to a branch chain.
34        * @param _globalAddress the address of the global virtualized token.
35        * @param _dstChainId the chain to which the token will be added.
36        * @param _gasParams Gas parameters for remote execution.
37:       */

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L27-L37)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

11   interface IERC20hTokenBranch {
12       /*///////////////////////////////////////////////////////////////
13                           ERC20 LOGIC
14       //////////////////////////////////////////////////////////////*/
15   
16       /**
17        * @notice Function to mint tokens in the Branch Chain.
18        * @param account Address of the account to receive the tokens.
19        * @param amount Amount of tokens to be minted.
20        * @return Boolean indicating if the operation was successful.
21:       */

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L11-L21)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

13   interface IERC20hTokenBranchFactory {
14       /*///////////////////////////////////////////////////////////////
15                               hTOKEN FUNCTIONS
16       //////////////////////////////////////////////////////////////*/
17       /**
18        * @notice Function to create a new Branch hToken.
19        * @param _name Name of the Token.
20        * @param _symbol Symbol of the Token.
21        * @param _decimals Decimals of the Token.
22        * @param _addPrefix Boolean to add or not the chain prefix to the token name and symbol.
23:       */

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L13-L23)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

12   interface IERC20hTokenRoot {
13       /*///////////////////////////////////////////////////////////////
14                           VIEW FUNCTIONS
15       //////////////////////////////////////////////////////////////*/
16   
17       /// @notice View Function returns Local Network Identifier.
18:      /// @return Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L12-L18)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

13   interface IERC20hTokenRootFactory {
14       /*///////////////////////////////////////////////////////////////
15                               hTOKEN FUNCTIONS
16       //////////////////////////////////////////////////////////////*/
17   
18       /**
19        * @notice Function to create a new hToken.
20        * @param _name Name of the Token.
21        * @param _symbol Symbol of the Token.
22        * @param _decimals Decimals of the Token.
23:       */

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L13-L23)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

5    interface ILayerZeroReceiver {
6        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination
7        // @param _srcChainId - the source endpoint identifier
8        // @param _srcAddress - the source sending contract address from the source chain
9        // @param _nonce - the ordered message nonce
10:      // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L5-L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

5    interface ILayerZeroUserApplicationConfig {
6        // @notice set the configuration of the LayerZero messaging library of the specified version
7        // @param _version - messaging library version
8        // @param _chainId - the chainId for the pending config change
9        // @param _configType - type of configuration. every messaging library has its own convention.
10:      // @param _config - configuration in the bytes. can encode arbitrary content.

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5-L10)

```solidity
File: src/interfaces/IMulticall2.sol

9:   interface IMulticall2 {

```
*GitHub*: [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L9-L9)

```solidity
File: src/interfaces/IPortStrategy.sol

12   interface IPortStrategy {
13       /*///////////////////////////////////////////////////////////////
14                             TOKEN MANAGEMENT
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Function to withdraw underlying/native token amount back into Branch Port.
19        *   @param _recipient hToken receiver.
20        *   @param _token native token address.
21        *   @param _amount amount of tokens.
22:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L12-L22)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

11   interface IRootBridgeAgentFactory {
12       /*///////////////////////////////////////////////////////////////
13                           BRIDGE AGENT FUNCTIONS
14       //////////////////////////////////////////////////////////////*/
15:  

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L11-L15)

```solidity
File: src/interfaces/IRootPort.sol

10:  interface ICoreRootRouter {

31   interface IRootPort {
32       /*///////////////////////////////////////////////////////////////
33                           VIEW FUNCTIONS
34       //////////////////////////////////////////////////////////////*/
35       /**
36        * @notice View Function returns True if the chain Id has been added to the system.
37        *  @param _chainId The Layer Zero chainId of the chain.
38        * @return bool True if the chain Id has been added to the system.
39:       */

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L10-L10), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L31-L39)

```solidity
File: src/interfaces/IRootRouter.sol

14   interface IRootRouter {
15       /*///////////////////////////////////////////////////////////////
16                           LAYERZERO FUNCTIONS
17       ///////////////////////////////////////////////////////////////*/
18   
19       /**
20        *     @notice Function to execute Branch Bridge Agent system initiated requests with no asset deposit.
21        *     @param params data received from messaging layer.
22        *     @param srcChainId chain where the request originated from.
23        *
24:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L14-L24)

</details>




### [D&#x2011;23] ~~It's not standard to end and begin a code object on the same line~~
These are perfectly standard

*There are 99 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

4:   import {IArbitrumBranchPort as IArbPort} from "./interfaces/IArbitrumBranchPort.sol";

5:   import {IRootBridgeAgent} from "./interfaces/IRootBridgeAgent.sol";

8:   import {BranchBridgeAgent} from "./BranchBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L5-L5), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L8-L8)

```solidity
File: src/ArbitrumBranchPort.sol

5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

7:   import {IArbitrumBranchPort} from "./interfaces/IArbitrumBranchPort.sol";

8:   import {IRootPort} from "./interfaces/IRootPort.sol";

10:  import {BranchPort} from "./BranchPort.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L10-L10)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

4:   import {ERC20} from "solmate/tokens/ERC20.sol";

7:   import {IBranchBridgeAgentFactory as IBridgeAgentFactory} from "./interfaces/IBranchBridgeAgentFactory.sol";

8:   import {IArbitrumBranchPort as IPort} from "./interfaces/IArbitrumBranchPort.sol";

10:  import {CoreBranchRouter} from "./CoreBranchRouter.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L4-L4), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L10-L10)

```solidity
File: src/BaseBranchRouter.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

7:   import {ERC20} from "solmate/tokens/ERC20.sol";

9:   import {IBranchRouter} from "./interfaces/IBranchRouter.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L7-L7), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L9-L9)

```solidity
File: src/BranchBridgeAgent.sol

4:   import {ExcessivelySafeCall} from "lib/ExcessivelySafeCall.sol";

6:   import {IBranchPort as IPort} from "./interfaces/IBranchPort.sol";

8:   import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

18:  import {ILayerZeroEndpoint} from "./interfaces/ILayerZeroEndpoint.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L8-L8), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L18-L18)

```solidity
File: src/BranchBridgeAgentExecutor.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

8:   import {IBranchRouter as IRouter} from "./interfaces/IBranchRouter.sol";

10:  import {BranchBridgeAgent} from "./BranchBridgeAgent.sol";

11:  import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L11-L11)

```solidity
File: src/BranchPort.sol

5:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

8:   import {ERC20} from "solmate/tokens/ERC20.sol";

10:  import {IPortStrategy} from "./interfaces/IPortStrategy.sol";

11:  import {IBranchPort} from "./interfaces/IBranchPort.sol";

13:  import {ERC20hTokenBranch} from "./token/ERC20hTokenBranch.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L5-L5), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L11-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L13-L13)

```solidity
File: src/CoreBranchRouter.sol

4:   import {ERC20} from "solmate/tokens/ERC20.sol";

6:   import {IBranchPort as IPort} from "./interfaces/IBranchPort.sol";

8:   import {IBranchBridgeAgentFactory as IBridgeAgentFactory} from "./interfaces/IBranchBridgeAgentFactory.sol";

9:   import {IBranchRouter} from "./interfaces/IBranchRouter.sol";

10:  import {ICoreBranchRouter} from "./interfaces/ICoreBranchRouter.sol";

11:  import {IERC20hTokenBranchFactory as ITokenFactory} from "./interfaces/IERC20hTokenBranchFactory.sol";

13:  import {BaseBranchRouter} from "./BaseBranchRouter.sol";

14:  import {ERC20hTokenBranch as ERC20hToken} from "./token/ERC20hTokenBranch.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L11-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L13-L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L14-L14)

```solidity
File: src/CoreRootRouter.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {ERC20} from "solmate/tokens/ERC20.sol";

8:   import {IERC20hTokenRootFactory as IFactory} from "./interfaces/IERC20hTokenRootFactory.sol";

9:   import {IRootRouter} from "./interfaces/IRootRouter.sol";

16:  import {IRootPort as IPort} from "./interfaces/IRootPort.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L9-L9), [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L16-L16)

```solidity
File: src/MulticallRootRouter.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

7:   import {IMulticall2 as IMulticall} from "./interfaces/IMulticall2.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L7-L7)

```solidity
File: src/MulticallRootRouterLibZip.sol

4:   import {LibZip} from "solady/utils/LibZip.sol";

6:   import {MulticallRootRouter} from "./MulticallRootRouter.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L6-L6)

```solidity
File: src/RootBridgeAgent.sol

4:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

6:   import {ExcessivelySafeCall} from "lib/ExcessivelySafeCall.sol";

8:   import {ILayerZeroEndpoint} from "./interfaces/ILayerZeroEndpoint.sol";

10:  import {IBranchBridgeAgent} from "./interfaces/IBranchBridgeAgent.sol";

11:  import {IERC20hTokenRoot} from "./interfaces/IERC20hTokenRoot.sol";

13:  import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

25:  import {IRootPort as IPort} from "./interfaces/IRootPort.sol";

27:  import {VirtualAccount} from "./VirtualAccount.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L11-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L13-L13), [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L25-L25), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L27-L27)

```solidity
File: src/RootBridgeAgentExecutor.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

7:   import {IRootBridgeAgent} from "./interfaces/IRootBridgeAgent.sol";

9:   import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

10:  import {RootBridgeAgent} from "./RootBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L4-L4), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L7-L7), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L10-L10)

```solidity
File: src/RootPort.sol

5:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

8:   import {IERC20hTokenRootFactory} from "./interfaces/IERC20hTokenRootFactory.sol";

9:   import {IRootBridgeAgent as IBridgeAgent} from "./interfaces/IRootBridgeAgent.sol";

12:  import {ERC20hTokenRoot} from "./token/ERC20hTokenRoot.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L5-L5), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L9-L9), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L12-L12)

```solidity
File: src/VirtualAccount.sol

5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

7:   import {ERC721} from "solmate/tokens/ERC721.sol";

9:   import {ERC1155Receiver} from "@openzeppelin/contracts/token/ERC1155/utils/ERC1155Receiver.sol";

10:  import {IERC1155Receiver} from "@openzeppelin/contracts/token/ERC1155/IERC1155Receiver.sol";

11:  import {IERC721Receiver} from "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";

14:  import {IRootPort} from "./interfaces/IRootPort.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L7-L7), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L11-L11), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L14-L14)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

4:   import {IArbitrumBranchPort as IPort} from "../interfaces/IArbitrumBranchPort.sol";

7:   import {BranchBridgeAgentFactory} from "./BranchBridgeAgentFactory.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L4-L4), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L7-L7)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {DeployBranchBridgeAgent} from "../BranchBridgeAgent.sol";

8:   import {IBranchPort as IPort} from "../interfaces/IBranchPort.sol";

9:   import {IBranchBridgeAgentFactory} from "../interfaces/IBranchBridgeAgentFactory.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L9-L9)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {ERC20} from "../token/ERC20hTokenBranch.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L6-L6)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {ERC20} from "solmate/tokens/ERC20.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L6-L6)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

4:   import {IRootBridgeAgentFactory} from "../interfaces/IRootBridgeAgentFactory.sol";

5:   import {IRootPort} from "../interfaces/IRootPort.sol";

7:   import {RootBridgeAgent} from "../RootBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L7-L7)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

5:   import {IBranchPort} from "./IBranchPort.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L5-L5)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

4:   import {ILayerZeroReceiver} from "./ILayerZeroReceiver.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L4-L4)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

4:   import {GasParams} from "./IBranchBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L4-L4)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

4:   import {ERC20hTokenBranch} from "../token/ERC20hTokenBranch.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L4-L4)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

4:   import {ERC20hTokenRoot} from "../token/ERC20hTokenRoot.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L4-L4)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

4:   import {ILayerZeroReceiver} from "./ILayerZeroReceiver.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L4-L4)

```solidity
File: src/interfaces/IRootPort.sol

5:   import {GasParams} from "../interfaces/IRootBridgeAgent.sol";

7:   import {VirtualAccount} from "../VirtualAccount.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L7-L7)

```solidity
File: src/interfaces/IVirtualAccount.sol

4:   import {IERC721Receiver} from "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L4-L4)

```solidity
File: src/token/ERC20hTokenBranch.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {ERC20} from "solmate/tokens/ERC20.sol";

8:   import {IERC20hTokenBranch} from "../interfaces/IERC20hTokenBranch.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L8-L8)

```solidity
File: src/token/ERC20hTokenRoot.sol

4:   import {Ownable} from "solady/auth/Ownable.sol";

6:   import {ERC20} from "solmate/tokens/ERC20.sol";

8:   import {IERC20hTokenRoot} from "../interfaces/IERC20hTokenRoot.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L8-L8)

</details>




### [D&#x2011;24] ~~Save gas with the use of specific import statements~~
Importing whole files rather than specific identifiers [does not waste gas](https://ethereum.stackexchange.com/questions/138876/does-solidity-optimizer-eliminate-unused-internal-functions-of-libraries), so this finding is invalid

*There is one instance of this issue:*

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

5:   import "./ILayerZeroUserApplicationConfig.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L5-L5)


### [D&#x2011;25] ~~Use `safeApprove()`~~
`safeApprove()` has been deprecated for a while, and has been [removed](https://github.com/OpenZeppelin/openzeppelin-contracts/commit/0f10efe2326dfb79442967b82bde4ff1b28c69cd#diff-b62d42226577342d084c6a310585311ee8f0320462f92839f8fc65307bf6037aL38-L55) in the most recent version.

*There are 2 instances of this issue:*

```solidity
File: src/BaseBranchRouter.sol

168:                 ERC20(_hToken).approve(_localPortAddress, _amount - _deposit);

175:             ERC20(_token).approve(_localPortAddress, _deposit);

```
*GitHub*: [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L168-L168), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L175-L175)


### [D&#x2011;26] ~~Use `assembly` to write address/contract type storage values~~
Using this suggestion stomps over any value packed into the same slot as the address, so this advice is not safe.

*There are 25 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

62:          localBridgeAgentAddress = _localBridgeAgentAddress;

63:          localPortAddress = IBridgeAgent(_localBridgeAgentAddress).localPortAddress();

64:          bridgeAgentExecutorAddress = IBridgeAgent(_localBridgeAgentAddress).bridgeAgentExecutorAddress();

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L62-L62), [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L63-L63), [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L64-L64)

```solidity
File: src/BranchBridgeAgent.sol

444:         deposit.owner = address(0);

832:         deposit.owner = _refundee;

882:         deposit.owner = _refundee;

```
*GitHub*: [444](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L444-L444), [832](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L832-L832), [882](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L882-L882)

```solidity
File: src/BranchPort.sol

129:         coreBranchRouterAddress = _coreBranchRouter;

334:         coreBranchRouterAddress = _newCoreRouter;

419:         coreBranchRouterAddress = _coreBranchRouter;

```
*GitHub*: [129](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L129-L129), [334](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L334-L334), [419](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L419-L419)

```solidity
File: src/CoreRootRouter.sol

86:          bridgeAgentAddress = payable(_bridgeAgentAddress);

87:          bridgeAgentExecutorAddress = IBridgeAgent(_bridgeAgentAddress).bridgeAgentExecutorAddress();

88:          hTokenFactoryAddress = _hTokenFactory;

```
*GitHub*: [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L86-L86), [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L87-L87), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L88-L88)

```solidity
File: src/MulticallRootRouter.sol

112:         bridgeAgentAddress = payable(_bridgeAgentAddress);

113:         bridgeAgentExecutorAddress = IBridgeAgent(_bridgeAgentAddress).bridgeAgentExecutorAddress();

```
*GitHub*: [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L112-L112), [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L113-L113)

```solidity
File: src/RootBridgeAgent.sol

1014:        settlement.owner = _refundee;

1015:        settlement.recipient = _recipient;

1106:        settlement.owner = _refundee;

1107:        settlement.recipient = _recipient;

```
*GitHub*: [1014](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1014-L1014), [1015](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1015-L1015), [1106](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1106-L1106), [1107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1107-L1107)

```solidity
File: src/RootPort.sol

138:         coreRootRouterAddress = _coreRootRouter;

159:         coreRootBridgeAgentAddress = _coreRootBridgeAgent;

160:         localBranchPortAddress = _localBranchPortAddress;

513:         coreRootRouterAddress = _coreRootRouter;

514:         coreRootBridgeAgentAddress = _coreRootBridgeAgent;

```
*GitHub*: [138](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L138-L138), [159](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L159-L159), [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L160-L160), [513](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L513-L513), [514](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L514-L514)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

74:          localCoreRouterAddress = _coreRouter;

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L74-L74)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

51:          coreRootRouterAddress = _coreRouter;

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L51-L51)

</details>




### [D&#x2011;27] ~~Use multiple `require()` and `if` statements instead of `&&`~~
The suggestion in this rule is not logically equivalent for `if`-statements unless they're nested, and cannot be done if there's an `else`-block without spending more gas. It doesn't seem more readable for `require()`s either

*There is one instance of this issue:*

```solidity
File: src/RootBridgeAgent.sol

1141         if (_amount == 0 && _deposit == 0) revert InvalidInputParams();
1142         if (_amount < _deposit) revert InvalidInputParams();
1143:

```
*GitHub*: [1141](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1141-L1143)


### [D&#x2011;28] ~~It is standard for all external and public functions to be override from an interface~~
According to the Solidity [docs](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), "Starting from Solidity 0.8.8, the `override` keyword is not required when overriding an interface function, except for the case where the function is defined in multiple bases", so while it may have been a requirement in the past, they're trying to change that. Paired with the advice of making all `public` and `external` functions a part of an `interface`, this finding would end up having all sponsors mark all `public`/`external` functions with `override`, making the keyword meaningless. It's better to use `override` only when something is actually being overridden.

*There are 117 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

89:      function retrySettlement(uint32, bytes calldata, GasParams[2] calldata, bool) external payable override lock {}

99:      function _performCall(address payable, bytes memory _calldata, GasParams calldata) internal override {

112:     function _performFallbackCall(address payable, uint32 _settlementNonce) internal override {

125:     function _requiresEndpoint(address _endpoint, bytes calldata) internal view override {

```
*GitHub*: [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L89-L89), [99](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L99-L99), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L112-L112), [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L125-L125)

```solidity
File: src/ArbitrumBranchPort.sol

50       function depositToPort(address _depositor, address _recipient, address _underlyingAddress, uint256 _deposit)
51           external
52           override
53           lock
54           requiresBridgeAgent
55:      {

73       function withdrawFromPort(address _depositor, address _recipient, address _globalAddress, uint256 _amount)
74           external
75           override
76           lock
77           requiresBridgeAgent
78:      {

107:     function _bridgeIn(address _recipient, address _localAddress, uint256 _amount) internal override {

119      function _bridgeOut(
120          address _depositor,
121          address _localAddress,
122          address _underlyingAddress,
123          uint256 _amount,
124          uint256 _deposit
125:     ) internal override {

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L50-L55), [73](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L73-L78), [107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L107-L107), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L119-L125)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

51:      function addLocalToken(address _underlyingAddress, GasParams calldata) external payable override {

85       function _receiveAddBridgeAgent(
86           address _newBranchRouter,
87           address _branchBridgeAgentFactory,
88           address _rootBridgeAgent,
89           address _rootBridgeAgentFactory,
90           address _refundee,
91           GasParams memory _gParams
92:      ) internal override {

126:     function executeNoSettlement(bytes calldata _data) external payable override requiresAgentExecutor {

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L51-L51), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L85-L92), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L126-L126)

```solidity
File: src/BaseBranchRouter.sol

74:      function getDepositEntry(uint32 _depositNonce) external view override returns (Deposit memory) {

83:      function callOut(bytes calldata _params, GasParams calldata _gParams) external payable override lock {

88       function callOutAndBridge(bytes calldata _params, DepositInput calldata _dParams, GasParams calldata _gParams)
89           external
90           payable
91           override
92           lock
93:      {

104      function callOutAndBridgeMultiple(
105          bytes calldata _params,
106          DepositMultipleInput calldata _dParams,
107          GasParams calldata _gParams
108:     ) external payable override lock {

123:     function executeNoSettlement(bytes calldata) external payable virtual override requiresAgentExecutor {

128      function executeSettlement(bytes calldata, SettlementParams memory)
129          external
130          payable
131          virtual
132          override
133          requiresAgentExecutor
134:     {

139      function executeSettlementMultiple(bytes calldata, SettlementMultipleParams memory)
140          external
141          payable
142          virtual
143          override
144          requiresAgentExecutor
145:     {

```
*GitHub*: [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L74-L74), [83](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L83-L83), [88](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L88-L93), [104](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L104-L108), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L123-L123), [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L128-L134), [139](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L139-L145)

```solidity
File: src/BranchBridgeAgent.sol

156:     function getDepositEntry(uint32 _depositNonce) external view override returns (Deposit memory) {

180      function callOutSystem(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
181          external
182          payable
183          override
184          lock
185          requiresRouter
186:     {

195      function callOut(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
196          external
197          payable
198          override
199          lock
200:     {

209      function callOutAndBridge(
210          address payable _refundee,
211          bytes calldata _params,
212          DepositInput memory _dParams,
213          GasParams calldata _gParams
214:     ) external payable override lock {

231      function callOutAndBridgeMultiple(
232          address payable _refundee,
233          bytes calldata _params,
234          DepositMultipleInput memory _dParams,
235          GasParams calldata _gParams
236:     ) external payable override lock {

262      function callOutSigned(address payable _refundee, bytes calldata _params, GasParams calldata _gParams)
263          external
264          payable
265          override
266          lock
267:     {

276      function callOutSignedAndBridge(
277          address payable _refundee,
278          bytes calldata _params,
279          DepositInput memory _dParams,
280          GasParams calldata _gParams,
281          bool _hasFallbackToggled
282:     ) external payable override lock {

306      function callOutSignedAndBridgeMultiple(
307          address payable _refundee,
308          bytes calldata _params,
309          DepositMultipleInput memory _dParams,
310          GasParams calldata _gParams,
311          bool _hasFallbackToggled
312:     ) external payable override lock {

343      function retryDeposit(
344          bool _isSigned,
345          uint32 _depositNonce,
346          bytes calldata _params,
347          GasParams calldata _gParams,
348          bool _hasFallbackToggled
349:     ) external payable override lock {

422:     function retrieveDeposit(uint32 _depositNonce, GasParams calldata _gParams) external payable override lock {

434:     function redeemDeposit(uint32 _depositNonce) external override lock {

464      function retrySettlement(
465          uint32 _settlementNonce,
466          bytes calldata _params,
467          GasParams[2] calldata _gParams,
468          bool _hasFallbackToggled
469:     ) external payable virtual override lock {

485      function clearToken(address _recipient, address _hToken, address _token, uint256 _amount, uint256 _deposit)
486          external
487          override
488          requiresAgentExecutor
489:     {

494      function clearTokens(bytes calldata _sParams, address _recipient)
495          external
496          override
497          requiresAgentExecutor
498          returns (SettlementMultipleParams memory)
499:     {

578:     function lzReceive(uint16, bytes calldata _srcAddress, uint64, bytes calldata _payload) public override {

587      function lzReceiveNonBlocking(address _endpoint, bytes calldata _srcAddress, bytes calldata _payload)
588          public
589          override
590          requiresEndpoint(_endpoint, _srcAddress)
591:     {

```
*GitHub*: [156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L156-L156), [180](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L180-L186), [195](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L195-L200), [209](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L209-L214), [231](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L231-L236), [262](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L262-L267), [276](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L276-L282), [306](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L306-L312), [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L343-L349), [422](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L422-L422), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L434-L434), [464](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L464-L469), [485](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L485-L489), [494](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L494-L499), [578](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L578-L578), [587](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L587-L591)

```solidity
File: src/BranchPort.sol

135:     function renounceOwnership() public payable override onlyOwner {

144:     function manage(address _token, uint256 _amount) external override requiresPortStrategy(_token) {

167:     function replenishReserves(address _token, uint256 _amount) external override lock {

188:     function replenishReserves(address _strategy, address _token) external override lock {

226      function withdraw(address _recipient, address _underlyingAddress, uint256 _deposit)
227          public
228          virtual
229          override
230          lock
231          requiresBridgeAgent
232:     {

237      function bridgeIn(address _recipient, address _localAddress, uint256 _amount)
238          external
239          override
240          requiresBridgeAgent
241:     {

246      function bridgeInMultiple(
247          address _recipient,
248          address[] memory _localAddresses,
249          address[] memory _underlyingAddresses,
250          uint256[] memory _amounts,
251          uint256[] memory _deposits
252:     ) external override requiresBridgeAgent {

277      function bridgeOut(
278          address _depositor,
279          address _localAddress,
280          address _underlyingAddress,
281          uint256 _amount,
282          uint256 _deposit
283:     ) external override lock requiresBridgeAgent {

288      function bridgeOutMultiple(
289          address _depositor,
290          address[] memory _localAddresses,
291          address[] memory _underlyingAddresses,
292          uint256[] memory _amounts,
293          uint256[] memory _deposits
294:     ) external override lock requiresBridgeAgent {

319:     function addBridgeAgent(address _bridgeAgent) external override requiresBridgeAgentFactory {

331:     function setCoreRouter(address _newCoreRouter) external override requiresCoreRouter {

338:     function addBridgeAgentFactory(address _newBridgeAgentFactory) external override requiresCoreRouter {

348:     function toggleBridgeAgentFactory(address _newBridgeAgentFactory) external override requiresCoreRouter {

355:     function toggleBridgeAgent(address _bridgeAgent) external override requiresCoreRouter {

362:     function addStrategyToken(address _token, uint256 _minimumReservesRatio) external override requiresCoreRouter {

375:     function toggleStrategyToken(address _token) external override requiresCoreRouter {

382      function addPortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
383          external
384          override
385          requiresCoreRouter
386:     {

396:     function togglePortStrategy(address _portStrategy, address _token) external override requiresCoreRouter {

403      function updatePortStrategy(address _portStrategy, address _token, uint256 _dailyManagementLimit)
404          external
405          override
406          requiresCoreRouter
407:     {

414      function setCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent)
415          external
416          override
417          requiresCoreRouter
418:     {

```
*GitHub*: [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L135-L135), [144](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L144-L144), [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L167-L167), [188](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L188-L188), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L226-L232), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L237-L241), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L246-L252), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L277-L283), [288](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L288-L294), [319](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L319-L319), [331](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L331-L331), [338](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L338-L338), [348](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L348-L348), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L355-L355), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L362-L362), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L375-L375), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L382-L386), [396](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L396-L396), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L403-L407), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L414-L418)

```solidity
File: src/CoreBranchRouter.sol

86:      function executeNoSettlement(bytes calldata _params) external payable virtual override requiresAgentExecutor {

```
*GitHub*: [86](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L86-L86)

```solidity
File: src/CoreRootRouter.sol

297      function executeResponse(bytes calldata _encodedData, uint16 _srcChainId)
298          external
299          payable
300          override
301          requiresExecutor
302:     {

332:     function execute(bytes calldata _encodedData, uint16) external payable override requiresExecutor {

350      function executeDepositSingle(bytes memory, DepositParams memory, uint16)
351          external
352          payable
353          override
354          requiresExecutor
355:     {

360      function executeDepositMultiple(bytes calldata, DepositMultipleParams memory, uint16)
361          external
362          payable
363          override
364          requiresExecutor
365:     {

370:     function executeSigned(bytes memory, address, uint16) external payable override requiresExecutor {

375      function executeSignedDepositSingle(bytes memory, DepositParams memory, address, uint16)
376          external
377          payable
378          override
379          requiresExecutor
380:     {

385      function executeSignedDepositMultiple(bytes memory, DepositMultipleParams memory, address, uint16)
386          external
387          payable
388          override
389          requiresExecutor
390:     {

```
*GitHub*: [297](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L297-L302), [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L332-L332), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L350-L355), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L360-L365), [370](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L370-L370), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L375-L380), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L385-L390)

```solidity
File: src/MulticallRootRouter.sol

123:     function executeResponse(bytes memory, uint16) external payable override {

137:     function execute(bytes calldata encodedData, uint16) external payable override lock requiresExecutor {

203:     function executeDepositSingle(bytes calldata, DepositParams calldata, uint16) external payable override {

223      function executeSigned(bytes calldata encodedData, address userAccount, uint16)
224          external
225          payable
226          override
227          lock
228          requiresExecutor
229:     {

312      function executeSignedDepositSingle(bytes calldata encodedData, DepositParams calldata, address userAccount, uint16)
313          external
314          payable
315          override
316          requiresExecutor
317          lock
318:     {

401      function executeSignedDepositMultiple(
402          bytes calldata encodedData,
403          DepositMultipleParams calldata,
404          address userAccount,
405          uint16
406:     ) external payable override requiresExecutor lock {

```
*GitHub*: [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L123-L123), [137](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L137-L137), [203](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L203-L203), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L223-L229), [312](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L312-L318), [401](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L401-L406)

```solidity
File: src/MulticallRootRouterLibZip.sol

37:      function _decode(bytes calldata data) internal pure override returns (bytes memory) {

```
*GitHub*: [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L37-L37)

```solidity
File: src/RootBridgeAgent.sol

135:     function getSettlementEntry(uint32 _settlementNonce) external view override returns (Settlement memory) {

160      function callOut(
161          address payable _refundee,
162          address _recipient,
163          uint16 _dstChainId,
164          bytes calldata _params,
165          GasParams calldata _gParams
166:     ) external payable override lock requiresRouter {

175      function callOutAndBridge(
176          address payable _refundee,
177          address _recipient,
178          uint16 _dstChainId,
179          bytes calldata _params,
180          SettlementInput calldata _sParams,
181          GasParams calldata _gParams,
182          bool _hasFallbackToggled
183:     ) external payable override lock requiresRouter {

202      function callOutAndBridgeMultiple(
203          address payable _refundee,
204          address _recipient,
205          uint16 _dstChainId,
206          bytes calldata _params,
207          SettlementMultipleInput calldata _sParams,
208          GasParams calldata _gParams,
209          bool _hasFallbackToggled
210:     ) external payable override lock requiresRouter {

233      function retrySettlement(
234          uint32 _settlementNonce,
235          address _recipient,
236          bytes calldata _params,
237          GasParams calldata _gParams,
238          bool _hasFallbackToggled
239:     ) external payable override lock {

299:     function redeemSettlement(uint32 _settlementNonce) external override lock {

351      function bridgeIn(address _recipient, DepositParams memory _dParams, uint256 _srcChainId)
352          public
353          override
354          requiresAgentExecutor
355:     {

387      function bridgeInMultiple(address _recipient, DepositMultipleParams calldata _dParams, uint256 _srcChainId)
388          external
389          override
390          requiresAgentExecutor
391:     {

434      function lzReceiveNonBlocking(
435          address _endpoint,
436          uint16 _srcChainId,
437          bytes calldata _srcAddress,
438          bytes calldata _payload
439:     ) public override requiresEndpoint(_endpoint, _srcChainId, _srcAddress) {

1170:    function approveBranchBridgeAgent(uint256 _branchChainId) external override requiresManager {

1176     function syncBranchBridgeAgent(address _newBranchBridgeAgent, uint256 _branchChainId)
1177         external
1178         override
1179         requiresPort
1180:    {

```
*GitHub*: [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L135-L135), [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L160-L166), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L175-L183), [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L202-L210), [233](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L233-L239), [299](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L299-L299), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L351-L355), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L387-L391), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L434-L439), [1170](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1170-L1170), [1176](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1176-L1180)

```solidity
File: src/RootPort.sol

166:     function renounceOwnership() public payable override onlyOwner {

175      function getLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
176          external
177          view
178          override
179          returns (address)
180:     {

200      function getUnderlyingTokenFromGlobal(address _globalAddress, uint256 _srcChainId)
201          external
202          view
203          override
204          returns (address)
205:     {

211:     function isGlobalToken(address _globalAddress, uint256 _srcChainId) external view override returns (bool) {

216:     function isLocalToken(address _localAddress, uint256 _srcChainId) external view override returns (bool) {

230:     function isUnderlyingToken(address _underlyingToken, uint256 _srcChainId) external view override returns (bool) {

239      function setAddresses(
240          address _globalAddress,
241          address _localAddress,
242          address _underlyingAddress,
243          uint256 _srcChainId
244:     ) external override requiresCoreRootRouter {

259      function setLocalAddress(address _globalAddress, address _localAddress, uint256 _srcChainId)
260          external
261          override
262          requiresCoreRootRouter
263:     {

277      function bridgeToRoot(address _recipient, address _hToken, uint256 _amount, uint256 _deposit, uint256 _srcChainId)
278          external
279          override
280          requiresBridgeAgent
281:     {

294      function bridgeToRootFromLocalBranch(address _from, address _hToken, uint256 _amount)
295          external
296          override
297          requiresLocalBranchPort
298:     {

304      function bridgeToLocalBranchFromRoot(address _to, address _hToken, uint256 _amount)
305          external
306          override
307          requiresLocalBranchPort
308:     {

315      function burn(address _from, address _hToken, uint256 _amount, uint256 _srcChainId)
316          external
317          override
318          requiresBridgeAgent
319:     {

325      function burnFromLocalBranch(address _from, address _hToken, uint256 _amount)
326          external
327          override
328          requiresLocalBranchPort
329:     {

336      function mintToLocalBranch(address _to, address _hToken, uint256 _amount)
337          external
338          override
339          requiresLocalBranchPort
340:     {

350:     function fetchVirtualAccount(address _user) external override returns (VirtualAccount account) {

369      function toggleVirtualAccountApproved(VirtualAccount _userAccount, address _router)
370          external
371          override
372          requiresBridgeAgent
373:     {

382:     function addBridgeAgent(address _manager, address _bridgeAgent) external override requiresBridgeAgentFactory {

393      function syncBranchBridgeAgentWithRoot(
394          address _newBranchBridgeAgent,
395          address _rootBridgeAgent,
396          uint256 _branchChainId
397:     ) external override requiresCoreRootRouter {

414:     function toggleBridgeAgent(address _bridgeAgent) external override onlyOwner {

421:     function addBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

431:     function toggleBridgeAgentFactory(address _bridgeAgentFactory) external override onlyOwner {

438      function addNewChain(
439          address _coreBranchBridgeAgentAddress,
440          uint256 _chainId,
441          string memory _wrappedGasTokenName,
442          string memory _wrappedGasTokenSymbol,
443          uint8 _wrappedGasTokenDecimals,
444          address _newLocalBranchWrappedNativeTokenAddress,
445          address _newUnderlyingBranchWrappedNativeTokenAddress
446:     ) external override onlyOwner {

483:     function addEcosystemToken(address _ecoTokenGlobalAddress) external override onlyOwner {

509:     function setCoreRootRouter(address _coreRootRouter, address _coreRootBridgeAgent) external override onlyOwner {

521      function setCoreBranchRouter(
522          address _refundee,
523          address _coreBranchRouter,
524          address _coreBranchBridgeAgent,
525          uint16 _dstChainId,
526          GasParams calldata _gParams
527:     ) external payable override onlyOwner {

539      function syncNewCoreBranchRouter(address _coreBranchRouter, address _coreBranchBridgeAgent, uint16 _dstChainId)
540          external
541          override
542          onlyOwner
543:     {

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L166-L166), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L175-L180), [200](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L200-L205), [211](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L211-L211), [216](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L216-L216), [230](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L230-L230), [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L239-L244), [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L259-L263), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L277-L281), [294](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L294-L298), [304](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L304-L308), [315](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L315-L319), [325](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L325-L329), [336](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L336-L340), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L350-L350), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L369-L373), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L382-L382), [393](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L393-L397), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L414-L414), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L421-L421), [431](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L431-L431), [438](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L438-L446), [483](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L483-L483), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L509-L509), [521](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L521-L527), [539](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L539-L543)

```solidity
File: src/VirtualAccount.sol

51:      function withdrawNative(uint256 _amount) external override requiresApprovedCaller {

56:      function withdrawERC20(address _token, uint256 _amount) external override requiresApprovedCaller {

61:      function withdrawERC721(address _token, uint256 _tokenId) external override requiresApprovedCaller {

66:      function call(Call[] calldata calls) external override requiresApprovedCaller returns (bytes[] memory returnData) {

119:     function onERC721Received(address, address, uint256, bytes calldata) external pure override returns (bytes4) {

124      function onERC1155Received(address, address, uint256, uint256, bytes calldata)
125          external
126          pure
127          override
128          returns (bytes4)
129:     {

134      function onERC1155BatchReceived(address, address, uint256[] calldata, uint256[] calldata, bytes calldata)
135          external
136          pure
137          override
138          returns (bytes4)
139:     {

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L51-L51), [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L56-L56), [61](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L61-L61), [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L66-L66), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L119-L119), [124](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L124-L129), [134](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L134-L139)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

56:      function initialize(address _coreRootBridgeAgent) external override onlyOwner {

79       function createBridgeAgent(
80           address _newBranchRouterAddress,
81           address _rootBridgeAgentAddress,
82           address _rootBridgeAgentFactoryAddress
83:      ) external virtual override returns (address newBridgeAgent) {

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L56-L56), [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L79-L83)

```solidity
File: src/token/ERC20hTokenBranch.sol

29:      function mint(address account, uint256 amount) external override onlyOwner returns (bool) {

35:      function burn(uint256 amount) public override onlyOwner {

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L29-L29), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L35-L35)

</details>




### [D&#x2011;29] ~~Must approve or increase allowance first~~
The bot is just flagging `transferFrom()` calls without a prior approval. Many projects require you to approve their contract before using it, so this suggestion is not helpful, and certainly is not 'Low' severity, since that's the design and no funds are lost. There is no way for the project to address this issue other than by requiring that the caller send the tokens themselves, which has its own risks.

*There are 9 instances of this issue:*

```solidity
File: src/ArbitrumBranchPort.sol

66:          _underlyingAddress.safeTransferFrom(_depositor, address(this), _deposit);

128:             _underlyingAddress.safeTransferFrom(_depositor, address(this), _deposit);

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L66-L66), [128](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L128-L128)

```solidity
File: src/BaseBranchRouter.sol

167:                 _hToken.safeTransferFrom(msg.sender, address(this), _amount - _deposit);

174:             _token.safeTransferFrom(msg.sender, address(this), _deposit);

```
*GitHub*: [167](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L167-L167), [174](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L174-L174)

```solidity
File: src/BranchPort.sol

526:             _localAddress.safeTransferFrom(_depositor, address(this), _hTokenAmount);

532:             _underlyingAddress.safeTransferFrom(_depositor, address(this), _deposit);

```
*GitHub*: [526](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L526-L526), [532](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L532-L532)

```solidity
File: src/RootBridgeAgent.sol

1151:                _globalAddress.safeTransferFrom(_depositor, localPortAddress, _amount - _deposit);

```
*GitHub*: [1151](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1151-L1151)

```solidity
File: src/RootPort.sol

301:         _hToken.safeTransferFrom(_from, address(this), _amount);

```
*GitHub*: [301](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L301-L301)

```solidity
File: src/VirtualAccount.sol

62:          ERC721(_token).transferFrom(address(this), msg.sender, _tokenId);

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L62-L62)


### [D&#x2011;30] ~~Cast to `bytes` or `bytes32` for clearer semantic meaning~~
These calls to `abi.encodePacked()` have more than one argument

*There are 42 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

115:             rootChainId, "", 0, abi.encodePacked(bytes1(0x09), _settlementNonce)

```
*GitHub*: [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L115-L115)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

62:          bytes memory payload = abi.encodePacked(bytes1(0x02), params);

115:         bytes memory payload = abi.encodePacked(bytes1(0x04), data);

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L62-L62), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L115-L115)

```solidity
File: src/BranchBridgeAgent.sol

142:         rootBridgeAgentPath = abi.encodePacked(_rootBridgeAgentAddress, address(this));

171:             abi.encodePacked(uint16(2), _gasLimit, _remoteBranchExecutionGas, rootBridgeAgentAddress)

188:         bytes memory payload = abi.encodePacked(bytes1(0x00), depositNonce++, _params);

202:         bytes memory payload = abi.encodePacked(bytes1(0x01), depositNonce++, _params);

219          bytes memory payload = abi.encodePacked(
220              bytes1(0x02), _depositNonce, _dParams.hToken, _dParams.token, _dParams.amount, _dParams.deposit, _params
221:         );

241          bytes memory payload = abi.encodePacked(
242              bytes1(0x03),
243              uint8(_dParams.hTokens.length),
244              _depositNonce,
245              _dParams.hTokens,
246              _dParams.tokens,
247              _dParams.amounts,
248              _dParams.deposits,
249              _params
250:         );

269:         bytes memory payload = abi.encodePacked(bytes1(0x04), msg.sender, depositNonce++, _params);

287          bytes memory payload = abi.encodePacked(
288              _hasFallbackToggled ? bytes1(0x85) : bytes1(0x05),
289              msg.sender,
290              _depositNonce,
291              _dParams.hToken,
292              _dParams.token,
293              _dParams.amount,
294              _dParams.deposit,
295              _params
296:         );

317          bytes memory payload = abi.encodePacked(
318              _hasFallbackToggled ? bytes1(0x86) : bytes1(0x06),
319              msg.sender,
320              uint8(_dParams.hTokens.length),
321              _depositNonce,
322              _dParams.hTokens,
323              _dParams.tokens,
324              _dParams.amounts,
325              _dParams.deposits,
326              _params
327:         );

398                  payload = abi.encodePacked(
399                      bytes1(0x03),
400                      uint8(deposit.hTokens.length),
401                      _depositNonce,
402                      deposit.hTokens,
403                      deposit.tokens,
404                      deposit.amounts,
405                      deposit.deposits,
406                      _params
407:                 );

386                  payload = abi.encodePacked(
387                      _hasFallbackToggled ? bytes1(0x86) : bytes1(0x06),
388                      msg.sender,
389                      uint8(deposit.hTokens.length),
390                      _depositNonce,
391                      deposit.hTokens,
392                      deposit.tokens,
393                      deposit.amounts,
394                      deposit.deposits,
395                      _params
396:                 );

373                  payload = abi.encodePacked(
374                      bytes1(0x02),
375                      _depositNonce,
376                      deposit.hTokens[0],
377                      deposit.tokens[0],
378                      deposit.amounts[0],
379                      deposit.deposits[0],
380                      _params
381:                 );

362                  payload = abi.encodePacked(
363                      _hasFallbackToggled ? bytes1(0x85) : bytes1(0x05),
364                      msg.sender,
365                      _depositNonce,
366                      deposit.hTokens[0],
367                      deposit.tokens[0],
368                      deposit.amounts[0],
369                      deposit.deposits[0],
370                      _params
371:                 );

427:         bytes memory payload = abi.encodePacked(bytes1(0x08), msg.sender, _depositNonce);

474:         bytes memory payload = abi.encodePacked(_hasFallbackToggled ? bytes1(0x87) : bytes1(0x07), params);

776:             abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, rootBridgeAgentAddress)

790:             abi.encodePacked(bytes1(0x09), _settlementNonce),

```
*GitHub*: [142](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L142-L142), [171](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L171-L171), [188](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L188-L188), [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L202-L202), [219](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L219-L221), [241](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L241-L250), [269](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L269-L269), [287](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L287-L296), [317](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L317-L327), [398](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L398-L407), [386](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L386-L396), [373](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L373-L381), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L362-L371), [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L427-L427), [474](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L474-L474), [776](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L776-L776), [790](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L790-L790)

```solidity
File: src/CoreBranchRouter.sol

51:          bytes memory payload = abi.encodePacked(bytes1(0x01), params);

75:          bytes memory payload = abi.encodePacked(bytes1(0x02), params);

181:         bytes memory payload = abi.encodePacked(bytes1(0x03), params);

229:         bytes memory payload = abi.encodePacked(bytes1(0x04), params);

```
*GitHub*: [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L51-L51), [75](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L75-L75), [181](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L181-L181), [229](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L229-L229)

```solidity
File: src/CoreRootRouter.sol

136:         bytes memory payload = abi.encodePacked(bytes1(0x02), params);

171:         bytes memory payload = abi.encodePacked(bytes1(0x03), params);

196:         bytes memory payload = abi.encodePacked(bytes1(0x04), params);

223:         bytes memory payload = abi.encodePacked(bytes1(0x05), params);

254:         bytes memory payload = abi.encodePacked(bytes1(0x06), params);

284:         bytes memory payload = abi.encodePacked(bytes1(0x07), params);

434:         bytes memory payload = abi.encodePacked(bytes1(0x01), params);

```
*GitHub*: [136](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L136-L136), [171](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L171-L171), [196](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L196-L196), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L223-L223), [254](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L254-L254), [284](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L284-L284), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L434-L434)

```solidity
File: src/RootBridgeAgent.sol

151:             abi.encodePacked(uint16(2), _gasLimit, _remoteBranchExecutionGas, getBranchBridgeAgent[_dstChainId])

168:         bytes memory payload = abi.encodePacked(bytes1(0x00), _recipient, settlementNonce++, _params);

292:         bytes memory payload = abi.encodePacked(bytes1(0x03), settlementOwner, _settlementNonce);

829:                 abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)

893              payload = abi.encodePacked(
894                  _hasFallbackToggled ? bytes1(0x82) : bytes1(0x02),
895                  _recipient,
896                  uint8(_hTokens.length),
897                  _settlementNonce,
898                  _hTokens,
899                  _tokens,
900                  _amounts,
901                  _deposits,
902                  _params
903:             );

879              payload = abi.encodePacked(
880                  _hasFallbackToggled ? bytes1(0x81) : bytes1(0x01),
881                  _recipient,
882                  _settlementNonce,
883                  _hTokens[0],
884                  _tokens[0],
885                  _amounts[0],
886                  _deposits[0],
887                  _params
888:             );

921:                 abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)

943:             abi.encodePacked(bytes1(0x04), _depositNonce),

992          _payload = abi.encodePacked(
993              _hasFallbackToggled ? bytes1(0x81) : bytes1(0x01),
994              _recipient,
995              _settlementNonce,
996              localAddress,
997              underlyingAddress,
998              _amount,
999              _deposit,
1000             _params
1001:        );

1089         _payload = abi.encodePacked(
1090             _hasFallbackToggled ? bytes1(0x02) & 0x0F : bytes1(0x02),
1091             _recipient,
1092             uint8(hTokens.length),
1093             _settlementNonce,
1094             hTokens,
1095             tokens,
1096             _amounts,
1097             _deposits,
1098             _params
1099:        );

1182:        getBranchBridgeAgentPath[_branchChainId] = abi.encodePacked(_newBranchBridgeAgent, address(this));

```
*GitHub*: [151](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L151-L151), [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L168-L168), [292](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L292-L292), [829](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L829-L829), [893](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L893-L903), [879](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L879-L888), [921](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L921-L921), [943](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L943-L943), [992](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L992-L1001), [1089](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1089-L1099), [1182](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1182-L1182)


### [D&#x2011;31] ~~Return values of transfer()/transferFrom() not checked~~
The examples below are for known contracts, which revert if they fail, or are not for ERC20 contracts

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

62:          ERC721(_token).transferFrom(address(this), msg.sender, _tokenId);

```
*GitHub*: [62](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L62-L62)


### [D&#x2011;32] ~~Array lengths not checked~~
These instances only have one array

*There are 6 instances of this issue:*

```solidity
File: src/MulticallRootRouter.sol

488      function _multicall(IMulticall.Call[] memory calls)
489          internal
490          returns (uint256 blockNumber, bytes[] memory returnData)
491:     {

```
*GitHub*: [488](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L488-L491)

```solidity
File: src/VirtualAccount.sol

66:      function call(Call[] calldata calls) external override requiresApprovedCaller returns (bytes[] memory returnData) {

85:      function payableCall(PayableCall[] calldata calls) public payable returns (bytes[] memory returnData) {

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L66-L66), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L85-L85)

```solidity
File: src/interfaces/IMulticall2.sol

20:      function aggregate(Call[] memory calls) external returns (uint256 blockNumber, bytes[] memory returnData);

```
*GitHub*: [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L20-L20)

```solidity
File: src/interfaces/IVirtualAccount.sol

65:      function call(Call[] calldata callInput) external returns (bytes[] memory);

73:      function payableCall(PayableCall[] calldata calls) external payable returns (bytes[] memory);

```
*GitHub*: [65](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L65-L65), [73](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L73-L73)


### [D&#x2011;33] ~~Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning~~
These instances don't use only bytes/strings, so they're invalid

*There are 28 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

115:             rootChainId, "", 0, abi.encodePacked(bytes1(0x09), _settlementNonce)

```
*GitHub*: [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L115-L115)

```solidity
File: src/BranchBridgeAgent.sol

142:         rootBridgeAgentPath = abi.encodePacked(_rootBridgeAgentAddress, address(this));

171:             abi.encodePacked(uint16(2), _gasLimit, _remoteBranchExecutionGas, rootBridgeAgentAddress)

188:         bytes memory payload = abi.encodePacked(bytes1(0x00), depositNonce++, _params);

202:         bytes memory payload = abi.encodePacked(bytes1(0x01), depositNonce++, _params);

219          bytes memory payload = abi.encodePacked(
220              bytes1(0x02), _depositNonce, _dParams.hToken, _dParams.token, _dParams.amount, _dParams.deposit, _params
221:         );

241          bytes memory payload = abi.encodePacked(
242              bytes1(0x03),
243              uint8(_dParams.hTokens.length),
244              _depositNonce,
245              _dParams.hTokens,
246              _dParams.tokens,
247              _dParams.amounts,
248              _dParams.deposits,
249              _params
250:         );

269:         bytes memory payload = abi.encodePacked(bytes1(0x04), msg.sender, depositNonce++, _params);

287          bytes memory payload = abi.encodePacked(
288              _hasFallbackToggled ? bytes1(0x85) : bytes1(0x05),
289              msg.sender,
290              _depositNonce,
291              _dParams.hToken,
292              _dParams.token,
293              _dParams.amount,
294              _dParams.deposit,
295              _params
296:         );

317          bytes memory payload = abi.encodePacked(
318              _hasFallbackToggled ? bytes1(0x86) : bytes1(0x06),
319              msg.sender,
320              uint8(_dParams.hTokens.length),
321              _depositNonce,
322              _dParams.hTokens,
323              _dParams.tokens,
324              _dParams.amounts,
325              _dParams.deposits,
326              _params
327:         );

398                  payload = abi.encodePacked(
399                      bytes1(0x03),
400                      uint8(deposit.hTokens.length),
401                      _depositNonce,
402                      deposit.hTokens,
403                      deposit.tokens,
404                      deposit.amounts,
405                      deposit.deposits,
406                      _params
407:                 );

386                  payload = abi.encodePacked(
387                      _hasFallbackToggled ? bytes1(0x86) : bytes1(0x06),
388                      msg.sender,
389                      uint8(deposit.hTokens.length),
390                      _depositNonce,
391                      deposit.hTokens,
392                      deposit.tokens,
393                      deposit.amounts,
394                      deposit.deposits,
395                      _params
396:                 );

373                  payload = abi.encodePacked(
374                      bytes1(0x02),
375                      _depositNonce,
376                      deposit.hTokens[0],
377                      deposit.tokens[0],
378                      deposit.amounts[0],
379                      deposit.deposits[0],
380                      _params
381:                 );

362                  payload = abi.encodePacked(
363                      _hasFallbackToggled ? bytes1(0x85) : bytes1(0x05),
364                      msg.sender,
365                      _depositNonce,
366                      deposit.hTokens[0],
367                      deposit.tokens[0],
368                      deposit.amounts[0],
369                      deposit.deposits[0],
370                      _params
371:                 );

427:         bytes memory payload = abi.encodePacked(bytes1(0x08), msg.sender, _depositNonce);

776:             abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, rootBridgeAgentAddress)

790:             abi.encodePacked(bytes1(0x09), _settlementNonce),

```
*GitHub*: [142](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L142-L142), [171](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L171-L171), [188](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L188-L188), [202](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L202-L202), [219](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L219-L221), [241](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L241-L250), [269](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L269-L269), [287](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L287-L296), [317](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L317-L327), [398](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L398-L407), [386](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L386-L396), [373](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L373-L381), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L362-L371), [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L427-L427), [776](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L776-L776), [790](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L790-L790)

```solidity
File: src/RootBridgeAgent.sol

151:             abi.encodePacked(uint16(2), _gasLimit, _remoteBranchExecutionGas, getBranchBridgeAgent[_dstChainId])

168:         bytes memory payload = abi.encodePacked(bytes1(0x00), _recipient, settlementNonce++, _params);

292:         bytes memory payload = abi.encodePacked(bytes1(0x03), settlementOwner, _settlementNonce);

829:                 abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)

893              payload = abi.encodePacked(
894                  _hasFallbackToggled ? bytes1(0x82) : bytes1(0x02),
895                  _recipient,
896                  uint8(_hTokens.length),
897                  _settlementNonce,
898                  _hTokens,
899                  _tokens,
900                  _amounts,
901                  _deposits,
902                  _params
903:             );

879              payload = abi.encodePacked(
880                  _hasFallbackToggled ? bytes1(0x81) : bytes1(0x01),
881                  _recipient,
882                  _settlementNonce,
883                  _hTokens[0],
884                  _tokens[0],
885                  _amounts[0],
886                  _deposits[0],
887                  _params
888:             );

921:                 abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)

943:             abi.encodePacked(bytes1(0x04), _depositNonce),

992          _payload = abi.encodePacked(
993              _hasFallbackToggled ? bytes1(0x81) : bytes1(0x01),
994              _recipient,
995              _settlementNonce,
996              localAddress,
997              underlyingAddress,
998              _amount,
999              _deposit,
1000             _params
1001:        );

1089         _payload = abi.encodePacked(
1090             _hasFallbackToggled ? bytes1(0x02) & 0x0F : bytes1(0x02),
1091             _recipient,
1092             uint8(hTokens.length),
1093             _settlementNonce,
1094             hTokens,
1095             tokens,
1096             _amounts,
1097             _deposits,
1098             _params
1099:        );

1182:        getBranchBridgeAgentPath[_branchChainId] = abi.encodePacked(_newBranchBridgeAgent, address(this));

```
*GitHub*: [151](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L151-L151), [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L168-L168), [292](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L292-L292), [829](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L829-L829), [893](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L893-L903), [879](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L879-L888), [921](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L921-L921), [943](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L943-L943), [992](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L992-L1001), [1089](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1089-L1099), [1182](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1182-L1182)


### [D&#x2011;34] ~~Use `@inheritdoc` rather than using a non-standard annotation~~


*There are 10 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

95       /**
96        * @notice Internal function performs the call to LayerZero messaging layer Endpoint for cross-chain messaging.
97        *   @param _calldata params for root bridge agent execution.
98        */
99:      function _performCall(address payable, bytes memory _calldata, GasParams calldata) internal override {

108      /**
109       * @notice Internal function performs the call to Layerzero Endpoint Contract for cross-chain messaging.
110       *   @param _settlementNonce root settlement nonce to fallback.
111       */
112:     function _performFallbackCall(address payable, uint32 _settlementNonce) internal override {

123      /// @notice Verifies the caller is the Root Bridge Agent.
124      /// @dev Internal function used in modifier to reduce contract bytesize.
125:     function _requiresEndpoint(address _endpoint, bytes calldata) internal view override {

```
*GitHub*: [95](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L95-L99), [108](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L108-L112), [123](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L123-L125)

```solidity
File: src/ArbitrumBranchPort.sol

102       * @notice Internal function to bridge in assets from the Root Chain.
103       * @param _recipient recipient of the bridged assets.
104       * @param _localAddress address of the local token.
105       * @param _amount amount of the bridged assets.
106       */
107:     function _bridgeIn(address _recipient, address _localAddress, uint256 _amount) internal override {

114       * @param _localAddress address of the local token.
115       * @param _underlyingAddress address of the underlying token.
116       * @param _amount amount of the bridged assets.
117       * @param _deposit amount of the underlying assets to be deposited.
118       */
119      function _bridgeOut(
120          address _depositor,
121          address _localAddress,
122          address _underlyingAddress,
123          uint256 _amount,
124          uint256 _deposit
125:     ) internal override {

```
*GitHub*: [102](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L102-L107), [114](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L114-L125)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

80        *    @param _gParams Gas parameters for remote execution.
81        *    @dev FUNC ID: 2
82        *    @dev all hTokens have 18 decimals.
83        *
84        */
85       function _receiveAddBridgeAgent(
86           address _newBranchRouter,
87           address _branchBridgeAgentFactory,
88           address _rootBridgeAgent,
89           address _rootBridgeAgentFactory,
90           address _refundee,
91           GasParams memory _gParams
92:      ) internal override {

```
*GitHub*: [80](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L80-L92)

```solidity
File: src/BranchPort.sol

134      /// @notice Function being overrriden to prevent mistakenly renouncing ownership.
135:     function renounceOwnership() public payable override onlyOwner {

```
*GitHub*: [134](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L134-L135)

```solidity
File: src/RootPort.sol

165      /// @notice Function being overriden to prevent mistakenly renouncing ownership.
166:     function renounceOwnership() public payable override onlyOwner {

```
*GitHub*: [165](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L165-L166)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

52       /**
53        * @notice Initializes the Bridge Agent Factory Contract.
54        * @param _coreRootBridgeAgent Address of the Core Root Bridge Agent.
55        */
56:      function initialize(address _coreRootBridgeAgent) external override onlyOwner {

74       /**
75        * @notice Creates a new bridge agent for a branch chain.
76        * @param _newBranchRouterAddress Address of the new branch router.
77        * @param _rootBridgeAgentAddress Address of the root bridge agent to connect to.
78        */
79       function createBridgeAgent(
80           address _newBranchRouterAddress,
81           address _rootBridgeAgentAddress,
82           address _rootBridgeAgentFactoryAddress
83:      ) external virtual override returns (address newBridgeAgent) {

```
*GitHub*: [52](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L52-L56), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L74-L83)


### [D&#x2011;35] ~~Empty function body~~
These constructors have calls to base contracts, so the empty function body cannot be removed. Adding a comment about this is not useful.

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

43       constructor(
44           uint16 _localChainId,
45           address _rootBridgeAgentAddress,
46           address _localRouterAddress,
47           address _localPortAddress
48       )
49           BranchBridgeAgent(
50               _localChainId,
51               _localChainId,
52               _rootBridgeAgentAddress,
53               address(0),
54               _localRouterAddress,
55               _localPortAddress
56           )
57:      {}

```
*GitHub*: [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L43-L57)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

44:      constructor() CoreBranchRouter(address(0)) {}

```
*GitHub*: [44](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L44-L44)

```solidity
File: src/MulticallRootRouterLibZip.sol

29       constructor(uint256 _localChainId, address _localPortAddress, address _multicallAddress)
30           MulticallRootRouter(_localChainId, _localPortAddress, _multicallAddress)
31:      {}

```
*GitHub*: [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L29-L31)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

30       constructor(
31           uint16 _rootChainId,
32           address _rootBridgeAgentFactoryAddress,
33           address _localCoreBranchRouterAddress,
34           address _localPortAddress,
35           address _owner
36       )
37           BranchBridgeAgentFactory(
38               _rootChainId,
39               _rootChainId,
40               _rootBridgeAgentFactoryAddress,
41               address(0),
42               _localCoreBranchRouterAddress,
43               _localPortAddress,
44               _owner
45           )
46:      {}

```
*GitHub*: [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L30-L46)


### [D&#x2011;36] ~~Operator += costs more gas than = + for state variables~~
Not using `+=` for non-basic-typed state variables costs an extra **[40 gas](https://gist.github.com/IllIllI000/4fc5f83a9edc6ed16677258bf58f32a5)** due to having to recalculate the mapping's value's hash

*There are 5 instances of this issue:*

```solidity
File: src/BranchPort.sol

157:         getPortStrategyTokenDebt[msg.sender][_token] += _amount;

169:         getPortStrategyTokenDebt[msg.sender][_token] -= _amount;

172:         getStrategyTokenDebt[_token] -= _amount;

```
*GitHub*: [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L157-L157), [169](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L169-L169), [172](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L172-L172)

```solidity
File: src/token/ERC20hTokenRoot.sol

58:          getTokenBalance[chainId] += amount;

70:          getTokenBalance[chainId] -= amount;

```
*GitHub*: [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L58-L58), [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L70-L70)


### [D&#x2011;37] ~~Using named function calls is a much safer~~
A named function cannot be used here, because it's not known to the current contract

*There are 4 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

717:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

737:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

```
*GitHub*: [717](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L717-L717), [737](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L737-L737)

```solidity
File: src/RootBridgeAgent.sol

754:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

779:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

```
*GitHub*: [754](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L754-L754), [779](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L779-L779)


### [D&#x2011;38] ~~`selfbalance()` is cheaper than `address(this).balance`~~
Both methods use the [same amount](https://gist.github.com/IllIllI000/23eac38a9b6483167a92e52bb915faa1) of gas, so this finding is invalid

*There are 9 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

717:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

737:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

787:         ILayerZeroEndpoint(lzEndpointAddress).send{value: address(this).balance}(

```
*GitHub*: [717](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L717-L717), [737](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L737-L737), [787](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L787-L787)

```solidity
File: src/BranchBridgeAgentExecutor.sol

92:              _recipient.safeTransferETH(address(this).balance);

126:             _recipient.safeTransferETH(address(this).balance);

```
*GitHub*: [92](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L92-L92), [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L126-L126)

```solidity
File: src/RootBridgeAgent.sol

695:                 address(this).balance

754:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

779:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

940:         ILayerZeroEndpoint(lzEndpointAddress).send{value: address(this).balance}(

```
*GitHub*: [695](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L695-L695), [754](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L754-L754), [779](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L779-L779), [940](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L940-L940)


### [D&#x2011;39] ~~Contract should expose an `interface`~~
These are library functions, so they cannot use an interface

*There are 4 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

11       function deploy(uint16 _localChainId, address _daoAddress, address _localRouterAddress, address _localPortAddress)
12           external
13           returns (ArbitrumBranchBridgeAgent)
14:      {

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L11-L14)

```solidity
File: src/BranchBridgeAgent.sol

24       function deploy(
25           uint16 _rootChainId,
26           uint16 _localChainId,
27           address _rootBridgeAgentAddress,
28           address _lzEndpointAddress,
29           address _localRouterAddress,
30           address _localPortAddress
31:      ) external returns (BranchBridgeAgent) {

```
*GitHub*: [24](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L24-L31)

```solidity
File: src/BranchBridgeAgentExecutor.sol

16:      function deploy() external returns (address) {

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L16-L16)

```solidity
File: src/RootBridgeAgentExecutor.sol

14:      function deploy(address _rootBridgeAgent) external returns (address) {

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L14-L14)


### [D&#x2011;40] ~~Storage Write Removal Bug On Conditional Early Termination~~
In solidity versions 0.8.13 through 0.8.16, there is a [bug](https://blog.soliditylang.org/2022/09/08/storage-write-removal-before-conditional-termination/) involving the use of the Yul functions `return()` and `stop()`. If those functions aren't called, or if the Solidity version doesn't match, the finding is not low severity.

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

149          assembly {
150              size := extcodesize(addr)
151:         }

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L149-L151)


### [D&#x2011;41] ~~Low level calls with Solidity before 0.8.14 result in an optimiser bug~~
This assembly block does not call `mstore()`, so it's not possible to hit the bug here even if there are small future changes, so this doesn't seem low severity.

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

149          assembly {
150              size := extcodesize(addr)
151:         }

```
*GitHub*: [149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L149-L151)


### [D&#x2011;42] ~~`abi.encode()` is less efficient than `abi.encodepacked()`~~
`abi.encodePacked()` does not always save gas over `abi.encode()` and in fact often costs [more](https://gist.github.com/IllIllI000/2ee970e4f05af4d2a3d89a56b5cc93a5) gas. The [comparison](https://github.com/ConnorBlockchain/Solidity-Encode-Gas-Comparison) sometimes linked to itself even shows that when addresses are involved, the packed flavor costs more gas.

*There are 15 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

53:          bytes memory params = abi.encode(

112:         bytes memory data = abi.encode(newBridgeAgent, _rootBridgeAgent);

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L53-L53), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L112-L112)

```solidity
File: src/BranchBridgeAgent.sol

471:         bytes memory params = abi.encode(_settlementNonce, msg.sender, _params, _gParams[1]);

```
*GitHub*: [471](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L471-L471)

```solidity
File: src/CoreBranchRouter.sol

48:          bytes memory params = abi.encode(msg.sender, _globalAddress, _dstChainId, [_gParams[1], _gParams[2]]);

72:          bytes memory params = abi.encode(_underlyingAddress, newToken, newToken.name(), newToken.symbol(), decimals);

178:         bytes memory params = abi.encode(_globalAddress, newToken);

226:         bytes memory params = abi.encode(newBridgeAgent, _rootBridgeAgent);

```
*GitHub*: [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L48-L48), [72](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L72-L72), [178](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L178-L178), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L226-L226)

```solidity
File: src/CoreRootRouter.sol

126:         bytes memory params = abi.encode(

168:         bytes memory params = abi.encode(_branchBridgeAgentFactory);

193:         bytes memory params = abi.encode(_branchBridgeAgent);

220:         bytes memory params = abi.encode(_underlyingToken, _minimumReservesRatio);

251:         bytes memory params = abi.encode(_portStrategy, _underlyingToken, _dailyManagementLimit, _isUpdateDailyLimit);

281:         bytes memory params = abi.encode(_coreBranchRouter, _coreBranchBridgeAgent);

424:         bytes memory params = abi.encode(

```
*GitHub*: [126](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L126-L126), [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L168-L168), [193](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L193-L193), [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L220-L220), [251](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L251-L251), [281](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L281-L281), [424](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L424-L424)

```solidity
File: src/RootPort.sol

362:         newAccount = new VirtualAccount{salt: keccak256(abi.encode(_user))}(_user, address(this));

```
*GitHub*: [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L362-L362)


### [D&#x2011;43] ~~Large approvals may not work with some ERC20 tokens~~
These are not maximum approvals, or approvals that grow over time, so there is no broken behavior here

*There are 4 instances of this issue:*

```solidity
File: src/BaseBranchRouter.sol

168:                 ERC20(_hToken).approve(_localPortAddress, _amount - _deposit);

175:             ERC20(_token).approve(_localPortAddress, _deposit);

```
*GitHub*: [168](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L168-L168), [175](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L175-L175)

```solidity
File: src/MulticallRootRouter.sol

521:         outputToken.safeApprove(_bridgeAgentAddress, amountOut);

559:             outputTokens[i].safeApprove(_bridgeAgentAddress, amountsOut[i]);

```
*GitHub*: [521](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L521-L521), [559](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L559-L559)


### [D&#x2011;44] ~~Not initializing local variables to zero saves gas~~
This is only true for state variables, and does not save gas for [local variables](https://gist.github.com/IllIllI000/e075d189c1b23dce256cd166e28f3397). The examples below are for local variables and therefore do not save gas, and are invalid.

*There are 15 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

192:         for (uint256 i = 0; i < _hTokens.length;) {

```
*GitHub*: [192](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L192-L192)

```solidity
File: src/BranchBridgeAgent.sol

447:         for (uint256 i = 0; i < deposit.tokens.length;) {

513:         for (uint256 i = 0; i < numOfAssets;) {

```
*GitHub*: [447](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L447-L447), [513](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L513-L513)

```solidity
File: src/BranchPort.sol

257:         for (uint256 i = 0; i < length;) {

305:         for (uint256 i = 0; i < length;) {

```
*GitHub*: [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L257-L257), [305](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L305-L305)

```solidity
File: src/MulticallRootRouter.sol

278:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

367:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

455:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

557:         for (uint256 i = 0; i < outputTokens.length;) {

```
*GitHub*: [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L278-L278), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L367-L367), [455](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L455-L455), [557](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L557-L557)

```solidity
File: src/RootBridgeAgent.sol

318:         for (uint256 i = 0; i < settlement.hTokens.length;) {

399:         for (uint256 i = 0; i < length;) {

1070:        for (uint256 i = 0; i < hTokens.length;) {

```
*GitHub*: [318](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L318-L318), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L399-L399), [1070](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1070-L1070)

```solidity
File: src/RootBridgeAgentExecutor.sol

281:         for (uint256 i = 0; i < uint256(uint8(numOfAssets));) {

```
*GitHub*: [281](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L281-L281)

```solidity
File: src/VirtualAccount.sol

70:          for (uint256 i = 0; i < length;) {

90:          for (uint256 i = 0; i < length;) {

```
*GitHub*: [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L70-L70), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L90-L90)

</details>




### [D&#x2011;45] ~~Using `this` to access functions results in an external call, wasting gas~~
This is not an external call

*There are 5 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

582:             abi.encodeWithSelector(this.lzReceiveNonBlocking.selector, msg.sender, _srcAddress, _payload)

```
*GitHub*: [582](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L582-L582)

```solidity
File: src/RootBridgeAgent.sol

427:             abi.encodeWithSelector(this.lzReceiveNonBlocking.selector, msg.sender, _srcChainId, _srcAddress, _payload)

```
*GitHub*: [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L427-L427)

```solidity
File: src/VirtualAccount.sol

120:         return this.onERC721Received.selector;

130:         return this.onERC1155Received.selector;

140:         return this.onERC1155BatchReceived.selector;

```
*GitHub*: [120](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L120-L120), [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L130-L130), [140](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L140-L140)


### [D&#x2011;46] ~~Using `storage` instead of `memory` for structs/arrays saves gas~~
There is no storage being read from

*There are 14 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

507:         address[] memory _hTokens = new address[](numOfAssets);

508:         address[] memory _tokens = new address[](numOfAssets);

509:         uint256[] memory _amounts = new uint256[](numOfAssets);

510:         uint256[] memory _deposits = new uint256[](numOfAssets);

827:         address[] memory addressArray = new address[](1);

828:         uint256[] memory uintArray = new uint256[](1);

```
*GitHub*: [507](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L507-L507), [508](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L508-L508), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L509-L509), [510](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L510-L510), [827](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L827-L827), [828](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L828-L828)

```solidity
File: src/RootBridgeAgent.sol

1007:        address[] memory addressArray = new address[](1);

1008:        uint256[] memory uintArray = new uint256[](1);

1067:        address[] memory hTokens = new address[](_globalAddresses.length);

1068:        address[] memory tokens = new address[](_globalAddresses.length);

```
*GitHub*: [1007](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1007-L1007), [1008](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1008-L1008), [1067](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1067-L1067), [1068](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1068-L1068)

```solidity
File: src/RootBridgeAgentExecutor.sol

276:         address[] memory hTokens = new address[](numOfAssets);

277:         address[] memory tokens = new address[](numOfAssets);

278:         uint256[] memory amounts = new uint256[](numOfAssets);

279:         uint256[] memory deposits = new uint256[](numOfAssets);

```
*GitHub*: [276](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L276-L276), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L277-L277), [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L278-L278), [279](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L279-L279)


### [D&#x2011;47] ~~Use replace and pop instead of the delete keyword to removing an item from an array~~
The examples below are mappings, not arrays

*There are 2 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

456:         delete getDeposit[_depositNonce];

```
*GitHub*: [456](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L456-L456)

```solidity
File: src/RootBridgeAgent.sol

343:         delete getSettlement[_settlementNonce];

```
*GitHub*: [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L343-L343)


### [D&#x2011;48] ~~Events that mark critical parameter changes should contain both the old and the new value~~
These are not critical parameter changes

*There are 15 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

689:             emit LogFallback(nonce);

700:         emit LogExecute(nonce);

```
*GitHub*: [689](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L689-L689), [700](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L700-L700)

```solidity
File: src/BranchPort.sol

163:         emit DebtCreated(msg.sender, _token, _amount);

184:         emit DebtRepaid(msg.sender, _token, _amount);

218:         emit DebtRepaid(_strategy, _token, amountToWithdraw);

351:         emit BridgeAgentFactoryToggled(_newBridgeAgentFactory);

358:         emit BridgeAgentToggled(_bridgeAgent);

378:         emit StrategyTokenToggled(_token);

399:         emit PortStrategyToggled(_portStrategy, _token);

```
*GitHub*: [163](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L163-L163), [184](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L184-L184), [218](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L218-L218), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L351-L351), [358](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L358-L358), [378](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L378-L378), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L399-L399)

```solidity
File: src/RootBridgeAgent.sol

726:             emit LogFallback(nonce, _srcChainId);

736:         emit LogExecute(nonce, _srcChainId);

```
*GitHub*: [726](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L726-L726), [736](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L736-L736)

```solidity
File: src/RootPort.sol

406:         emit BridgeAgentSynced(_newBranchBridgeAgent, _rootBridgeAgent, _branchChainId);

417:         emit BridgeAgentToggled(_bridgeAgent);

434:         emit BridgeAgentFactoryToggled(_bridgeAgentFactory);

549:         emit CoreBranchSynced(_coreBranchRouter, _coreBranchBridgeAgent, _dstChainId);

```
*GitHub*: [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L406-L406), [417](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L417-L417), [434](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L434-L434), [549](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L549-L549)


### [D&#x2011;49] ~~Style guide: Function Names Not in mixedCase~~
According to the Solidity Style Guide, non-`external`/`public` function names should begin with an [underscore](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables), and all of these fall into that category

*There are 49 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

99:      function _performCall(address payable, bytes memory _calldata, GasParams calldata) internal override {

112:     function _performFallbackCall(address payable, uint32 _settlementNonce) internal override {

125:     function _requiresEndpoint(address _endpoint, bytes calldata) internal view override {

```
*GitHub*: [99](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L99-L99), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L112-L112), [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L125-L125)

```solidity
File: src/ArbitrumBranchPort.sol

107:     function _bridgeIn(address _recipient, address _localAddress, uint256 _amount) internal override {

119      function _bridgeOut(
120          address _depositor,
121          address _localAddress,
122          address _underlyingAddress,
123          uint256 _amount,
124          uint256 _deposit
125:     ) internal override {

```
*GitHub*: [107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L107-L107), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L119-L125)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

85       function _receiveAddBridgeAgent(
86           address _newBranchRouter,
87           address _branchBridgeAgentFactory,
88           address _rootBridgeAgent,
89           address _rootBridgeAgentFactory,
90           address _refundee,
91           GasParams memory _gParams
92:      ) internal override {

```
*GitHub*: [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L85-L92)

```solidity
File: src/BaseBranchRouter.sol

160:     function _transferAndApproveToken(address _hToken, address _token, uint256 _amount, uint256 _deposit) internal {

186      function _transferAndApproveMultipleTokens(
187          address[] memory _hTokens,
188          address[] memory _tokens,
189          uint256[] memory _amounts,
190          uint256[] memory _deposits
191:     ) internal {

```
*GitHub*: [160](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L160-L160), [186](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L186-L191)

```solidity
File: src/BranchBridgeAgent.sol

712:     function _execute(uint256 _settlementNonce, bytes memory _calldata) private {

730      function _execute(bool _hasFallbackToggled, uint32 _settlementNonce, address _refundee, bytes memory _calldata)
731          private
732:     {

765      function _performCall(address payable _refundee, bytes memory _payload, GasParams calldata _gParams)
766          internal
767          virtual
768:     {

785:     function _performFallbackCall(address payable _refundee, uint32 _settlementNonce) internal virtual {

812      function _createDeposit(
813          uint32 _depositNonce,
814          address payable _refundee,
815          address _hToken,
816          address _token,
817          uint256 _amount,
818          uint256 _deposit
819:     ) internal {

860      function _createDepositMultiple(
861          uint32 _depositNonce,
862          address payable _refundee,
863          address[] memory _hTokens,
864          address[] memory _tokens,
865          uint256[] memory _amounts,
866          uint256[] memory _deposits
867:     ) internal {

903      function _clearToken(address _recipient, address _hToken, address _token, uint256 _amount, uint256 _deposit)
904          internal
905:     {

936:     function _requiresEndpoint(address _endpoint, bytes calldata _srcAddress) internal view virtual {

```
*GitHub*: [712](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L712-L712), [730](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L730-L732), [765](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L765-L768), [785](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L785-L785), [812](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L812-L819), [860](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L860-L867), [903](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L903-L905), [936](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L936-L936)

```solidity
File: src/BranchPort.sol

435:     function _excessReserves(uint256 _strategyTokenDebt, address _token) internal view returns (uint256) {

449      function _reservesLacking(uint256 _strategyTokenDebt, address _token, uint256 currBalance)
450          internal
451          view
452          returns (uint256)
453:     {

468      function _minimumReserves(uint256 _strategyTokenDebt, uint256 _currBalance, address _token)
469          internal
470          view
471          returns (uint256)
472:     {

485:     function _checkTimeLimit(address _token, uint256 _amount) internal {

502:     function _bridgeIn(address _recipient, address _localAddress, uint256 _amount) internal virtual {

514      function _bridgeOut(
515          address _depositor,
516          address _localAddress,
517          address _underlyingAddress,
518          uint256 _amount,
519          uint256 _deposit
520:     ) internal virtual {

```
*GitHub*: [435](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L435-L435), [449](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L449-L453), [468](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L468-L472), [485](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L485-L485), [502](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L502-L502), [514](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L514-L520)

```solidity
File: src/CoreBranchRouter.sol

166      function _receiveAddGlobalToken(
167          address _globalAddress,
168          string memory _name,
169          string memory _symbol,
170          uint8 _decimals,
171          address _refundee,
172          GasParams memory _gParams
173:     ) internal {

199      function _receiveAddBridgeAgent(
200          address _newBranchRouter,
201          address _branchBridgeAgentFactory,
202          address _rootBridgeAgent,
203          address _rootBridgeAgentFactory,
204          address _refundee,
205          GasParams memory _gParams
206:     ) internal virtual {

244:     function _toggleBranchBridgeAgentFactory(address _newBridgeAgentFactoryAddress) internal {

263:     function _removeBranchBridgeAgent(address _branchBridgeAgent) internal {

284:     function _manageStrategyToken(address _underlyingToken, uint256 _minimumReservesRatio) internal {

307      function _managePortStrategy(
308          address _portStrategy,
309          address _underlyingToken,
310          uint256 _dailyManagementLimit,
311          bool _isUpdateDailyLimit
312:     ) internal {

```
*GitHub*: [166](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L166-L173), [199](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L199-L206), [244](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L244-L244), [263](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L263-L263), [284](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L284-L284), [307](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L307-L312)

```solidity
File: src/CoreRootRouter.sol

406      function _addGlobalToken(
407          address _refundee,
408          address _globalAddress,
409          uint16 _dstChainId,
410          GasParams[2] memory _gParams
411:     ) internal {

452      function _addLocalToken(
453          address _underlyingAddress,
454          address _localAddress,
455          string memory _name,
456          string memory _symbol,
457          uint8 _decimals,
458          uint16 _srcChainId
459:     ) internal {

481:     function _setLocalToken(address _globalAddress, address _localAddress, uint16 _dstChainId) internal {

500      function _syncBranchBridgeAgent(address _newBranchBridgeAgent, address _rootBridgeAgent, uint256 _srcChainId)
501          internal
502:     {

```
*GitHub*: [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L406-L411), [452](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L452-L459), [481](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L481-L481), [500](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L500-L502)

```solidity
File: src/MulticallRootRouter.sol

488      function _multicall(IMulticall.Call[] memory calls)
489          internal
490          returns (uint256 blockNumber, bytes[] memory returnData)
491:     {

508      function _approveAndCallOut(
509          address refundee,
510          address recipient,
511          address outputToken,
512          uint256 amountOut,
513          uint256 depositOut,
514          uint16 dstChainId,
515          GasParams memory gasParams
516:     ) internal virtual {

544      function _approveMultipleAndCallOut(
545          address refundee,
546          address recipient,
547          address[] memory outputTokens,
548          uint256[] memory amountsOut,
549          uint256[] memory depositsOut,
550          uint16 dstChainId,
551          GasParams memory gasParams
552:     ) internal virtual {

581:     function _decode(bytes calldata data) internal pure virtual returns (bytes memory) {

604:     function _requiresExecutor() internal view {

```
*GitHub*: [488](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L488-L491), [508](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L508-L516), [544](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L544-L552), [581](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L581-L581), [604](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L604-L604)

```solidity
File: src/MulticallRootRouterLibZip.sol

37:      function _decode(bytes calldata data) internal pure override returns (bytes memory) {

```
*GitHub*: [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L37-L37)

```solidity
File: src/RootBridgeAgent.sol

749:     function _execute(uint256 _depositNonce, bytes memory _calldata, uint16 _srcChainId) private {

768      function _execute(
769          bool _hasFallbackToggled,
770          uint32 _depositNonce,
771          address _refundee,
772          bytes memory _calldata,
773          uint16 _srcChainId
774:     ) private {

808      function _performCall(
809          uint16 _dstChainId,
810          address payable _refundee,
811          bytes memory _payload,
812          GasParams calldata _gParams
813:     ) internal {

856      function _performRetrySettlementCall(
857          bool _hasFallbackToggled,
858          address[] memory _hTokens,
859          address[] memory _tokens,
860          uint256[] memory _amounts,
861          uint256[] memory _deposits,
862          bytes memory _params,
863          uint32 _settlementNonce,
864          address payable _refundee,
865          address _recipient,
866          uint16 _dstChainId,
867          GasParams memory _gParams,
868          uint256 _value
869:     ) internal {

938:     function _performFallbackCall(address payable _refundee, uint32 _depositNonce, uint16 _dstChainId) internal {

966      function _createSettlement(
967          uint32 _settlementNonce,
968          address payable _refundee,
969          address _recipient,
970          uint16 _dstChainId,
971          bytes memory _params,
972          address _globalAddress,
973          uint256 _amount,
974          uint256 _deposit,
975          bool _hasFallbackToggled
976:     ) internal returns (bytes memory _payload) {

1045     function _createSettlementMultiple(
1046         uint32 _settlementNonce,
1047         address payable _refundee,
1048         address _recipient,
1049         uint16 _dstChainId,
1050         address[] memory _globalAddresses,
1051         uint256[] memory _amounts,
1052         uint256[] memory _deposits,
1053         bytes memory _params,
1054         bool _hasFallbackToggled
1055:    ) internal returns (bytes memory _payload) {

1131     function _updateStateOnBridgeOut(
1132         address _depositor,
1133         address _globalAddress,
1134         address _localAddress,
1135         address _underlyingAddress,
1136         uint256 _amount,
1137         uint256 _deposit,
1138         uint16 _dstChainId
1139:    ) internal {

```
*GitHub*: [749](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L749-L749), [768](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L768-L774), [808](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L808-L813), [856](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L856-L869), [938](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L938-L938), [966](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L966-L976), [1045](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1045-L1055), [1131](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1131-L1139)

```solidity
File: src/RootBridgeAgentExecutor.sol

243:     function _bridgeIn(address _recipient, DepositParams memory _dParams, uint16 _srcChainId) internal {

268      function _bridgeInMultiple(address _recipient, bytes calldata _dParams, uint16 _srcChainId)
269          internal
270          returns (DepositMultipleParams memory dParams)
271:     {

```
*GitHub*: [243](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L243-L243), [268](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L268-L271)

```solidity
File: src/RootPort.sol

190      function _getLocalToken(address _localAddress, uint256 _srcChainId, uint256 _dstChainId)
191          internal
192          view
193          returns (address)
194:     {

```
*GitHub*: [190](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L190-L194)

</details>




### [D&#x2011;50] ~~Bad bot rules~~
The titles below correspond to issues submitted by various bots, where the submitting bot solely submitted invalid findings (i.e. the submitter didn't filter the results of the rule), so they should be given extra scrutiny:
- **Max allowance is not compatible with all tokens** - internal approval for the contract's own balance, so the rule is pointing to the support **for** max allowance
- **increase/decrease allowance should be used instead of approve** - this is an internal approval function
- **Must approve or increase allowance first** - the rule is flagging all transferFrom() calls, without approval logic
- **Contract existence is not checked before low level call** - reading calldata, not making an external call
- **Empty function blocks** - the bot's removed the extensive comment documentation in the 'code blocks' it shows for these virtual functions used to allow child contracts to implement functionality, or are constructors
- **Utility contracts can be made into libraries** - all provided examples are invalid
- **Address values should be used through variables rather than used as literals** - none of the examples are of addresses
- **Employ Explicit Casting to Bytes or Bytes32 for Enhanced Code Clarity and Meaning** - the large majority of the examples are of multiple arguments, not just one
- **Some if-statement can be converted to a ternary** - you can't use a ternary when only one of the branches is a `return`
- **Addresses shouldn't be hard-coded** - none of these are addresses
- **State variables used within a function more than once should be cached to save gas** - none of these are state variables
- **Use storage instead of memory for structs/arrays** - these all are array call arguments, not arrays copied from storage
- **Use bitmap to save gas** - none of these are examples where bitmaps can be used
- **Consider merging sequential for loops** - the examples cannot be merged
- **Emitting storage values instead of the memory one.** - this is a gas finding, not a Low one
- **`selfbalance()` is cheaper than `address(this).balance`** - some bots submit the issue twice (under the heading `Use assembly when getting a contractundefineds balance of ETH`)
- **Imports could be organized more systematically** - a lot of bots are blindly checking for interfaces not coming first. That is not the only way of organizing imports, and most projects are doing it in a systematic, valid, way
- **Unused * definition** - some bots are reporting false positives for these rules. Check that it isn't used, or that if it's used, that there are two definitions, with one being unused
- **`internal` functions not called by the contract should be removed** - some bots are reporting false positives when the function is called by a child contract, rather than the defining contract
- **Change `public` to `external` for functions that are not called internally** - some bots are reporting false positives when the function is called by a child contract, rather than the defining contract
- **Avoid contract existence checks by using low level calls** - at least one bot isn't checking that the version is prior to 0.8.10
- **For Operations that will not overflow, you could use unchecked** - at least one bot is flagging every single line, which has nothing to do with using `unchecked`

Some of these have been raised as invalid in multiple contests, and the bot owners have not fixed them. Without penalties, they're unlikely to make any changes

*There is one instance of this issue:*

```solidity
File: src/token/ERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L2-L2)


### [D&#x2011;51] ~~The result of function calls should be cached rather than re-calling the function~~
These cannot be cached

*There are 4 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

689:             emit LogFallback(nonce);

700:         emit LogExecute(nonce);

```
*GitHub*: [689](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L689-L689), [700](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L700-L700)

```solidity
File: src/RootBridgeAgent.sol

726:             emit LogFallback(nonce, _srcChainId);

736:         emit LogExecute(nonce, _srcChainId);

```
*GitHub*: [726](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L726-L726), [736](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L736-L736)


### [D&#x2011;52] ~~Contracts do not work with fee-on-transfer tokens~~
An ERC20 token being used, in and of itself, is not evidence of a fee-on-transfer issue; there must be other evidence that the balance accounting gets broken, and these lines do not contain such evidence.

*There are 17 instances of this issue:*

```solidity
File: src/ArbitrumCoreBranchRouter.sol

56:              string.concat("Arbitrum Ulysses ", ERC20(_underlyingAddress).name()),

57:              string.concat("arb-u", ERC20(_underlyingAddress).symbol()),

58:              ERC20(_underlyingAddress).decimals()

```
*GitHub*: [56](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L56-L56), [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L57-L57), [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L58-L58)

```solidity
File: src/BranchPort.sol

503:         ERC20hTokenBranch(_localAddress).mint(_recipient, _amount);

```
*GitHub*: [503](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L503-L503)

```solidity
File: src/CoreBranchRouter.sol

64:          uint8 decimals = ERC20(_underlyingAddress).decimals();

68:              ERC20(_underlyingAddress).name(), ERC20(_underlyingAddress).symbol(), decimals, true

```
*GitHub*: [64](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L64-L64), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L68-L68), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L68-L68)

```solidity
File: src/CoreRootRouter.sol

426:             ERC20(_globalAddress).name(),

427:             ERC20(_globalAddress).symbol(),

428:             ERC20(_globalAddress).decimals(),

```
*GitHub*: [426](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L426-L426), [427](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L427-L427), [428](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L428-L428)

```solidity
File: src/RootPort.sol

321:         ERC20hTokenRoot(_hToken).burn(_from, _amount, _srcChainId);

332:         ERC20hTokenRoot(_hToken).burn(_from, _amount, localChainId);

342:         if (!ERC20hTokenRoot(_hToken).mint(_to, _amount, localChainId)) revert UnableToMint();

452:             IERC20hTokenRootFactory(ICoreRootRouter(coreRootRouterAddress).hTokenFactoryAddress()).createToken(

```
*GitHub*: [321](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L321-L321), [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L332-L332), [342](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L342-L342), [452](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L452-L452)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

66:              ERC20(_wrappedNativeTokenAddress).name(),

67:              ERC20(_wrappedNativeTokenAddress).symbol(),

68:              ERC20(_wrappedNativeTokenAddress).decimals(),

```
*GitHub*: [66](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L66-L66), [67](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L67-L67), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L68-L68)


### [D&#x2011;53] ~~Re-org attack~~
No specific vulnerability has been outlined, other than the fact that block chains have re-orgs, and nothing is being cloned

*There are 10 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

15:          return new ArbitrumBranchBridgeAgent(

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L15-L15)

```solidity
File: src/BranchBridgeAgent.sol

32:          return new BranchBridgeAgent(

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L32-L32)

```solidity
File: src/BranchBridgeAgentExecutor.sol

17:          return address(new BranchBridgeAgentExecutor());

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L17-L17)

```solidity
File: src/RootBridgeAgentExecutor.sol

15:          return address(new RootBridgeAgentExecutor(_rootBridgeAgent));

```
*GitHub*: [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L15-L15)

```solidity
File: src/RootPort.sol

362:         newAccount = new VirtualAccount{salt: keccak256(abi.encode(_user))}(_user, address(this));

```
*GitHub*: [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L362-L362)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

63:          ERC20hTokenBranch newToken = new ERC20hTokenBranch(

103:             : new ERC20hTokenBranch("", "", _name, _symbol, _decimals, localPortAddress);

102:             ? new ERC20hTokenBranch(chainName, chainSymbol, _name, _symbol, _decimals, localPortAddress)

```
*GitHub*: [63](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L63-L63), [103](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L103-L103), [102](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L102-L102)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

81:          newToken = new ERC20hTokenRoot(

```
*GitHub*: [81](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L81-L81)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

50:              new RootBridgeAgent(

```
*GitHub*: [50](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L50-L50)

</details>




### [D&#x2011;54] ~~`SafeTransferLib` does not ensure that the token contract exists~~
`safeTransfer()`/`safeTransferFrom()` aren't called from this file, so the vulnerability doesn't exist here

*There are 6 instances of this issue:*

```solidity
File: src/BranchBridgeAgentExecutor.sol

6:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

30:      using SafeTransferLib for address;

```
*GitHub*: [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L6-L6), [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L30-L30)

```solidity
File: src/MulticallRootRouter.sol

5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

58:      using SafeTransferLib for address;

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L5-L5), [58](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L58-L58)

```solidity
File: src/VirtualAccount.sol

5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

18:      using SafeTransferLib for address;

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L5-L5), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L18-L18)


### [D&#x2011;55] ~~Use `_safeMint` instead of `_mint` for ERC721~~
The contract here isn't an ERC721 - it's some other token. Note that ERC1155 defines `_mint()`, not `_safeMint()`

*There are 2 instances of this issue:*

```solidity
File: src/token/ERC20hTokenBranch.sol

30:          _mint(account, amount);

```
*GitHub*: [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L30-L30)

```solidity
File: src/token/ERC20hTokenRoot.sol

59:          _mint(to, amount);

```
*GitHub*: [59](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L59-L59)


### [D&#x2011;56] ~~Default `bool` values are manually reset~~
Using delete instead of assigning zero/false to state variables does not save any extra gas with the optimizer [on](https://gist.github.com/IllIllI000/ef8ec3a70aede7f12433fe63dc418515#with-the-optimizer-set-at-200-runs) (saves 5-8 gas with optimizer completely off), so this finding is invalid, especially since if they were interested in gas savings, they'd have the optimizer enabled. Some bots are also flagging `true` rather than just `false`

*There are 21 instances of this issue:*

```solidity
File: src/BranchPort.sol

130:         isBridgeAgentFactory[_bridgeAgentFactory] = true;

322:         isBridgeAgent[_bridgeAgent] = true;

341:         isBridgeAgentFactory[_newBridgeAgentFactory] = true;

369:         isStrategyToken[_token] = true;

390:         isPortStrategy[_portStrategy][_token] = true;

420:         isBridgeAgent[_coreBranchBridgeAgent] = true;

```
*GitHub*: [130](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L130-L130), [322](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L322-L322), [341](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L341-L341), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L369-L369), [390](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L390-L390), [420](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L420-L420)

```solidity
File: src/CoreRootRouter.sol

76:          _setup = true;

85:          _setup = false;

```
*GitHub*: [76](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L76-L76), [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L85-L85)

```solidity
File: src/RootBridgeAgent.sol

1172:        isBranchBridgeAgentAllowed[_branchChainId] = true;

```
*GitHub*: [1172](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1172-L1172)

```solidity
File: src/RootPort.sol

113:         isChainId[_localChainId] = true;

116:         _setup = true;

117:         _setupCore = true;

133:         _setup = false;

135:         isBridgeAgentFactory[_bridgeAgentFactory] = true;

157:         _setupCore = false;

249:         isGlobalAddress[_globalAddress] = true;

387:         isBridgeAgent[_bridgeAgent] = true;

425:         isBridgeAgentFactory[_bridgeAgentFactory] = true;

465:         isChainId[_chainId] = true;

467:         isGlobalAddress[newGlobalToken] = true;

499:         isGlobalAddress[_ecoTokenGlobalAddress] = true;

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L113-L113), [116](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L116-L116), [117](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L117-L117), [133](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L133-L133), [135](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L135-L135), [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L157-L157), [249](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L249-L249), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L387-L387), [425](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L425-L425), [465](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L465-L465), [467](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L467-L467), [499](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L499-L499)


### [D&#x2011;57] ~~Interfaces should be defined in separate files from their usage~~
These interfaces are already in a file separate from the implementation

*There are 21 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/interfaces/IArbitrumBranchPort.sol

16   interface IArbitrumBranchPort is IBranchPort {
17       /*///////////////////////////////////////////////////////////////
18                           EXTERNAL FUNCTIONS
19       //////////////////////////////////////////////////////////////*/
20   
21       /**
22        * @notice Function to deposit underlying/native token amount into Port in exchange for Local hToken.
23        *     @param _depositor underlying/native token depositor.
24        *     @param _recipient hToken receiver.
25        *     @param _underlyingAddress underlying/native token address.
26        *     @param _amount amount of tokens.
27:       */

```
*GitHub*: [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L16-L27)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

87   interface IBranchBridgeAgent is ILayerZeroReceiver {
88       /*///////////////////////////////////////////////////////////////
89                           VIEW FUNCTIONS
90       //////////////////////////////////////////////////////////////*/
91   
92       /**
93        * @notice External function to return the Branch Chain's Local Port Address.
94        * @return address of the Branch Chain's Local Port.
95:       */

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L87-L95)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

12   interface IBranchBridgeAgentFactory {
13       /*///////////////////////////////////////////////////////////////
14                           BRIDGE AGENT FUNCTIONS
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Creates a new Branch Bridge Agent.
19        * @param newRootRouterAddress New Root Router Address.
20        * @param rootBridgeAgentAddress Root Bridge Agent Address.
21        * @param _rootBridgeAgentFactoryAddress Root Bridge Agent Factory Address.
22        * @return newBridgeAgent New Bridge Agent Address.
23:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L12-L23)

```solidity
File: src/interfaces/IBranchPort.sol

14   interface IBranchPort {
15       /*///////////////////////////////////////////////////////////////
16                               VIEW FUNCTIONS
17       //////////////////////////////////////////////////////////////*/
18       /**
19        * @notice Returns true if the address is a Bridge Agent.
20        *   @param _bridgeAgent Bridge Agent address.
21        *   @return bool.
22:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L14-L22)

```solidity
File: src/interfaces/IBranchRouter.sol

21   interface IBranchRouter {
22       /*///////////////////////////////////////////////////////////////
23                               VIEW / STATE
24       //////////////////////////////////////////////////////////////*/
25   
26:      /// @notice External function to return the Branch Chain's Local Port Address.

```
*GitHub*: [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L21-L26)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

27   interface ICoreBranchRouter {
28       /*///////////////////////////////////////////////////////////////
29                           EXTERNAL FUNCTIONS
30       //////////////////////////////////////////////////////////////*/
31   
32       /**
33        * @notice Function to deploy/add a token already present in the global environment to a branch chain.
34        * @param _globalAddress the address of the global virtualized token.
35        * @param _dstChainId the chain to which the token will be added.
36        * @param _gasParams Gas parameters for remote execution.
37:       */

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L27-L37)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

11   interface IERC20hTokenBranch {
12       /*///////////////////////////////////////////////////////////////
13                           ERC20 LOGIC
14       //////////////////////////////////////////////////////////////*/
15   
16       /**
17        * @notice Function to mint tokens in the Branch Chain.
18        * @param account Address of the account to receive the tokens.
19        * @param amount Amount of tokens to be minted.
20        * @return Boolean indicating if the operation was successful.
21:       */

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L11-L21)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

13   interface IERC20hTokenBranchFactory {
14       /*///////////////////////////////////////////////////////////////
15                               hTOKEN FUNCTIONS
16       //////////////////////////////////////////////////////////////*/
17       /**
18        * @notice Function to create a new Branch hToken.
19        * @param _name Name of the Token.
20        * @param _symbol Symbol of the Token.
21        * @param _decimals Decimals of the Token.
22        * @param _addPrefix Boolean to add or not the chain prefix to the token name and symbol.
23:       */

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L13-L23)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

12   interface IERC20hTokenRoot {
13       /*///////////////////////////////////////////////////////////////
14                           VIEW FUNCTIONS
15       //////////////////////////////////////////////////////////////*/
16   
17       /// @notice View Function returns Local Network Identifier.
18:      /// @return Local Network Identifier.

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L12-L18)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

13   interface IERC20hTokenRootFactory {
14       /*///////////////////////////////////////////////////////////////
15                               hTOKEN FUNCTIONS
16       //////////////////////////////////////////////////////////////*/
17   
18       /**
19        * @notice Function to create a new hToken.
20        * @param _name Name of the Token.
21        * @param _symbol Symbol of the Token.
22        * @param _decimals Decimals of the Token.
23:       */

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L13-L23)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

7    interface ILayerZeroEndpoint is ILayerZeroUserApplicationConfig {
8        // @notice send a LayerZero message to the specified address at a LayerZero endpoint.
9        // @param _dstChainId - the destination chain identifier
10       // @param _destination - the address on destination chain (in bytes). address length/format may vary by chains
11       // @param _payload - a custom bytes payload to send to the destination contract
12       // @param _refundAddress - if the source transaction is cheaper than the amount of value passed, refund the additional amount to this address
13       // @param _zroPaymentAddress - the address of the ZRO token holder who would pay for the transaction
14:      // @param _adapterParams - parameters for custom functionality. e.g. receive airdropped native gas from the relayer on destination

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L7-L14)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

5    interface ILayerZeroReceiver {
6        // @notice LayerZero endpoint will invoke this function to deliver the message on the destination
7        // @param _srcChainId - the source endpoint identifier
8        // @param _srcAddress - the source sending contract address from the source chain
9        // @param _nonce - the ordered message nonce
10:      // @param _payload - the signed payload is the UA bytes has encoded to be sent

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L5-L10)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

5    interface ILayerZeroUserApplicationConfig {
6        // @notice set the configuration of the LayerZero messaging library of the specified version
7        // @param _version - messaging library version
8        // @param _chainId - the chainId for the pending config change
9        // @param _configType - type of configuration. every messaging library has its own convention.
10:      // @param _config - configuration in the bytes. can encode arbitrary content.

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L5-L10)

```solidity
File: src/interfaces/IMulticall2.sol

9:   interface IMulticall2 {

```
*GitHub*: [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L9-L9)

```solidity
File: src/interfaces/IPortStrategy.sol

12   interface IPortStrategy {
13       /*///////////////////////////////////////////////////////////////
14                             TOKEN MANAGEMENT
15       //////////////////////////////////////////////////////////////*/
16   
17       /**
18        * @notice Function to withdraw underlying/native token amount back into Branch Port.
19        *   @param _recipient hToken receiver.
20        *   @param _token native token address.
21        *   @param _amount amount of tokens.
22:       */

```
*GitHub*: [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L12-L22)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

94   interface IRootBridgeAgent is ILayerZeroReceiver {
95       /*///////////////////////////////////////////////////////////////
96                               VIEW FUNCTIONS
97       //////////////////////////////////////////////////////////////*/
98   
99       /**
100       * @notice Function that returns the current settlement nonce.
101       *   @return nonce bridge agent's current settlement nonce
102       *
103:      */

```
*GitHub*: [94](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L94-L103)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

11   interface IRootBridgeAgentFactory {
12       /*///////////////////////////////////////////////////////////////
13                           BRIDGE AGENT FUNCTIONS
14       //////////////////////////////////////////////////////////////*/
15:  

```
*GitHub*: [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L11-L15)

```solidity
File: src/interfaces/IRootPort.sol

10:  interface ICoreRootRouter {

31   interface IRootPort {
32       /*///////////////////////////////////////////////////////////////
33                           VIEW FUNCTIONS
34       //////////////////////////////////////////////////////////////*/
35       /**
36        * @notice View Function returns True if the chain Id has been added to the system.
37        *  @param _chainId The Layer Zero chainId of the chain.
38        * @return bool True if the chain Id has been added to the system.
39:       */

```
*GitHub*: [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L10-L10), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L31-L39)

```solidity
File: src/interfaces/IRootRouter.sol

14   interface IRootRouter {
15       /*///////////////////////////////////////////////////////////////
16                           LAYERZERO FUNCTIONS
17       ///////////////////////////////////////////////////////////////*/
18   
19       /**
20        *     @notice Function to execute Branch Bridge Agent system initiated requests with no asset deposit.
21        *     @param params data received from messaging layer.
22        *     @param srcChainId chain where the request originated from.
23        *
24:       */

```
*GitHub*: [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L14-L24)

```solidity
File: src/interfaces/IVirtualAccount.sol

27   interface IVirtualAccount is IERC721Receiver {
28       /**
29        * @notice Returns the address of the user that owns the VirtualAccount.
30        * @return The address of the user that owns the VirtualAccount.
31:       */

```
*GitHub*: [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L27-L31)

</details>




### [D&#x2011;58] ~~Non-library/interface files should use fixed compiler versions, not floating ones~~
Interfaces should not use fixed compiler versions, since they may be used by projects using a different version

*There are 21 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/interfaces/BridgeAgentStructs.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L2-L2)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L3-L3)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L2-L2)

```solidity
File: src/interfaces/IBranchBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/IBranchPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L3-L3)

```solidity
File: src/interfaces/IBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L2-L2)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenBranch.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranch.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenRoot.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRoot.sol#L2-L2)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L2-L2)

```solidity
File: src/interfaces/ILayerZeroEndpoint.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroEndpoint.sol#L3-L3)

```solidity
File: src/interfaces/ILayerZeroReceiver.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroReceiver.sol#L3-L3)

```solidity
File: src/interfaces/ILayerZeroUserApplicationConfig.sol

3:   pragma solidity >=0.5.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ILayerZeroUserApplicationConfig.sol#L3-L3)

```solidity
File: src/interfaces/IMulticall2.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IMulticall2.sol#L2-L2)

```solidity
File: src/interfaces/IPortStrategy.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IPortStrategy.sol#L3-L3)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L2-L2)

```solidity
File: src/interfaces/IRootBridgeAgentFactory.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgentFactory.sol#L2-L2)

```solidity
File: src/interfaces/IRootPort.sol

3:   pragma solidity ^0.8.0;

```
*GitHub*: [3](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L3-L3)

```solidity
File: src/interfaces/IRootRouter.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L2-L2)

```solidity
File: src/interfaces/IVirtualAccount.sol

2:   pragma solidity ^0.8.0;

```
*GitHub*: [2](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L2-L2)

</details>




### [D&#x2011;59] ~~Using `calldata` instead of `memory` for read-only arguments in `external` functions saves gas~~
Not true for non-word-sized [types](https://gist.github.com/IllIllI000/2ac9a647be917f58ffe5baa2cecbbc42)

*There are 8 instances of this issue:*

```solidity
File: src/BranchPort.sol

/// @audit bridgeInMultiple(_localAddresses)
248:         address[] memory _localAddresses,

/// @audit bridgeInMultiple(_underlyingAddresses)
249:         address[] memory _underlyingAddresses,

/// @audit bridgeOutMultiple(_localAddresses)
290:         address[] memory _localAddresses,

/// @audit bridgeOutMultiple(_underlyingAddresses)
291:         address[] memory _underlyingAddresses,

```
*GitHub*: [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L248-L248), [249](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L249-L249), [290](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L290-L290), [291](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L291-L291)

```solidity
File: src/interfaces/IBranchPort.sol

/// @audit bridgeInMultiple(_localAddresses)
105:         address[] memory _localAddresses,

/// @audit bridgeInMultiple(_underlyingAddresses)
106:         address[] memory _underlyingAddresses,

/// @audit bridgeOutMultiple(_localAddresses)
137:         address[] memory _localAddresses,

/// @audit bridgeOutMultiple(_underlyingAddresses)
138:         address[] memory _underlyingAddresses,

```
*GitHub*: [105](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L105-L105), [106](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L106-L106), [137](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L137-L137), [138](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L138-L138)


### [D&#x2011;60] ~~Unusual loop variable~~
These instances all properly use 'i' as the outer for-loop loop variable

*There are 15 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/BaseBranchRouter.sol

192:         for (uint256 i = 0; i < _hTokens.length;) {

```
*GitHub*: [192](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L192-L192)

```solidity
File: src/BranchBridgeAgent.sol

447:         for (uint256 i = 0; i < deposit.tokens.length;) {

513:         for (uint256 i = 0; i < numOfAssets;) {

```
*GitHub*: [447](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L447-L447), [513](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L513-L513)

```solidity
File: src/BranchPort.sol

257:         for (uint256 i = 0; i < length;) {

305:         for (uint256 i = 0; i < length;) {

```
*GitHub*: [257](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L257-L257), [305](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L305-L305)

```solidity
File: src/MulticallRootRouter.sol

278:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

367:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

455:             for (uint256 i = 0; i < outputParams.outputTokens.length;) {

557:         for (uint256 i = 0; i < outputTokens.length;) {

```
*GitHub*: [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L278-L278), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L367-L367), [455](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L455-L455), [557](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L557-L557)

```solidity
File: src/RootBridgeAgent.sol

318:         for (uint256 i = 0; i < settlement.hTokens.length;) {

399:         for (uint256 i = 0; i < length;) {

1070:        for (uint256 i = 0; i < hTokens.length;) {

```
*GitHub*: [318](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L318-L318), [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L399-L399), [1070](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1070-L1070)

```solidity
File: src/RootBridgeAgentExecutor.sol

281:         for (uint256 i = 0; i < uint256(uint8(numOfAssets));) {

```
*GitHub*: [281](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L281-L281)

```solidity
File: src/VirtualAccount.sol

70:          for (uint256 i = 0; i < length;) {

90:          for (uint256 i = 0; i < length;) {

```
*GitHub*: [70](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L70-L70), [90](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L90-L90)

</details>




### [D&#x2011;61] ~~Missing contract-existence checks before low-level calls~~
The contract or caller exists, or it's a transfer of funds

*There are 3 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

95       /**
96        * @notice Internal function performs the call to LayerZero messaging layer Endpoint for cross-chain messaging.
97        *   @param _calldata params for root bridge agent execution.
98        */
99       function _performCall(address payable, bytes memory _calldata, GasParams calldata) internal override {
100          // Cache Root Bridge Agent Address
101          address _rootBridgeAgentAddress = rootBridgeAgentAddress;
102          // Send Gas to Root Bridge Agent
103          _rootBridgeAgentAddress.call{value: msg.value}("");
104          // Execute locally
105          IRootBridgeAgent(_rootBridgeAgentAddress).lzReceive(rootChainId, "", 0, _calldata);
106:     }

```
*GitHub*: [95](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L95-L106)

```solidity
File: src/RootBridgeAgent.sol

825                  getBranchBridgeAgentPath[_dstChainId],
826                  _payload,
827                  _refundee,
828                  address(0),
829                  abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)
830              );
831  
832              // Check if call to local chain
833          } else {
834              //Send Gas to Local Branch Bridge Agent
835              callee.call{value: msg.value}("");
836              //Execute locally
837              IBranchBridgeAgent(callee).lzReceive(0, "", 0, _payload);
838:         }

917                  getBranchBridgeAgentPath[_dstChainId],
918                  payload,
919                  payable(_refundee),
920                  address(0),
921                  abi.encodePacked(uint16(2), _gParams.gasLimit, _gParams.remoteBranchExecutionGas, callee)
922              );
923  
924              // Check if call to local chain
925          } else {
926              //Send Gas to Local Branch Bridge Agent
927              callee.call{value: _value}("");
928              //Execute locally
929              IBranchBridgeAgent(callee).lzReceive(0, "", 0, payload);
930:         }

```
*GitHub*: [825](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L825-L838), [917](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L917-L930)


### [D&#x2011;62] ~~Shorten the array rather than copying to a new one~~
None of these examples are of filtering out entries from an array.

*There are 14 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

507          address[] memory _hTokens = new address[](numOfAssets);
508          address[] memory _tokens = new address[](numOfAssets);
509          uint256[] memory _amounts = new uint256[](numOfAssets);
510:         uint256[] memory _deposits = new uint256[](numOfAssets);

508          address[] memory _tokens = new address[](numOfAssets);
509          uint256[] memory _amounts = new uint256[](numOfAssets);
510          uint256[] memory _deposits = new uint256[](numOfAssets);
511: 

509          uint256[] memory _amounts = new uint256[](numOfAssets);
510          uint256[] memory _deposits = new uint256[](numOfAssets);
511  
512:         // Transfer the token to the recipient

510          uint256[] memory _deposits = new uint256[](numOfAssets);
511  
512          // Transfer the token to the recipient
513:         for (uint256 i = 0; i < numOfAssets;) {

827          address[] memory addressArray = new address[](1);
828          uint256[] memory uintArray = new uint256[](1);
829  
830:         // Save deposit to storage

828          uint256[] memory uintArray = new uint256[](1);
829  
830          // Save deposit to storage
831:         Deposit storage deposit = getDeposit[_depositNonce];

```
*GitHub*: [507](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L507-L510), [508](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L508-L511), [509](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L509-L512), [510](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L510-L513), [827](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L827-L830), [828](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L828-L831)

```solidity
File: src/RootBridgeAgent.sol

1007         address[] memory addressArray = new address[](1);
1008         uint256[] memory uintArray = new uint256[](1);
1009 
1010:        // Get storage reference for new Settlement

1008         uint256[] memory uintArray = new uint256[](1);
1009 
1010         // Get storage reference for new Settlement
1011:        Settlement storage settlement = getSettlement[cachedSettlementNonce];

1067         address[] memory hTokens = new address[](_globalAddresses.length);
1068         address[] memory tokens = new address[](_globalAddresses.length);
1069 
1070:        for (uint256 i = 0; i < hTokens.length;) {

1068         address[] memory tokens = new address[](_globalAddresses.length);
1069 
1070         for (uint256 i = 0; i < hTokens.length;) {
1071:            // Populate Addresses for Settlement

```
*GitHub*: [1007](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1007-L1010), [1008](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1008-L1011), [1067](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1067-L1070), [1068](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1068-L1071)

```solidity
File: src/RootBridgeAgentExecutor.sol

276          address[] memory hTokens = new address[](numOfAssets);
277          address[] memory tokens = new address[](numOfAssets);
278          uint256[] memory amounts = new uint256[](numOfAssets);
279:         uint256[] memory deposits = new uint256[](numOfAssets);

277          address[] memory tokens = new address[](numOfAssets);
278          uint256[] memory amounts = new uint256[](numOfAssets);
279          uint256[] memory deposits = new uint256[](numOfAssets);
280: 

278          uint256[] memory amounts = new uint256[](numOfAssets);
279          uint256[] memory deposits = new uint256[](numOfAssets);
280  
281:         for (uint256 i = 0; i < uint256(uint8(numOfAssets));) {

279          uint256[] memory deposits = new uint256[](numOfAssets);
280  
281          for (uint256 i = 0; i < uint256(uint8(numOfAssets));) {
282:             // Cache offset

```
*GitHub*: [276](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L276-L279), [277](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L277-L280), [278](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L278-L281), [279](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L279-L282)


### [D&#x2011;63] ~~Avoid fetching a low-level call's return data by using assembly~~
The return data is in fact used, so assembly provides no gas savings

*There are 4 instances of this issue:*

```solidity
File: src/BranchBridgeAgent.sol

717:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

737:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

```
*GitHub*: [717](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L717-L717), [737](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L737-L737)

```solidity
File: src/RootBridgeAgent.sol

754:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

779:         (bool success,) = bridgeAgentExecutorAddress.call{value: address(this).balance}(_calldata);

```
*GitHub*: [754](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L754-L754), [779](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L779-L779)


### [D&#x2011;64] ~~Change `public` function visibility to `external` to save gas~~
Both `public` and `external` functions use the same amount of gas (both deployment and runtime gas), so this finding is invalid

*There are 2 instances of this issue:*

```solidity
File: src/RootBridgeAgent.sol

423:     function lzReceive(uint16 _srcChainId, bytes calldata _srcAddress, uint64, bytes calldata _payload) public {

```
*GitHub*: [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L423-L423)

```solidity
File: src/VirtualAccount.sol

85:      function payableCall(PayableCall[] calldata calls) public payable returns (bytes[] memory returnData) {

```
*GitHub*: [85](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L85-L85)


### [D&#x2011;65] ~~Use != 0 instead of > 0 for unsigned integer comparison~~
Only valid prior to Solidity version 0.8.13, and only for `require()` statements, and at least one of those is not true for the examples below

*There are 18 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchPort.sol

127:         if (_deposit > 0) {

132:         if (_amount - _deposit > 0) {

```
*GitHub*: [127](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L127-L127), [132](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L132-L132)

```solidity
File: src/BaseBranchRouter.sol

165:         if (_amount - _deposit > 0) {

173:         if (_deposit > 0) {

```
*GitHub*: [165](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L165-L165), [173](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L173-L173)

```solidity
File: src/BranchBridgeAgent.sol

906:         if (_amount - _deposit > 0) {

912:         if (_deposit > 0) {

```
*GitHub*: [906](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L906-L906), [912](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L912-L912)

```solidity
File: src/BranchPort.sol

259:             if (_amounts[i] - _deposits[i] > 0) {

266:             if (_deposits[i] > 0) {

525:         if (_hTokenAmount > 0) {

531:         if (_deposit > 0) {

```
*GitHub*: [259](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L259-L259), [266](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L266-L266), [525](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L525-L525), [531](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L531-L531)

```solidity
File: src/RootBridgeAgent.sol

363:         if (_dParams.amount > 0) {

370:         if (_dParams.deposit > 0) {

1146:        if (_underlyingAddress == address(0)) if (_deposit > 0) revert UnrecognizedUnderlyingAddress();

1149:        if (_amount - _deposit > 0) {

1156:        if (_deposit > 0) {

```
*GitHub*: [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L363-L363), [370](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L370-L370), [1146](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1146-L1146), [1149](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1149-L1149), [1156](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L1156-L1156)

```solidity
File: src/RootPort.sol

284:         if (_amount - _deposit > 0) {

290:         if (_deposit > 0) if (!ERC20hTokenRoot(_hToken).mint(_recipient, _deposit, _srcChainId)) revert UnableToMint();

```
*GitHub*: [284](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L284-L284), [290](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L290-L290)

```solidity
File: src/VirtualAccount.sol

152:         return size > 0;

```
*GitHub*: [152](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L152-L152)

</details>




### [D&#x2011;66] ~~Unused function parameter~~
The variable is in fact used, so the instances below are invalid

*There is one instance of this issue:*

```solidity
File: src/VirtualAccount.sol

/// @audit addr
147:     function isContract(address addr) internal view returns (bool) {

```
*GitHub*: [147](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L147-L147)


### [D&#x2011;67] ~~State variables not capped at reasonable values~~
These assignments already have the necessary checks

*There are 2 instances of this issue:*

```solidity
File: src/BranchPort.sol

157:         getPortStrategyTokenDebt[msg.sender][_token] += _amount;

368:         getMinimumTokenReserveRatio[_token] = _minimumReservesRatio;

```
*GitHub*: [157](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L157-L157), [368](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L368-L368)


### [D&#x2011;68] ~~Unused import~~
These instances _are_ used

*There are 187 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/ArbitrumBranchBridgeAgent.sol

/// @audit IArbitrumBranchPort
4:   import {IArbitrumBranchPort as IArbPort} from "./interfaces/IArbitrumBranchPort.sol";

/// @audit IRootBridgeAgent
5:   import {IRootBridgeAgent} from "./interfaces/IRootBridgeAgent.sol";

/// @audit GasParams
/// @audit IBranchBridgeAgent
6:   import {GasParams, IBranchBridgeAgent} from "./interfaces/IBranchBridgeAgent.sol";

/// @audit BranchBridgeAgent
8:   import {BranchBridgeAgent} from "./BranchBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L5-L5), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L6-L6), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L8-L8)

```solidity
File: src/ArbitrumBranchPort.sol

/// @audit SafeTransferLib
5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit IArbitrumBranchPort
7:   import {IArbitrumBranchPort} from "./interfaces/IArbitrumBranchPort.sol";

/// @audit IRootPort
8:   import {IRootPort} from "./interfaces/IRootPort.sol";

/// @audit BranchPort
10:  import {BranchPort} from "./BranchPort.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L10-L10)

```solidity
File: src/ArbitrumCoreBranchRouter.sol

/// @audit ERC20
4:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IBranchBridgeAgent
/// @audit GasParams
6:   import {IBranchBridgeAgent as IBridgeAgent, GasParams} from "./interfaces/IBranchBridgeAgent.sol";

/// @audit IBranchBridgeAgentFactory
7:   import {IBranchBridgeAgentFactory as IBridgeAgentFactory} from "./interfaces/IBranchBridgeAgentFactory.sol";

/// @audit IArbitrumBranchPort
8:   import {IArbitrumBranchPort as IPort} from "./interfaces/IArbitrumBranchPort.sol";

/// @audit CoreBranchRouter
10:  import {CoreBranchRouter} from "./CoreBranchRouter.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L6-L6), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L6-L6), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumCoreBranchRouter.sol#L10-L10)

```solidity
File: src/BaseBranchRouter.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit SafeTransferLib
5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit ERC20
7:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IBranchRouter
9:   import {IBranchRouter} from "./interfaces/IBranchRouter.sol";

/// @audit IBranchBridgeAgent
12:      IBranchBridgeAgent as IBridgeAgent,

/// @audit GasParams
13:      GasParams,

/// @audit Deposit
14:      Deposit,

/// @audit DepositInput
15:      DepositInput,

/// @audit DepositParams
16:      DepositParams,

/// @audit DepositMultipleInput
17:      DepositMultipleInput,

/// @audit DepositMultipleParams
18:      DepositMultipleParams,

/// @audit SettlementParams
19:      SettlementParams,

/// @audit SettlementMultipleParams
20:      SettlementMultipleParams

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L7-L7), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L9-L9), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L13-L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L14-L14), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L15-L15), [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L16-L16), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L17-L17), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L18-L18), [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L19-L19), [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BaseBranchRouter.sol#L20-L20)

```solidity
File: src/BranchBridgeAgent.sol

/// @audit ExcessivelySafeCall
4:   import {ExcessivelySafeCall} from "lib/ExcessivelySafeCall.sol";

/// @audit IBranchPort
6:   import {IBranchPort as IPort} from "./interfaces/IBranchPort.sol";

/// @audit BridgeAgentConstants
8:   import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

/// @audit Deposit
10:      Deposit,

/// @audit DepositInput
11:      DepositInput,

/// @audit DepositMultipleInput
12:      DepositMultipleInput,

/// @audit GasParams
13:      GasParams,

/// @audit IBranchBridgeAgent
14:      IBranchBridgeAgent,

/// @audit ILayerZeroReceiver
15:      ILayerZeroReceiver,

/// @audit SettlementMultipleParams
16:      SettlementMultipleParams

/// @audit ILayerZeroEndpoint
18:  import {ILayerZeroEndpoint} from "./interfaces/ILayerZeroEndpoint.sol";

/// @audit BranchBridgeAgentExecutor
/// @audit DeployBranchBridgeAgentExecutor
20:  import {BranchBridgeAgentExecutor, DeployBranchBridgeAgentExecutor} from "./BranchBridgeAgentExecutor.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L13-L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L14-L14), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L15-L15), [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L16-L16), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L18-L18), [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L20-L20), [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgent.sol#L20-L20)

```solidity
File: src/BranchBridgeAgentExecutor.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit SafeTransferLib
6:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit IBranchRouter
8:   import {IBranchRouter as IRouter} from "./interfaces/IBranchRouter.sol";

/// @audit BranchBridgeAgent
10:  import {BranchBridgeAgent} from "./BranchBridgeAgent.sol";

/// @audit BridgeAgentConstants
11:  import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

/// @audit SettlementParams
/// @audit SettlementMultipleParams
12:  import {SettlementParams, SettlementMultipleParams} from "./interfaces/IBranchBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L12-L12), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchBridgeAgentExecutor.sol#L12-L12)

```solidity
File: src/BranchPort.sol

/// @audit Ownable
5:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit SafeTransferLib
6:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit ERC20
8:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IPortStrategy
10:  import {IPortStrategy} from "./interfaces/IPortStrategy.sol";

/// @audit IBranchPort
11:  import {IBranchPort} from "./interfaces/IBranchPort.sol";

/// @audit ERC20hTokenBranch
13:  import {ERC20hTokenBranch} from "./token/ERC20hTokenBranch.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L5-L5), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L11-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L13-L13)

```solidity
File: src/CoreBranchRouter.sol

/// @audit ERC20
4:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IBranchPort
6:   import {IBranchPort as IPort} from "./interfaces/IBranchPort.sol";

/// @audit IBranchBridgeAgent
/// @audit GasParams
7:   import {IBranchBridgeAgent as IBridgeAgent, GasParams} from "./interfaces/IBranchBridgeAgent.sol";

/// @audit IBranchBridgeAgentFactory
8:   import {IBranchBridgeAgentFactory as IBridgeAgentFactory} from "./interfaces/IBranchBridgeAgentFactory.sol";

/// @audit IBranchRouter
9:   import {IBranchRouter} from "./interfaces/IBranchRouter.sol";

/// @audit ICoreBranchRouter
10:  import {ICoreBranchRouter} from "./interfaces/ICoreBranchRouter.sol";

/// @audit IERC20hTokenBranchFactory
11:  import {IERC20hTokenBranchFactory as ITokenFactory} from "./interfaces/IERC20hTokenBranchFactory.sol";

/// @audit BaseBranchRouter
13:  import {BaseBranchRouter} from "./BaseBranchRouter.sol";

/// @audit ERC20hTokenBranch
14:  import {ERC20hTokenBranch as ERC20hToken} from "./token/ERC20hTokenBranch.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L6-L6), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L7-L7), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L11-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L13-L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreBranchRouter.sol#L14-L14)

```solidity
File: src/CoreRootRouter.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit ERC20
6:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IERC20hTokenRootFactory
8:   import {IERC20hTokenRootFactory as IFactory} from "./interfaces/IERC20hTokenRootFactory.sol";

/// @audit IRootRouter
9:   import {IRootRouter} from "./interfaces/IRootRouter.sol";

/// @audit DepositParams
11:      DepositParams,

/// @audit DepositMultipleParams
12:      DepositMultipleParams,

/// @audit GasParams
13:      GasParams,

/// @audit IRootBridgeAgent
14:      IRootBridgeAgent as IBridgeAgent

/// @audit IRootPort
16:  import {IRootPort as IPort} from "./interfaces/IRootPort.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L9-L9), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L13-L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L14-L14), [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/CoreRootRouter.sol#L16-L16)

```solidity
File: src/MulticallRootRouter.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit SafeTransferLib
5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit IMulticall2
7:   import {IMulticall2 as IMulticall} from "./interfaces/IMulticall2.sol";

/// @audit GasParams
9:       GasParams,

/// @audit IRootBridgeAgent
10:      IRootBridgeAgent as IBridgeAgent,

/// @audit SettlementInput
11:      SettlementInput,

/// @audit SettlementMultipleInput
12:      SettlementMultipleInput

/// @audit IRootRouter
/// @audit DepositParams
/// @audit DepositMultipleParams
14:  import {IRootRouter, DepositParams, DepositMultipleParams} from "./interfaces/IRootRouter.sol";

/// @audit IVirtualAccount
/// @audit Call
15:  import {IVirtualAccount, Call} from "./interfaces/IVirtualAccount.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L7-L7), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L12-L12), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L14-L14), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L14-L14), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L14-L14), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L15-L15), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L15-L15)

```solidity
File: src/MulticallRootRouterLibZip.sol

/// @audit LibZip
4:   import {LibZip} from "solady/utils/LibZip.sol";

/// @audit MulticallRootRouter
6:   import {MulticallRootRouter} from "./MulticallRootRouter.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L6-L6)

```solidity
File: src/RootBridgeAgent.sol

/// @audit SafeTransferLib
4:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit ExcessivelySafeCall
6:   import {ExcessivelySafeCall} from "lib/ExcessivelySafeCall.sol";

/// @audit ILayerZeroEndpoint
8:   import {ILayerZeroEndpoint} from "./interfaces/ILayerZeroEndpoint.sol";

/// @audit IBranchBridgeAgent
10:  import {IBranchBridgeAgent} from "./interfaces/IBranchBridgeAgent.sol";

/// @audit IERC20hTokenRoot
11:  import {IERC20hTokenRoot} from "./interfaces/IERC20hTokenRoot.sol";

/// @audit BridgeAgentConstants
13:  import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

/// @audit GasParams
15:      GasParams,

/// @audit DepositParams
16:      DepositParams,

/// @audit DepositMultipleParams
17:      DepositMultipleParams,

/// @audit ILayerZeroReceiver
18:      ILayerZeroReceiver,

/// @audit IRootBridgeAgent
19:      IRootBridgeAgent,

/// @audit Settlement
20:      Settlement,

/// @audit SettlementInput
21:      SettlementInput,

/// @audit SettlementMultipleInput
22:      SettlementMultipleInput

/// @audit IRootPort
25:  import {IRootPort as IPort} from "./interfaces/IRootPort.sol";

/// @audit VirtualAccount
27:  import {VirtualAccount} from "./VirtualAccount.sol";

/// @audit DeployRootBridgeAgentExecutor
/// @audit RootBridgeAgentExecutor
28:  import {DeployRootBridgeAgentExecutor, RootBridgeAgentExecutor} from "./RootBridgeAgentExecutor.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L8-L8), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L11-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L13-L13), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L15-L15), [16](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L16-L16), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L17-L17), [18](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L18-L18), [19](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L19-L19), [20](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L20-L20), [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L21-L21), [22](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L22-L22), [25](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L25-L25), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L27-L27), [28](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L28-L28), [28](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgent.sol#L28-L28)

```solidity
File: src/RootBridgeAgentExecutor.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit IRootRouter
/// @audit DepositParams
/// @audit DepositMultipleParams
6:   import {IRootRouter as IRouter, DepositParams, DepositMultipleParams} from "./interfaces/IRootRouter.sol";

/// @audit IRootBridgeAgent
7:   import {IRootBridgeAgent} from "./interfaces/IRootBridgeAgent.sol";

/// @audit BridgeAgentConstants
9:   import {BridgeAgentConstants} from "./interfaces/BridgeAgentConstants.sol";

/// @audit RootBridgeAgent
10:  import {RootBridgeAgent} from "./RootBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L6-L6), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L6-L6), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L6-L6), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L7-L7), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootBridgeAgentExecutor.sol#L10-L10)

```solidity
File: src/RootPort.sol

/// @audit Ownable
5:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit SafeTransferLib
6:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit IERC20hTokenRootFactory
8:   import {IERC20hTokenRootFactory} from "./interfaces/IERC20hTokenRootFactory.sol";

/// @audit IRootBridgeAgent
9:   import {IRootBridgeAgent as IBridgeAgent} from "./interfaces/IRootBridgeAgent.sol";

/// @audit IRootPort
/// @audit ICoreRootRouter
/// @audit GasParams
/// @audit VirtualAccount
10:  import {IRootPort, ICoreRootRouter, GasParams, VirtualAccount} from "./interfaces/IRootPort.sol";

/// @audit ERC20hTokenRoot
12:  import {ERC20hTokenRoot} from "./token/ERC20hTokenRoot.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L5-L5), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L10-L10), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L10-L10), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L10-L10), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L10-L10), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L12-L12)

```solidity
File: src/VirtualAccount.sol

/// @audit SafeTransferLib
5:   import {SafeTransferLib} from "solady/utils/SafeTransferLib.sol";

/// @audit ERC721
7:   import {ERC721} from "solmate/tokens/ERC721.sol";

/// @audit ERC1155Receiver
9:   import {ERC1155Receiver} from "@openzeppelin/contracts/token/ERC1155/utils/ERC1155Receiver.sol";

/// @audit IERC1155Receiver
10:  import {IERC1155Receiver} from "@openzeppelin/contracts/token/ERC1155/IERC1155Receiver.sol";

/// @audit IERC721Receiver
11:  import {IERC721Receiver} from "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";

/// @audit IVirtualAccount
/// @audit Call
/// @audit PayableCall
13:  import {IVirtualAccount, Call, PayableCall} from "./interfaces/IVirtualAccount.sol";

/// @audit IRootPort
14:  import {IRootPort} from "./interfaces/IRootPort.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L7-L7), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L11-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L13-L13), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L13-L13), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L13-L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/VirtualAccount.sol#L14-L14)

```solidity
File: src/factories/ArbitrumBranchBridgeAgentFactory.sol

/// @audit IArbitrumBranchPort
4:   import {IArbitrumBranchPort as IPort} from "../interfaces/IArbitrumBranchPort.sol";

/// @audit ArbitrumBranchBridgeAgent
/// @audit DeployArbitrumBranchBridgeAgent
6:   import {ArbitrumBranchBridgeAgent, DeployArbitrumBranchBridgeAgent} from "../ArbitrumBranchBridgeAgent.sol";

/// @audit BranchBridgeAgentFactory
7:   import {BranchBridgeAgentFactory} from "./BranchBridgeAgentFactory.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L6-L6), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L6-L6), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ArbitrumBranchBridgeAgentFactory.sol#L7-L7)

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit DeployBranchBridgeAgent
6:   import {DeployBranchBridgeAgent} from "../BranchBridgeAgent.sol";

/// @audit IBranchPort
8:   import {IBranchPort as IPort} from "../interfaces/IBranchPort.sol";

/// @audit IBranchBridgeAgentFactory
9:   import {IBranchBridgeAgentFactory} from "../interfaces/IBranchBridgeAgentFactory.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L9-L9)

```solidity
File: src/factories/ERC20hTokenBranchFactory.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit ERC20
6:   import {ERC20} from "../token/ERC20hTokenBranch.sol";

/// @audit IERC20hTokenBranchFactory
/// @audit ERC20hTokenBranch
8:   import {IERC20hTokenBranchFactory, ERC20hTokenBranch} from "../interfaces/IERC20hTokenBranchFactory.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L8-L8), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenBranchFactory.sol#L8-L8)

```solidity
File: src/factories/ERC20hTokenRootFactory.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit ERC20
6:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IERC20hTokenRootFactory
/// @audit ERC20hTokenRoot
8:   import {IERC20hTokenRootFactory, ERC20hTokenRoot} from "../interfaces/IERC20hTokenRootFactory.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L8-L8), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/ERC20hTokenRootFactory.sol#L8-L8)

```solidity
File: src/factories/RootBridgeAgentFactory.sol

/// @audit IRootBridgeAgentFactory
4:   import {IRootBridgeAgentFactory} from "../interfaces/IRootBridgeAgentFactory.sol";

/// @audit IRootPort
5:   import {IRootPort} from "../interfaces/IRootPort.sol";

/// @audit RootBridgeAgent
7:   import {RootBridgeAgent} from "../RootBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L4-L4), [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/RootBridgeAgentFactory.sol#L7-L7)

```solidity
File: src/interfaces/IArbitrumBranchPort.sol

/// @audit IBranchPort
5:   import {IBranchPort} from "./IBranchPort.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L5-L5)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

/// @audit ILayerZeroReceiver
4:   import {ILayerZeroReceiver} from "./ILayerZeroReceiver.sol";

/// @audit GasParams
7:       GasParams,

/// @audit Deposit
8:       Deposit,

/// @audit DepositInput
9:       DepositInput,

/// @audit DepositMultipleInput
10:      DepositMultipleInput,

/// @audit DepositParams
11:      DepositParams,

/// @audit DepositMultipleParams
12:      DepositMultipleParams,

/// @audit SettlementParams
13:      SettlementParams,

/// @audit SettlementMultipleParams
14:      SettlementMultipleParams

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L4-L4), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L13-L13), [14](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L14-L14)

```solidity
File: src/interfaces/IBranchRouter.sol

/// @audit GasParams
5:       GasParams,

/// @audit Deposit
6:       Deposit,

/// @audit DepositInput
7:       DepositInput,

/// @audit DepositMultipleInput
8:       DepositMultipleInput,

/// @audit SettlementParams
9:       SettlementParams,

/// @audit SettlementMultipleParams
10:      SettlementMultipleParams

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L5-L5), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L6-L6), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L10-L10)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

/// @audit GasParams
4:   import {GasParams} from "./IBranchBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L4-L4)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

/// @audit ERC20hTokenBranch
4:   import {ERC20hTokenBranch} from "../token/ERC20hTokenBranch.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L4-L4)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

/// @audit ERC20hTokenRoot
4:   import {ERC20hTokenRoot} from "../token/ERC20hTokenRoot.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L4-L4)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

/// @audit ILayerZeroReceiver
4:   import {ILayerZeroReceiver} from "./ILayerZeroReceiver.sol";

/// @audit GasParams
7:       GasParams,

/// @audit DepositParams
8:       DepositParams,

/// @audit DepositMultipleParams
9:       DepositMultipleParams,

/// @audit Settlement
10:      Settlement,

/// @audit SettlementInput
11:      SettlementInput,

/// @audit SettlementMultipleInput
12:      SettlementMultipleInput,

/// @audit SettlementParams
13:      SettlementParams

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L4-L4), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L7-L7), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L8-L8), [9](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L9-L9), [10](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L10-L10), [11](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L11-L11), [12](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L12-L12), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L13-L13)

```solidity
File: src/interfaces/IRootPort.sol

/// @audit GasParams
5:   import {GasParams} from "../interfaces/IRootBridgeAgent.sol";

/// @audit VirtualAccount
7:   import {VirtualAccount} from "../VirtualAccount.sol";

```
*GitHub*: [5](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L5-L5), [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L7-L7)

```solidity
File: src/interfaces/IRootRouter.sol

/// @audit DepositParams
/// @audit DepositMultipleParams
4:   import {DepositParams, DepositMultipleParams} from "../interfaces/IRootBridgeAgent.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L4-L4), [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L4-L4)

```solidity
File: src/interfaces/IVirtualAccount.sol

/// @audit IERC721Receiver
4:   import {IERC721Receiver} from "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L4-L4)

```solidity
File: src/token/ERC20hTokenBranch.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit ERC20
6:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IERC20hTokenBranch
8:   import {IERC20hTokenBranch} from "../interfaces/IERC20hTokenBranch.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenBranch.sol#L8-L8)

```solidity
File: src/token/ERC20hTokenRoot.sol

/// @audit Ownable
4:   import {Ownable} from "solady/auth/Ownable.sol";

/// @audit ERC20
6:   import {ERC20} from "solmate/tokens/ERC20.sol";

/// @audit IERC20hTokenRoot
8:   import {IERC20hTokenRoot} from "../interfaces/IERC20hTokenRoot.sol";

```
*GitHub*: [4](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L4-L4), [6](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L6-L6), [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/token/ERC20hTokenRoot.sol#L8-L8)

</details>




### [D&#x2011;69] ~~safeMint should be used in place of mint~~
These are not ERC721.mint() calls

*There are 3 instances of this issue:*

```solidity
File: src/BranchPort.sol

503:         ERC20hTokenBranch(_localAddress).mint(_recipient, _amount);

```
*GitHub*: [503](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/BranchPort.sol#L503-L503)

```solidity
File: src/RootPort.sol

290:         if (_deposit > 0) if (!ERC20hTokenRoot(_hToken).mint(_recipient, _deposit, _srcChainId)) revert UnableToMint();

342:         if (!ERC20hTokenRoot(_hToken).mint(_to, _amount, localChainId)) revert UnableToMint();

```
*GitHub*: [290](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L290-L290), [342](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/RootPort.sol#L342-L342)


### [D&#x2011;70] ~~Unused `event` definition~~
These events are referenced by contracts other than the one that defined it

*There are 28 instances of this issue:*

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

332:     event LogExecute(uint256 indexed nonce);

333:     event LogFallback(uint256 indexed nonce);

```
*GitHub*: [332](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L332-L332), [333](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L333-L333)

```solidity
File: src/interfaces/IBranchPort.sol

220:     event DebtCreated(address indexed _strategy, address indexed _token, uint256 _amount);

221:     event DebtRepaid(address indexed _strategy, address indexed _token, uint256 _amount);

223:     event StrategyTokenAdded(address indexed _token, uint256 indexed _minimumReservesRatio);

224:     event StrategyTokenToggled(address indexed _token);

226      event PortStrategyAdded(
227          address indexed _portStrategy, address indexed _token, uint256 indexed _dailyManagementLimit
228:     );

229:     event PortStrategyToggled(address indexed _portStrategy, address indexed _token);

230      event PortStrategyUpdated(
231          address indexed _portStrategy, address indexed _token, uint256 indexed _dailyManagementLimit
232:     );

234:     event BridgeAgentFactoryAdded(address indexed _bridgeAgentFactory);

235:     event BridgeAgentFactoryToggled(address indexed _bridgeAgentFactory);

237:     event BridgeAgentToggled(address indexed _bridgeAgent);

239:     event CoreBranchSet(address indexed _coreBranchRouter, address indexed _coreBranchBridgeAgent);

```
*GitHub*: [220](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L220-L220), [221](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L221-L221), [223](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L223-L223), [224](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L224-L224), [226](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L226-L228), [229](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L229-L229), [230](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L230-L232), [234](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L234-L234), [235](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L235-L235), [237](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L237-L237), [239](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L239-L239)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

337:     event LogExecute(uint256 indexed depositNonce, uint256 indexed srcChainId);

338:     event LogFallback(uint256 indexed settlementNonce, uint256 indexed dstChainId);

```
*GitHub*: [337](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L337-L337), [338](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L338-L338)

```solidity
File: src/interfaces/IRootPort.sol

371:     event BridgeAgentFactoryAdded(address indexed bridgeAgentFactory);

372:     event BridgeAgentFactoryToggled(address indexed bridgeAgentFactory);

374:     event BridgeAgentAdded(address indexed bridgeAgent, address indexed manager);

375:     event BridgeAgentToggled(address indexed bridgeAgent);

376:     event BridgeAgentSynced(address indexed bridgeAgent, address indexed rootBridgeAgent, uint256 indexed srcChainId);

378:     event NewChainAdded(uint256 indexed chainId);

380:     event VirtualAccountCreated(address indexed user, address account);

382      event LocalTokenAdded(
383          address indexed underlyingAddress, address indexed localAddress, address indexed globalAddress, uint256 chainId
384:     );

385:     event GlobalTokenAdded(address indexed localAddress, address indexed globalAddress, uint256 indexed chainId);

386:     event EcosystemTokenAdded(address indexed ecoTokenGlobalAddress);

387:     event CoreRootSet(address indexed coreRootRouter, address indexed coreRootBridgeAgent);

388      event CoreBranchSet(
389          address indexed coreBranchRouter, address indexed coreBranchBridgeAgent, uint16 indexed dstChainId
390:     );

391      event CoreBranchSynced(
392          address indexed coreBranchRouter, address indexed coreBranchBridgeAgent, uint16 indexed dstChainId
393:     );

```
*GitHub*: [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L371-L371), [372](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L372-L372), [374](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L374-L374), [375](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L375-L375), [376](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L376-L376), [378](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L378-L378), [380](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L380-L380), [382](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L382-L384), [385](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L385-L385), [386](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L386-L386), [387](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L387-L387), [388](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L388-L390), [391](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L391-L393)


### [D&#x2011;71] ~~Unused `error` definition~~
The error is used in a file that is different from the one in which it is defined

*There are 73 instances of this issue:*

<details>
<summary>see instances</summary>


```solidity
File: src/interfaces/IArbitrumBranchPort.sol

45:      error UnknownGlobalToken();

46:      error UnknownUnderlyingToken();

```
*GitHub*: [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L45-L45), [46](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IArbitrumBranchPort.sol#L46-L46)

```solidity
File: src/interfaces/IBranchBridgeAgent.sol

339:     error UnknownFlag();

340:     error ExecutionFailure();

342:     error LayerZeroUnauthorizedCaller();

343:     error LayerZeroUnauthorizedEndpoint();

345:     error AlreadyExecutedTransaction();

347:     error InvalidInput();

350:     error NotDepositOwner();

351:     error DepositRetryUnavailableUseCallout();

352:     error DepositRedeemUnavailable();

354:     error UnrecognizedRouter();

355:     error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [339](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L339-L339), [340](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L340-L340), [342](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L342-L342), [343](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L343-L343), [345](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L345-L345), [347](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L347-L347), [350](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L350-L350), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L351-L351), [352](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L352-L352), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L354-L354), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchBridgeAgent.sol#L355-L355)

```solidity
File: src/interfaces/IBranchPort.sol

245:     error AlreadyAddedBridgeAgent();

246:     error AlreadyAddedBridgeAgentFactory();

247:     error InvalidMinimumReservesRatio();

248:     error InvalidInputArrays();

249:     error InsufficientReserves();

250:     error UnrecognizedCore();

251:     error UnrecognizedBridgeAgent();

252:     error UnrecognizedBridgeAgentFactory();

253:     error UnrecognizedPortStrategy();

254:     error UnrecognizedStrategyToken();

```
*GitHub*: [245](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L245-L245), [246](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L246-L246), [247](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L247-L247), [248](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L248-L248), [249](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L249-L249), [250](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L250-L250), [251](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L251-L251), [252](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L252-L252), [253](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L253-L253), [254](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchPort.sol#L254-L254)

```solidity
File: src/interfaces/IBranchRouter.sol

113:     error UnrecognizedFunctionId();

115:     error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [113](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L113-L113), [115](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IBranchRouter.sol#L115-L115)

```solidity
File: src/interfaces/ICoreBranchRouter.sol

53:      error UnrecognizedBridgeAgent();

54:      error UnrecognizedBridgeAgentFactory();

```
*GitHub*: [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L53-L53), [54](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/ICoreBranchRouter.sol#L54-L54)

```solidity
File: src/interfaces/IERC20hTokenBranchFactory.sol

32:      error UnrecognizedCoreRouter();

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenBranchFactory.sol#L32-L32)

```solidity
File: src/interfaces/IERC20hTokenRootFactory.sol

32:      error UnrecognizedCoreRouterOrPort();

```
*GitHub*: [32](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IERC20hTokenRootFactory.sol#L32-L32)

```solidity
File: src/interfaces/IRootBridgeAgent.sol

344:     error ExecutionFailure();

346:     error AlreadyExecutedTransaction();

347:     error UnknownFlag();

351:     error LayerZeroUnauthorizedEndpoint();

352:     error LayerZeroUnauthorizedCaller();

354:     error AlreadyAddedBridgeAgent();

355:     error UnrecognizedExecutor();

356:     error UnrecognizedPort();

357:     error UnrecognizedBridgeAgent();

359:     error UnrecognizedBridgeAgentManager();

360:     error UnrecognizedRouter();

362:     error UnrecognizedUnderlyingAddress();

363:     error UnrecognizedLocalAddress();

365:     error SettlementRetryUnavailable();

366:     error SettlementRetryUnavailableUseCallout();

367:     error SettlementRedeemUnavailable();

368:     error SettlementRetrieveUnavailable();

369:     error NotSettlementOwner();

371:     error InsufficientBalanceForSettlement();

373:     error InvalidInputParams();

374:     error InvalidInputParamsLength();

```
*GitHub*: [344](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L344-L344), [346](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L346-L346), [347](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L347-L347), [351](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L351-L351), [352](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L352-L352), [354](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L354-L354), [355](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L355-L355), [356](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L356-L356), [357](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L357-L357), [359](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L359-L359), [360](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L360-L360), [362](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L362-L362), [363](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L363-L363), [365](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L365-L365), [366](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L366-L366), [367](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L367-L367), [368](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L368-L368), [369](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L369-L369), [371](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L371-L371), [373](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L373-L373), [374](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootBridgeAgent.sol#L374-L374)

```solidity
File: src/interfaces/IRootPort.sol

399:     error InvalidGlobalAddress();

400:     error InvalidLocalAddress();

401:     error InvalidUnderlyingAddress();

403:     error InvalidUserAddress();

405:     error InvalidCoreRootRouter();

406:     error InvalidCoreRootBridgeAgent();

407:     error InvalidCoreBranchRouter();

408:     error InvalidCoreBrancBridgeAgent();

410:     error UnrecognizedBridgeAgentFactory();

411:     error UnrecognizedBridgeAgent();

413:     error UnrecognizedToken();

414:     error UnableToMint();

416:     error AlreadyAddedChain();

417:     error AlreadyAddedEcosystemToken();

419:     error AlreadyAddedBridgeAgent();

420:     error AlreadyAddedBridgeAgentFactory();

421:     error BridgeAgentNotAllowed();

422:     error UnrecognizedCoreRootRouter();

423:     error UnrecognizedLocalBranchPort();

```
*GitHub*: [399](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L399-L399), [400](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L400-L400), [401](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L401-L401), [403](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L403-L403), [405](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L405-L405), [406](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L406-L406), [407](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L407-L407), [408](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L408-L408), [410](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L410-L410), [411](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L411-L411), [413](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L413-L413), [414](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L414-L414), [416](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L416-L416), [417](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L417-L417), [419](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L419-L419), [420](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L420-L420), [421](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L421-L421), [422](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L422-L422), [423](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootPort.sol#L423-L423)

```solidity
File: src/interfaces/IRootRouter.sol

97:      error UnrecognizedFunctionId();

98:      error UnrecognizedBridgeAgentExecutor();

```
*GitHub*: [97](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L97-L97), [98](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IRootRouter.sol#L98-L98)

```solidity
File: src/interfaces/IVirtualAccount.sol

79:      error CallFailed();

81:      error UnauthorizedCaller();

```
*GitHub*: [79](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L79-L79), [81](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L81-L81)

</details>




### [D&#x2011;72] ~~Unused `struct` definition~~
These structs are used outside of the defining contract

*There are 15 instances of this issue:*

```solidity
File: src/MulticallRootRouter.sol

17   struct OutputParams {
18       // Address to receive the output assets.
19       address recipient;
20       // Address of the output hToken.
21       address outputToken;
22       // Amount of output hTokens to send.
23       uint256 amountOut;
24       // Amount of output underlying token to send.
25       uint256 depositOut;
26:  }

28   struct OutputMultipleParams {
29       // Address to receive the output assets.
30       address recipient;
31       // Addresses of the output hTokens.
32       address[] outputTokens;
33       // Amounts of output hTokens to send.
34       uint256[] amountsOut;
35       // Amounts of output underlying tokens to send.
36       uint256[] depositsOut;
37:  }

```
*GitHub*: [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L17-L26), [28](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouter.sol#L28-L37)

```solidity
File: src/interfaces/BridgeAgentStructs.sol

8    struct GasParams {
9        uint256 gasLimit; // gas allocated for the cross-chain call.
10       uint256 remoteBranchExecutionGas; //gas allocated for remote branch execution. Must be lower than `gasLimit`.
11:  }

13   struct Deposit {
14       uint8 status;
15       address owner;
16       address[] hTokens;
17       address[] tokens;
18       uint256[] amounts;
19       uint256[] deposits;
20:  }

22   struct DepositInput {
23       //Deposit Info
24       address hToken; //Input Local hTokens Address.
25       address token; //Input Native / underlying Token Address.
26       uint256 amount; //Amount of Local hTokens deposited for interaction.
27       uint256 deposit; //Amount of native tokens deposited for interaction.
28:  }

30   struct DepositMultipleInput {
31       //Deposit Info
32       address[] hTokens; //Input Local hTokens Address.
33       address[] tokens; //Input Native / underlying Token Address.
34       uint256[] amounts; //Amount of Local hTokens deposited for interaction.
35       uint256[] deposits; //Amount of native tokens deposited for interaction.
36:  }

38   struct DepositMultipleParams {
39       //Deposit Info
40       uint8 numberOfAssets; //Number of assets to deposit.
41       uint32 depositNonce; //Deposit nonce.
42       address[] hTokens; //Input Local hTokens Address.
43       address[] tokens; //Input Native / underlying Token Address.
44       uint256[] amounts; //Amount of Local hTokens deposited for interaction.
45       uint256[] deposits; //Amount of native tokens deposited for interaction.
46:  }

48   struct DepositParams {
49       //Deposit Info
50       uint32 depositNonce; //Deposit nonce.
51       address hToken; //Input Local hTokens Address.
52       address token; //Input Native / underlying Token Address.
53       uint256 amount; //Amount of Local hTokens deposited for interaction.
54       uint256 deposit; //Amount of native tokens deposited for interaction.
55:  }

57   struct Settlement {
58       uint16 dstChainId; //Destination chain for interaction.
59       uint80 status; //Status of the settlement
60       address owner; //Owner of the settlement
61       address recipient; //Recipient of the settlement.
62       address[] hTokens; //Input Local hTokens Addresses.
63       address[] tokens; //Input Native / underlying Token Addresses.
64       uint256[] amounts; //Amount of Local hTokens deposited for interaction.
65       uint256[] deposits; //Amount of native tokens deposited for interaction.
66:  }

68   struct SettlementInput {
69       address globalAddress; //Input Global hTokens Address.
70       uint256 amount; //Amount of Local hTokens deposited for interaction.
71       uint256 deposit; //Amount of native tokens deposited for interaction.
72:  }

74   struct SettlementMultipleInput {
75       address[] globalAddresses; //Input Global hTokens Addresses.
76       uint256[] amounts; //Amount of Local hTokens deposited for interaction.
77       uint256[] deposits; //Amount of native tokens deposited for interaction.
78:  }

80   struct SettlementParams {
81       uint32 settlementNonce; // Settlement nonce.
82       address recipient; // Recipient of the settlement.
83       address hToken; // Input Local hTokens Address.
84       address token; // Input Native / underlying Token Address.
85       uint256 amount; // Amount of Local hTokens deposited for interaction.
86       uint256 deposit; // Amount of native tokens deposited for interaction.
87:  }

89   struct SettlementMultipleParams {
90       uint8 numberOfAssets; // Number of assets to deposit.
91       address recipient; // Recipient of the settlement.
92       uint32 settlementNonce; // Settlement nonce.
93       address[] hTokens; // Input Local hTokens Addresses.
94       address[] tokens; // Input Native / underlying Token Addresses.
95       uint256[] amounts; // Amount of Local hTokens deposited for interaction.
96       uint256[] deposits; // Amount of native tokens deposited for interaction.
97:  }

```
*GitHub*: [8](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L8-L11), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L13-L20), [22](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L22-L28), [30](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L30-L36), [38](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L38-L46), [48](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L48-L55), [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L57-L66), [68](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L68-L72), [74](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L74-L78), [80](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L80-L87), [89](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentStructs.sol#L89-L97)

```solidity
File: src/interfaces/IVirtualAccount.sol

7    struct Call {
8        address target;
9        bytes callData;
10:  }

13   struct PayableCall {
14       address target;
15       bytes callData;
16       uint256 value;
17:  }

```
*GitHub*: [7](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L7-L10), [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/IVirtualAccount.sol#L13-L17)


### [D&#x2011;73] ~~`internal` functions not called by the contract should be removed~~
These are required to exist, and are called by parent contracts

*There are 6 instances of this issue:*

```solidity
File: src/ArbitrumBranchBridgeAgent.sol

99:      function _performCall(address payable, bytes memory _calldata, GasParams calldata) internal override {

112:     function _performFallbackCall(address payable, uint32 _settlementNonce) internal override {

125:     function _requiresEndpoint(address _endpoint, bytes calldata) internal view override {

```
*GitHub*: [99](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L99-L99), [112](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L112-L112), [125](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchBridgeAgent.sol#L125-L125)

```solidity
File: src/ArbitrumBranchPort.sol

107:     function _bridgeIn(address _recipient, address _localAddress, uint256 _amount) internal override {

119      function _bridgeOut(
120          address _depositor,
121          address _localAddress,
122          address _underlyingAddress,
123          uint256 _amount,
124          uint256 _deposit
125:     ) internal override {

```
*GitHub*: [107](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L107-L107), [119](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/ArbitrumBranchPort.sol#L119-L125)

```solidity
File: src/MulticallRootRouterLibZip.sol

37:      function _decode(bytes calldata data) internal pure override returns (bytes memory) {

```
*GitHub*: [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/MulticallRootRouterLibZip.sol#L37-L37)


### [D&#x2011;74] ~~Unused contract variables~~
The variable is used outside of the contract in which it is defined

*There are 20 instances of this issue:*

```solidity
File: src/interfaces/BridgeAgentConstants.sol

13:      uint8 internal constant STATUS_READY = 0;

15:      uint8 internal constant STATUS_DONE = 1;

17:      uint8 internal constant STATUS_RETRIEVE = 2;

21:      uint8 internal constant STATUS_FAILED = 1;

23:      uint8 internal constant STATUS_SUCCESS = 0;

27:      uint256 internal constant PARAMS_START = 1;

29:      uint256 internal constant PARAMS_START_SIGNED = 21;

31:      uint256 internal constant PARAMS_TKN_START = 5;

33:      uint256 internal constant PARAMS_TKN_START_SIGNED = 25;

35:      uint256 internal constant PARAMS_ENTRY_SIZE = 32;

37:      uint256 internal constant PARAMS_ADDRESS_SIZE = 20;

39:      uint256 internal constant PARAMS_TKN_SET_SIZE = 109;

41:      uint256 internal constant PARAMS_TKN_SET_SIZE_MULTIPLE = 128;

43:      uint256 internal constant ADDRESS_END_OFFSET = 12;

45:      uint256 internal constant PARAMS_AMT_OFFSET = 64;

47:      uint256 internal constant PARAMS_DEPOSIT_OFFSET = 96;

49:      uint256 internal constant PARAMS_END_OFFSET = 6;

51:      uint256 internal constant PARAMS_END_SIGNED_OFFSET = 26;

53:      uint256 internal constant PARAMS_SETTLEMENT_OFFSET = 129;

57:      uint256 internal constant MAX_TOKENS_LENGTH = 255;

```
*GitHub*: [13](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L13-L13), [15](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L15-L15), [17](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L17-L17), [21](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L21-L21), [23](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L23-L23), [27](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L27-L27), [29](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L29-L29), [31](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L31-L31), [33](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L33-L33), [35](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L35-L35), [37](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L37-L37), [39](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L39-L39), [41](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L41-L41), [43](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L43-L43), [45](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L45-L45), [47](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L47-L47), [49](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L49-L49), [51](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L51-L51), [53](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L53-L53), [57](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/interfaces/BridgeAgentConstants.sol#L57-L57)


### [D&#x2011;75] ~~Initialization can be front-run~~
These initializers are called by other contracts in the project, and thus cannot be front-run

*There is one instance of this issue:*

```solidity
File: src/factories/BranchBridgeAgentFactory.sol

87:      function initialize(address _coreRootBridgeAgent) external virtual onlyOwner {

```
*GitHub*: [87](https://github.com/code-423n4/2023-09-maia/blob/6c21f6b739252367c5fe770fed3ff76eb3ca2c86/src/factories/BranchBridgeAgentFactory.sol#L87-L87)


## Rubric
See [this](https://illilli000.github.io/races/2023-07-lens/scorer.html) link for how to use this rubric:
```json
{"salt":"c5914b","hashes":["1b3dcba911","5b5b2dee5b","99168e02ab","8ed824d1c5","4bc568306e","f658099c82","3ec1940027","8fbecd2d5d","863c4757be","aa7b927cb1","d4f0491fd9","c555fc6484","8f3f1f7c8a","35e2c25c84","2550e07c56","a21ec7a07f","11af947f3b","e89105dd57","59b22f4519","2d2a307650","b7ce1cd0a3","1743cf2013","3a56c99fde","0c0a17d9b8","228168d2d0","71108a7f8b","274920e35a","4bd4e084af","2de5fff6cb","633e0c24b1","c46d88d873","7ba8954362","1f2c61074f","00c58fb2de","7b79f2c338","a8321deb8b","a4430ba8f7","02b0bf2018","4ad22406c9","a3b84e69b1","959576b6db","e9e6684e4e","0cbf3b3e72","13361c2919","036de17cbb","9eca8eead6","297eed28cb","23fc02e7af","018a1861cf","0dc0852232","bd449fc8ed","d34633432a","f022951a33","c7f8d7d1ab","5e398fd223","0e7d6e8cda","015231f0c2","cb27d5c375","9f3bf5b7c3","46042e2d8a","6dae03174c","f52e77f192","f0ac19b0b1","d91328b804","b21968d868","cbeea24a34","f4c3e11239","007fcdd233","21be0de2f0","6ade1e60a4","7365353743","cd51b711bf","b890454a33","8bf7f9db3f","e939bcaea4","ba7b3e063c","c0b71fcc49","d6e36ff390","760177e539","bb600c2f08","c4775a79a1","91f43e1748","8a438655a5","ab3dc186bc","0cbf3b3e72","13361c2919","036de17cbb","9eca8eead6","297eed28cb","23fc02e7af","018a1861cf","cb3e640bee","72f40d9ad6","6e871a329b","4eecbfdaf1","94b80f6159","38fbe2e42e","b7d3746e5f","33bf5eec8b","2cf7fb9027","7a89624aa6","96e86cc9f8","92969b135a","260d7b79f2","e239342b84","91d9974722","04e7721173","c324a7b510","df48ed16ed","3c12b9c269","2485ed7b35","7ef2008d9f","1417ddfd04","514292b0dc","fb51276a56","4d7831bc80","2f27483f74","3c6839cca8","5ca2738f2a","083019f5dd","b247741453","c02570727d","e8102a48ba","eb03afd5db","9dbd4cb34d","c672a233ab","123ec611ef","917e9c9b14","cd79c86249","9effd68893","045215ee59","d0c3ab5b97","41460441fb","718740c070","7633e85607","ff74c45cb7","df3b571531","03cc4e5635","016c733f65","4552eac7bf","268b947b72","ad4df2b5dc","bd1a40d0a2","2cb0cb8648","f7e5c4105e","207c2b154d","cd62394afc","d87d2b0f6b","b6700f7bd2","bc9280b656","7c9a4649b9","1a9a8b6f9b","caabc477c1","3fed1fe454","4faa6cd6c8","09fcd7c545","1a3f88bc4b","275481b37b","2914033c7e","7bf73e2cd3","0d33824478","cdd5a24a01","664061f4eb","0426d83f9f","76674eecf9","5663a6bc42","8e234bbe7c","13c6749d27","bd7f0cc01b","08f2651cfe","772cfa2e6d","6d3fcbc400","31c2205878","c84aec6518","079d0e5339","8120f353ed","d037ea0072","662138b469","7d88fd0790","5e554c0237","39eb12fc3d","7b07e59f2d","167844cc39","405ff35ee7","c5293bbcec","f44a293baa","c5a011d305","7e73457ed8","31417ac6df","f9dfaa7830","bac33fb8c8","8c6c3bea5f","6b63b1aaaf","0655e7297c","3c76ea1ca3","0b2cd89a83","bd439d02a8","fe0914ffc0","7d52db6cec","d84be0a796","eb0de1adb5","a6e365022b","065598c67e","0011dc93ee","4e20e00718","8dbeda8e8b","5a6e88b77d","904ce2dc39","a7ddb3e8fb","4ba74fcae2","79a04f295d","2c4cedb809","5edd635cb3","0812299bf9","c14633374e","97e09bb0e3","683cc9088e","4846ed0bd4","386257e27a","742fc7ad71","76f545d67c","3c5b2baf54","dac99ff43a","332346be66","e977c4ed66","d1198a0f52","345d0b07c4","78cc897c49","2f446e7373","5d40d53a85","d4ca6097f2","f7ea66ba53","a0fa4e630c","2bc02a5983","375538b1e7","6b34b7a41b","dc1c27c231","76ef366d9f","36754da6ed","1d8821d4f8","5d3f18a09a","42b8ee37bd","934e44f4c6","a7a043596a","11bea908fe","1d493a6bdd","6a8edc2927","eab3237e23","c429bcfa1f","658d5f056f","22601e1e16","c769d8589c","d1d062e202","26e031f113","1246cb3bcd","043f23c4d8","f01ef0def8","38a7f2d7be","24cc5a4a14","d98400d98a","1e9935c7d1","27e4f468eb","c0f57f3a71","94da52db8d","ea27d613b7","20c341f7e4","bdb294cf26","a7f66dffd6","62d801857e","941308642f","3cc48d8b2b","378e466114","7731734900","2c49465cc3","483f172a9b","3544e219dd","7e90eed82d","31e4d084e1","10122a6c8f","4bcb175c97","f4033c82e9","26d6d37a76","95ff7a1d0d","4aeedd06bc","8a4bbae824","97a4daa620","c62f174919","2e6732efc0","73f72907cb","2bcb49c298","cb30488bc5","ef34a0e184","af2a9897e9","1ca7b73beb","7bd73045a1","a7132eb451","7f4d866878","9fb8eccec9","55ed88625f","06e49d3fac","5c6cd05fc0","4de5d768f7","e3400cd1db","3c3fc12ebc","e125cdc6fe","65e7f458f6","461008bd57","84d8f63d65","0d86bfc900","015d4be30a","6b25f3aaeb","02ab7a5754","d4029acb34","37ee2043f4","6343315145","834c8166ce","8c6c807fac","5383a5d30d","40ff1c235e","c5af722c98","6497b90aa8","a507b00198","050268263d","56b460a864","1cc66dc0e6","fa71b9234d","2b14b04281","3300e9ceb0","33d10949c1","bc6bfb61ea","6b27a5da95","59654a50d6","ca112f8ae3","867e639017","1b400ab51e","0d3d52108a","f433dc8fcc","b744a8bb18","bd6574dc3f","84d1e88696","ae44ca905e","ca2b19c285","704b6ba1cc","caf0e184ee","50948c962e","dc8cbee81f","0c437af41e","81fa11eace","c23f93a348","c9a27d15a4","ee0a2f93fa","cfd22d15d9","fc7e4d26a5","73b6cfd870","6ee08e90ca","07df7aad4c","ae74d881ed","63bd57ea92","5fa6b323c7","02a8b574d3","facecc92c9","0af8ff42c0","86ec3e0dfd","3203191c01","e0c454a702","39207fd0da","4573e8389f","5dda7242ec","e107ec8248","c5ba838ceb","37e05538f5","ccc75060ff","7e78864524","a92257a0d8","ed2341d4c1","beefa9b570","6f80499235","eb2b4c40ad","ffbf2f01f6","02a89de503","dd7fb45f6f","800f509f7b","d427cd36ec","7958eecb48","e0478ab46e","998a2b0d72","779f7b6ae6","aafdb61e7f","08e5c93e95","92f0a79329","80854c4b7a","57a635813f","7ee3490df7","e5c9689c97","b2fa93fa46","b2180300d6","1fee93f8b6","b305d9ca54","a9161d10d2","1953175f53","ba574be7a6","3ae2f667c8","5fae4b8e94","c228337b25","65a7b144da","6c7ff2e4ef","6cc9c35651","8011078194","4a0207d47b","01b71c4f7a","dc41564d61","447b3111a5","0a66728027","e24f087a7e","e61584dc60","d37e028b9c","29081c6c06","bc6646d8f5","7008c199b9","c8cdb04fe0","f189d9f33e","9af0d2b7a8","270bff39f8","e36c8452aa","31bcd33846","045d96db71","7d4ea696fa","4ee7bb6eee","08f255c169","3cae683bf1","6eead72f54","cc8ee16ef5","bedd281a27","02c208f583","7a7e30207a","45efa8c89d","d3b850865e","a688f044c8","f8e1dc2c8b","8e74f198ef","a07b70ddf8","c09f73666d","245138ba18","d0c58825d3","38d6ff0816","abc84e3446","d5d5484439","cd986ad311","7f79da160e","2d29ec8a53","a0c97a40ff","018083939a","e18bb0c09f","6315718a8d","e814603f27","7a7e30207a","45efa8c89d","d3b850865e","a688f044c8","f8e1dc2c8b","8e74f198ef","a07b70ddf8","aaa701e302","51443700ab","aecf254dd6","93c966c2e7","d19200f22f","58dafd96bf","12672fdebd","8d56062bae","7bcf6cc0a2","ef673f07a1","1462ffc1f5","ccf2647972","86dd5b4221","a3968718f1","d423d19baf","40274b5353","2a99c5feb7","fb901de380","cbbec9c40f","d22586a90f","31a99e56e8","99bb39cf2a","847087c2f2","31e7be0871","8cfe48d401","b9cc63417f","4df0a9f4a1","556d0a5177","06c783b2bc","1e3a27ec62","3d7168d62f","1cf3ebeb1c","dd5d223161","ecdab7b633","af014a4c52","24240af926","0dc15bd8ae","5a421f6a91","1305e2b3c9","bc47e21e91","ef2d1b7311","9910b2864e","00373ee188","5244f0a681","c39aac0ab4","f4aac88e30","04241d20e7","bf76f8df6c","a672f713c0","4a1d0be508","64d3866d00","9c744d509f","793a359074","f12e5f640c","0e5b5c0236","0acf316e02","1b3048c1cf","d2ac92f87b","7b29fced7d","774a121470","a9cf2200bc","29f541f7f9","8b667a6b4e","0706a695e5","039a269ea8","be430f4d8c","11f8cb32f3","c1eca9d43c","6297b90d61","313e786418","601d758f81","cc81faeccd","dce1479170","89d57c11d4","d71f3a677c","b0d0b7d719","5198ef79c2","40ca0528f1","6b816d8555","32cad73afb","2cd2f8f2f9","4e88128f42","b4a664e406","93e7cdf598","1d12484c80","3aa3f14d21","602668beb6","bad338f6f7","ae63046247","283a65494f","9528703d9c","c6d2ff86aa","92ee7cd1ad","8bb60d3c14","ed000b1bac","dec4b25f28","8b3fe1b8af","386e8fc2fe","d4a9cf2b5d","3a0b7d5e3a","ec33055172","d75097861c","be9c5274b3","889fb9f977","f4968012dc","b6a2acb183","e7c7aa9a84","2654632869","13b740302c","c532dc2d60","f1e872f45c","399724ff25","dc0de8f843","688bbd8c16","07c4e3b3c6","631de9e136","475b3ddb87","f6fe1dec31","9fde3912c7","bdc546b6a9","c266e4a9fb","ce8bfdd87b","67f3bd2d95","b78f8b4144","feb043fb85","739791172e","4ecaadf89e","789f792538","9d28bf4410","d1c32d3a48","ccec6e77b6","9cbbe26209","11b94ffd49","a07d4fc1e3","b88a30cd00","33ffb31929","4e2d3aa2b9","d19eeddc33","08d28072aa","54df5f635c","9caca140ec","eda11f538e","2e9350527c","f2815b94c2","b1f237daf7","05f1520e97","e48355d06f","249e21886a","b2ac5abd42","160455b457","2645342705","d339f59601","74076dcc8b","81848cb05f","d5524fa65c","681e4610cc","04335d2f2e","c9c3f4507c","49cb2e3e14","b71bd71539","a316c0b4e4","c3c0be8009","51341f2f27","3cdea6e0d7","fa5e72ddb2","12a1629420","3658394bf0","ab823d6c44","c5273891d7","0ea9cb6fe2","bb42d1a618","4913a8528a","abcadc9cb9","34045707d8","f787afce51","b70924c0ee","8180329fd1","06f26999f0","99ac72a6c3","7c579cd6ef","1b55ab6ef3","4c2ef52293","610200c955","d1bab8e962","f1e88570c3","83a0e63e11","e9eded6db9","53582913e1","cfeec1d20a","8c39058445","2af3dc3aae","beb6256cb2","c53506a185","96cac93930","8a410a3466","05db2887de","2109fcde02","0e908a546e","84b7192002","2e6ea77f59","8146a6b8a4","7095ff4f15","ce7af31076","0ccdcece19","8d4ca0715a","6b9e2c429b","38042ba155","d77af08f07","71db809afa","9858f6efd1","6db99a0b3b","7575232cbc","8da4d15c99","6f15d2159c","2f8eb579b0","c458339240","717a8edc0e","ebd0bfb879","ed4af903d9","0850369489","174cb92b2c","8e592867d7","d3da79afe2","e9b18a8a2f","08dd555342","548e3c3cf3","635dc17655","d64ea46269","bc4d4423dd","c58564b68f","d69a94176f","e077c704f1","e8b1c5f66e","0c718c4f64","4b2eea213d","0cf5e5b324","d13c8d6796","e2a9f95205","8082b7df9a","66d7a8a07d","d4370d858c","0d6ffca358","24a4e0b9df","23b5a76169","529139cca0","9d3ee12409","81e08890eb","5774146865","b531cff7aa","a0993d2368","d7cbe2cf71","c96400b111","f2ee8d5732","1f0a0e9030","3fa89771e8","7f513c7000","27f28a373f","3a3f8de20c","a0aacc6539","d96402e29c","cb4bcbd299","58843c9ae3","dd8a216d8d","6e73f34940","85edfacfd9","96fe0c668b","149af7423d","55a4fdbd80","351c76300e","a201bc77cb","056a2c318c","c26ef3e5f6","e31fce06b3","68fe441a53","3cdf66b683","d31d3cb088","21c38fa349","d70c930f87","ebe3aa99e0","c9548b9cb0","677053506e","3c62fc0667","f2e900d1a8","d4013c3de7","2c5e7f9bed","764299922a","0fd62b1687","2758d6109c","cf5d0016b3","f7e27ff100","83cefc0c7b","fd9205abfe","b4c7d22bb2","8e940a36e1","2758d6109c","cf5d0016b3","f7e27ff100","83cefc0c7b","fd9205abfe","b4c7d22bb2","8e940a36e1","0c986f191d","36ddfa712c","ef75a12248","3e681721a2","d09294b5b9","a71b61cb31","4adaef8489","cb21e74150","e14fd7f4b2","ce0445607f","741b876c6d","0f71ab92ec","c6d7ef61ca","5b3362d920","0aebea4048","452f4af5ce","d5a6df1b36","7ecf8140b9","f2092e5b58","199ea68b63","7ffbf354c5","0014bbdcb4","dbfa6ea623","6c5ca95980","1e584c04a7","9f32403b0e","10decf4142","8272bcb2dc","fe125175fe","81d59be3c3","0a0ff81697","37ad9c298e","5971105dac","4b2a20bc75","725b436010","65cacc40ea","bdb7b2f499","27721bb60d","b92c34af3c","e50ab4b7dc","6f6f79be6b","6cc2599cfa","533592a094","977a2705c4","f4d30bc772","6665a3a2cb","0af361a466","02c450f24e","849bb6dd70","63fa12887d","f885b6d108","420caf0153","d1dc7f4bfc","6c216a5d21","7aa66c1919","ba8082f26b","1b778f7902","5e5ed7e69a","384f676f31","ef53b4e089","f2d9679d35","4340da630b","91133f4f4e","13bede161e","2550a55d02","8181aa579b","4096c17696","5c9520a833","a714cf8713","2b467657d1","19cf5735e2","947e6c1269","487dbe45f0","1aaccb6bb2","59c1d5af21","27a031c002","d1c7b2d652","b5ae228eb1","00aac00dc8","c866af946b","bcae79b81e","e9cf52f633","e7676425da","6b03849e9a","db3b419795","75d96d9f29","2ef98575cb","8c2a409025","52ae2bf5a5","0599e05db7","552faefdd0","1e881610ef","4b97a3e2c3","3ac248bf28","85761fba0d","f34b0e5fb4","021020d458","5ddc14626d","1a3cd16256","6e600e9561","2526a34ffd","4d63da8209","1a30d5bd16","dd54bd953d","14e9e58f75","1946a02d4d","266cd90519","0d893adf71","a58dea9741","4e0bb4177e","7f4741e299","41eb7acd0d","c5dd062f22","9a23df4bd9","40a01bc758","f6ff282180","4daef5258a","af96d47218","52e9170721","5267536705","54e84fda43","be9ad53201","6cf802b523","729ac3bccf","4d34045db1","3fd1bcb04d","9c9a00bee9","783b60c04f","0722e8efdb","c4a3d9519e","d9ba742f05","ab9588c82b","55e316368e","034c09fafa","104921782f","eada61557a","7aed9ab169","90997d6850","870f0e4e15","c11fb6f825","55bd1cb149","94954cc273","20f629f617","96c2d7d920","1be0caba5f","881c9e943c","439e82d9a2","e311481fde","b63159cf10","51e7a4190c","680185a0c3","791dea05b2","5859a31285","bd8cca2b49","1946a02d4d","266cd90519","0d893adf71","a58dea9741","4e0bb4177e","7f4741e299","41eb7acd0d","4d69decc76","1d036f1efa","f93fc7de69","49b71570ae","c7cfeeceb5","e6960c520c","ea4f2877d8","0406d1ca01","759fe15842","d2fdc695d4","0c667dff9a","6637990a4b","87b644b5d1","cd48bee9e7","af17eee009","facd4d6315","eea9895ad4","057b154e34","846a0fab1b","8bf4389be5","1349a37e5f","58a2ced506","bdcd293885","2c0d4efada","a34926bf7d","42dd2a1bd9","e7a6a77325","771b1f6bbf","06de7e3278","a3081eb56c","897f7a0729","f2657d74e4","2bd4ec0452","b4627ea146","af40c515b5","933d716f9e","29973a2e25","c1ec86a4bf","ce58297926","4ce272eb5b","b356c1011f","5cd4bd4036","3f4f702540","bf06224328","d147dbc6ef","44c00b2a06","d048d86e97","03f80677c4","95449145da","d65dfa17c0","0da291aee8","8d911907be","9bda8b9a45","302c7f699d","be2dbb699d","83780d1651","0406d1ca01","759fe15842","d2fdc695d4","0c667dff9a","6637990a4b","87b644b5d1","cd48bee9e7","e85a596e9b","1e4c673cba","e2c971b595","f7affa9bbe","bf65375c23","6e3d25c062","aab1ec77f7","d64340480f","2140329f56","1e0eb0a415","1f5ba25a4b","72d8543704","b8bf52a14d","1d27f1e5c8","0ca8f9a6f1","1c0612a999","7cea9bea26","c1871f7ac1","400fa9603b","3a5c37d0d8","e3793b69ba","cc50d470b0","e42fee9a67","15c32f58e7","b9e1ea67f0","2cd878aa0d","cce193075c","8239c3e53b","c5987be6c5","c672975746","e761c8970a","4a32c1ab2a","c4834e5bd8","8c92a4a3cc","1308a883e8","486646cf58","622e23f544","f28b790e76","f49bd9cc25","8d7f4ddb07","4e896f8945","13365d9edb","a83a13afc6","5eb0f1eec3","d155d4a291","2ba80ba4e2","468ccba159","09d2eecede","30f4f0eaee","1e15ba94da","d2ebd37aa8","c627e0e188","dac95a87ba","6b0caef6c6","f8d6a41be9","502160c1af","34d66dc319","76cdbf2845","9fee0a091d","cc147f54cc","516a311c76","43eb817d7b","460406d7d1","b81d3bc1dd","44cbc1793b","6999734dbd","1e3d926793","255ab7a4f5","5566f0af3c","3798e8d155","116c8d0e8c","5f8dfdb9a7","bbf271874d","62dc3c7c15","2aa325720b","2d590c834a","7a92ee3cd9","01b6cc70ca","80316f1731","de7e25c7c4","c4b8e9c6f5","a01d7562dd","96b1d17ba5","f6efdb08de","69c848de11","f9e95b9903","4ffff13e43","e058e33792","066668d81c","5877de47ac","a09627f461","c2d20c4d8d","8830962a1c","327f2338d7","7a807145e4","56629c5314","a2df5644d9","ae53342e47","e5df36fad5","ab1a991d25","32d29a1a35","21ab34adb2","cb1e7f6c13","cdda313916","c1c3ccd89f","e86c6d5182","a621ecdad4","61f29a8346","17610b77ba","b5266ac456","5203f9a19f","11a38baff8","69c848de11","f9e95b9903","4ffff13e43","e058e33792","066668d81c","5877de47ac","a09627f461","fd3da020a3","be1cd20561","4a5271568e","f9fc9ab9cc","2d3fc90f5f","6adba7a750","732c303887","995a886a26","987865fbc8","3200866193","f42336dc81","d51be0aa20","1f6ca78bf5","017b8697f6","007eb7c819","af362af4d4","e1a6f52afa","14847aba0d","f4c78cf9ef","0a1d1ddc16","8bcae34130","5d319f0472","f279173f51","6032159f75","177344acba","e8ee124cf1","1cbf919f17","78014a5700","c276ebe0f6","ee6911bb4f","17b650537d","5e59e3af29","9d269bbcd0","ce6d4333ad","d590999b30","bcb956fbf8","283ee8b9e4","b267dec705","99b445db2c","c272d099fa","5360c92f75","9f10361b1e","6f6c4a23d0","34274bbb0a","3a5dc9f879","1b77d2ab62","ee12acdb1b","1d2ed49c68","856f361623","61c3f12fac","c4f2cd375b","57166002c7","ce04c02904","897bfc0e79","1a2e5330ea","82a8af1847","d1a504d3a4","76c7f0e575","9df13bd77c","f53c2d617c","6537590277","76b2eabf2a","8b0e07dc0d","20f1d3649a","28f0eab743","9d8a6685a4","2a70161734","02f8179549","a754f8f4c4","200e12f0d6","8f9c27b384","28190f27ec","ff10bc7b24","2c8ba58df5","93b2b6ce21","f2fe8899cb","3d17572ded","46d337dc41","eaac59d6dc","6777ebe21f","d4a90caa2f","9313324cd0","2b344e99ef","57e402340e","0be32c8e62","efdaa4679d","73a0325c46","f3afaeccbe","af6062d35f","45e6726619","66ad70dec3","58d8615695","ee4354b27d","c1766e5518","edc102c210","9bf29dc718","c3612f0c57","91a4b5b3ca","0a402e6721","7fda750511","8367658ae0","e985aba27f","9c86e1ac9b","a05c1ac7e7","b37d8346a3","4aacf5077c","7e079feac8","3a1774e91e","1c27939135","4feb31675c","cc02ece751","7f8f0f7fb8","8f9c27b384","28190f27ec","ff10bc7b24","2c8ba58df5","93b2b6ce21","f2fe8899cb","3d17572ded","a75c134bfe","ab1059ff2b","8caf98f390","3f9a0343f7","de32d0b5da","5f169bc0fa","8a5ec8465e","d9524575d5","6091795c73","57c3163295","d13f4186b4","697303b140","5d919054e8","63ccf4e78e","4312cc2f5c","8586c44747","e873ca6321","93cd533e6c","646bd40b6e","f8a558946f","623e0680cb","4312cc2f5c","8586c44747","e873ca6321","93cd533e6c","646bd40b6e","f8a558946f","623e0680cb","069113de33","d0cd8b5570","cc800d1a1a","dc23e1feaf","9ad6af989a","44cff43761","3a9dc8dd43","3c0f78b7c8","bd88690098","7096b904ab","529b0fce45","f29b9fe508","19cc822ec3","bab1168b11","c13cac5a89","e40b374231","6cc45be1a8","8efbd4afbd","ef94b50d23","2026917fa6","13004a4679","593b39d1b3","c8e621cc28","c8eb926efb","8170426387","b667c37825","28f4823972","9c7e056dd1","fda0adda66","6d7a66dc06","8c965a3fc8","d722996c20","b36012c24f","9208ae6e44","a7c701d3d8","fa2beb04c0","d306257e58","bad55f64ee","77e4e5b731","273f4ffd46","80213936cd","8703d4b685","2698888701","84a5d25002","44942afbbd","32f4e3b99d","2d9b8e1ee0","a3486083cb","d6afc11392","dcc75f2fc4","0054057926","0497402d28","3b8ec9d7d1","0c3484e9ce","9abda8ad99","2bbf09f8f3","3acc446e36","dd828de5f6","978ff31fbb","4c4b930460","67a116146d","c071aaf31b","20f1b83ff1","85ba04c399","7562a7256e","42209504ac","e04a4971fc","ec3ac36933","f753fd7aa3","5c4d423ac3","4e361cf6bc","5dee21aa9f","1df2dfe0ba","02603dc2a0","e9e138e1d9","027bcdc9ad","a23d2ba109","7f353fbbf2","cd5ab4806f","090d9e5d7c","538eba3a3e","ba2c536de1","9769e4bf7d","17bbe31ca2","5434ffdd9f","c55f49ec62","bb2fcdd5fb","7e72be43c5","b45601c528","8834ec6f01","e7379b3be1","9a8218e2b7","32acc645fa","1bdd80330a","62fb9ec0a0","bbf24c9d8e","8e0f3cc3b8","5edac07524","d3c235607e","f56b7f28c2","49d97971db","c1e3d93d14","dc96284baf","63894add32","7312cae0e3","9250020016","bebee4a737","d44bec7535","bec62087cf","cfdbec6aa0","78b6531fe5","ea7e15b427","7d299dbda6","5aba0653bf","5dc0c186a5","66bc86adef","7ee86b2ebe","6ccffb9c77","ec0ad528bd","d7b2a65e8d","6b18a16c43","41bfc47137","f1c05fc8f5","6abbcffb46","daaca3a420","683cb989fc","979ab26457","72ce7395d1","48e9694183","985b0ce2bd","d53caab05e","6351d0abcd","17137059bd","ba799c6f90","37621d91c0","9bba79c46e","4ae4d9e1dd","059c8e149c","e61713ccb3","23306fc648","a6bcc970c5","fe0098afeb","5969dc6881","c83777050d","609a27b91d","28739fea0b","7a14194d17","4236b81cbc","ce3f693001","c8ef72039b","55f4d75832","64ec45bc8b","251a771f5e","e685795283","a8c347c31b","126858c772","5802fed8f5","143714d84a","0fe9fab29e","afa55408dc","27c10bb886","1ddb83e725","868483cdde","30d48b7fb3","fddac4659f","25be44e3ba","605faeaa8d","170722f8a0","1d8e2346e1","813a14964b","2860f03ce2","ee71e5fbc7","fe3b211efd","9dfe5799d3","2ef72647c8","786af91351","f627784d0c","4dac07213e","c11457183e","4ad983d9a9","88baa6c8ad","63e3a802d7","4d8a58aa08","c319bfb4f7","df437972bc","54045f0910","0f8245a085","c9fe3745d4","1be13a8788","29b5526ad6","a911c7f1de","d9afc0fac5","4251666dbe","097dbf8dea","ca15f71a59","4315299508","374f4b22d4","67a45abd4e","030090f728","152b418c05","daa51c8527","f6fc57726c","2d1176ba7d","9ab22eb0a2","d13786982e","c458a363a5","b386948ca5","2c63dc2d82","7ec9e94ab7","d1d3c2fca4","f0022dbf9e","31d08ff529","2974f0ef5c","ac199fb153","32245a9143","03642d82a1","5cdae05762","65bafcbe27","07cbb3ae64","acd617f5f4","2d9203b537","2a21494732","2f55a0415a","cc3cd034f7","fd47c3a717","a10488c36c","f9d85c613a","3d19a32b21","dab9bc0c33","79533c74aa","1353ea3c23","7121be7e4d","2662cbdc9d","0cdc16a1f8","e6c2128cf4","9198d038f8","f1f17bc41e","3d2177f2d2","b402da5cf8","b8034e3fb8","10c521f82c","4f20b32b13","271d1a1a6b","6470e77979","f821655b55","c1ea85c446","bf18d1abbe","fcee36ec58","e35e79ef03","80082a1dd5","806f550f50","d94d6af403","07bcef90af","c33fe3e7ae","dc7870a701","5e2e0d3d00","40e1590b42","217c9e1d5f","5c21db7444","90c7269399","510c61d5c3","52eee53857","2be7add672","65e3809f3c","0bb7b247ca","d03ad57007","16f882306a","925b30eba4","d403e2364c","ede99395a8","6473391b2e","edfc01a1e4","8dfb8110f7","7769163aaf","d794bd17e0","bfb9392e63","5831412d51","b052320096","dde04529a6","74fdb6318c","d7c693af91","b7f94a846d","401b865dbf","f200f329f6","aad34a72d1","c9645766ff","b38be3ca93","0f2cea9165","9ccbc10210","59ac8c122b","614322e71b","40c71299ca","4caa916774","f1b551f555","a80e2c3ad4","f30d141d9b","afbd8d4f00","ce84b7dccb","118e1929e7","4b416ec98d","d6d6cf2e33","8a3e38395e","dc0777eef5","134b2bb0f9","160f1ad3ac","6b670fa225","437a243171","5629dd8c3d","4831b2598f","5f38a291a7","47cbc3e8d2","05a5c2cc37","c99c8030f8","33d0660ff5","725fe2e69b","12901c64af","c76095a6ef","a4d2669fa6","8e36a77b5b","ca2120d052","e792c20bb4","8c25bc035b","638e13bb99","8a693bf19f","a606b8ba7e","fa7710aa1d","836f069f58","c0b26206c9","56a20fb4b8","443b1afcc0","71e398db87","7ea37d42ac","07d5726149","537419a51e","0585a799d0","911a7d8a4e","fca15476e5","36ffc6c39e","378ebbda61","62d81e8b0e","7238ef1b28","15bca75a2e","6bca5468e4","9da0175c92","18c97325d1","7251e706cb","7167e6de84","e63704ff5c","cc91d5d134","ab10a227e4","352ce1f6e3","1cca5c3e89","a7baeb032c","ec58702067","7b6da253ff","bcf63521be","301e3ba3c0","8be9f2c53c","39f7ad3738","cc12d20ae0","848b1fd03a","c37e24f3da","1853fc8ab7","875742a6d0","29ee52cf38","6b4975bec2","3f39090917","6e290b7492","7eced0ff0e","38d25a9652","3bea54165e","6db5983766","ba1c6bedf0","6d6c4cfbce","160a567d79","6cce95bce1","d0cd829127","b51cb37862","8bc3750cab","31d7e7b503","6b95a1cba7","11712fc61f","dc2160736e","2cca10a7b9","fe3f7d7a0f","4e408ca2e7","59f8df7538","a69b6549b7","9723e24608","33070a9f89","3e133d3640","1179ee3366","02d12c3ffd","e2c39f068f","7debf2c67d","76d55fb7e3","f5e24102b5","de99d264e2","74fda75d20","d36768a497","17b3970b5e","1858609867","8c0c090357","810918bf87","beabd03ec1","b0b29b5cb0","fa15b01de8","2b8fa8279c","5f688a5635","8ec5b6a50a","c0090cd7d2","380b5298a2","89a97f6b1a","0ffc6c3a7c","aefff5c1dd","952c583b9c","0ea1229d7f","8de791117d","ed1b9f15ca","a7fd679e4b","c74c220927","1dae278320","2e48963680","950185989b","62b5a61ec8","7e0685a075","054f4634e2","b262ca1a15","86610ccf90","761cc3da7a","dd062cee9b","e2012c3027","ba72ae4e2a","83afe83767","ca96baf6d8","cd3bc99045","7ad6659bf1","2c050d6234","c6ae37f410","f9d3fc67fb","812cf1c35c","99b28c0ddc","dfca9e4eb7","3492805bf0","691f563e6e","4263aebfec","431d3f7ea7","7f66b08583","58a15183d6","ad4801b129","35810b2429","63261b8d36","c5997d0be4","da11ee52d4","a1a1881816","7804640325","dc01b2043d","89b81117a1","92fbd2f0ea","43a879565b","033dcbdd98","0ab0b775e6","1780052873","20597930d8","148f2bd333","e4ba177d19","a94ac81748","0e4566b1af","6f6f385d18","f337dc7989","65d8b34a13","ef1b31dea9","d513d67297","b1152a25ad","11f0f11a74","04b33a3b7f","30461908f0","d63d47105d","6f2d2616c0","79caf3fa6a","3cc232942e","a285285873","18409c163d","67a62a93b2","5a17b941d6","fcdf46eb84","3c18e5c723","9e3a9963f3","681c85f37e","d569ffd2e9","93a37f6bd7","ea90d30a81","34293595ab","b21f6bca7d","b7ac057680","5ff1b339c0","3398b121fd","ebf577d933","d3eee82133","243172bc14","5ad6ca259e","5f7227f61e","dd1d8e68d3","51747d1cef","469aefa3d5","e542b0228b","3b4931984c","55b2f98a89","64a0f0ba96","4236d0a018","c69290ddec","29eaed3166","d3fa3eb5f1","9f191e9d74","06d9ec25d1","2a30f7e0ba","3dff5aab57","5fc9ce8b10","f01436c5aa","336b126689","ec794dfaad","a5f520b8d2","7cbba401c6","e1c4248d28","b8bbd35246","b631131dac","1ab3fa357f","fb907b17ed","d132c993e7","56f1122ca1","2f391b851d","0a472f7b7f","0ba9715a0f","edfb2c8d74","1bc424d90f","025905cd48","bcc749327a","691d00de72","d7a6bb2d7a","b83e48043f","82b99277e5","24f582342f","f855058fa2","9fa1b7508f","2bfd92ec41","530e8ab00f","91987c1794","90151d0ec3","7aad5bd358","433d5cc5b7","d2e65bab07","d3b5df0c1a","04f18d0a5f","26db6fc904","b24d60322a","f209a0c50f","6406538384","70affbd6e9","a404ca5a10","c4452f4d82","e79b5300bb","3d7fd04ee5","6841beb150","dbf1aa3648","0da11a956a","fb52434229","2ac743e887","0299a45a28","498d6b268c","e5cc78ed79","392952a378","3655e21891","591f8ceba3","0f2741212c","a6f662f001","a0e377d113","12fb75633a","e8e9675d8c","f9b3a202c6","e71ed12971","2a9f4b429d","bcac82cd42","988809b10a","0f733bbea4","76faa03d03","fb75eab477","4aa703e8b3","7eeabaedc4","ed27cbff97","c275349ec3","ebebbe8c3c","7458c0ab00","44ef277c32","d0d713a10e","05cb4a96cd","8cc2910291","6a1d9ec8fe","3d38e9a8e9","dbc40bb63c","cd4bd6c043","5480bb2f7e","ba5ea1b208","13de62ff19","75ed43236a","df73a908bb","4fdb0235ba","cac93c7472","9a55bb1356","59955a337a","a7ac9c93d3","ce64a18417","c7d08d0d1a","b09e4dc26e","d90c2b15f1","2319bbad3c","b95ada6ee3","ed4e03ed12","fe9dd702b8","2ca4f66d4c","dbec7ca6d4","1f5154c9f2","fb3b6596e0","72a08abfda","c984c64672","423ff6d114","a207c77605","e7af958c96","815e542754","33bf9085c1","07ce3b53b1","c21fcb3bd6","07345a1bd5","d631e00685","181935b0a8","d31704e7c3","9d0bf56110","02f271c204","495d81508b","fdd3f2fa02","8f83712fa2","8917be8ab6","25e11beadc","80753214f4","c3c765975a","aaab7fa24a","eac953a107","5348db9cde","3113c9c760","05b96c9e67","0922ba2096","993fb031f9","e63e623202","58638b6eaa","f2ce0ea991","cf9f439475","fb995f2bc3","0cd59a1446","0198f36675","ddecc4dac8","5277c8b3cc","bdc925af8d","da1cb1e402","c00f93502f","c9f5aa4532","3de3be4c35","746cf84532","2d6b85dec1","406223bcbd","dc21e37397","7443c96986","25f48af09b","063bbc4253","6b9456e928","049e62e737","93d56b951e","4a5ba61479","8fce27888e","96a7a633ed","694075f9c8","f5bce19837","7726eadb39","4f53bb2cf3","304f5b3618","dad4e532ef","8f38689d4b","ff499a44db","4d26a6443e","860e74e4b1","e8ea36827f","4d640a9220","d42001f20a","f339e26e41","fb2f59ff44","fcc24b84d4","b836b23f3a","9b32244fa5","802496e5e4","0f8f6e8908","98d62621c4","d46fb32ff3","f5bce19837","7726eadb39","4f53bb2cf3","304f5b3618","dad4e532ef","8f38689d4b","ff499a44db","a23ed038be","a1cf7f9088","addf859417","fa9cbd64ab","ebdecee541","98d3dc5750","1614199d83","7db1533805","49fe66e1c6","0232358177","a64a3cd3f1","d58f8d8d79","5aef99b0b7","87e178ab5d","6fa6cef309","1b0e620ee0","b50d2dd135","c3bdc72a60","bd09cdbbe5","60a57cb355","9b92253e65","f8aaa1a7fb","2c99d8d84b","2268a123ed","ce51b883fe","5fff565dbf","1639e23db2","5f0c0206bd","72e3149959","6f3d7651b2","007b65b090","67f983db9a","437983832b","bda40308d5","6641ee662e","f08d4e6ff3","877363dee3","8bd9170cd8","7daf37add0","a0aa5cbea6","c0b3001436","af641693f5","98d41689d4","c86b18deef","186479bdf6","11fb7e2d76","72daefd115","23b6b540bc","42bb9feb30","f92fc9a054","0b297f2d7c","abd2374892","9ba29bcc67","71cdc7d6ae","cc175f4dec","d5e13580b8","f05693362a","3bea3cc2b8","cc6f667865","bb7969006a","4f3c4f5b21","184b3607fb","026a0c13c1","2f8c134752","872af384b1","18091ffc10","0dc423ea3d","4f72735527","65c968b4fd","897273cfc6","5688e74856","4997085e73","bd8cbb395a","f08d2e597f","5ae031b6cf","287815e057","42f639a696","35f60686b2","fffd6b6544","8b35da7558","ff0426d0e4","b8335c5d95","7a8e10eb50","80fbad3de7","1be02b9525","cf52a0fc42","c11df1fd41","d49da8b22e","e80bf900b4","127711957f","6da92e1e14","cb4b46b272","5f23358bdb","952ef6a522","578c66fadc","849ca1592b","6faa89ab2d","a8980d4e21","b2e8a5cf08","f989b7e14a","4b2f6dd525","2eee0435f7","700d81e774","4a01d75760","faaa05bffe","ade0b985d6","6f9e4f6890","7e079889a3","168af76313","c60807259c","2fae978434","2084e358da","3f19375a73","fbde1ef81b","8ec2b87ec0","dbd9fe2b01","4b06857290","1bfba48de8","e830d5874d","14a63fc1d4","71b0319228","c1cb636caf","b58bf0e481","9b506163c0","2ef1c61d9f","d108a3b6c6","34bb70d9f5","78e59933b0","2ac8ec70e9","77d44b4d06","82e7800e7c","24a8c6862c","4c938213d4","368b9fe1b9","387ed84c44","44fad01fbf","84c9a55c00","1d2302e9b3","d6aaaee81c","41af9c4b54","ff03f0880d","3116c5ecdd","8e13648a1b","469603f6aa","1fb17d20e4","aee0ada50e","1f3bc00d01","f685440ede","6d65433689","566a962d83","a9bdf7906c","bc19fcf86d","58e1ec72dd","7c548d805a","1002643776","05c9b4ea5c","37dfb73f98","6dbc53fb66","e3f37a1042","cbbbe392fb","142131f870","d14656f040","6589358dc9","50b26521d1","d779375c3d","ed879acf91","1e9b01faa5","0ed4cab5b5","6c7ed0bb46","e6ce55dc06","2923defb73","6f898d8dfc","a377390687","107a6423ef","8568440c18","b6793494cd","abbb1cb0dd","dfa5fcf2c7","9b1ca8561d","e0147d79ea","8d5d0e30e3","bb03e07df6","0dca25198e","926fae59c4","f6255585b8","690ce88c37","75de387ca9","213eee54aa","1d94a05944","43e5838238","96e26e846b","3a5345e1c6","e06d2e4fb4","c9a8d7ba33","0d4c6e1f89","05609b9665","660946e293","bde1e95fc7","4b67a45dd8","5036b76623","44af375c7d","ccee887d36","f8899a7372","d1dd114704","bb93206372","5748942b89","3420213448","4c84c69e46","ce29aa1b2d","66167e04f0","39b9bd972b","ae1ca3e797","c9d02ede26","bb22e16cdc","56302e9863","eb04acd714","17983656f2","d424c32828","43e324ef97","cfbd859ee3","9ff052b2cc","b87493ddeb","b39487810e","6756cdc171","de9c518493","315330afcf","ccb703664f","d00e68a7d9","a018dc41b0","458759df8e","103bec764b","8fb5e33ae1","e2f1ea6d28","97f60bdde7","3c6327c2f0","12d938f193","08cb1a42a2","6cc5cdf5dd","3cb12c4709","fe82e15502","d26198e4d6","eeb79c85eb","85cc671393","050e267973","45b0dcf57f","283bdc1787","8181a38c97","bd4a8b033f","c4c3d11a58","4939b3df31","cf62424ea7","cec1f2758c","e90d84115c","c4bbb509f7","97ee41ca0f","4a016daec9","7043af0547","f5d98f2e3c","82d02fb836","0e8439ec7b","37fc244a04","0a1383c4f9","7971949222","ffd9ea634a","1ed0d1b7d2","80a79c1dcd","b8cb2582ca","0630bbc190","b1cb406717","dd8f28dfcc","cb2849e898","794fc4252f","eaf35eb470","88a25f56e3","83ada5cee9","dac25498ee","2972e68238","2897f7a559","727768ed97","9643fa72fb","a6d08a9fd1","76bdb3d6e2","a2a3e87d3d","2ec4f5da17","c8088ceb86","d9ca2ca06b","5b5ae9d438","fd83c3ce36","3e1bef8044","289e0cfae3","1b0a6c54a1","5ec2fd804b","0e6d57511c","9f4fd690d3","39b9bd972b","ae1ca3e797","c9d02ede26","bb22e16cdc","56302e9863","eb04acd714","17983656f2","4ee812b612","555cab3981","d5ba457a6c","d937f9aecd","b66c31cb85","fe25b313f5","bef57be190","264d4fded5","d5f7518f8b","34db53ebf1","6adb029231","340ad39f59","1abfd53744","e92f53f8cc","abcee8880e","cd57304b6e","80c8ffd4b4","750f9b755a","016eb8bbe9","87d731fdf0","7c3b134981","2e6738d551","887cbb4943","8b90413088","4bb1aa05b1","bc8484eeee","3154cc31a6","13a793d432","abcee8880e","cd57304b6e","80c8ffd4b4","750f9b755a","016eb8bbe9","87d731fdf0","7c3b134981","554253a4f4","0f6b96ca34","caca96d347","3dc00ceb38","972e98417b","fdaaf9449b","e71a058099","5879e2b8f7","5b557738c3","955a991cd4","1e99968021","a6dabc1c3f","2d02db743a","57084154f5","d220d3ebe1","032acfd85b","99507e2f98","df036b3c5b","b383f5ab3f","beff8287fc","6580373109","c4e0f87b02","8ba58ce1b5","37facf7303","9ac13cda7d","0cc511fb86","64e5b7d016","32037b6ebd","e3ca7e1b86","15bad00bd4","2451561839","8567e6745a","27cf3782ba","caccf95ab4","672684c381","684a62ff35","9610c29908","0c9838c4a3","17cf488109","375854e2a9","b2cbc4830f","4fd0511b04","43132591dc","11290c3b65","f4c04f1794","6d4523340b","d99c031adc","64d4ca81b7","f41a1bbe07","413ab7f0e7","4bf70fe7cd","30930e3cd6","2492ed6d59","6e10202cc6","19010e2bea","4897a8495b","684a62ff35","9610c29908","0c9838c4a3","17cf488109","375854e2a9","b2cbc4830f","4fd0511b04","289a7f35c0","70751c2ba6","0345e4f244","5f10f59f4d","9479f5ec0e","c4cfd28a89","a4c5b08103","dfe7a20a1f","6a3b9b6d61","7f4b643159","eb12efefe5","bcb4f62697","97e86f0d84","fc79384147","422a0549d2","e47455e2d5","8ea99cb9dd","325e8cf277","bc8f787a9d","bcca093f91","85693fb44b","e16a5b5ed3","9054cf7ba7","7cb4aafffb","03687f743b","15d03dd3b7","a765ec4e10","437b6c0334","eb6501a031","dc80cc1057","14795c8b71","6c327ad658","b075969e33","fe4998807c","4088fc6fcd","6fadd42344","d4cb33c4ca","3ddde55952","f720e4c0a7","5874fbaaf3","002a27c507","b02c97a432","ad3daf87f7","2f06b29a1e","c178e7965b","bfb8b49e00","d0161027f8","03330e2c17","c846366f94","9b48d69487","c1e356ac81","8bbdbd58db","a3075a85cd","4e0e1cc41b","971636ef96","dfd1d9a293","7feb579af5","7d3bb8de4a","bf36579961","8a40c05199","957c8bf5c5","da57a4a06b","022753a013","2a058f713c","1ccf9a5208","99c861aca4","4da365b740","626d62d869","2dec29a537","cb09c52ff7","08e9f6fe99","8cbe4d737f","54fd437733","0e7b1974ec","19854ca883","095320ce37","a0d147501f","f0effc8cda","17e25a2801","8722b6ac7c","5a1ddf9751","2262b825fc","6fe744248a","64084d6067","d73ef044b1","83e9da9820","7504bfee4f","9f44933320","509908a2a8","da13af5b38","b537098588","38ab2c44b2","3c997aded0","fa7ad6b3bd","caa664e51a","e6e8454578","242404be71","9adbf66caa","717fc572c6","32c389a7c9","87a3dbdc62","f87c499739","05d9557c85","f438272d3b","faa366cab0","38ab2c44b2","3c997aded0","fa7ad6b3bd","caa664e51a","e6e8454578","242404be71","9adbf66caa","1dcdc95de5","35984c4f11","4eb34cd53b","fa20ba82b4","6bc6d1991f","a55f9b6ca8","b9c3479283","b006b0ecf7","3c455f0c51","f03ed27c09","4000e0e233","28ef3f8fae","ad6d8989db","a54acae13d","cde60fa31d","f70b554016","f528ca1569","93da4f844f","a7afc0c690","fcba488611","2454290890","6419a2dcf8","d83e9adf5f","b147704bc9","37a8569d06","37b72826df","6b8c1b45bf","a860a25651","164f6a580a","2e1fd449b4","1646e0b66e","5832581175","3e3a50827f","594583e2f6","f8f6ddb370","48f4924aff","a4448161bb","e673698c3f","76d4daedab","e64741f350","08c6b3c229","c8c171fe63","634f2778cd","aed11576ff","98ea824973","96619135ce","9bc6fee1f4","738a0d7fa2","04fc6c4495","a92b963048","a13b13a625","a0b90f52a7","2c52f82983","c12a91df4a","79eb62483e","9d1a1bac87","1e7eaa14ab","1ca2769391","6f562ac876","ec2d97d892","e548349ab0","a8e91b4c28","cac39de8de","b3745b1626","32d894ee7c","eeb5d74e2f","644b68b48b","b1bb9a6757","acda539568","a4d9611341","4d22f1e75f","113502c775","23a66d2f24","c45d953c99","4f82dd2865","2b5048bb85","085d0d22a9","46a1369268","1367658339","7ab20aca35","5bff4acb2b","6169b0c677","d711ca34c0","43d05fff2c","77282d3fcb","bdd5ee93cb","8e1e307ac9","d085e6e5ec","f41ca96448","94e21b7ff9","c2e868ff66","6084bc372f","32b667871f","a19716c494","53f0ba4008","918d3d591e","21bfeb25b4","556ec0f968","8a0e3a3a08","8b723fe59f","a915cc3117","871faec4f8","e605c02e20","49c1602e76","ea294e0609","6769ed1dfd","81c870c22f","90132a3dd1","bf70f62019","ececb39c0b","b8ab706e40","bf0252ff53","2310a166af","b91ebcdb33","f516a7e570","aeb7d250da","7036a19276","108fc124b4","0ccf8004d5","4520567f71","ee11953228","9da898d3ae","eb3b7c8276","3a20fe120c","a1a0952b77","839209189d","cdd41125b1","327a36ff0e","cd9f2ceb0c","54af058b70","163c7d79c1","94f797ce3d","2a255825de","dd9cf64f55","f1daac477b","3d10f2471d","2b863f7188","35595100aa","8d5a043712","09f041c398","066cbe0d42","4e3d9940a3","5f010bf07b","2706846c32","456f162d8a","de2a318e8b","c8a28c8f76","3091ec31c7","a9bbcccae1","dd0f615965","534162852f","73679ef46c","0d890c25a3","ca93afd8ba","42ce262d9f","a52db8b1c5","b035319d9b","3eda0894ce","2df6f5be2d","25e0b67142","cd9a858f11","a20de2a876","6859ac9fc9","75cff91072","d10dc51def","7e740d7588","e978e68aee","f7f2daa5d5","ba464ee796","af79161524","93a53e0615","12e97cd247","e98f0879cc","43ae6d73a0","7fde0ab486","7b77f85111","c15d8c7bd4","58cee54980","a2b372eee2","2f6c5d0241","8ab5a515ed","1a41244d93","f94c9d89e4","1fc1cd42b8","2b3dc9f045","19de483d8c","c1dc9dc4ed","56e493c3cd","df3681b5f7","5b8cc7f98d","de31454669","95b51b38e5","ba78eb4632","f5032f1687","9f761f10bb","0850af5a81","f47a723b65","6e8c663be5","390ac535e3","c2bba9e798","f1b08bcdda","faf64fcd75","7f9dcaa80a","e1c86f680f","71fee91963","b771892b68","91c29e7bf8","9dca969440","764ebd8694","558733bed7","5b8cc7f98d","de31454669","95b51b38e5","ba78eb4632","f5032f1687","9f761f10bb","0850af5a81","98e03b3fd4","77eec4aa44","5ced4911a7","50798d5037","ce5a6372ee","7f2b2ac2de","8d7df67fc7","079fb9b2ae","184fda6f52","47a7b356ec","1a675b987d","d641220c84","ef239b2a5d","9d8d73910d","76c1318247","94224d223a","834a9987bc","8e4fcf17e4","2ceaebd13a","4c96e066a2","8d09a8e2e2","f7e6108f73","a6a54f91f9","c036b280cc","5b678f815d","4214f3520f","0a84e7f48f","49c61c321c","ba1a0a99d6","1e74da3956","f8705ebe56","e326f98add","b665c08566","d49a78abb3","d7b9f013fa","f87ba86d25","381f013d83","0d79d36715","48b3e11cd3","3ab6774e2e","4dcc0772f6","7e2ffa80aa","5da561841d","e565998fe0","3c6898529e","8151e44299","94d5e6de93","6fc1a4c623","1ed38a9203","6fdaefc86e","9a2d1e1771","0d76f5e731","67464ff8ef","02fb6dcb92","61a7fb7a7e","994040d24f","3f5346d619","39f55f61b6","c85c84b863","129548516a","04e5af686f","b5cc9322cb","4ee50c3484","0d552407c3","05e404ae88","c36bc1cb6d","1d824dbf84","594300a455","71143df2d6","f14719a041","9d9bbb2e0d","48e2389e00","457d3ee068","de5e6d05fb","479b18066c","e76b3b01c1","45829a820e","37fd6e311b","14e278a5f4","aca405670c","582f6cef17","69851854bd","ae000cba5f","2da11844ad","9d9bbb2e0d","48e2389e00","457d3ee068","de5e6d05fb","479b18066c","e76b3b01c1","45829a820e","e32e710fb4","b2967e79a4","bb61dab760","83ae224f45","d183638aad","00f51c4d4d","056cbe5907","c9dcd2ac69","c5745e5666","5258727421","e9de203650","28baba9e52","c0566f7018","f14d930b41","e32e710fb4","b2967e79a4","bb61dab760","83ae224f45","d183638aad","00f51c4d4d","056cbe5907","9d9bbb2e0d","48e2389e00","457d3ee068","de5e6d05fb","479b18066c","e76b3b01c1","45829a820e","bffdbdf9ed","3fd96feadd","406b8a416d","5ac9cd05eb","40e72d279f","48f8186620","06476a052d","1a98feebf7","99dbbb5558","fb5fa62046","463c280c0b","9aec77b47d","9725f3e2ef","897f63910a","0979f4837e","c3492922cd","54b504cdfa","1ee896aefd","179f09884e","943e393d63","55409c4d5d","0a07cc8998","81b4a76949","016cdb1f2f","f54ad24617","f23e45b696","f3974f2ade","363a46e8dd","850533b864","9cf93a04b2","7ee28fc7d4","ffe1a104f5","501b4c3194","a6d1ca2b94","01fb3845f8","e71b14b64b","2d5ae04d46","e53e9e7f72","166eb6c9c0","389ce00102","a105ebbc4f","6861959608","d56003dc11","dd4d6a5c1f","c99e92068f","93b2fb8f63","41fd913648","f55cdbea7b","84e2cf495f","30d4fdb0c3","0006455492","9ce8d85e60","052a05ec21","e0042e22a5","61d2cf1bcd","9330bfc4ce","e71b14b64b","2d5ae04d46","e53e9e7f72","166eb6c9c0","389ce00102","a105ebbc4f","6861959608","0a07cc8998","81b4a76949","016cdb1f2f","f54ad24617","f23e45b696","f3974f2ade","363a46e8dd","23ec5dd240","7bc16bd0d6","3f85a8eea4","5100dd75a3","0ba8422e18","2a18fcbfa2","637b28e913","6b3f5e3895","d8b014ed0d","26ff7128ba","b92cacfa3c","0fa1c66bc5","2e509ee621","b040a6fea6","94686c867e","94c80ea780","028a87b759","20deb11a90","7c37247a20","09b5422181","3ecc28bff1","827609f5b8","3dc703a094","a4bf4ecd8b","a109a58aa2","e51d999723","90bb1170a5","8ae0781645","69d0bd52df","9bc53b98b2","86adc4ba57","8d1cdb7e28","81efdabae7","19e8aaa967","fea5cb6c05","b541b95aa1","0eac54e219","d80154e721","e9e49a718b","90b3e24f2c","229bb93aec","78d005ff18","4117fd829c","7a39a0aeb1","88a21d24a7","98f7a2da70","cdb8d611d1","6342be220b","9901123f37","4f5abd862f","cd43e1cdfc","2ef43d8b4c","81387b3d57","a4ca90fffb","34f2cf738e","83621ff1a5","b510473b38","e850fc0c80","f280d1efe9","b833d674d3","471fd1d569","dd3f5bce2f","560ca724e9","8c7c376902","7a30ca93eb","1d63273dda","9217d07065","923f333be1","1c4fee975c","8c832dc214","bba0f71e85","8bbd992c6e","00f79b0509","146868d6dc","a9c2d1b025","b615b651f1","986e37abc8","ea3675849c","0b6832f298","46b5937230","9450e16dad","7df7e830b1","90693af81f","72a5f72976","480481d65f","50148faa3f","54e85b6613","fadd16e565","425f749db6","c30ab2a761","3e154bd2df","e81d81a72b","e88f2ce773","4bd58cc0a0","91958e674d","8aa569435c","892cf94e6b","a298b3cebb","f6e95e6f3c","42031d6092","cb803faa61","8d875cac25","7d2519cc59","b1246b13e5","5fef4c0208","0975cf028d","042d39ac65","12b9027517","07ff44004f","d65f264553","0154ed0cd3","6a4ab11308","6aef4746cb","8724af1766","3dc9d9622d","31e4ea4215","d0751266b4","f2ba7fe46b","71f6cad079","b3e3181bab","14e864eac8","e91803480b","ecb2930a80","2acd482f50","9c7a110dc8","672ed5120e","0f2c027791","99a466798d","a0ff5fd178","9ca2ccb6ea","bdb28ea896","4726d40e61","b2457d88ea","23f7c3b6fc","46638b2eb9","bcf1d700c9","49ae0279d9","8e0ece2410","07caf2a724","f930d539a3","ed56e6d438","61c44f4dac","acaed14e4b","bc478538b9","135da8d4ea","e4bd2de94f","7257baced3","835f48bdd5","d99af87088","b628d60c5a","b05fdcee11","1f1c3a1458","19f3339078","f426a04328","66cf4b01f1","c2df41ae32","ec300bc0c6","f462c111e3","0f6b4324af","66a2a484bb","7c28ab6499","3509333519","63d8eacc9e","794030157d","beb06b18e9","6a54880130","8bd88d28ce","09e7453270","265af02d43","a13880bea4","0c29c28ccd","dd1881a655","95f2992a1c","3f0e91eef6","f9f926e7d5","6222c2e545","7202a3d164","a021169671","7bb448dac4","3e8a5830e9","7e357cac29","5fa4c8d404","e30ea89ec2","7dcda68a2c","4042c76774","f9d1b4516a","d41d034233","c39338e7fd","d4cd6b8dfb","55ff016a60","258ebde027","f38d845462","2459331a8e","6aad34e086","1ef2bd6819","ecf4df6082","4183d7f09d","66c08423d5","2bdcd425cc","2b89ccfd4c","2faba9df77","83aa83c4b7","a3b609fcc8","a3c7f371d0","af2fab6309","43e0cbf425","e9d8d34599","e62af13d2d","e10ebf1824","0b76be5afa","e1f5ced72a","22ca5b3b6d","0fb1b2f161","f3db1742b9","25fa63dc02","15f6405fd7","974081b951","1ff6bc9cf9","1ffcbada73","b9fad8a9da","9856ab18c5","487b3b2ed0","f919024f79","0661e99082","1f2eb62c3f","bde1c3f1bb","fd0eed6d36","171605fcd5","513fe3795f","600422ec0f","9e891855fe","c99318747d","646d2845fb","3ee684298a","0bb23053c6","e6c23923c8","bfced4dbc8","40910d5472","32572b3c69","cd2af6a0de","7b91336a11","9eacd2e2c6","36078ac2f9","a471c69f4d","f419d66a94","de8b8f63a9","8ecbd06e96","d15c326a68","905e807ee1","3d568837ff","57681a687c","f4fc274dc9","c07d61ecba","b6e6f3a602","c75dd98037","28f1730605","20564d1c53","d73123d7b7","ccb03587b9","265f4f85f6","01cb65a1fa","7a9a36971b","857242d33d","d424310502","834f017a29","51b7847a7e","a86ffbdb1c","7d59e23711","5b805370ed","c85c16a466","acce71e19d","1274f821be","acb4910791","325edf0e76","8293817411","3175fc97d4","225e7cfe61","cd7378f06d","64b5f705a6","66803543cb","057334082a","e478705918","63722a397e","ab06a788fd","cafe6c5e85","bc6a57685c","589d984e4b","7fea4940ae","eb0ddd5396","742b654cc0","d154bfc6c8","ad387d2d38","dd58f0b765","86a7f5e9fe","c45d0b2fd3","f49ef94ce9","9fa999f8a7","4e221b87ab","852c32d8b3","6f50517ed8","bb1dc78041","bda86abc78","c7c2ed88ec","f891fe10d8","3ffcc0ce02","99d9c51854","2d101254a9","98c2a3868c","37a60e32f8","0232abd316","bdf5eac8bc","74e45b9e4b","74b3114ae8","a197a6356d","d39d67a33d","b62bcb35d0","8f2d663b90","1f3628ddc3","34c25c6b40","2d4c23a939","4686e0c4bd","2feb43ca6d","24b1b45595","ae616e7aa9","4e46433db3","35caf4ba2f","80d05fbf55","4277c5e74d","cf1cb2b7f6","61d90b9a68","e21bd3bd15","2932ba66ac","34acb957a1","0f3787b822","67f719fb41","bf2fdf6244","b57d6aef95","f5ece7d6a6","aa60eff240","01548ea5e9","67b55514f5","c6c62ab32b","cb951822a7","4723674d49","e74726758e","ca95c3495e","6a4acb039a","8f861a50b9","d5567cf73f","a1dd4d67f0","8548d568a8","b9f9289d72","42d1647113","45fea7ac89","739c13674d","cc2562f168","64b89eb35f","e581948a7a","51d53bf9f0","16a704b41a","8d8b1aad0e","ab10de819d","01e7249cda","661cac64bd","9645729c6b","5f2663affe","3acdc827c0","feb4806c28","490c3b39e7","25d4a725cb","08df09ccab","a14cc88245","8f982a854a","a37777124a","595e3081c1","0c52671439","cf7a6f0803","0ae02bdc08","95664d5fdd","7f7f10e92b","d086a6c927","ba2c4a7d5b","2c19a2f463","db4fd6589a","75f402bfb7","a7ce53ca5b","a64ce6c62f","34784d8b3a","7a5053a239","c2eae13b9b","b2480d47b2","7ddeb2f666","4b1a94c70a","5dc98d96a0","eb40937b45","9772df4144","4c65c664fe","8be3fe0b33","2b3d39fafb","0ec32f2698","8b33565d79","accb45a1da","dffd4fbb1b","103f305261","3302baeb29","e8f8c375d8","3ce4a1a82f","dfae00ad21","32c00b4f55","18eb8dfdd1","49e1ee2fcc","bcfb461e05","7607194160","eced14b0a7","a9552fad12","a26e090721","24795632bf","66edd77c4f","ebd675cac5","9d518648c7","fcd24ab5ef","8dce505aa9","bdb7b8795a","801c1f7b1e","b1f652ac3b","2f334869ed","90ae762293","abeddc4797","d896630ce7","3580d6f0c0","eb1741578b","423a37b7d8","1222269899","780ca2991f","a489956d31","95716dd002","1b388c5d6f","2dd8102f64","78e4a03cbd","772b952777","5f7267d3fc","af4430e1b0","8966fb5c1a","eddc157bc4","eac41b76cd","228db41860","67261b4d20","037d6a8504","03a0208bdc","4ae717bd7c","1f2d82d428","c6e4c144d9","bcafb8e3f8","11cdbae1c8","b2409269fc","e989f0ee27","b93f70c898","06594f4bed","469bc28f64","7aead8442b","e0580bc9f6","e6e97d647a","bc733084dd","ce28cf92d0","3d4496aa16","21fc599d7b","b6e822e0e9","ba35e95395","b8af4bfebe","f96d2128c6","08349df75c","05ed5cdd01","c897ab8812","b3228a5362","93e789658e","ca6ed087ec","da52047730","b2ddcf818d","5f5f4949bc","8e12f010c4","6b2b20e205","b5254bb9a2","8e8ccef967","be571adbaf","5c88c907fc","bc6c1dc394","7fd39ed0ec","400036d3f0","d6c6069888","288da4501e","e989f0ee27","b93f70c898","06594f4bed","469bc28f64","7aead8442b","e0580bc9f6","e6e97d647a","3d18d9c276","b511e2a714","7b4f4fdaf8","13274d1d9d","d165e8aa71","e989998c61","7ef2269922","9dbd20130e","2de7368368","8580de4865","4d8add2112","c3c6f2cdac","5cd2599d09","156d4c8269","3a400468f2","3b768e9f62","f19c315a23","00ccf39314","04cae61ab8","4fdc233392","0ff8d47a17","4068445931","415b4f84bf","cef204ae78","1a6deb0212","56851f8333","988f2d8399","bdb61711c5","729ebe2bd6","5332ea83ce","487c37ff9a","95e484ee89","23e4a78a5b","45e3618461","d329e1b838","3e570b63d8","25df15b87b","2ac5c37c38","6de296b6d7","cef24a96df","f499cbab2e","dffea9977c","800a17892d","54de12f496","7eb20991f5","155cd8f2b7","e92d2b862d","f65f2b2c46","29687281c6","5bd6c95339","10bbb41245","92afbd9742","eb55af0198","12350a7af8","4adf173423","f4d1ddfc32","c226973189","dc0a69efed","1e29d226fd","9647cc68a8","2cd22efa4b","aee8c77bb3","d90004b3b5","1d563b8801","b283099435","20d7e698f1","efd8916912","df84ca6158","6f91acbd72","816a70e62e","62e10cbcb0","6cf3ec9d16","f61a97662f","7971ff8066","4ffca4596f","3f58d1a3fa","f36cc9c1c1","76abef294c","9f6a828b9a","893b14aa63","5559a12b1e","ef263c7d1e","7e9c4b9a7e","939ae4cc03","95f44af04f","3bd6bb5dd4","8839164827","8ab32f8ff1","f2a9531eb1","b5e7ff8f69","36bc1c0152","13623dc687","dab578c311","c9927eadcd","8eb9624959","d83445dcd7","0bb2695079","5903758747","fb6246aebc","8e2a287817","c8d4520521","7eed88732c","45ab00ba94","b0e2b3cb5c","b73a35ccc3","5a920716f0","ffcb4f9750","3faf23a693","68b70ec665","03e9fa9901","48cd80cd7c","da9dfd459e","d9478569d8","f7e9162c92","61d1969660","cc08a41355","5512b27cff","e93abfe1a1","ef45910c53","9bf5c3b455","70693c6e27","5967e04f5e","4287bf31b5","266f2a3fab","3e24c1dd6f","ca8f269631","0afd2c848d","c12a301f82","dadb10fdbe","7a5b81d402","d4c31ca49e","49f0b26954","23152d6e8e","c18f6e5e87","f8be1208a7","54e1644e03","89b442b001","829a542289","7b4f3a34d6","fb62aa6c33","9d57893a8f","88fb42bd5c","2736bec3b4","d445f12e2f","8b5b2dde67","cd35c3cae4","81383b03af","5532f9c1f5","01e7f31bdb","9c259b58ad","7f4af01c0b","d9f5e398b3","caa027e9cc","141ccece50","9620a29592","bcbf8fbf04","bc076454c7","830871fa36","a061dbbc69","4eead07a6a","7f3ca99c70","f1a16cea4c","c24e4d9b3c","856ca4c33a","1bc003e999","21b003c8cd","423c0c22d1","d2429805b2","27b10bac57","428302280c","c54caab9e1","cc2a9cef55","6e12549d97","cfcf281913","0b8fc452ba","38e3ff973b","2e5565776d","f90b1ee01e","37862050d8","a0b9895ee4","c31ac7f1c1","1f0fec20bb","441aabda88","4f4b53630f","60e0c0a315","368de77892","093785e111","78c6bf7838","1d8862fc78","3406c98196","f77e0536a0","76fd51929a","6252fb136a","6f2509a63d","e59faa9278","21f991ac46","b12b01f750","029bc6ef03","36dcd1b413","a50fb5bbb4","6927435d58","79889d122c","48e5231685","cdaf8cdcb2","8eebf4e758","ac06d6e60d","9c7d69c4f4","78602f719c","00f603ed96","2678c9ef8e","e8407b3a6b","331da8fd5d","6ca367fb5f","fba5d7bc70","1510142dd5","48bc628d7d","120ab06aeb","99c68c781e","d3166302fd","7bb4aeb243","2669490845","ecf384e008","446290faab","0175ee6820","3406c98196","f77e0536a0","76fd51929a","6252fb136a","6f2509a63d","e59faa9278","21f991ac46","01fd3b9c8a","96358326dc","42e7010174","e2b781d400","0ae9895959","9588b62b7b","6f10e4ee2f","8d533c4059","852363b23f","8a53abfd54","7ca0b7a1bd","f3daa377e0","37d676c819","cda516ea6a","3142996221","6a546ec047","8970a80700","a553ddd086","1216039bd4","e6d15e0df5","e34f1fde33","1ba6a09c90","98695ad6c4","ccf5a0c337","e6693cb55b","edbac11c9a","7763df12ca","50a3a2ce41","8661bbba8c","e8e2240890","2875322132","937e8871c5","66e9c90e01","bf04c765fb","fbc1c21167","8661bbba8c","e8e2240890","2875322132","937e8871c5","66e9c90e01","bf04c765fb","fbc1c21167","61026a11ef","bf888a04ae","b2f95d29c5","090905ab37","6dca1cbf11","b3c8605239","d7a69b9ebe","3cd9998aa8","3544096dd7","fc9a0168c2","b068ac2725","f76cc414d1","5e9bbd7c79","e39f811aa8","efc06dde78","ef31cf6dff","1e021f5739","4d167095fc","96409ecb31","e5d883cbd4","08065c79f4","84e482f597","f27b9c89a8","745e127513","2180276936","b56c383199","4620763521","2cfc2d9283","ff22b99416","0d98611282","7089438bb4","79d620ef6e","b97ceca815","b290aea54b","b319a7d6ee","46a12c7f12","087462458e","c59083ed5f","f9b2a99e10","d38993c73e","84a4d30849","057e600db5","17816bdc80","a191d50ea8","312eea7483","2db929df20","af5cdc3af9","4d868df830","014c86b751","46a12c7f12","087462458e","c59083ed5f","f9b2a99e10","d38993c73e","84a4d30849","057e600db5","b406a139af","46e7bf82b5","75285b2e31","13cebecf2f","fbcc96f72d","4d3be85a24","9d2739aebf","31c1d2e2fa","b09bb19732","692567bc63","4ad7159be9","48801bdc6d","306c727a14","4adb408729","f120098f08","5771631114","76f18fb376","5ff6195b9c","ee0ee2d486","f9a6333c61","d9531da89e","ad14d30c9f","1a4fc60f88","ba7c2ef56e","81b1ccea7d","f25ad6532c","371612922d","f983cf8ffe","ad747f76a1","70a52d5aaa","bf0cffb54f","6892221ef9","886061f307","c2f144e68b","edfb34db6b","7b56b3fad1","b0f7259dcd","27c86070b8","52c463986c","745795d8f6","22ae863a55","a27a62d474","26d664d26f","17d289f62f","822ccb1190","780341fe61","f5bbe427d8","118eec9716","bdfcc8dc4b","3c4eb98e14","ae20719375","ddff671166","d8d1422022","80428ce34b","73d3e6fd1b","2c29e55c53","e434a9698d","c8f4eac6c4","2ab946872e","71368f5b6d","069d453fe3","420904574a","e611e267f3","4b4dcedfde","601f90a313","36ff1ceaf9","d1914faf8f","b360b6ebe9","3f19bee03f","53b58879e0","3f5e2421ad","16f1d38beb","212231b27d","30eafcba87","0eb20a4dfe","b1412627c6","8914b14ea0","461d490b87","978dc4d7ff","6ae2d616fd","da26c1c5d4","1223aaa3d5","5e4c3dc211","39eedf0e83","45c8b2185f","4eb8f3e996","a5cb7ea2d4","68cebb8800","a94687bc8d","d9484e504a","b8b74c474c","1bc8734bf1","d62eb16348","d549520020","ec547cc2ba","8530acc772","4755a97a89","1cf1e99931","3f5e2421ad","16f1d38beb","212231b27d","30eafcba87","0eb20a4dfe","b1412627c6","8914b14ea0","a4665e5db4","3475bf082c","ceadc02f7c","d474634507","95b11d5ed0","363efda4df","2712776799","c1ad9b8f3a","c452fcd4c2","fa78d3f02a","7b6f34e264","966b628906","9e9d326a1f","377beba48d","6b9cf4af95","cbb5f04f65","b27774ba9f","0da867c1f8","3a9b42a450","bee0439a19","a250c33346","b5b05f40cc","730e4f113f","3451deda98","13d6a80cd8","2910e25415","d17323f0d1","b2c1cab37c","1e4ad331a6","45cbfff6f5","07ee60ada5","1d6c748464","1503121c23","76b99563df","7a26187365","6cd2b69d7a","c4c17db908","12461e3e20","bc70cfb72e","09a0b91943","5ea06e2b1d","46ddd54ba8","9f4f9b398f","1a4f09cfbc","589a6998df","095f1b4c6c","e48b150bc2","d463c5ac82","7cc4265e78","9887cd9a85","d8766737cc","4041efb41a","8cdc56d087","e7aead826c","51269ebe7f","04d6a6f17f","1e4ad331a6","45cbfff6f5","07ee60ada5","1d6c748464","1503121c23","76b99563df","7a26187365","d73517b186","dc04d47038","4a0396845c","3ee2528292","3cb1b33e54","447e7add3e","9d2702d9cf","e3d6c66d79","c3030066e4","ebc9e34d3f","399bf7aa9e","c9646a8e80","1ba08d2891","074e9550f0","8f255c8d09","1b5cfe0e1c","5fbc4960fa","982c1c65b2","cd730f6d39","00c8bb41d9","8ef852a8ef","24634f8a24","9dfe363b6c","e04f28170e","40b2e436b3","f85a8db0b2","e3234be2df","cb8f21ea0b","644515e650","727b828e2b","69b4b67516","500cbc480e","54ec1cb7a4","a466df2fcb","fd4634dffa","3b1c53b0ca","07326fa815","8ad1b34085","76e0bf4c31","5ccb2fb317","ab296d1ebe","ac50daddcb","103f5750b9","b0471ec320","b680bcf8ff","b01b04ba17","0a13e964da","a713598ee7","fd158267e8","66c5735760","edcaeb4692","22c53b268a","25f44a6e56","8f21f6f174","be8a733fe8","8e48f6421b","a41c93c9da","77a74e41b8","1d0fe27b9a","7eb436a4ae","14fd06abcc","d7511d3ef0","995e48958c","ae1d8634df","3b0ab4c518","54553de9ae","6b938d3cd0","03db8eb4ae","607e8f74ce","80d5de4fcb","7248874fef","05172ca640","776afeab53","fe338a1e3c","f9eeda4fb6","578775e8ce","5c91e97110","798f708f47","8aa5425cde","bde3b7a51b","3f3cc0c6b2","ddec48c41f","a5e3146890","d16bb210d2","335a1ce1ea","03ae70844b","ca8142f4ea","7d9042f453","4ebbb2c6f6","85d1d9507f","f1a0472c32","7c93cad3ab","4144491f5e","ef30107e98","562bd53f2d","49e3e3be3b","22b80c5d76","94113bf14d","47fddd4153","86ced2ac7c","e80b4ff91e","bb3b5ad6b2","8e4bf0a499","aac8db26c2","b65111751a","34c9f9899d","f81c962015","526c20674c","28b60994eb","a38fdfce7b","42476f82d2","759a1a1e5a","9bce938ac8","47fc45e5f8","ff5343eb5c","50ce67a2c3","434e338ab4","c72139291c","f7d3bc016b","2bfb7b6f37","0abb615d8d","1ef41433c2","22bd0e4b74","d2d140887f","2cca6715b5","98a9ee79db","101dc1b97d","23f14c58b9","1df37b31ea","fcd539d49d","401068a708","3610677f70","0c7230c5e2","003d087da2","9614ac22b3","dec9c09096","a25dd8f94c","a8b2d29f4f","86f53b40c7","0a424e365a","1b6b572342","8bfd4bbda8","c8beb4f9a8","959ebbd84d","909081d2cb","9140bc969c","13ce1449c6","b05b11b536","2f14717e5b","5391d293f2","6c6d584ef1","8007a4daac","d0792dea3f","8f4a402222","49cceba3be","a240b6d6c8","b36a1e7833","b05dc8082d","e7b81f3913","b34adfde95","120e37b920","49fb64bda0","04557cc850","071b608f5c","9d534a7bcc","71bde17d7d","04406288bf","e75f97ceea","a07446f8a7","e39defec29","d231161ff0","eb44b03632","360a8550ca","f28d1a1272","c3739fc196","640edab067","0d3f80f0c5","83f5a1d358","6918218fdf","d417ff1523","8138cb9f22","7af46f1d25","dc43a77549","54d5f2415b","2ea4adacf9","8406924334","3033841d62","01194d540a","d656783f1d","c0fea86645","971ad37870","946cb73478","3ea111ab3e","420c1de4a9","efc85326fa","3f45858b37","504bb8a7bc","28e326556c","96ae276fe2","c41d02a773","582d45d116","503b0899d6","de3be879ae","d7fd3e243c","04450debb7","e1dcea2984","63d265fe4f","cd61e089ff","3133058fd6","7d639a97cf","640edab067","0d3f80f0c5","83f5a1d358","6918218fdf","d417ff1523","8138cb9f22","7af46f1d25","62feaef800","e210eb35ce","73917434a8","c8c66d4c11","cb8a528b5e","e6f288e576","f8dc4146d5","509b3a2bdf","e2f8f06054","0322551460","5500bf6987","60fe5e140b","87ef760069","54fc543f17","d0c5509d50","5a3695d45f","8119a106d9","34c4834c2c","313f36cf19","73bfc3d0f6","1103ede239","9e88d560eb","b62ca15ece","409f1bcd44","2dc9905d03","3aa3152ed3","7f2dee621e","e7ad23a69b","2198817b22","0221daab81","99ee42188d","3ca93d2e4e","8e72246e22","9e402b5881","3669df5910","b8fa264d22","4023ee7ed1","d9a6766cef","6d458585a0","267d2dd87a","4e69c8fce1","8e96d81a6c","b8fa264d22","4023ee7ed1","d9a6766cef","6d458585a0","267d2dd87a","4e69c8fce1","8e96d81a6c","0d88efc673","2bdc173628","da92d4d411","ce4b7fd306","2009e19c0a","2829242d09","8f3b6873b1","1b3c80a1c8","21730ba282","a5f6325f70","06eae7d4d3","51cf7a7314","9a799859c8","fb1f592ef7","aa3212b338","050938dda6","e2679462c5","e1268bf372","abb47ebc71","7a237ed97d","885f87117a","84c5bc4f72","7b56b60932","341f8e190b","c160032463","cdc4087091","14bc473dfb","94260af36d","2a0fc403d4","b13a71605f","3eabdc5bfa","31f4bfdcff","0cbdb2fe87","19c70d30f3","fd2466e4a0","349840d8d2","979bbdfb80","d960297f66","f04f5497e6","3b57a74fe0","9807944703","6977f39164","8836eb3c80","69e4b22bf2","a56c931465","fa4790ff52","d8feadbf46","3551548b25","0e3ee71731","96b8490d61","890c543780","ae9cf465f5","35de7fa43a","aecec9a0a9","a17b7d8979","4aba3b95bc","19fa6adefc","16e01b059d","56f62208a1","192b01eb78","118c8de59f","74e0ec72cf","db357b01eb","88f50b5f4c","e865dda615","23548abe23","da045196a3","70703bec29","e07331b1bf","0d700f9018","9f212afa37","11d6407f61","51c6ec7e6e","61c03c26e3","66554963db","b35c822dce","902e0e34c8","4b4fb2c593","204a94cf89","ee5fa484fb","fde002b000","754b07d065","debef9e43e","c7398c12c8","db79f6896b","ab1712ef42","4cd965defc","9812d3b0ae","4563761e24","c9ca63d8be","c56c53a88e","562b484997","634c132de4","e859cd56c3","0f090b8d08","efb73c8438","24659a3fc7","e501d9863f","20c5960bdf","7f244f20da","742235ecb7","c19a36725a","5bf339109a","dfb1bc6cc9","595f4bd04f","4978021eb5","e6a98fd472","1b672f1341","2da9d1506c","e0b6c74162","da69205867","f169ff3d5f","885a4f80f2","ac1ffcb3fc","72b7d2ace3","9408e568f7","5c010ed2cc","f03bef8bfc","9c4c69f7fc","082b6b690e","230a11e8f9","43a2d0b0a1","9c86fd6e84","8202df993c","fa8730e7b1","fa4b99b1f0","1b4ae9572c","8cba566bb8","d7bb618b26","08a67c9023","526b9c38a5","c6b44dce96","3b5333fbbd","80c44614e4","65771bcbe8","fc4a046040","0ac56774d1","688a41013b","6ce5b4dd22","126f5a3efd","c75cf37f0d","6f0db38dc7","6d059564c1","d87652933b","7fca7f61d2","8227dbd187","3d060a6273","c75cf37f0d","6f0db38dc7","6d059564c1","d87652933b","7fca7f61d2","8227dbd187","3d060a6273","249d642558","6deb996616","b07afb5ba1","29a7d57143","82aa5501cc","40a48f9102","ce63f3ed11","fda8997bd2","d59bc1ed7f","eb20474875","bb5ab82fff","50e9028ad7","089e0e12d2","36d96944c9","c75cf37f0d","6f0db38dc7","6d059564c1","d87652933b","7fca7f61d2","8227dbd187","3d060a6273","09cdfb6b00","9a5ccde2a6","bbb32de136","02b250c084","bdae37d188","8010368be5","d6e7fa55ce","239f0bff39","41eaeafab1","1c9f72966d","98bd2b0f44","9a6040fe76","1df630f52e","682e2178e6","1da82247e5","aef42b96ad","36217a4269","47553a22ef","de92286a14","356b005e1d","ecb9666811","b77c9120b1","213168b937","d98eb921f9","527d1ca01e","ef25a303cb","c16b85c470","2299a6b2ba","59ac9c259f","e1f8f6dc5a","07395952b3","32008f97f1","54fe4695d7","501494ba40","50c6e9a76b","f6d0529283","c450b72561","c64757dc85","7420566be4","61b2597eac","51bae68dad","0ae7933204","3a010f5634","59d5c0c5e7","7e0910595a","86bd94ef0a","d09d927e0b","ce95066455","5c8435a313","5f12308206","daad9b5060","4ef672beac","b65f5911eb","b6a37ee9e4","85aa9a3a55","864087858b","bfcab86f08","2d7b78c324","22c02e5679","bc6a7a5d07","c91ca45bdf","598234a202","73fa655869","043073ef02","f0f6aad4ce","327872aa7e","5b7989e647","52c82a63eb","3ee073a10f","3d701f8443","071a63b4d6","582b25b489","a234d3faad","ede6ba55e2","08342799dc","8351ccfcf5","9b5f60c469","d8bcef5774","4993011730","48319ac195","f047e69f8a","286d089ebd","1388a21dd8","e12bd3b33a","a6b2559277","c3c50b827b","de262509d2","356338407e","517e4af85e","c528080823","351c21a4b9","4bbf26ca9f","22b35a317f","c76ab49a71","a6a7d4d070","29d46c91f9","23456a2e91","d5cef19b80","f645db565a","fef4822f16","73f0ff4e70","7a5a3bbaae","dffd4d419a","5bc18429ff","2754c2caa1","7be6feccb2","a03f799123","527ef227ce","6e76c08be2","2a95e24fce","2317eb615a","8588fdfd9e","ed4cddf2ec","99d259bb71","af993bdbfe","da9a9af398","6a0bfe76cc","60e33a9d1b","2ccf8332d5","8fd8ede0c4","e4f09566f8","f8b9f97514","cf72e6c802","e19f9c5477","9d851fd64a","f862d5ad85","e1c4bbeb90","2528985671","0926450887","f4763bc7e1","399f8f4887","3b3d5e788a","a2e18c3e5c","63339cb438","bee9ffe760","84dc22a9e8","23ccd164eb","cde632b134","6aed123842","aeed8b6b64","8829c142f4","1332c632c2","223a895945","ead9853440","b206296e61","02046ea601","b974d31432","3f2104479a","38c299fc5e","c8eec8f582","da3a257744","384a2d1fb1","aa43d456ff","204ed8d4a4","6e979202a0","f82f558366","f1522602c5","642d34ae90","d13357a05e","d052d90e71","a2e8f34551","6dfa76f3f7","df252eb256","516cb6bc59","21ef7ad559","893918b25d","82e3fe32c7","ba10f044d4","cf3968036e","59ef9bc8fe","78c986ab55","53d5c5fc93","2ed8a4d990","64a87c114d","47324205e7","5e79a2042f","03f7b56edc","89fbc76751","f3e8eadf56","89ce4fcc50","72cf8b3fca","5326088724","7617d06b4a","c898efacd3","7243dfee5e","90cc70e561","1095dcbb94","ebe3734c63","7f6f30d0d3","c46be59b28","1cf44d62f5","d7d0f395db","c435eedaf3","e7d8b2372d","3fc6fd12f8","11016c1706","f974aca188","79a212fea5","33a5a98659","509d82711d","542d542d0e","4236792ffb","a0b5278ace","703730b8b6","45ff787cad","664980821b","17092aa0cd","8a6309502a","2196e961f6","ca508d4f7e","ccd6cd191c","ada630e765","41a523636c","08ff00e2a4","2be260270a","6dd4245371","489b00c417","eb5469048d","7d9391004d","9c8e02ccad","b9a6712641","45b4a45024","0cb7c43e1f","3e2bed0d61","df96134e1d","7e9772c518","09df1ab482","110360de38","7a017149ce","c5a9e26367","a081779db3","b932291de2","2de308b0b4","fbc14d4dab","39bf8d1b6d","4eb8250dfd","65fff6a154","a94e6b56bd","365c7eeb54","66f2195a01","9c8906bc0c","f92654995b","b4facd308a","20933e5d96","bc6b34e1a9","a644ee4b7d","e2c6ed43fb","8dc4e6d14e","96599f6bed","64ea33b2fd","46b378e604","c0d06fb5f3","0bff6fbd4e","db8d940761","b4355fbbc1","afb8c4af95","bcac0ad3f4","5b68063920","5203df60cf","1a16bfaa1b","8aa9cc51c3","29ea58cfb2","50ecb35816","058d00c683","82b04c69b2","ff5f0dc8e8","0f9474d1b1","67a2a40026","d63dd63dff","5919e0d2d9","fdc1111907","9806542c63","b6dc040f09","e933cce502","f728aebdbf","d8aab890de","48c92442d6","c452c20a1f","589cc0ee93","e919cd5cfe","2faf280e69","494d555f46","342252d950","c3440b1e21","2876f26e8c","7828758b41","089db3389e","0f9474d1b1","67a2a40026","d63dd63dff","5919e0d2d9","fdc1111907","9806542c63","b6dc040f09","c79d3e25e6","cd1e887f70","47364d2f33","b769fd870e","9cd0ad4929","7c1ca95c94","f17d91e04f","5af67cef17","53e2373d3f","e5b51bea8a","182cd6e2ef","e8f4b5f4c0","17d94f0434","4ba7481c29","a00894b8a4","7e1e5fc731","e72ed50b21","930f940f05","81c71f180c","e4b793e1bb","9dd825f432","f69285ceca","ef06987a70","dd98148538","16fa072b55","20542413b8","238130f152","835bdff474","1a2c733528","7093b6312b","9ecef21a8c","03855f0eca","7174f47434","f363ad7fff","229bd5d4a9","64c97941d5","28b68c0809","625368017c","ba137f6243","51a2da72e7","8a4ef114f9","a71b92e8b4","ace480e559","ae32901c83","31f0db811f","63aafa15e6","9ce5dc8636","f904571b89","cc99f30b3f","a27972fa89","6262f0e840","16d4dd2282","fa9fd3bfb9","91aa4560af","4defdc2c5b","6ceab4400d","2a23f1a28a","b3425f5449","b1ff5ed518","00037ded6f","7295ff4c4f","b522526910","aceff4217b","7220ced778","eb698f3506","448729bd38","f6a308ef47","9129842e7e","1053e5c51c","fb3ad82c9d","f42ec01e6d","044add00f3","8ee499919a","56fe9a8f42","ed72cb6724","e399ad77c1","1ce7eff0dd","c347209068","1d1bd5ca85","a18b60abce","2acce93cc8","f2b6a8f93b","eeb821976c","58626cee66","b571a8955b","bb37938da1","b09983a02c","8f9140acfd","e557a393af","91f3575402","ad9963cdc7","b70d3511fc","1539573468","7d7e587ff8","c771b1dd13","c4f5b662c9","b1cd448ede","43c6c7a268","6f5a515548","bad48e1492","983402cc7c","c027bc7313","d52d7b16f2","b77480f1a1","9e80abf6f3","3bfa394832","feb98b8274","2e66086842","0294321cc0","f72f318a2c","7c375b6788","7e2e52354b","87b4b541f1","a5639b00cc","96436ed00c","09172c9884","a966fd83e5","1698d28918","0fd4cbe563","31221eab59","ff2df35d5a","8bfd6e68bf","5d3d4f45fa","3d778e4268","45acc5dcd0","c303bb6828","7136e40e2b","6dfb30dbac","43e26acd5a","14ec020672","adc41a4325","c76bfa1347","6b6089ef1e","28b1ee3ec5","3447dfce43","bda7a6094e","52295a0c77","3a38bf6e87","9511534449","02cd49f29a","3bfa394832","feb98b8274","2e66086842","0294321cc0","f72f318a2c","7c375b6788","7e2e52354b","80bffb2ee8","8dd1cce091","35b766c77a","525b17ee7a","34b31e0bc4","415e16631e","8b92c469e4","906752809e","e3f1a9cf07","bb9659fdaf","c5f7f99c4c","9ebbcbb722","00a1dad837","4958c283f0","9e0db7b26f","bea3af7e5a","b79311f6a9","62b1e7a5e8","551edccf4a","1260925227","2b955f2061","1a1ce32883","f966c57b31","fe65de0801","b75f29fae5","da2abe898c","4cb5b16ff8","723094ab94","9e0db7b26f","bea3af7e5a","b79311f6a9","62b1e7a5e8","551edccf4a","1260925227","2b955f2061","ff6a53f00e","cf7a6e3370","1f2cd8786d","5a7e02ee03","c012b3c771","519384c4ef","f54bc2084a","09d300ca9a","4b0bf731ce","a6793f4a4e","98fbf6a746","cd6c5a9060","4051e671ea","a161c6cb37","d9708f48a0","3f70660dce","aa8556a39f","66cd89fbd7","dd67ac7877","7ac5ec2f24","b28681e74a","262e5b5b7e","91d3d0180a","0d904d18d4","36a8312d45","eba4b9b99e","10fc61aaeb","7c4253ef0e","8c5f316d3b","46a816329b","86cf321b87","997ed32e32","17427a522c","dc2fde6c1c","d129723ca7","09bd5ea2a7","71b46cd557","5291694661","a107baae7a","6c9c53c9a6","99ed2f7963","7938891f4e","a9e97a27b1","5bf1dd36ce","5ed4399439","18cef6fb01","532a09153f","33a338aac3","eadb1c1a6b","cb88166e33","546b3445e9","ad8e544d56","5fdd644eb6","028cd3c75b","18b623d790","a4b471443b","6faab8b1d6","dfe76a4c31","05ef8efcd2","e6bae1f160","c82f860285","42f627542d","d33755eb3d","b5e74d0ff9","1af0394def","2c86ddd782","c87e7bd887","d24cb66a6a","8f9d46aec5","481a118c9f","2000c5ecc0","7db63d44e5","71c4fe8958","a21e374e46","4ecc6b1f00","0803572b2a","db71e7c7b7","8772d51eaf","ada0a7cd34","1d635e3d0d","8a54d52ebd","567fa2a82b","c431072f0a","55df00253b","4ae9f65092","5c156b8053","4c3fda890c","49ac119ac9","ab931b063c","a8c83bc6d6","66269145eb","4ee06bbaee","f7f1f49dc3","930b09ac86","3d33cd7dcd","269f481d2b","83219756e8","d6ee1a1ad7","4ee06bbaee","f7f1f49dc3","930b09ac86","3d33cd7dcd","269f481d2b","83219756e8","d6ee1a1ad7","e4f338e92e","a720a13665","7e2ea291db","95f5923edd","86ccba1f4e","c14aead232","482e844e26","dfdf6e9066","e6589f6eda","f00f39bd29","b49e13e81d","ab5e1000c6","dda90fccf8","273104c04e","4ee06bbaee","f7f1f49dc3","930b09ac86","3d33cd7dcd","269f481d2b","83219756e8","d6ee1a1ad7","6843ebab41","e869b257cd","27e7d373eb","50baf48842","65ba5e2ab1","e4b37a5654","4b8ae43fe0","627ad1506d","50ed4b5682","466a3bb6ad","5f23a4e816","ad27e58d46","23f079e496","adaa8d9cad","627ad1506d","50ed4b5682","466a3bb6ad","5f23a4e816","ad27e58d46","23f079e496","adaa8d9cad","8ed29d2670","d57eaf6c0d","a49bec6150","6cf63b0c4d","b75a63591c","3a455d4e5e","04c58554e8","6e40ed4f86","11f36bf62c","beceedb4a7","899343f013","2d26bcf472","8c05131b23","670a926c24","39c1cfdaa9","bb1082c32a","07c59366f6","571d5c6e5d","75ddf3f372","b42528dc6c","472fefd2a0","ae1bdff964","40b6fe1585","e59113f9f1","513f47bacf","44fcaa59e9","e70b1f804b","e50754ddb9","5d91fa5ee5","b1babaa455","6aa9d0997c","3cae90ce56","ef0a77f6ca","a95a5e9211","666c09bbe2","b8448e695c","5906ec62a0","84bba2e3e2","a0d7514a41","6e6fb1159b","4a5b233bc7","48186a1fae","28c0bf75fd","151d26ea2c","469fdcfa26","6b89a39e01","77f95d3ec8","48d8a43968","c575422880","a5261e9da5","f6c2730771","c77cd914c9","870823145d","529ca46ec6","070b20b35c","bcc7dfd3aa","f691cc89d4","861dfdb4e6","c1df2550ca","986339e1c6","3b552a0f4f","75580f1d2e","f42169e288","d633915717","96df1fe322","0fa18a3338","4d35c69cee","759ea00026","d783de2587","eea6ceb906","443fcb7f42","b9f5349792","29402c3089","1f33388129","221df4e032","12f1caf43c","769567e13b","af850fe9d7","93cde86716","0b9a5565af","e0a385cfc1","a2bf926f3b","16db26f7a3","243d3d8d04","263b61202b","e08dfea0fd","4f7fa8b2aa","f92a881340","11d1551b73","e4f528302e","152cff1a7f","104bd6731c","fc37836421","346b39b2fb","4d97c7df04","3a57991d31","85728e06d7","d2eb4cf8b9","6ce012f819","5929c4ea57","4b4a35eb56","d3a03134e8","7fed0efdc9","54c405e339","7eec537257","3f741dfbbf","0dd60bf55d","0312097266","3655fa29e1","09d35709c7","b731566070","b34776f10c","d61026e597","819e82ba36","fa444d2c15","049a510756","5309386bf2","eed3745aeb","7cb850120a","10beec9c4b","4c297d0810","cc8d14e8e8","e69ac23442","c2866fca0b","39399e471f","6099659b1e","de65cb624d","a1048ebc2d","f04849f3a2","6191bb4387","b588ddf748","dc0c5ca0c9","40771ebcfd","a2913ce6b6","5ccc39c566","5ffbe48dd4","9cfaffdcb8","3d4b4a7679","1571376840","41a22a6036","e82e645a09","334cb0b3ba","04e471e13c","ac73ed97f0","fdb887b101","7fda566440","97a14ed39e","a2b7aa2661","13bc891ad0","c02b933573","d08523632f","c06309d9a7","cb55221b36","12411afa2f","cba54af319","f5c448e0fc","791681f410","f16d88164b","19cabccb34","d4d7211d3e","cbb7f1ee8b","9a2477a2af","83f3a7a321","6951c8d824","7298d0e99c","1d5b928588","d6e89e0e39","e70cabd521","4d5a7bfec6","43b1e0e3c7","3d9dc1fad4","03204eff37","d8c31f5b3d","3ac80c551d","6b275b36ec","5ad15386ee","1720eeb228","adea66ed00","ac82a3b2b5","0799072c9d","1259395e58","1acee105d8","90e2901c42","e989152121","ec3b434ca8","437031e52e","2765312cda","91817a5c28","3c50bc51c9","cfadbaf93d","5f8e0fe5d9","bf08df091e","d2ed727f7f","bba3637990","19aaf773cc","2d342b7273","eb28ab9bc9","5b6c971c6a","4e00f14dc0","83f81bf736","64659b8927","eeaa9ae90a","24c5c7aeac","63c04403b1","00116244a0","e67a83a993","f2e41632bb","ff1894a957","c066d1e512","e782475f32","754a0a4d1e","37d8534c63","cf100e2d22","cead7a40a7","51c9bafacb","e93f0f4b10","a1f4003211","f3d6b17665","e0499a94bb","12d505fecd","05558b71f6","5a6fe7c8bb","18400b0e3c","d71646fc30","95d603594c","48c0246d7c","85cc16bb37","f5c0f066c5","2c5e3269f5","f1acdaed2d","fa6d8807c5","95d603594c","48c0246d7c","85cc16bb37","f5c0f066c5","2c5e3269f5","f1acdaed2d","fa6d8807c5","9b0fc8ab3c","fafdcf5947","d3cb4bc704","31776955ea","3e667ae1f3","101dcfbee3","f2237af416","169d5a8f04","0ad091683b","a51fe30e43","241016ef28","e5f6ca0fcb","1b6589370e","9365f31884","1402a5c4d2","9979a94840","2b3c2f2325","7701ad85ef","0e8a1fb696","2fcd236a7f","0c884a6d71","f7edd7b6b3","412cff75be","1a0519383e","9725d6003c","0476e44f18","af16a27cc4","1da0374664","fa9ec5aa99","8b152de8c3","3538034c0f","b55694159b","f1dd24bdb0","7e871bb23d","8517d3f8fd","c51f17add1","55e3fd01f7","fd1686979b","ba8442d4c5","bc3f64a065","983304952f","42942400d3","ce8646ccf0","a0a427417a","2581a572c1","e00070b286","1595723ab7","5bc3d472da","53519092b6","66a024c857","e7e2f08982","66a3233c44","0a027e787a","363d8e2546","b4aca9cd68","cbe48328a9","68f800ce2a","bc43584d53","b0d5425aa6","300f840692","d1df2753ea","4ae18f26b6","daae6f6d9d","81d92ce3e7","32133253af","047b8a8c1b","0203731dc8","f550d99841","47177134c4","bad060d082","0fcbe6f72b","ad229005be","7dbf95d9f3","eed5d72608","5ec88535de","887b594d61","dc2b750b28","70a0fcf01b","ce5aa8eaa4","793caff7b7","98ac5d71da","60cb9e4325","e7a374186d","0468f0939e","24d172988b","f59336827f","30459383bd","a18b27969f","d2318725bd","50597cbde2","af3a687d41","be84ebc36f","98956b0324","46f8e2a429","6a37b366d3","5695889f13","4e0c2b1ff9","694bf70d82","babc92a3ee","5583b5dbe9","4c227bacd0","095e04029d","e631f85594","07518f979d","e1fe8b8381","0bdd888953","7781b41212","66162cfb35","d5b796c96d","b2badefa2e","b220c6dd42","90917bdd9f","babc92a3ee","5583b5dbe9","4c227bacd0","095e04029d","e631f85594","07518f979d","e1fe8b8381","a997dd66f1","ccb6507c0c","bf88917d18","2e3f1745ff","8ce6c98863","6aa9b3a123","77d7580145","c4af928bd1","d350883149","6282578309","c25208cd60","b2e883f607","f7e25868ea","73f1ee41f1","d6bd1bc0b4","3cf4f118ba","a32787578f","e8780f46a1","d94698f91a","c6b4ab6aed","2507f1dd36","be0cea6e3d","aa5b2a7dbc","e6c9bf7d5a","e43b2fab94","009da726f5","f361b0b665","fa13323427","d87f462579","6c9731f67f","a3c0d4a4aa","6afd5fcdb4","ea313eacd6","1a51a96c41","a83bf0f8fc","0142e313ea","77e04f81eb","308f703d75","e4b1bbe7aa","7203d492be","6e17e5a0a4","ac3ed1015e","784bf20342","e750548c29","8d59a889bb","67b87070f4","424bd1c18a","4c85893bca","d97372fad4","5cf11a86ac","f5195ac835","f6ff1663b8","bd4de42679","a52640c741","fd3d55c04c","d70d76e01e","2efd8fd487","c416109519","ca8733108c","c784e800b9","71d28c810b","febc163be5","37359c5308","784bf20342","e750548c29","8d59a889bb","67b87070f4","424bd1c18a","4c85893bca","d97372fad4","fd3136c3ab","8ce5306fa0","60a74c3904","cab97d81c5","1d08c097a5","5318fe2837","6c0975e5e8","2f7fc10a20","0d50090d71","ef765814d1","1bc9271027","60b57b541a","8a6a185a26","6bffcedbaa","a7de7333b1","bfab8471a5","ea410380b8","9df90d83a1","510420c203","499b9e54e9","62a3ce05ef","3c80ff3e99","d612fe0b0c","5805022667","873288ebe5","df6367d764","9c263c9b97","455da6e1a5","4305d4ef74","38b147f903","d8c8e74657","33d2510aef","642144324d","318ef27f16","b1937c6dda","6e5f518e20","0f7e914ef6","cc89144c55","cb3a0f7a1f","d483d743dc","35b83b587b","59ad42478c","bcef66172a","d140ed5abd","2d0095ed5e","63644fbd9f","67af911e8e","5cca5e8473","24d5bb1637","db5f05008a","793fb4aed6","fccdc77850","f57cc0fc1e","caf24281c2","19fc1bcae4","4839a1e614","99de9ea9b0","aa82e2cd55","b16aec5b72","7779f7c078","a4eefe3ed3","ea742ad32a","22916a8a20","39185b317d","edd93258fd","8f97ad11bf","e5a33289a9","15fb62a5e1","1776cc1308","f30124cb46","0fad8125b2","3f81c19c1b","d8229a3980","19b433f50f","d6930df296","62c35d3952","55f418c173","f996740895","b4ad2c6040","90ec8c9149","e690acf2f4","0ef8d802ad","89d8d4b185","b5275cee98","39185b317d","edd93258fd","8f97ad11bf","e5a33289a9","15fb62a5e1","1776cc1308","f30124cb46","085e21818a","3c782a0f19","7d701b8efc","292a99899d","e426d41ecd","28c38a4a60","c578d35522","21e0f8491c","19791a7758","bb7135a14a","eba482d5f8","8064c86b9e","f198eb16a2","a73cd3fba0","4545cf2578","463f4fb150","405369f417","09024872fe","6bf3402b78","81eb1e5624","85404a2169","3c688230b6","6cbcebd64e","841629ef5b","70a75adb25","947975aa82","49d8107517","f730d79191","f4b36096c8","2bd243a274","a8ea0bb345","211d91cd0e","6a56f39fed","93ee21e51d","42fc8d598a","b6ba4988c7","020f18fdc0","cdedd07a02","9e6db44046","eee7d91337","780eadd429","959d819b74","41a7ca1363","ff6de5cbb3","02d02e1a4c","17e426937c","0cf8ff5b7d","7f9b1bf950","b7987c4125","898d24f373","d2cb34ad54","b5543064fa","ee2bcbd5e9","168e3ff0e1","5ed88ae8c0","0bf776c979","b4708959e5","17c55abd3e","e53938daca","7803d86d32","9252af5e69","557b1ac121","6a54d8d554","05fa5ccf83","b5ef0674c0","b001b8f695","32ea3271da","b2147853fc","0a806bf34d","110f316597","7abe21dc01","70c2665646","a6ef1b46ad","3021b4edee","43bed63582","3a975609b7","63c1b27332","6bcf71c7de","cfd0667584","6e0ddc966e","4e8d76d1d9","e36317fe5d","efbacf5db4","c9adb99c5b","89f9baffab","a1d27c0929","3ce408f6ab","dd683805fd","79017acc4c","1eac0e420b","4cea89f624","8854ee114a","0779acf9a6","cb18ad4cfe","91ff4dbc1f","86e71ae8a7","cd35f59946","7b607a4815","ae89c1278a","8d8998a93b","1a178a2bfe","a0a469fe86","361109f683","b97c9e9365","566094008e","f2ee40d71a","9537c37c06","09cdd8ef4c","233c8064a7","79d8bf3329","89bbd26980","15b757d63a","1863bfc303","a64593cd16","e975aeeee1","b9d5e91431","1593c17d04","7ccf1349ae","c607bf097a","20f98db796","43bd61904f","d5bf0a6ee2","63ab6a3f0b","4eb608d960","48d1c6b4ee","7f5ca987fd","ad3c2fc0d0","63a5eec1cd","e53bb31eac","0d818cddc6","34869c89f2","26e3e9100c","70cc009b8c","f0111a667b","91592b34e9","2f32b89da8","87e231d847","f4d7ad2e66","cb9ed09b9d","a373cd9c12","dc262a1b7f","25a5acafb7","99d5d052a2","dc840d679b","590f8f6b8f","d4a4f41386","62c6de6ca7","421369bb16","3172d1b73e","9efec62a49","72b9a84302","ebe8e5dae2","8bb17d0dee","d8210dcb58","92c8273e43","e2d5f3e96e","f83ae647e5","183eee7ec2","a8687d8ca7","1f0e9938ad","87f9cd39c5","c511092243","89691e061f","7bf04d6bc0","174ed31ada","f37b686ec9","78dfcd988d","37b6863964","c511092243","89691e061f","7bf04d6bc0","174ed31ada","f37b686ec9","78dfcd988d","37b6863964","9b4764e9a6","dd18b954a6","acb6e5ab70","46892424e9","95eac5bbc3","9a406e1cd8","4465e563ef","13659c6074","69cd197464","c03b631ef2","53a6fb2121","215b314401","f516de6552","fea3fd05a4","0400d315d5","a9785c60ab","30f394281b","8bca477dd1","999aa2ee06","564c5572cb","6818ade61e","f8c2dc2d77","19c0ef66c1","3e094856db","e4a8b981e2","5370c33611","62dfe0e051","25f7479642","b43936f701","0c6cd90087","88bec8314c","c36ec74edf","73a6edbf3b","c806f2de06","9e9ed89ec2","e52790741e","771c434902","14c3f257bc","25161f39a7","2c97ac6f4c","27fc7b79db","ea93656665","ea23d514e2","60e8346a62","7186adf265","19ac6d7fbe","c7d97538e3","00cf6b3884","a9535ce2db","79837b1727","b2ca8b7683","0f2cff5aca","8168a5530a","bf3116667b","d285d1d075","221163ac01","ca2e693aa7","120cb34bea","78c956b9dc","69f34ca96d","11f2ceff7a","157a54608f","b642695f8c","ee4bbd1def","51179c3b1f","a0fa00dca9","853aeb153d","f5c9c80319","2503f33907","9e7766e799","9281bc2d67","db90200e00","310a08de3a","22921aebe0","14774ecbaf","285c4f509f","b39e8851e3","87ec97ad74","bec7d8c8c1","72097f5b1b","2e92ebabda","541167ae46","4c4770403f","5ea750b49f","c272dade99","e37d915442","77b615fec7","6f1e185fda","2e1eecbb25","a747b6ef74","248810e16c","92c25d4ba0","1223cad98a","2a3b1c2e58","ee9356e8c5","fd923869da","8a6047fc3a","545b6edefd","f0ae924a96","f25fee3915","a00b5b4d81","65d0083ac7","95df2e5a4e","8b0674fee0","256e4bb910","ab4d47d93a","9cd54a1499","b92793573e","d1aeb587b4","4dec70e80f","42fc8e96d5","4cffebe505","04de7eb10d","9f49a9dd4b","748a7d1022","88ee424477","3904949b25","6b00842da6","930bd42794","7ab5658e13","e1168f842a","7e155467b5","dfb798e50a","e40c51bddc","f381c41f91","595f60c617","53079fcadb","3408b51f59","f78e66a6e9","c4728c3718","e2125e7de8","6651881a39","9b82839cc8","cba1dbe660","13144d7fb5","f4795f524e","fae7686d88","3bb2218bbd","8a607b0703","1441806d21","6c444a4346","73d38d1c9a","efc8b34e4b","2bfb5ff128","f8b8200285","66385edaf7","7d527c9f98","6c444a4346","73d38d1c9a","efc8b34e4b","2bfb5ff128","f8b8200285","66385edaf7","7d527c9f98","0dc4075a2e","5ad456842a","9d994ed441","a2d7d3ae22","34edb1f51d","e60fdd6d17","ea2e1d6711","598f965713","92bdaa396d","4de56d8573","450540b4c7","7b0ae1c3a2","25eeb30915","98046b7bc8","68ec4ed210","a8bcdc8539","eed4d53ff0","5fa6a51a95","7adef100ad","b237090c63","8b60c9c7e7","9acd2d59b5","bd3d558b0b","0529f4d888","7131c31b23","d1b97de3f0","057d1a483a","73b0c5ad5c","86bca23e93","234513739f","79275b35a2","4641a173cd","8f6e4a3701","18e8b4e44f","83f0798f79","ba3f7e6133","885f51696e","472ced5fe5","acfb410fae","1d6b33ab30","9481932142","5167712628","5c2d92b268","38bf1858fb","8636738e34","8901a6406e","9e72dae634","c2dcfc9e21","ddad00edbe","509e602476","b33a3e08f5","196cc7878d","0b30e5eb38","1af480d8f2","5849947629","093a6a8299","56bf6fe8fa","22e2cacd56","9d7e974dc7","9d39d7760e","9ec6cf43c7","3887025de6","d6ddf07e6d","bd5a0ceac7","3a109e9376","17b030e123","0a482c533c","1660c81fc4","f67deba54c","d33e4c82f0","ff69884525","caad4a3e27","39edff19c1","83ca16a95a","403181fc0b","acfd07c28d","152dc2bd4f","5660a4a1ea","0e8417b2d1","f5695aac8a","aeef4188e9","04105c9aab","ef6f0c1aeb","df3e1e5ce1","b3a171ffd5","d0114b3ff7","74912d7c98","b332bcf93f","366630de6c","9b0bdc308e","9488e8da4c","8f3ebbd350","74f0b515fc","66390d6021","16b00f316e","0aaa5b5b74","637a1a7ad6","0ea7246baf","09920e986a","ec1dd0b443","a4261718cc","6ae9cbb539","eace71d433","deeb43508e","86573b24a6","0e03357f6f","2b8323fb2a","df9f2cdf00","8b29df7139","62d50cdc43","4ff3ce9759","6e4a2d7e9b","c7890e50ff","ec7a4a39d8","39be33918a","858bbe5cb9","335f9f4b0f","f84ee12382","a2e7bfd26f","541d44d72d","ccd921ef08","9473984fcf","f62b4fca1f","4eae8552a0","18ebc13554","c19b25c6b8","5b5f63a627","79110fe3b2","4348c443ec","9f5ef24c26","7588a91aa1","72e2556c69","2c9a81525f","4a93a3b79a","0fdaec5738","9eb842b83a","c245e1418c","44931977a3","55f4341f49","a5593e32e8","4a93a3b79a","0fdaec5738","9eb842b83a","c245e1418c","44931977a3","55f4341f49","a5593e32e8","d8cd855465","03b2afa91e","e1f9f80a4d","cc2ec92fef","8fbe0108ef","549f2a6c6a","505c69ca72","5514b3f780","93ee498c15","e9b85a22ca","a6cd706e45","17fe83e1b7","9bd08f5bb2","d78d16df02","6e9480a02b","ed968141cf","7a53dfb1dc","c8ed885a11","4086491fe8","545acc4966","48db6f8803","9b4afc343d","1ebd1f099c","f267f30412","faf18bc36d","7fc208a179","b122152dbe","3c24275453","6e1b66665c","1c9c78b04c","47c7a20071","147e840219","cc7e5e99e7","8769c898a2","8a2aa4d792","79576c22c4","3a2f3d7901","602a7bf49c","23a2abc9eb","23a82fa10b","babeed1095","5e6ae49311","f4945d739e","f456c648a6","51c307479f","bd4f03227e","95836688d3","fe9ca271ff","3b92436558","52c6c72987","e69dc970ae","8468592162","ed567b0938","dbc206c597","c059a74535","9977d3583f","1b9c973c8c","e37a9efc8a","c22c11b671","e58ae42105","397fd91d5e","66154d2957","e534eba825","fd5a151734","4f5cbbc66c","0a7742a087","399e50b1b2","9977d741bb","97276ded95","81d8e82ad0","d8c9f69189","3c5aca013c","fae4656c6b","9ef2a07026","2f13046a8d","3ef76a0718","2244028983","14ba3dbe2f","378b7e3ff4","10102f11d4","53c4a058a0","29168f3f4d","045cb3fc8d","ba07bc6210","bc77a9c23b","579c06b916","cfe60d68f7","20a0fed1dc","2e6ebc0cdc","98e885f337","14350dbe71","d9d725444f","180068ad06","1e95ffcb68","86644ef585","605199605d","348d5d8bd7","663c2db1ad","32347eae95","2b7f549aef","e2038fdb54","28ab1d8e20","1c3b5a8b94","f3409433b9","cbf557bf47","4defea5688","93239a2ab3","aba70ffdbb","2e1f951b2a","c0846f9142","7bf7805851","9cd8846fd3","520c0e981a","2266ef0bbe","d18baa85f1","53928098cd","da25c163d7","c4eab16d6a","899e913fa7","945dcf5faf","a051faa237","4a844213b9","d2cb442352","d56fe731d3","a4e7f20190","348bcca4fc","772a46c5d9","a30f5b8102","1a696f64bb","d24cd739ac","d724822295","18cc952890","a6e35be251","5b89e6f0ae","08a7ee70a7","1348143f49","adcfb13835","54275c1f3d","69d90cae0e","eab3a7faf5","bcd85a3561","d4132119ca","4f6c47ffae","a0d8f6c834","83a7fbaca7","15353e96ea","4897469398","9679f1280d","a45ebd7e2b","09094f11b9","3a9c681856","8525216bde","3cac007c4d","0a06a56b72","c7bc6ff763","ded171a405","0604006e97","45a6de7081","592abc47cb","697d5fda5d","aeee9a329f","27dc881147","6349cb85f0","f92eac8d09","f22e3c39df","d4b987694c","8af081075c","a0f1720478","d36680b2fc","221713c1d8","6ab378fd6b","c7d0daee3c","16b8407182","c81b7c5ac6","47bfa423f7","1bfd1104d0","1bbae49926","c5eff4ffba","de9c00c548","c93990fb62","c6429fd9d0","48a7619c7e","c59e16f2ef","afb7575c99","38a5eb259e","54901457b8","3a707e497e","7f419a4e3f","9a5e3d8211","b533ef001f","a1846d1243","b18b837033","45b0dea741","feeffe1e2d","9c5699225d","633a2e8f0a","2ff1c9159b","6acd14f6c2","04defa3d77","723a77c4a6","ee59113132","cfea0267b8","824ab967ef","cae98ab184","ac706bc0ad","e9b0aa8d8f","be4f0ce108","5e09e44439","b9faa2bd80","5c4db64e4a","16e8c072cb","acefda41fc","b69b58987c","348515e69a","7c019f3d18","e29e6935b5","9f443d9c81","6ee2a57b0b","f5a39434e0","b10f1c65b1","30b1c0ca2d","4e0bea5ae0","cdb04e7a75","025a7e7573","0cdbc018a3","fcf78cd184","3b1ce5891f","af9cbbe879","ff4b55cd4f","52ca8a73c3","6c2e4b418b","437d8a8366","f1fe2de079","a371003d13","500e17b43f","bcb01b42e8","7d28777b1b","13cf10dcad","a866c187ce","49473bc2b5","39f396d384","a929d220bd","b6372e91a7","743a790e37","a79b7fc4a7","437d8a8366","f1fe2de079","a371003d13","500e17b43f","bcb01b42e8","7d28777b1b","13cf10dcad","ef5ba9c7e2","c8209aea04","15e91900f1","37aedddeff","5fcc5fc1ee","e89de5beac","f2857d3fbc","157cdac2f0","00b2028491","44bf1658c1","083481ebc8","8d0173fa39","6ba10417ac","f7b6299d97","58e2a2e077","6dd5bebf57","9a02b15896","bf9848c4af","58b9a83496","944e2ec5b6","4636ea8915","05302c84e1","d3eade7b9f","506cac0ef1","f01308d46a","14d54697b4","c32e886a64","cf0f7e3300","6516d1af8b","86ec8e434d","8bb238c7fa","509c560416","18b7f92244","dc46c56002","693e360ae3","fd3a7c9c78","ffd342ed16","888e1f232b","c58545d403","64a65376f2","5f673eccef","11b72b0feb","ad37e5f924","35dc01e1b8","9f34e44c2b","4bb9a56bfb","9580ac4dbf","d66092962b","0792639bae","9c709b83bc","52da61750c","9b424b2640","4a131e4b76","95e86a4996","088ed0a4d9","c111fbf758","5d1160e13d","f386271fed","49eb133703","bd107d7d7e","b7d450f3f4","5951a7d1f5","496366687a","82e62f477b","ea80cf6667","1ac61bc80d","8a1d33e6ce","fc47a334a5","a9312b3a33","9ad342469d","e8aa845dfa","3f5f834165","fe79ba28a7","6169bec3ed","fb7a98831c","50ecc6b271","c13f7bb039","1fb57fa992","647258deae","b5ef2a7a1f","d27034b758","9d115af66e","7b912cae55","43f55cac86","2a8c972511","e5b529dbc6","52d402eca6","6b5a5c174d","a1267df169","a50be46dee","c64bae7259","56be0d42c1","d069abefba","c83db77419","3a832dd45d","fbf0a92a53","ce1791dbe8","f564490fbb","82e62f477b","ea80cf6667","1ac61bc80d","8a1d33e6ce","fc47a334a5","a9312b3a33","9ad342469d","368c99935d","484d98acbf","d0b99490b7","47ef7fc601","268f4cf042","505fdbd9b2","05c8f71766","1ca052b0ab","f4350acca0","75efb2e786","240ab20bf7","c8f5c26bcd","4dd0f4523e","722cad650a","d0292852ae","ca9036193e","28e21e9605","a94e4824f5","9451eeddff","5f7ecec06f","6796f8b9ab","e6102ebd1b","455fee3916","33b429b1d2","074824395e","dfb1672523","9d36b8a789","50e668b6c8","65924f15e4","f4b64fbc7c","94154df7c7","56831a82b2","0b89a7fb4f","c11a65cbb0","1240da1a3b","65924f15e4","f4b64fbc7c","94154df7c7","56831a82b2","0b89a7fb4f","c11a65cbb0","1240da1a3b","0202768e27","f52142610f","485d118cbb","a03301bf5a","20df3f1c2b","643e98e0d8","afe75ad483","8e1244144d","005e78241b","11925c2605","46c8f77a08","5a993b95f7","86c03e011f","ba22f28199","55ab5663e5","17ebe43721","5298f6f6e2","c551c9e823","e753318fdf","0dc184976f","f1e4340d48","481d1939fc","bff5024192","08e2b39384","4345f3c921","a1388972a0","8394183eff","1afcd1d53b","6b86c36c34","f99ce60e03","0e7caf6a8f","4df60fd3c7","b659903c20","96c007be7a","71191b4fd4","a55404c243","fc9bfdfd8b","0c082b98fa","c3cbfb7b33","c83f159aa6","12c558bf39","224901a4eb","63aa43af29","c9ce11e73f","3acec8eef2","c6b2dc2cd8","712161db48","f4c59f53ea","94d7b4e5d7","21dd63cb3b","4bfdce197f","8a34203948","7744540d88","4eb62dc708","ad6b520532","8a8e36115c","d153f97718","8b75244521","77a84d9e23","7073519470","58da49a108","95695b00b0","a742912632","3c15af0ffc","f622d89496","045fee151b","53113df56a","9defd8e421","99af99a2ec","bfcec1ddfc","1344aca0f4","25e62d1a6e","3a2c1f1b1e","ba6bc409da","46cbca2583","01387b1dcf","476217427b","8a656aca7c","55e41baf7d","351f076975","740fb23887","29bb40580e","5155272aed","75f1c0d1a6","d4910ab6ab","ff42575a3d","5ea3a043e7","7b0f2b6db1","56ed10034d","cf3749cc59","fd223c55c7","85f6be545c","fc36b0c709","07f7f4ffcf","e95bd40552","134a0e12fb","e32dce4e58","24420293f0","bc8bd51195","47f0b487be","93ffe47546","c44ad2ae11","453e8cff77","10176f5d41","544c0188bc","e3b32238bc","83aef2c7a5","952b85d6e0","433732f7e7","cbaf6e95a8","c72ca7462f","e41c47407e","ac2fdfc7a9","f484adf4d4","cbc3dffd41","b7a288e6ce","184735fb6b","fb227c292e","0aeccc6673","47c0c3732b","a1e873dc91","948141b321","e9f899591d","51ae20936c","ecb008e97b","f79e40eae3","0016458855","052613c5b1","5a20aa8682","2186a1a880","a71240e70f","c3794b80ae","2b57480ea0","e8126ab849","b4b12efb94","9aefb438e5","4a036b22b7","6f0a2c8663","b563adae62","cc95fba984","43a5d604d2","65d998eb53","e7036c2b11","396115c316","87ead545de","edf192a9da","ce25c73caf","8c3b311d2d","d85e3275ce","d749ef7aa4","530bd8931d","3d1a1c9840","4cfed75e06","73cc02f1a4","2308a5c761","4048c08aaf","facc7dc1fd","e67a6a1dda","e8981d647f","3e637ce473","a7f11df33a","7e60cd2104","da0584b107","130840a067","63dc918ac3","3c51cf3702","d4fdc5cea3","3da99a5227","5d97f6630a","30972a0fde","28e78eded4","810e12d72a","e3404a0c4a","b33b8a94ef","d0271ab5ed","a11b40247d","30617170ba","522ea5ea95","47e379520d","85e36019c3","356dcc3ae8","b59c5ec0bd","537c783dcd","29d3bc30bd","1e940db69d","6218a91f23","f7920b9856","be6c517692","9077588534","22133bee94","a44428bfb8","615c2fac83","3a8b6562e8","f9b6a078ef","3136284ba4","2bc27fa488","d9a61ce184","0859378616","1f2012c434","2dde1b8f74","32a2949b76","a543ee74af","5468635db8","f8562c0f1e","495bfa89b7","14ba4b1432","4e7083d784","f23a548549","9d7d74d893","0b33722cfc","336a784aff","673deb4bb4","970039a4f2","a047ca79d5","601e7f545a","a91883e90c","0913497704","326998cf7a","aee0056906","3ee7a02a0d","13d8e40a8b","3f3730193a","376f178328","a3370ac22c","578fc373b2","037e35207e","0e9a1828df","11e8bfb89f","b7bf094733","8eacf2485a","be41040a3f","dc58d319da","7f3180f0a1","642bbc4e53","9944aefd5a","3fde5189d0","eb46035776","41b5755e6d","83c6902627","fadf5c51ab","37787706a1","4565ed271a","9e6ab4ea1b","ff3e1bcce9","1a903f9e48","9afafdd0e2","eb98b11ae3","7b954d1352","1968063f94","ffd0704f96","ddd0cdfbd5","281bc34cfe","0fb979ed07","8b6fa2e1cf","f190da4109","4cab3e56de","280bd2b37b","ed8df094b4","04bcece39a","5841365e5c","2dfc927361","a74068cd9d","0d7f6b1bbe","b8be73cb14","4a578220b2","1ac70208da","a75ecf4bc3","e1b1325877","9f1cccced3","3e3d077938","327ae4f70c","a9defe6c6c","1df4cd1182","6fc882e337","d411f24194","1f8101e19b","765c38b4a6","6750a714e6","6d01e2a4d6","80a05603a9","50f2c9d933","b217ad6d38","c2efb27d74","c73ed990f3","6fe278e4d0","61866abe1d","6440d0bdb6","1e9cf2fc3c","fac2955a83","00cad9cc23","caa671520a","8232ea480f","5269054479","3c4ba1f9c8","8d0238a81a","09aacddf69","726d26c7fd","0f2c187d08","1e95f168d0","82d4fce8ca","d94cefe520","bccd973fa3","ec73cfcb8a","1dcaf790ac","d1a9811eb0","f1a20b62e3","44de7fdd55","ba89aaad53","1aa8180000","2e492e8d0f","775c8d49fa","004b4660da","4919ea8586","8332ec7ccc","c2559d6d50","6d68b266a9","5e5ffbda75","9719033b40","5bc3868a2f","697d86f1f9","9cd4eef732","0e4aaba216","4a67931d2a","c16d13dcef","ae6412382a","5cf4072174","1df7cfb3f3","f30d3bdc88","5329118322","05e54afc98","4a7789fba6","7a6e0e9619","e583279ab4","471b5e1a48","4063eaf5f9","9c9bd1336d","347df9afbf","30d7dfb23f","400f59d216","17d42a7060","6b372799ab","d5341fcba9","532f535577","73b04393df","a99a1c3056","cc673c77bf","4c769ee94a","77ed36139b","816766b71c","b039d243b3","db1d1472ea","031ee56c64","9784a2d9aa","ebb8e5a037","8d95f6190d","1efc2b087d","dcb9e58ef9","54a16b4b70","73a5cfd419","8a80ad2450","aac1bbda83","022961dfef","717398e3a7","1128b03eea","b7544f3c76","61337cc785","9b9f50d334","e25f0007e7","cc3747d0dd","7beec8fd2e","18459bd6ff","6a11bb3cc5","2d859c0d6b","052efd7a18","ab41b5f42c","3899b7ed41","db5ec4dee4","166945cd69","80a94e0d41","0052d7ffef","ee87d5831a","85b8932a4b","8bc806b45c","81349db449","ab73679414","9e7a0da0f4","e6a0a2a888","0b0e3bd084","f1791aee63","e1aa47840d","f2e6cac983","7edcd3c9c8","80a94e0d41","0052d7ffef","ee87d5831a","85b8932a4b","8bc806b45c","81349db449","ab73679414","c36586f80c","75fcc9b852","38713321b4","dea985b25c","f782d95a83","9a978c20a9","3efe720f2f","21cffe7c3d","3f4ec7dbea","199759d9a6","0accac9400","e80d1b2838","201b86ea89","f0e6158794","183a228673","a43dc701dd","1e2e1e4078","60c203e9d4","b3e2667a79","aff943c58a","9e015487b6","70e2bc16ce","1301bba4e4","462c397415","6ef044e93f","2c2d553833","65a85a6b4b","68f3ff2c61","24896b5907","fb1269ba5f","d62fee3151","1744bbe5b2","70ebb14abf","269b402aeb","e7468c6804","72d27f392f","964ffb878e","c47453e53a","838a1a7022","cb9d789db6","058646a9a6","7c873b172c","ee8abc4924","e9833afee7","f2c1514eb0","ef59fa5f01","f67a272732","6c7e6e167c","13b2c9614d","c601311cfe","9e75c66ecf","778d6d36cd","de853631ec","0e5b302ed1","c52ad1f6a4","b41d3f01e4","13f1ac8524","e49e1b9571","12c77abd85","d675c22c94","3b6aaea20d","97e5ea1a97","c4ce1787e1","13f1ac8524","e49e1b9571","12c77abd85","d675c22c94","3b6aaea20d","97e5ea1a97","c4ce1787e1","44caeba0a8","16479c19ed","919418176f","a3f23bc41b","c266eb49bc","f77f86605b","e39b64fdd1","72d27f392f","964ffb878e","c47453e53a","838a1a7022","cb9d789db6","058646a9a6","7c873b172c","cae23bc95c","250feb92e6","8b73ce6c11","945fd78bed","cf2fbc2db9","ca850646e2","8c9cdd195d","4e51448547","b123277d16","42886e6dca","8eafabb38d","ae7dcbbf83","b6d655b4e0","0b6831fb43","0e824329ed","1e473222dd","0d62c3fa94","6a1c9f0581","1553756ac0","3bcdf98dce","98a5696db8","e9e76eb4c0","8982aa5cf8","234a90ff24","ebe48243cc","038c65fbaf","651959f10b","0d4443cb02","f8043ed487","6b3e71c1a0","b51106d829","18070886bf","0b8814a81d","c58e6ddefe","ea57016372","0e824329ed","1e473222dd","0d62c3fa94","6a1c9f0581","1553756ac0","3bcdf98dce","98a5696db8","74efd35d61","b4d6a3f714","80bb52bea7","504eb1ef95","808c0dddc8","e6f971e910","039918b547","b48f18b902","e72b7a79ef","8f00d85f21","6a969ae4f2","227a8f7d43","2c20bc8f38","9c67e95ed1","1ebfe4d00d","a7d81439b9","05ed7614a4","bf01449f78","7debc8e2b5","bd8eb90aba","4488966095","250cbe2b8f","1bce7aa3e6","8c806656a7","a5ab10db94","a2a6a9ead2","ddda4d3415","78a41e8327","ee0646c9ea","f234f57ecb","a508a6e249","b359472498","601d7968d4","1ce2f85e5d","628fc8809e","5f8eec16fe","a01467f4cb","3e1a6d2e11","1d6d402f0f","ad7c55b0cf","f1eff37056","007cfdd7c7","dbeefc0a4c","b8fa768952","72e5d33ba9","b86a7caf2c","ca509e6d36","e07ae40650","52e57c1827","bd5a68e7d6","ab1719f406","78f0742fc8","52a5996d4a","ca9a3e887e","ce28c4ebeb","bf169e6d51","5e2c972129","cd36d3d012","f89ee02e60","0179d6f7c0","a142920b5e","86024189e3","3c2c4fee39","c3d3efa28a","0dcb6bbeda","7c58699bf0","cbbb11002b","843ccae6e9","a9e1fc8b72","839a6a9bda","dc079033ac","22eda80788","3b81208278","6ec2fee5de","6adcdbb85f","59ca384613","0e9899297a","5efa7bc57f","24cad970d7","1f8bfb609c","5b01ece056","1794a3ac99","82063ab806","41de3b852b","a7cd2b6293","f5ff30800d","91daed998b","9518c7c9e5","4526cdc797","0b49837272","25509900e5","3efcf73e59","1e06f24e1c","a06e7e6de5","98fd0d8e64","8273e6bcaa","fe7382c478","37b4355d8a","f0fa6ad01a","162eb33535","06cf75f944","ac10e9c5bc","5661f15b71","6b2735917d","b96cca1962","c0834b7498","630e143288","dbab2d17f6","e98689f432","ec9ae3d63d","29bfd99e9d","fca22450aa","cb9891a36e","14215843ab","00b780b4b5","4edc6d83c7","74d1343cf0","a15d9d42f0","e9db022a57","7b4e249408","b2148eb564","0fd20f4ec7","e9494f6efe","f76283910a","cc2c6490c1","2667d28559","66dd919adf","e0712eeeb6","db1a811ab3","fc45984e14","276f5ddb00","19a3dc5b8e","00b3868e45","4c39f09209","6600bcc542","f948655100","88a0ad3cf1","37f065432d","7da132046e","d4c94f3ef4","f87cc2094a","9b354de5b8","6334164648","8164c6b7fa","28d6c52ac0","0dc4abc8c8","20076c5177","44ba2fb807","07313b45b6","5e997a9fc2","6fc2c4c0de","fe9f139683","ddefaa8d78","3bda998775","4a51fd22e3","36b227769d","abbbfb00bf","a1c4aff471","c1c9a0baf1","cf76216761","a6d550f127","e7c3d895e6","5dea36a4d3","4c144e4f5c","40a87902af","d6e72287f3","aaa0effb7a","8eb5dccdbc","51ded30eef","171275593b","743d061920","13dd859032","dcec667c2f","b86d04e02a","17de10567b","a00d6bab6b","3ba275d1b7","2994035921","dcf140be57","9632278ac9","e7f53bd40d","37a2c8cf5d","a00d6bab6b","3ba275d1b7","2994035921","dcf140be57","9632278ac9","e7f53bd40d","37a2c8cf5d","33306bf496","b02c075220","647557c40a","4d49fb9fc0","67631bae0e","4e7cd1c15f","15b0603d66","7967acdc0c","caa32ba274","9aabba5419","206f2d21ad","ba6f26bccf","86f693bef0","1c940753e5","7967acdc0c","caa32ba274","9aabba5419","206f2d21ad","ba6f26bccf","86f693bef0","1c940753e5","fbcadb9d5c","f31010d1e2","28ccb2c1a5","681b6c3bd1","b41123a0f8","132fb80b98","beda5daa0f","59585dc862","e837de1b79","a4f43e53b0","4c7f3f4556","46bc53e266","272ea2ba3c","7c9d1501ca","4cd61afee7","9047e830d9","20e8f919af","f879676711","707e463b80","0011432a58","8a035b0abb","8362fe169e","8d5bb64b23","2a7b9d3fbe","bb549320f2","ebca34f0d6","446cbb16a8","c44d734fa7","11dc120c25","2640da45a9","30ae9a5dc2","05ab50cfb5","b39932290e","5faa7ef0d3","f961cf447f","5e52d9394c","065da30175","66d977e67c","ecc5c4d920","21a648d717","003d336f7b","0af2682dc1","8385a8af8d","41314df109","1cea34a4db","db1ca15d22","d6e00a4490","773d3be513","e641fe4769","f6d5320ccb","e01814379e","d88a40d2d3","625ff7b967","fd623a21ba","17e7f31314","a721136cb7","d7eefec10c","1cf71ee0c7","a2207218e7","9548b58bea","3bcd26aad1","3ba1159c92","c2a541d7e1","d38003c49e","5e18e28cbe","678437d6f5","e611e5d30e","fe91ac00d7","26ae318e89","9f65f3773c","ab88bf6da5","46f5640c1b","e77425bcf1","0ea741c3f3","bcc8e432c5","97f6220fd2","104b22edd4","a8277ad569","93ccd65b89","d0a3699101","2e64923ed7","415f5b5866","4530e096cd","a66814a89f","e2310f2b79","3098de8e8c","3199c5166e","2587668646","d582dfcaed","849791749b","8be18a3f6d","e50ec981e5","7b9920f958","ac60996e86","fcb434203d","a4e12da38f","38b5a4fa7e","21250b4fad","ad6d6b3cd7","64f50a63df","c34d3d928a","7627fa5aaa","46470ce791","4f38937b02","276182a8f0","7ed9ccb191","7bc0becaf5","0ab5b888bb","4eb587babb","8f996b3aca","910c3f9065","ea588bb7bd","e50ec981e5","7b9920f958","ac60996e86","fcb434203d","a4e12da38f","38b5a4fa7e","21250b4fad","89c64b07e4","7de69b1f7e","a68041f415","5b982913ad","c7fbd11961","af16b8434d","00fe2b9781","aa2f80e42e","86727972e2","e94f1271bd","da5a22b2bb","a84f3d1d57","dcdc054d05","4fab7957c8","af59802ee1","2ba1f0d9c3","178b6638e7","9ca9c17d34","9e2bb708c5","0991c1a644","5c9c79d398","e00e8b553f","1fbfefe110","23159126cd","f0c54c19a0","6f92abc90b","ef136594a3","ba2d7262bb","f49d2c6b31","655a29d938","424e566cc6","a1dbeeb4ed","c49ee347c6","dc50863ff6","3e45e50eb8","8a14662c24","8b854a256f","c316e001c6","47d20674db","a3551b027a","152223e990","6a0ded3fa9","b84c027ade","20eaec2c28","0da1f89ca5","452bfecfc0","6ab66b9e5b","d156d53762","f0f146d1ba","317ad9e415","9cf4c366ad","7b3b17d78b","16dc734db9","ffe8abba5b","74a74de788","7d220397ad","9c2bac5628","7ac67112d2","7bc4c5904d","e4f91590a8","f749be0188","949fb13277","d57a44d1c0","9c6e078413","eac0fed581","7ea25e8c64","7df1a7ed8a","c662f621ed","666ca10f0e","71185f0c06","8905d31b5c","e3966794ea","5ee31d5d99","2196a747db","ed68fc92b8","0fc2ad2c2e","a834945c39","9045c1fcd1","ffd30b75db","7b0b1c4a3f","807f1be683","88aa930546","db04181e69","6ba702b005","598d2a90e8","071a9e42c7","eec7a246e9","11e4c8a4aa","c0295af2a8","1d972d5b21","00f17e94a8","7890617ad0","3e6acc8ff4","c3b6652e43","a13f34a8b6","dee1168bf3","21badb999b","07c7cbc945","2a366f3dda","3f9c9db9ed","41cd18ec29","84b862fc78","3db5417cd9","afbb204073","ac02ecf22b","410cdfc17f","12dc2fa2e2","bfeb648ec8","4502f85b19","1658b89bc5","ea6feca0e4","d36e3f6422","14ef46ea25","61f7701a13","a056e51ee9","d0a4abeab7","77d5bfda93","a004031128","140bb0e3e4","b7d6f8e2ae","19da16a527","945df17942","363e54dd5a","4e897c1543","c4bd5ea6a4","88e2ee7e7b","b226b37cf9","096f80654a","95eb5c7e1d","c86e9d512a","dedc501a5c","24a8aa8f08","f9263bf7ef","3702856e4a","f6bdc05f02","02d294a220","61618e60eb","c9ef91e002","5db525bcb4","968646aaf7","19c2fa7b56","bd13fdd4f6","25b975fe2d","8550a591b9","78c18b0cb0","8eac93e363","2822623332","a47f5f6a79","ed9c3dcc7d","92381066c1","8e140bd48c","29538de76c","2ba656c33a","363cbefd35","636a49a7e5","347fc2f85f","efeede0036","b674853edf","530b684d32","de60db50ef","95eae605dd","456f235e13","e4c31676bf","8bea587bd9","f3976ae28e","a120203532","9b753414da","9091e56cd1","52d85d8b10","4316b073b5","3a5a905ff1","a13141a26d","190f4502f9","5098b781cd","4133cfb789","eadeacb00e","8ca007f190","beaf591cb8","f5298be93a","0669f8bee7","855ac2f9c4","a4d47199cd","bbfe50a496","08049ef195","4de438b233","295b0f2ecb","a35e0de3c0","3f2591d4e1","f7192f56ae"]}
```
